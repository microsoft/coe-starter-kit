AssessmentAppScreen As screen:
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)

    conMain As groupContainer.verticalAutoLayoutContainer:
        Height: =Parent.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width
        X: =0+0
        Y: =0+0
        ZIndex: =1

        conMainHeader As groupContainer.horizontalAutoLayoutContainer:
            FillPortions: =0
            Height: =50
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =24
            PaddingRight: =Self.PaddingLeft
            ZIndex: =1

            conMainHeaderLeft As groupContainer.horizontalAutoLayoutContainer:
                Height: =100
                LayoutDirection: =LayoutDirection.Vertical
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =50
                LayoutMinWidth: =50
                LayoutMode: =LayoutMode.Auto
                ZIndex: =3

                lblMainHeader As Label:
                    Alignment: =Align.Left
                    Color: =
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =16
                    FontWeight: =FontWeight.Semibold
                    Height: =40
                    LayoutMinHeight: =32
                    LayoutMinWidth: =320
                    OnChange: =false
                    Text: ="Power Platform Solution Assessment"
                    Width: =512
                    X: =0
                    Y: =0
                    ZIndex: =1

        Rectangle2 As rectangle:
            AlignInContainer: =AlignInContainer.Stretch
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =ColorValue(AppTheme.palette.neutralLight)
            FocusedBorderColor: =RGBA(0, 120, 212, 1)
            Height: =1
            HoverFill: =RGBA(0, 120, 212, 1)
            PressedFill: =RGBA(0, 120, 212, 1)
            ZIndex: =2

        conMainBody As groupContainer.horizontalAutoLayoutContainer:
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            ZIndex: =3

            conMainSteps As groupContainer.verticalAutoLayoutContainer:
                FillPortions: =0
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =conMainHeader.PaddingLeft
                PaddingRight: =Self.PaddingLeft
                PaddingTop: =24
                Width: =280
                ZIndex: =1

                "SubwayNav1 As 'SubwayNav (1.0.19) Preview'.pcfdataset":
                    AlignInContainer: =AlignInContainer.Stretch
                    DisplayMode: =DisplayMode.Disabled
                    FillPortions: =1
                    Height: =200
                    Items: |-
                        =AddColumns(
                            colSetupSteps,
                            "ItemState",
                            If(
                                ItemKey=configStep,"Current",
                                ItemKey exactin colStepsCompleted.Value,"Completed",
                                ""
                            )
                        )
                    LayoutMinHeight: =200
                    LayoutMinWidth: =200
                    Theme: =AppThemeJson
                    Width: =200
                    X: =0
                    Y: =0
                    ZIndex: =3

            Rectangle2_1 As rectangle:
                AlignInContainer: =AlignInContainer.Stretch
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledFill: =RGBA(166, 166, 166, 1)
                Fill: =ColorValue(AppTheme.palette.neutralLight)
                FocusedBorderColor: =RGBA(0, 120, 212, 1)
                Height: =1
                HoverFill: =RGBA(0, 120, 212, 1)
                PressedFill: =RGBA(0, 120, 212, 1)
                Width: =1
                ZIndex: =2

            conMainDetails As groupContainer.verticalAutoLayoutContainer:
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingRight: =Self.PaddingLeft
                PaddingTop: =16
                ZIndex: =3

                lblStepName As Label:
                    Alignment: =Align.Left
                    Color: =
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =16
                    FontWeight: =FontWeight.Semibold
                    Height: =40
                    LayoutMinHeight: =32
                    LayoutMinWidth: =640
                    OnChange: =false
                    PaddingStart: =24
                    Text: =LookUp(colSetupSteps, ItemKey = configStep).ItemLabel
                    Width: =640
                    X: =0
                    Y: =0
                    ZIndex: =1

                lblStepDescription As htmlViewer:
                    AlignInContainer: =AlignInContainer.Stretch
                    AutoHeight: =true
                    Font: =Font.'Segoe UI'
                    HtmlText: =LookUp(colSetupSteps, ItemKey = configStep).ItemDescription
                    LayoutMinWidth: =100
                    PaddingLeft: =24
                    Width: =640
                    X: =40
                    Y: =40
                    ZIndex: =2

                conContentAll As groupContainer.horizontalAutoLayoutContainer:
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =24
                    PaddingRight: =Self.PaddingLeft
                    PaddingTop: =24
                    ZIndex: =4

                    conContentStart As groupContainer.verticalAutoLayoutContainer:
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Visible: =configStep=1
                        ZIndex: =1

                        conInnovationBacklog As groupContainer.horizontalAutoLayoutContainer:
                            Fill: |-
                                =ColorValue("#dff6dd")
                            FillPortions: =0
                            Height: =50
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            Visible: =hasIB
                            ZIndex: =1

                            "Icon3 As 'Fluent Icon (1.0.19)'":
                                AlignInContainer: =AlignInContainer.Stretch
                                DisplayMode: =DisplayMode.Edit
                                Height: =200
                                IconColor: |-
                                    ="#107c10"
                                IconName: ="Info"
                                LayoutMinHeight: =20
                                LayoutMinWidth: =200
                                Width: =30
                                X: =0
                                Y: =0
                                ZIndex: =1

                            HtmlText2 As htmlViewer:
                                AlignInContainer: =AlignInContainer.Stretch
                                Color: |-
                                    =ColorValue("#107c10")
                                FillPortions: =1
                                Font: =Font.'Segoe UI'
                                HtmlText: |-
                                    ="Your organization uses an Innovation Backlog to track new ideas, we recommend you create an idea in the Innovation Backlog first and return here with the link to your idea: <a href=' "& IBLink & "'>Launch Innovation Backlog</a>"
                                Size: =10.5
                                ZIndex: =2

                        Label1 As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =41
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =24
                            Size: =10.5
                            Text: |-
                                ="Solution name
                                
                                "
                            ZIndex: =2

                        "txtName As 'Text box'":
                            ColorBackground: =
                            ColorText: =
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =250
                            OnChange: =Set(vSolutionName, Self.Value)
                            Placeholder: =""
                            Value: =
                            Width: =640
                            X: =385
                            Y: =32
                            ZIndex: =3

                        Label1_1 As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =24
                            Size: =10.5
                            Text: |-
                                ="Target audience
                                
                                "
                            ZIndex: =4

                        "txtAudience As 'Text box'":
                            ColorBackground: =
                            ColorText: =
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =250
                            OnChange: =Set(vSolutionAudience, Self.Value)
                            Placeholder: =""
                            Value: =
                            Width: =640
                            X: =385
                            Y: =32
                            ZIndex: =5

                        "txtIB As 'Text box'":
                            ColorBackground: =
                            ColorText: =
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =250
                            OnChange: =Set(vSolutionIBLink, Self.Value)
                            Placeholder: ="Link to your idea in the Innovation Backlog"
                            Value: =
                            Visible: =hasIB
                            Width: =Parent.Width
                            X: =385
                            Y: =32
                            ZIndex: =6

                        Label1_2 As label:
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =24
                            Size: =10.5
                            Text: ="Solution Description"
                            ZIndex: =7

                        "txtDescription As 'Text box'":
                            ColorBackground: =
                            ColorText: =
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =1
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =250
                            Mode: ='TextBox.Mode'.Multiline
                            OnChange: =Set(vSolutionDescription, Self.Value)
                            Placeholder: =""
                            Value: =
                            Width: =640
                            X: =385
                            Y: =32
                            ZIndex: =8

                    conContentQuestions As groupContainer.verticalAutoLayoutContainer:
                        LayoutGap: =10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Visible: =configStep>1&&configStep<CountRows(colSetupSteps)
                        ZIndex: =2

                        galQuestions As gallery.variableTemplateHeightGallery:
                            BorderColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderColor: =RGBA(0, 120, 212, 1)
                            FocusedBorderThickness: =2
                            Items: =Filter(AllQuestions, categoryName = LookUp(colSetupSteps, ItemKey = configStep).ItemLabel)
                            Layout: =Layout.Vertical
                            LayoutMinHeight: =287
                            LayoutMinWidth: =320
                            TemplateSize: =80
                            ZIndex: =2

                            "cmbAnswerOptions As 'Combo box'.pcfdataset":
                                DefaultSelectedItems: =First(Filter(OurAnswers, theQuestion.Assessment=ThisItem.Assessment)).theAnswer
                                DisplayMode: =DisplayMode.Edit
                                Height: =32
                                Items: =Filter(AllAnswers, Question.Assessment = ThisItem.Assessment)
                                OnChange: |-
                                    =UpdateIf(
                                        OurAnswers,
                                        theQuestion.Assessment = ThisItem.Assessment,
                                        {
                                            theAnswer: LookUp(
                                                AllAnswers,
                                                'Answer Options' = First(cmbAnswerOptions.SelectedItems).'Answer Options'
                                            ),
                                            theAnswerGUID: LookUp(
                                                AllAnswers,
                                                'Answer Options' = First(cmbAnswerOptions.SelectedItems).'Answer Options'
                                            ).'Answer Options',
                                            theAnswerName:LookUp(
                                                AllAnswers,
                                                'Answer Options' = First(cmbAnswerOptions.SelectedItems).'Answer Options'
                                            ).'Answer Option'
                                        }
                                    )
                                OnSelect: =
                                Width: =320
                                X: =0
                                Y: =30
                                ZIndex: =2

                                admin_answeroption1_2 As pcfDataField.textualColumn:
                                    FieldDisplayName: ="admin_answeroption"
                                    FieldName: ="admin_answeroption"
                                    FieldType: ="s"
                                    FieldVariantName: ="textualColumn"
                                    Order: =1
                                    ZIndex: =7

                            lblQuestion_1 As Label:
                                Color: =
                                DisplayMode: =DisplayMode.Edit
                                FontWeight: =FontWeight.Semibold
                                Height: =32
                                OnChange: =false
                                Text: =ThisItem.questionName
                                Width: =450
                                X: =0
                                Y: =0
                                ZIndex: =3

                        conConsiderations_1 As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.Start
                            BorderColor: =
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            Height: |-
                                =conGovernanceThings_1.Visible *140 +
                                conRequiresPremium_1.Visible *140 +
                                conRequiresAI_1.Visible *140 +
                                conRequiresSupport_1.Visible *140 +
                                conRequiresStorage_1.Visible *140 +
                                conRequiresPortals_1.Visible *140 +
                                conImportThings_1.Visible *140
                            LayoutAlignItems: =LayoutAlignItems.Stretch
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutGap: =10
                            LayoutMinHeight: =120
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =5
                            PaddingLeft: =5
                            PaddingRight: =5
                            PaddingTop: =5
                            Visible: =!IsBlank(galQuestions.Selected.considerThis) || !IsBlank(galQuestions.Selected.cmbAnswerOptions.Selected.Consideration) || galQuestions.Selected.cmbAnswerOptions.Selected.'Requires Premium' || galQuestions.Selected.cmbAnswerOptions.Selected.'Requires AI Builder' || galQuestions.Selected.cmbAnswerOptions.Selected.'Requires Support' || galQuestions.Selected.cmbAnswerOptions.Selected.'Requires Additional Storage' || galQuestions.Selected.cmbAnswerOptions.Selected.'Requires Portals'
                            ZIndex: =3

                            conGovernanceThings_1 As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                BorderColor: =ColorValue(AppTheme.palette.themePrimary)
                                BorderThickness: =1
                                Fill: =Color.White
                                Height: =120
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMinHeight: =120
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =16
                                PaddingLeft: =20
                                PaddingRight: =20
                                PaddingTop: =12
                                Visible: =!IsBlank(galQuestions.Selected.cmbAnswerOptions.Selected.Consideration)
                                ZIndex: =2

                                lblTitle_8 As Label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    DisplayMode: =DisplayMode.Edit
                                    FontWeight: =FontWeight.Semibold
                                    Height: =32
                                    LayoutMinHeight: =32
                                    LayoutMinWidth: =100
                                    OnChange: =false
                                    Text: ="Governance considerations"
                                    Width: =320
                                    X: =0
                                    Y: =0
                                    ZIndex: =1

                                lblGovernanceConsiderations_1 As Label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    DisplayMode: =DisplayMode.Edit
                                    FillPortions: =1
                                    Height: =32
                                    LayoutMinHeight: =32
                                    LayoutMinWidth: =100
                                    OnChange: =false
                                    Text: =galQuestions.Selected.cmbAnswerOptions.Selected.Consideration
                                    Width: =320
                                    X: =0
                                    Y: =0
                                    ZIndex: =2

                            conRequiresPremium_1 As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                BorderColor: =ColorValue(AppTheme.palette.themePrimary)
                                BorderThickness: =1
                                Fill: =Color.White
                                Height: =120
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMinHeight: =120
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =16
                                PaddingLeft: =20
                                PaddingRight: =50
                                PaddingTop: =12
                                Visible: =galQuestions.Selected.cmbAnswerOptions.Selected.'Requires Premium'
                                ZIndex: =3

                                lblTitle_9 As Label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    DisplayMode: =DisplayMode.Edit
                                    FontWeight: =FontWeight.Semibold
                                    Height: =32
                                    LayoutMinHeight: =32
                                    LayoutMinWidth: =100
                                    OnChange: =false
                                    Text: ="Additonal licenses required"
                                    Width: =320
                                    X: =0
                                    Y: =0
                                    ZIndex: =1

                                HtmlText1_5 As htmlViewer:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    AutoHeight: =true
                                    Color: =
                                    FillPortions: =1
                                    Font: =Font.'Segoe UI'
                                    HtmlText: |-
                                        ="Based on your selection, your solution may require additional licenses. Learn more: <a href='https://learn.microsoft.com/en-us/power-platform/admin/pricing-billing-skus'>Power Platform licensing</a>"
                                    PaddingLeft: =0
                                    Size: =10.5
                                    ZIndex: =2

                            conRequiresAI_1 As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                BorderColor: =ColorValue(AppTheme.palette.themePrimary)
                                BorderThickness: =1
                                Fill: =Color.White
                                Height: =120
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMinHeight: =120
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =16
                                PaddingLeft: =20
                                PaddingRight: =20
                                PaddingTop: =12
                                Visible: =galQuestions.Selected.cmbAnswerOptions.Selected.'Requires AI Builder'
                                ZIndex: =4

                                lblTitle_10 As Label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    DisplayMode: =DisplayMode.Edit
                                    FontWeight: =FontWeight.Semibold
                                    Height: =32
                                    LayoutMinHeight: =32
                                    LayoutMinWidth: =100
                                    OnChange: =false
                                    Text: ="AI Builder capacity required"
                                    Width: =320
                                    X: =0
                                    Y: =0
                                    ZIndex: =1

                                HtmlText1_6 As htmlViewer:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    FillPortions: =1
                                    Font: =Font.'Segoe UI'
                                    HtmlText: |-
                                        ="Based on your selection, your solution may require AI Builder capacity. Learn more: <a href='https://learn.microsoft.com/en-us/ai-builder/administer-licensing'>AI Builder licensing</a>"
                                    PaddingLeft: =0
                                    Size: =10.5
                                    ZIndex: =2

                            conRequiresSupport_1 As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                BorderColor: =ColorValue(AppTheme.palette.themePrimary)
                                BorderThickness: =1
                                Fill: =Color.White
                                Height: =120
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMinHeight: =120
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =16
                                PaddingLeft: =20
                                PaddingRight: =20
                                PaddingTop: =12
                                Visible: =galQuestions.Selected.cmbAnswerOptions.Selected.'Requires Support'
                                ZIndex: =5

                                lblTitle_11 As Label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    DisplayMode: =DisplayMode.Edit
                                    FontWeight: =FontWeight.Semibold
                                    Height: =32
                                    LayoutMinHeight: =32
                                    LayoutMinWidth: =100
                                    OnChange: =false
                                    Text: ="Additional Support recommended"
                                    Width: =320
                                    X: =0
                                    Y: =0
                                    ZIndex: =1

                                HtmlText1_7 As htmlViewer:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    FillPortions: =1
                                    Font: =Font.'Segoe UI'
                                    HtmlText: ="Based on your selection, your solution may require additional support. Get in touch at the <B>Final Report</B> step to discuss support options."
                                    PaddingLeft: =0
                                    Size: =10.5
                                    ZIndex: =2

                            conRequiresStorage_1 As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                BorderColor: =ColorValue(AppTheme.palette.themePrimary)
                                BorderThickness: =1
                                Fill: =Color.White
                                Height: =120
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMinHeight: =120
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =16
                                PaddingLeft: =20
                                PaddingRight: =20
                                PaddingTop: =12
                                Visible: =galQuestions.Selected.cmbAnswerOptions.Selected.'Requires Additional Storage'
                                ZIndex: =6

                                lblTitle_12 As Label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    DisplayMode: =DisplayMode.Edit
                                    FontWeight: =FontWeight.Semibold
                                    Height: =32
                                    LayoutMinHeight: =32
                                    LayoutMinWidth: =100
                                    OnChange: =false
                                    Text: ="Additional storage required"
                                    Width: =320
                                    X: =0
                                    Y: =0
                                    ZIndex: =1

                                HtmlText1_8 As htmlViewer:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    FillPortions: =1
                                    Font: =Font.'Segoe UI'
                                    HtmlText: |-
                                        ="Based on your selection, your solution may require additional storage capacity. Learn more: <a href='https://learn.microsoft.com/en-us/power-platform/admin/whats-new-storage'>Power Platform capacity storage</a>"
                                    PaddingLeft: =0
                                    Size: =10.5
                                    ZIndex: =2

                            conRequiresPortals_1 As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                BorderColor: =ColorValue(AppTheme.palette.themePrimary)
                                BorderThickness: =1
                                Fill: =Color.White
                                Height: =120
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMinHeight: =120
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =16
                                PaddingLeft: =20
                                PaddingRight: =20
                                PaddingTop: =12
                                Visible: =galQuestions.Selected.cmbAnswerOptions.Selected.'Requires Portals'
                                ZIndex: =7

                                lblTitle_13 As Label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    DisplayMode: =DisplayMode.Edit
                                    FontWeight: =FontWeight.Semibold
                                    Height: =32
                                    LayoutMinHeight: =32
                                    LayoutMinWidth: =100
                                    OnChange: =false
                                    Text: ="Power Pages required"
                                    Width: =320
                                    X: =0
                                    Y: =0
                                    ZIndex: =1

                                HtmlText1_9 As htmlViewer:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    FillPortions: =1
                                    Font: =Font.'Segoe UI'
                                    HtmlText: |-
                                        ="Based on your selection, your solution may require the use of Power Pages. Learn more: <a href='https://learn.microsoft.com/en-us/power-pages/introduction'>Power Pages overview</a>"
                                    PaddingLeft: =0
                                    Size: =10.5
                                    ZIndex: =2

                            conImportThings_1 As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                BorderColor: =ColorValue(AppTheme.palette.themePrimary)
                                BorderThickness: =1
                                Fill: =Color.White
                                Height: =120
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMinHeight: =120
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =16
                                PaddingLeft: =20
                                PaddingRight: =20
                                PaddingTop: =12
                                Visible: =!IsBlank(galQuestions.Selected.considerThis)
                                ZIndex: =8

                                lblTitle_7 As Label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    DisplayMode: =DisplayMode.Edit
                                    FontWeight: =FontWeight.Semibold
                                    Height: =32
                                    LayoutMinHeight: =32
                                    LayoutMinWidth: =100
                                    OnChange: =false
                                    Text: ="Important things to keep in mind"
                                    Width: =320
                                    X: =0
                                    Y: =0
                                    ZIndex: =1

                                lblImportantConsiderations_1 As Label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =
                                    DisplayMode: =DisplayMode.Edit
                                    FillPortions: =1
                                    Height: =32
                                    LayoutMinHeight: =32
                                    LayoutMinWidth: =100
                                    OnChange: =false
                                    Text: =galQuestions.Selected.considerThis
                                    Width: =320
                                    X: =0
                                    Y: =0
                                    ZIndex: =2

                    conContentFinal As groupContainer.verticalAutoLayoutContainer:
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Visible: =configStep > 1 && configStep=CountRows(colSetupSteps)
                        ZIndex: =3

                        Label2 As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            Size: =10.5
                            Text: ="Based on your answers, your solution may require "
                            ZIndex: =1

                        conRequiresPremium_Final As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =ColorValue(AppTheme.palette.neutralPrimary)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            Fill: =Color.White
                            FillPortions: =0
                            Height: =50
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutMinHeight: =50
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =5
                            PaddingLeft: =5
                            PaddingRight: =5
                            PaddingTop: =5
                            Visible: =vConsiderations.requiresPremium = "Yes"
                            ZIndex: =2

                            "Icon2 As 'Fluent Icon (1.0.19)'":
                                AlignInContainer: =AlignInContainer.Stretch
                                DisplayMode: =DisplayMode.Edit
                                FillColor: =
                                FontColor: |-
                                    =If(vConsiderations.requiresPremium = "No", "#107c10","#d83b01")
                                Height: =40
                                IconName: ="LocationDot"
                                IconSize: =30
                                IconType: ='PowerCAT.Icon.IconType'.IconButon
                                LayoutMinHeight: =40
                                LayoutMinWidth: =200
                                Theme: =AppThemeJson
                                Width: =50
                                X: =0
                                Y: =0
                                ZIndex: =2

                            HtmlText1_12 As htmlViewer:
                                FillPortions: =1
                                Font: =Font.'Segoe UI'
                                Height: =30
                                HtmlText: |+
                                    =If(vConsiderations.requiresPremium = "Yes", "Additional licenses. Learn more: <a href='https://learn.microsoft.com/en-us/power-platform/admin/pricing-billing-skus'>Power Platform licensing</a>", "Based on your answers, we don't think your solution requires premium licenses")
                                    
                                LayoutMinHeight: =50
                                PaddingLeft: =0
                                Size: =10.5
                                ZIndex: =3

                        conRequiresSupport_2 As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =ColorValue(AppTheme.palette.neutralPrimary)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            Fill: =Color.White
                            FillPortions: =0
                            Height: =50
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =5
                            PaddingLeft: =5
                            PaddingRight: =5
                            PaddingTop: =5
                            Visible: =vConsiderations.requiresSupport = "Yes"
                            ZIndex: =3

                            "Icon2_1 As 'Fluent Icon (1.0.19)'":
                                AlignInContainer: =AlignInContainer.Stretch
                                DisplayMode: =DisplayMode.Edit
                                FillColor: =
                                FontColor: |-
                                    =If(vConsiderations.requiresSupport = "No", "#107c10","#d83b01")
                                Height: =50
                                IconName: ="LocationDot"
                                IconSize: =30
                                IconType: ='PowerCAT.Icon.IconType'.IconButon
                                LayoutMinHeight: =40
                                LayoutMinWidth: =200
                                Theme: =AppThemeJson
                                Width: =50
                                X: =0
                                Y: =0
                                ZIndex: =1

                            HtmlText1_13 As htmlViewer:
                                AlignInContainer: =AlignInContainer.Center
                                FillPortions: =1
                                Font: =Font.'Segoe UI'
                                Height: =30
                                HtmlText: |+
                                    =If(vConsiderations.requiresSupport = "Yes", "Additional support. Please <b>Contact us</b> to discuss support options.", "Based on your answers, we don't think your solution requires additional user support")
                                    
                                PaddingLeft: =0
                                Size: =10.5
                                ZIndex: =2

                        conRequiresStorage_2 As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =ColorValue(AppTheme.palette.neutralPrimary)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            Fill: =Color.White
                            FillPortions: =0
                            Height: =50
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =5
                            PaddingLeft: =5
                            PaddingRight: =5
                            PaddingTop: =5
                            Visible: =vConsiderations.requiresCapacity = "Yes"
                            ZIndex: =4

                            "Icon2_3 As 'Fluent Icon (1.0.19)'":
                                AlignInContainer: =AlignInContainer.Stretch
                                DisplayMode: =DisplayMode.Edit
                                FillColor: =
                                FontColor: |-
                                    =If(vConsiderations.requiresCapacity = "No", "#107c10","#d83b01")
                                Height: =50
                                IconName: ="LocationDot"
                                IconSize: =30
                                IconType: ='PowerCAT.Icon.IconType'.IconButon
                                LayoutMinHeight: =40
                                LayoutMinWidth: =200
                                Theme: =AppThemeJson
                                Width: =50
                                X: =0
                                Y: =0
                                ZIndex: =1

                            HtmlText1_11 As htmlViewer:
                                AlignInContainer: =AlignInContainer.Center
                                FillPortions: =1
                                Font: =Font.'Segoe UI'
                                Height: =30
                                HtmlText: |+
                                    =If(vConsiderations.requiresCapacity = "Yes", "Additional storage capacity. Learn more: <a href='https://learn.microsoft.com/en-us/power-platform/admin/whats-new-storage'>Power Platform capacity storage</a>", "Based on your answers, we don't think your solution will require capacity add-ons for additional storage")
                                    
                                LayoutMinHeight: =30
                                PaddingLeft: =0
                                Size: =10.5
                                ZIndex: =2

                        conRequiresPortals_2 As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =ColorValue(AppTheme.palette.neutralPrimary)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            Fill: =Color.White
                            FillPortions: =0
                            Height: =50
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =5
                            PaddingLeft: =5
                            PaddingRight: =5
                            PaddingTop: =5
                            Visible: =vConsiderations.requiresPortals = "Yes"
                            ZIndex: =5

                            "Icon2_4 As 'Fluent Icon (1.0.19)'":
                                AlignInContainer: =AlignInContainer.Stretch
                                DisplayMode: =DisplayMode.Edit
                                FillColor: =
                                FontColor: |-
                                    =If(vConsiderations.requiresPortals = "No", "#107c10","#d83b01")
                                Height: =50
                                IconName: ="LocationDot"
                                IconSize: =30
                                IconType: ='PowerCAT.Icon.IconType'.IconButon
                                LayoutMinHeight: =40
                                LayoutMinWidth: =200
                                Theme: =AppThemeJson
                                Width: =50
                                X: =0
                                Y: =0
                                ZIndex: =1

                            HtmlText1_14 As htmlViewer:
                                AlignInContainer: =AlignInContainer.Center
                                FillPortions: =1
                                Font: =Font.'Segoe UI'
                                Height: =30
                                HtmlText: |+
                                    =If(vConsiderations.requiresPortals = "Yes", "The use of Power Pages. Learn more: <a href='https://learn.microsoft.com/en-us/power-pages/introduction'>Power Pages overview</a>", "Based on your answers, we don't think your solution requires Power Pages licenses for external users")
                                    
                                PaddingLeft: =0
                                Size: =10.5
                                ZIndex: =2

                        conRequiresAI_Final As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =ColorValue(AppTheme.palette.neutralPrimary)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            Fill: =Color.White
                            FillPortions: =0
                            Height: =50
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutMinHeight: =50
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =5
                            PaddingLeft: =5
                            PaddingRight: =5
                            PaddingTop: =5
                            Visible: =vConsiderations.requiresAI = "Yes"
                            ZIndex: =6

                            "Icon2_5 As 'Fluent Icon (1.0.19)'":
                                AlignInContainer: =AlignInContainer.Stretch
                                DisplayMode: =DisplayMode.Edit
                                FillColor: =
                                FontColor: |-
                                    =If(vConsiderations.requiresAI = "No", "#107c10","#d83b01")
                                Height: =50
                                IconName: ="LocationDot"
                                IconSize: =30
                                IconType: ='PowerCAT.Icon.IconType'.IconButon
                                LayoutMinHeight: =40
                                LayoutMinWidth: =200
                                Theme: =AppThemeJson
                                Width: =50
                                X: =0
                                Y: =0
                                ZIndex: =1

                            HtmlText1_10 As htmlViewer:
                                FillPortions: =1
                                Font: =Font.'Segoe UI'
                                Height: =30
                                HtmlText: |+
                                    =If(vConsiderations.requiresAI = "Yes", "AI Builder capacity. Learn more: <a href='https://learn.microsoft.com/en-us/ai-builder/administer-licensing'>AI Builder licensing</a>", "Based on your answers, we don't think your solution requires AI Builder licenses")
                                    
                                PaddingLeft: =0
                                Size: =10.5
                                ZIndex: =2

                        Label2_1 As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            PaddingTop: =24
                            Size: =10.5
                            Text: ="Based on your answers, we don't think your solution requires "
                            ZIndex: =7

                        conRequiresPremium_Final_1 As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =ColorValue(AppTheme.palette.neutralPrimary)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            Fill: =Color.White
                            FillPortions: =0
                            Height: =50
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutMinHeight: =50
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =5
                            PaddingLeft: =5
                            PaddingRight: =5
                            PaddingTop: =5
                            Visible: =vConsiderations.requiresPremium = "No"
                            ZIndex: =8

                            "Icon2_6 As 'Fluent Icon (1.0.19)'":
                                AlignInContainer: =AlignInContainer.Stretch
                                DisplayMode: =DisplayMode.Edit
                                FillColor: =
                                FontColor: |-
                                    =If(vConsiderations.requiresPremium = "No", "#107c10","#d83b01")
                                Height: =40
                                IconName: ="LocationDot"
                                IconSize: =30
                                IconType: ='PowerCAT.Icon.IconType'.IconButon
                                LayoutMinHeight: =40
                                LayoutMinWidth: =200
                                Theme: =AppThemeJson
                                Width: =50
                                X: =0
                                Y: =0
                                ZIndex: =2

                            HtmlText1_15 As htmlViewer:
                                FillPortions: =1
                                Font: =Font.'Segoe UI'
                                Height: =30
                                HtmlText: |+
                                    =If(vConsiderations.requiresPremium = "Yes", "Based on your answers, your solution may require additional licenses. Learn more: <a href='https://learn.microsoft.com/en-us/power-platform/admin/pricing-billing-skus'>Power Platform licensing</a>", "Premium licenses")
                                    
                                LayoutMinHeight: =50
                                PaddingLeft: =0
                                Size: =10.5
                                ZIndex: =3

                        conRequiresSupport_3 As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =ColorValue(AppTheme.palette.neutralPrimary)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            Fill: =Color.White
                            FillPortions: =0
                            Height: =50
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =5
                            PaddingLeft: =5
                            PaddingRight: =5
                            PaddingTop: =5
                            Visible: =vConsiderations.requiresSupport = "No"
                            ZIndex: =9

                            "Icon2_7 As 'Fluent Icon (1.0.19)'":
                                AlignInContainer: =AlignInContainer.Stretch
                                DisplayMode: =DisplayMode.Edit
                                FillColor: =
                                FontColor: |-
                                    =If(vConsiderations.requiresSupport = "No", "#107c10","#d83b01")
                                Height: =50
                                IconName: ="LocationDot"
                                IconSize: =30
                                IconType: ='PowerCAT.Icon.IconType'.IconButon
                                LayoutMinHeight: =40
                                LayoutMinWidth: =200
                                Theme: =AppThemeJson
                                Width: =50
                                X: =0
                                Y: =0
                                ZIndex: =1

                            HtmlText1_16 As htmlViewer:
                                AlignInContainer: =AlignInContainer.Center
                                FillPortions: =1
                                Font: =Font.'Segoe UI'
                                Height: =30
                                HtmlText: |+
                                    =If(vConsiderations.requiresSupport = "Yes", "Based on your answers, your solution may require additional support. Please <b>Contact us</b> to discuss support options.", "Additional user support")
                                    
                                PaddingLeft: =0
                                Size: =10.5
                                ZIndex: =2

                        conRequiresStorage_3 As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =ColorValue(AppTheme.palette.neutralPrimary)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            Fill: =Color.White
                            FillPortions: =0
                            Height: =50
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =5
                            PaddingLeft: =5
                            PaddingRight: =5
                            PaddingTop: =5
                            Visible: =vConsiderations.requiresCapacity = "No"
                            ZIndex: =10

                            "Icon2_8 As 'Fluent Icon (1.0.19)'":
                                AlignInContainer: =AlignInContainer.Stretch
                                DisplayMode: =DisplayMode.Edit
                                FillColor: =
                                FontColor: |-
                                    =If(vConsiderations.requiresCapacity = "No", "#107c10","#d83b01")
                                Height: =50
                                IconName: ="LocationDot"
                                IconSize: =30
                                IconType: ='PowerCAT.Icon.IconType'.IconButon
                                LayoutMinHeight: =40
                                LayoutMinWidth: =200
                                Theme: =AppThemeJson
                                Width: =50
                                X: =0
                                Y: =0
                                ZIndex: =1

                            HtmlText1_17 As htmlViewer:
                                AlignInContainer: =AlignInContainer.Center
                                FillPortions: =1
                                Font: =Font.'Segoe UI'
                                Height: =30
                                HtmlText: |+
                                    =If(vConsiderations.requiresCapacity = "Yes", "Based on your answers, your solution may require additional storage capacity. Learn more: <a href='https://learn.microsoft.com/en-us/power-platform/admin/whats-new-storage'>Power Platform capacity storage</a>", "Capacity add-ons for additional storage")
                                    
                                LayoutMinHeight: =30
                                PaddingLeft: =0
                                Size: =10.5
                                ZIndex: =2

                        conRequiresPortals_3 As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =ColorValue(AppTheme.palette.neutralPrimary)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            Fill: =Color.White
                            FillPortions: =0
                            Height: =50
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =5
                            PaddingLeft: =5
                            PaddingRight: =5
                            PaddingTop: =5
                            Visible: =vConsiderations.requiresPortals = "No"
                            ZIndex: =11

                            "Icon2_9 As 'Fluent Icon (1.0.19)'":
                                AlignInContainer: =AlignInContainer.Stretch
                                DisplayMode: =DisplayMode.Edit
                                FillColor: =
                                FontColor: |-
                                    =If(vConsiderations.requiresPortals = "No", "#107c10","#d83b01")
                                Height: =50
                                IconName: ="LocationDot"
                                IconSize: =30
                                IconType: ='PowerCAT.Icon.IconType'.IconButon
                                LayoutMinHeight: =40
                                LayoutMinWidth: =200
                                Theme: =AppThemeJson
                                Width: =50
                                X: =0
                                Y: =0
                                ZIndex: =1

                            HtmlText1_18 As htmlViewer:
                                AlignInContainer: =AlignInContainer.Center
                                FillPortions: =1
                                Font: =Font.'Segoe UI'
                                Height: =30
                                HtmlText: |+
                                    =If(vConsiderations.requiresPortals = "Yes", "Based on your answers, your solution may require the use of Power Pages. Learn more: <a href='https://learn.microsoft.com/en-us/power-pages/introduction'>Power Pages overview</a>", "Power Pages licenses for external users")
                                    
                                PaddingLeft: =0
                                Size: =10.5
                                ZIndex: =2

                        conRequiresAI_Final_1 As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =ColorValue(AppTheme.palette.neutralPrimary)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            Fill: =Color.White
                            FillPortions: =0
                            Height: =50
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutMinHeight: =50
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =5
                            PaddingLeft: =5
                            PaddingRight: =5
                            PaddingTop: =5
                            Visible: =vConsiderations.requiresAI = "No"
                            ZIndex: =12

                            "Icon2_10 As 'Fluent Icon (1.0.19)'":
                                AlignInContainer: =AlignInContainer.Stretch
                                DisplayMode: =DisplayMode.Edit
                                FillColor: =
                                FontColor: |-
                                    =If(vConsiderations.requiresAI = "No", "#107c10","#d83b01")
                                Height: =50
                                IconName: ="LocationDot"
                                IconSize: =30
                                IconType: ='PowerCAT.Icon.IconType'.IconButon
                                LayoutMinHeight: =40
                                LayoutMinWidth: =200
                                Theme: =AppThemeJson
                                Width: =50
                                X: =0
                                Y: =0
                                ZIndex: =1

                            HtmlText1_19 As htmlViewer:
                                FillPortions: =1
                                Font: =Font.'Segoe UI'
                                Height: =30
                                HtmlText: |+
                                    =If(vConsiderations.requiresAI = "Yes", "Based on your answers, your solution may require AI Builder capacity. Learn more: <a href='https://learn.microsoft.com/en-us/ai-builder/administer-licensing'>AI Builder licensing</a>", "AI Builder licenses")
                                    
                                PaddingLeft: =0
                                Size: =10.5
                                ZIndex: =2

                Rectangle2_2 As rectangle:
                    AlignInContainer: =AlignInContainer.Stretch
                    BorderColor: =RGBA(166, 166, 166, 1)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledFill: =RGBA(166, 166, 166, 1)
                    Fill: =ColorValue(AppTheme.palette.neutralLight)
                    FocusedBorderColor: =RGBA(0, 120, 212, 1)
                    Height: =1
                    HoverFill: =RGBA(0, 120, 212, 1)
                    PressedFill: =RGBA(0, 120, 212, 1)
                    ZIndex: =5

                conMainNav As groupContainer.horizontalAutoLayoutContainer:
                    FillPortions: =0
                    Height: =80
                    LayoutGap: =24
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =conContentAll.PaddingLeft
                    ZIndex: =6

                    btnBack As Button:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =ColorValue(AppTheme.palette.neutralPrimary)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        ButtonType: ='Button.ButtonType'.Standard
                        DisabledBorderColor: =
                        DisabledFillColor: =
                        DisabledTextColor: =
                        DisplayMode: |-
                            =If(
                                configStep=1,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        FillColor: =
                        Height: =32
                        HoverBorderColor: =
                        HoverFillColor: =
                        HoverTextColor: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        OnChange: =false
                        OnSelect: |-
                            =If(
                                configStep>1,
                                With(
                                    {
                                        nextConfigStep: configStep-1
                                    },
                            
                                    // Go to the next step.
                                    Set(configStep,nextConfigStep)
                                )
                            )
                        PressedBorderColor: =
                        PressedFillColor: =
                        PressedTextColor: =
                        Text: ="Back"
                        TextColor: =
                        Width: =72
                        X: =40
                        Y: =40
                        ZIndex: =1

                    btnContact As Button:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =
                        DisabledBorderColor: =
                        DisabledFillColor: =
                        DisabledTextColor: =
                        DisplayMode: =DisplayMode.Edit
                        FillColor: =
                        Height: =32
                        HoverBorderColor: =
                        HoverFillColor: =
                        HoverTextColor: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        OnChange: =false
                        OnSelect: |-
                            =UpdateContext({showEmail: true})
                        PressedBorderColor: =
                        PressedFillColor: =
                        PressedTextColor: =
                        Text: ="Contact us"
                        TextColor: =
                        Visible: =configStep=Max(colSetupSteps,Value(ItemKey))
                        Width: =100
                        X: =0
                        Y: =0
                        ZIndex: =2

                    btnNext As Button:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =
                        DisabledBorderColor: =
                        DisabledFillColor: =
                        DisabledTextColor: =
                        DisplayMode: =If(IsBlank(vSolutionAudience) || IsBlank(vSolutionName) || IsBlank(vSolutionDescription), DisplayMode.Disabled, DisplayMode.Edit)
                        FillColor: =
                        Height: =32
                        HoverBorderColor: =
                        HoverFillColor: =
                        HoverTextColor: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        OnChange: =false
                        OnSelect: |-
                            =With(
                                {
                                    nextConfigStep: configStep+1,
                                    maxConfigStep: Max(colSetupSteps,Value(ItemKey))
                                },
                                If(
                                    configStep<maxConfigStep,
                            
                                    UpdateIf(OurAnswers, !IsBlank(theAnswer),
                               {
                                willRequirePremium: LookUp(AllAnswers, 'Answer Options'= theAnswer.'Answer Options').needPrem,
                                willRequirePortal: LookUp(AllAnswers, 'Answer Options'=theAnswer.'Answer Options').needPortal,
                                willRequireAI: LookUp(AllAnswers, 'Answer Options'=theAnswer.'Answer Options').needAI,
                                willRequireCapacity: LookUp(AllAnswers, 'Answer Options'=theAnswer.'Answer Options').needCapacity,
                                willRequireSupport: LookUp(AllAnswers, 'Answer Options'=theAnswer.'Answer Options').needSupport
                               });
                            
                            //generate storage variable
                            Set(
                                vConsiderations,
                                {
                                    requiresSupport: If(CountRows(Filter(OurAnswers, willRequireSupport=true))>0, "Yes", "No"),
                                    requiresAI: If(CountRows(Filter(OurAnswers, willRequireAI=true))>0, "Yes", "No"),
                                    requiresPortals: If(CountRows(Filter(OurAnswers, willRequirePortal=true))>0, "Yes", "No"),
                                    requiresPremium: If(CountRows(Filter(OurAnswers, willRequirePremium=true))>0, "Yes", "No"),
                                    requiresCapacity: If(CountRows(Filter(OurAnswers, willRequireCapacity=true))>0, "Yes", "No")
                                }
                            );
                            UpdateContext({allClear: 
                               If(vConsiderations.requiresAI = "No" && 
                                  vConsiderations.requiresCapacity = "No" &&
                                  vConsiderations.requiresPortals = "No" &&
                                  vConsiderations.requiresPremium = "No" &&
                                  vConsiderations.requiresSupport = "No", true, false)});
                            
                                    // Complete the current step.
                                    If(
                                        !(configStep exactin colStepsCompleted.Value),
                                        Collect(colStepsCompleted,configStep)
                                    );
                                    
                            
                                    // Go to the next step.
                                    Set(configStep,nextConfigStep) //fill values for requirements
                                )
                            )
                        PressedBorderColor: =
                        PressedFillColor: =
                        PressedTextColor: =
                        Text: ="Next"
                        TextColor: =
                        Visible: =configStep<>Max(colSetupSteps,Value(ItemKey))
                        Width: =72
                        X: =0
                        Y: =0
                        ZIndex: =3

                    btnDetails As Button:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =
                        DisabledBorderColor: =
                        DisabledFillColor: =
                        DisabledTextColor: =
                        DisplayMode: =DisplayMode.Edit
                        FillColor: =
                        Height: =32
                        HoverBorderColor: =
                        HoverFillColor: =
                        HoverTextColor: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        OnChange: =false
                        OnSelect: |-
                            =UpdateContext({showDetails: true})
                        PressedBorderColor: =
                        PressedFillColor: =
                        PressedTextColor: =
                        Text: ="View details"
                        TextColor: =
                        Visible: =configStep=Max(colSetupSteps,Value(ItemKey))
                        Width: =100
                        X: =0
                        Y: =0
                        ZIndex: =4

    dialogEmail As Dialog:
        Buttons: |-
            =Table({Label: "Cancel", ButtonType:'Button.ButtonType'.Standard } ,{Label: "Send email", ButtonType:'Button.ButtonType'.Primary})
        DialogHeight: =Parent.Height / 100 * 80
        DialogWidth: =Parent.Width / 100 * 80
        Fill: =dialogEmail.OverlayColor
        Height: =Parent.Height
        OnButtonSelect: |-
            =If( Self.SelectedButton.Label = "Send email", 
            Office365Outlook.SendEmailV2(txtTo.Value, txtSubject.Value, txtBody.HtmlText, {Importance:"Normal"});
                    Notify("Email Sent")
                );
            
            UpdateContext({showEmail:false})
        OnCloseSelect: |-
            =UpdateContext({showEmail: false})
        SubTitle: =""
        Title: ="Contact us"
        Visible: =showEmail
        Width: =Parent.Width
        ZIndex: =11

    grpDetails As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =11

        dialogMoreDetails As Dialog:
            Buttons: |-
                =//Table({Label: "Cancel", ButtonType:'Microsoft.CoreControls.Button.ButtonType'.Standard } ,{Label: "Ok", ButtonType:'Microsoft.CoreControls.Button.ButtonType'.Primary})
            DialogHeight: =Parent.Height / 100 * 80
            DialogWidth: =Parent.Width / 100 * 80
            Fill: =dialogMoreDetails.OverlayColor
            Height: =Parent.Height
            OnCloseSelect: |-
                =UpdateContext({showDetails: false})
            SubTitle: =""
            Title: ="Solution Assesment Result Details"
            Visible: =showDetails
            Width: =Parent.Width
            ZIndex: =2

        "cbWarningsOnly As 'Check box'":
            Checked: =true
            CheckedCheckboxBackgroundFill: =
            CheckedCheckboxBorderColor: =
            CheckmarkFill: =
            Color: =
            DisplayMode: =DisplayMode.Edit
            Height: =32
            HoverCheckboxBackgroundFill: =
            HoverCheckboxBorderColor: =
            Label: ="Warnings only"
            OnCheck: =false
            OnUncheck: =false
            UncheckedCheckboxBackgroundFill: =
            UncheckedCheckboxBorderColor: =
            Visible: =showDetails
            Width: =160
            X: =dialogMoreDetails.ContentX+dialogMoreDetails.ContentWidth-cbWarningsOnly.Width
            Y: =dialogMoreDetails.ContentY
            ZIndex: =4

        "cmbCategory As 'Combo box'.pcfdataset":
            DisplayMode: =DisplayMode.Edit
            Height: =32
            Items: =Filter('Assessment Categories', 'Assessment Categories (Views)'.'Active Assessment Categories')
            Visible: =showDetails
            Width: =320
            X: =dialogMoreDetails.ContentX+dialogMoreDetails.ContentWidth-cmbCategory.Width-cbWarningsOnly.Width-10
            Y: =dialogMoreDetails.ContentY
            ZIndex: =5

            "'Category Name1' As pcfDataField.textualColumn":
                FieldDisplayName: ="Category Name"
                FieldName: ="admin_categoryname"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =1
                ZIndex: =9

        "FluentDetailsList2_4 As 'Fluent Details List (1.0.19)'.pcfdataset":
            columns_Items: |-
                =Table(
                         {
                        ColName: "theQuestionName",
                        ColDisplayName: "Question",
                        ColWidth: 300,
                        ColSortable: true,
                        ColIsBold: false,
                        ColResizable: true,
                        ColMultiLine: true
                    },
                             {
                        ColName: "theAnswerName",
                        ColDisplayName: "Answer",
                        ColWidth: 300,
                        ColSortable: true,
                        ColIsBold: false,
                        ColResizable: true,
                         ColMultiLine: true
                    },
                     
                     {
                        ColName: "willRequirePremiumIcon",
                        ColDisplayName: "Premium",
                        ColWidth: 50,
                        ColSortable: true,
                        ColIsBold: false,
                        ColResizable: true,
                        ColCellType: "image"
                     },
                     {
                        ColName: "willRequireAIIcon",
                        ColDisplayName: "AI Builder",
                        ColWidth: 70,
                        ColSortable: true,
                        ColIsBold: false,
                        ColResizable: true,
                        ColCellType: "image"
                    },
                     {
                        ColName: "willRequireCapacityIcon",
                        ColDisplayName: "Storage",
                        ColWidth: 50,
                        ColSortable: true,
                        ColIsBold: false,
                        ColResizable: true,
                        ColCellType: "image"
                    },
                    {
                        ColName: "willRequirePortalIcon",
                        ColDisplayName: "Power Pages",
                        ColWidth: 70,
                        ColSortable: true,
                        ColIsBold: false,
                        ColResizable: true,
                        ColCellType: "image"
                    },
                    {
                        ColName: "willRequireSupportIcon",
                        ColDisplayName: "Support",
                        ColWidth: 50,
                        ColSortable: true,
                        ColIsBold: false,
                        ColResizable: true,
                        ColCellType: "image"
                    }
                )
            DisplayMode: =DisplayMode.Edit
            Height: =dialogMoreDetails.ContentHeight-cbWarningsOnly.Height
            Items: |-
                =AddColumns(
                    Filter(
                        OurAnswers,
                        If(
                            cbWarningsOnly.Checked,
                            (willRequireAI = true || willRequireCapacity = true || willRequirePortal = true || willRequirePremium = true || willRequireSupport = true),
                            !IsBlank(theQuestion)
                        ) && If(
                            CountRows(cmbCategory.SelectedItems) > 0,
                            theQuestion.'Assessment Category'.'Assessment Category' = First(cmbCategory.SelectedItems).'Assessment Category',
                            !IsBlank(theQuestion)
                        )
                    ),
                    "willRequirePremiumIcon",
                    If(willRequirePremium, "icon:SkypeCircleCheck", ""),
                    "willRequireAIIcon",
                    If(willRequireAI, "icon:SkypeCircleCheck", ""),
                    "willRequireCapacityIcon",
                    If(willRequireCapacity, "icon:SkypeCircleCheck", ""),
                    "willRequirePortalIcon",
                    If(willRequirePortal, "icon:SkypeCircleCheck", ""),
                    "willRequireSupportIcon",
                    If(willRequireSupport, "icon:SkypeCircleCheck", "")
                )
            SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.None
            Visible: =showDetails
            Width: =dialogMoreDetails.ContentWidth
            X: =dialogMoreDetails.ContentX
            Y: =dialogMoreDetails.ContentY+cbWarningsOnly.Height
            ZIndex: =10

            willRequireAI3_4 As pcfDataField.textualColumn:
                FieldDisplayName: ="willRequireAI"
                FieldName: ="willRequireAI"
                FieldType: ="b"
                FieldVariantName: ="textualColumn"
                Order: =1
                ZIndex: =19

            willRequireCapacity3_4 As pcfDataField.textualColumn:
                FieldDisplayName: ="willRequireCapacity"
                FieldName: ="willRequireCapacity"
                FieldType: ="b"
                FieldVariantName: ="textualColumn"
                Order: =2
                ZIndex: =20

            willRequirePortal3_4 As pcfDataField.textualColumn:
                FieldDisplayName: ="willRequirePortal"
                FieldName: ="willRequirePortal"
                FieldType: ="b"
                FieldVariantName: ="textualColumn"
                Order: =3
                ZIndex: =21

            willRequirePremium3_4 As pcfDataField.textualColumn:
                FieldDisplayName: ="willRequirePremium"
                FieldName: ="willRequirePremium"
                FieldType: ="b"
                FieldVariantName: ="textualColumn"
                Order: =4
                ZIndex: =22

            willRequireSupport3_4 As pcfDataField.textualColumn:
                FieldDisplayName: ="willRequireSupport"
                FieldName: ="willRequireSupport"
                FieldType: ="b"
                FieldVariantName: ="textualColumn"
                Order: =5
                ZIndex: =23

            theQuestionName2_2 As pcfDataField.textualColumn:
                FieldDisplayName: ="theQuestionName"
                FieldName: ="theQuestionName"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =8
                ZIndex: =24

            willRequirePremiumIcon1_2 As pcfDataField.textualColumn:
                FieldDisplayName: ="willRequirePremiumIcon"
                FieldName: ="willRequirePremiumIcon"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =7
                ZIndex: =25

            willRequireAIIcon1_2 As pcfDataField.textualColumn:
                FieldDisplayName: ="willRequireAIIcon"
                FieldName: ="willRequireAIIcon"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =8
                ZIndex: =26

            willRequireCapacityIcon1_2 As pcfDataField.textualColumn:
                FieldDisplayName: ="willRequireCapacityIcon"
                FieldName: ="willRequireCapacityIcon"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =9
                ZIndex: =27

            willRequirePortalIcon1_2 As pcfDataField.textualColumn:
                FieldDisplayName: ="willRequirePortalIcon"
                FieldName: ="willRequirePortalIcon"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =10
                ZIndex: =28

            willRequireSupportIcon1_2 As pcfDataField.textualColumn:
                FieldDisplayName: ="willRequireSupportIcon"
                FieldName: ="willRequireSupportIcon"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =11
                ZIndex: =29

            theAnswerName1_1 As pcfDataField.textualColumn:
                FieldDisplayName: ="theAnswerName"
                FieldName: ="theAnswerName"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =13
                ZIndex: =32

    conEmail As groupContainer.verticalAutoLayoutContainer:
        Height: =dialogEmail.ContentHeight-10
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        PaddingLeft: =20
        PaddingRight: =10
        Visible: =showEmail
        Width: =dialogEmail.ContentWidth
        X: =dialogEmail.ContentX
        Y: =dialogEmail.ContentY
        ZIndex: =15

        lblTo As Label:
            Color: =
            DisplayMode: =DisplayMode.Edit
            Height: =45
            LayoutMinHeight: =32
            LayoutMinWidth: =250
            OnChange: =false
            Text: ="To"
            VerticalAlignment: =VerticalAlign.Bottom
            Width: =320
            X: =385
            Y: =220
            ZIndex: =1

        "txtTo As 'Text box'":
            ColorBackground: =
            ColorText: =
            DisplayMode: =DisplayMode.Edit
            Height: =32
            LayoutMinHeight: =32
            LayoutMinWidth: =250
            Value: =AdminEmail
            Width: =Parent.Width
            X: =385
            Y: =252
            ZIndex: =2

        lblSubject As Label:
            Color: =
            DisplayMode: =DisplayMode.Edit
            Height: =45
            LayoutMinHeight: =32
            LayoutMinWidth: =250
            OnChange: =false
            Text: ="Subject"
            VerticalAlignment: =VerticalAlign.Bottom
            Width: =320
            X: =385
            Y: =220
            ZIndex: =3

        "txtSubject As 'Text box'":
            ColorBackground: =
            ColorText: =
            DisplayMode: =DisplayMode.Edit
            Height: =32
            LayoutMinHeight: =32
            LayoutMinWidth: =250
            Value: |-
                ="Power Platform Solution Assessment for " & vSolutionAudience & ": " & vSolutionName
            Width: =Parent.Width
            X: =385
            Y: =252
            ZIndex: =4

        lblMessage As Label:
            Color: =
            DisplayMode: =DisplayMode.Edit
            Height: =45
            LayoutMinHeight: =32
            LayoutMinWidth: =250
            OnChange: =false
            Text: ="Message"
            VerticalAlignment: =VerticalAlign.Bottom
            Width: =320
            X: =385
            Y: =311
            ZIndex: =5

        txtBody As richTextEditor:
            BorderColor: =RGBA(166, 166, 166, 1)
            Default: |-
                =If(allClear, 
                    "I have taken the Power Platform Solution Assessment for my solution and the final report showed no findings that need attention. <br><br>"
                    & If(!IsBlank(vSolutionIBLink), "<a href=" & vSolutionIBLink &">Innovation Backlog Description</a>") &
                    "<br><br>Solution Description: <br>" & vSolutionDescription
                    ,
                
                "I have taken the Power Platform Solution Assessment for my solution. <br>"
                    & If(!IsBlank(vSolutionIBLink), "<a href=" & vSolutionIBLink &">Innovation Backlog Description</a>") &
                    "<br><br>Solution Description: <br>" & vSolutionDescription & "<br> <br>
                    I could use your help with the following items: <br>
                    
                    <table>
                  <tr>
                    <td><b>Question </b></td>
                    <td><b>Answer </b></td>
                    <td><b>Help With </b></td>
                  </tr>" & 
                  Concat(Filter(OurAnswers, willRequireAI=true || willRequireCapacity = true || willRequirePortal = true || willRequirePremium = true || willRequireSupport = true),
                  "<tr>
                    <td>" & theQuestion.'Question Name' & "</td>
                    <td>" & theAnswer.'Answer Option' & "</td>
                    <td>" & If(willRequirePremium, "Premium ") &
                            If(willRequirePortal, "Portal ") &
                            If(willRequireAI, "AI ") &
                            If(willRequireCapacity, "Storage ") &
                            If(willRequireSupport, "Support ") & "</td>
                  </tr>"
                )
                &"</Table>"
                
                
                )
            FillPortions: =1
            LayoutMinWidth: =250
            Width: =Parent.Width
            X: =385
            Y: =365
            ZIndex: =6

