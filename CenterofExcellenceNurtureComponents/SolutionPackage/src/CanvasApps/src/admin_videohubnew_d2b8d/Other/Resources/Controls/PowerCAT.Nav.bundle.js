/*! For license information please see bundle.js.LICENSE.txt */
var pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad;(()=>{"use strict";var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Nav:()=>l});const n=React;var i=void 0;try{i=window}catch(e){}function a(e){if(void 0!==i){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:i}}var r=function(){function e(e,t){this._timeoutIds=null,this._immediateIds=null,this._intervalIds=null,this._animationFrameIds=null,this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._noop=function(){}}return e.prototype.dispose=function(){var e;if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(e in this._timeoutIds)this._timeoutIds.hasOwnProperty(e)&&this.clearTimeout(parseInt(e,10));this._timeoutIds=null}if(this._immediateIds){for(e in this._immediateIds)this._immediateIds.hasOwnProperty(e)&&this.clearImmediate(parseInt(e,10));this._immediateIds=null}if(this._intervalIds){for(e in this._intervalIds)this._intervalIds.hasOwnProperty(e)&&this.clearInterval(parseInt(e,10));this._intervalIds=null}if(this._animationFrameIds){for(e in this._animationFrameIds)this._animationFrameIds.hasOwnProperty(e)&&this.cancelAnimationFrame(parseInt(e,10));this._animationFrameIds=null}},e.prototype.setTimeout=function(e,t){var n=this,i=0;return this._isDisposed||(this._timeoutIds||(this._timeoutIds={}),i=setTimeout((function(){try{n._timeoutIds&&delete n._timeoutIds[i],e.apply(n._parent)}catch(e){n._logError(e)}}),t),this._timeoutIds[i]=!0),i},e.prototype.clearTimeout=function(e){this._timeoutIds&&this._timeoutIds[e]&&(clearTimeout(e),delete this._timeoutIds[e])},e.prototype.setImmediate=function(e,t){var n=this,i=0,r=a(t);return this._isDisposed||(this._immediateIds||(this._immediateIds={}),i=r.setTimeout((function(){try{n._immediateIds&&delete n._immediateIds[i],e.apply(n._parent)}catch(e){n._logError(e)}}),0),this._immediateIds[i]=!0),i},e.prototype.clearImmediate=function(e,t){var n=a(t);this._immediateIds&&this._immediateIds[e]&&(n.clearTimeout(e),delete this._immediateIds[e])},e.prototype.setInterval=function(e,t){var n=this,i=0;return this._isDisposed||(this._intervalIds||(this._intervalIds={}),i=setInterval((function(){try{e.apply(n._parent)}catch(e){n._logError(e)}}),t),this._intervalIds[i]=!0),i},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,n){var i=this;if(this._isDisposed)return this._noop;var a,r,o=t||0,s=!0,l=!0,d=0,m=null;n&&"boolean"==typeof n.leading&&(s=n.leading),n&&"boolean"==typeof n.trailing&&(l=n.trailing);var u=function t(n){var u=Date.now(),c=u-d,p=s?o-c:o;return c>=o&&(!n||s)?(d=u,m&&(i.clearTimeout(m),m=null),a=e.apply(i._parent,r)):null===m&&l&&(m=i.setTimeout(t,p)),a};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r=e,u(!0)}},e.prototype.debounce=function(e,t,n){var i=this;if(this._isDisposed){var a=function(){};return a.cancel=function(){},a.flush=function(){return null},a.pending=function(){return!1},a}var r,o,s=t||0,l=!1,d=!0,m=null,u=0,c=Date.now(),p=null;n&&"boolean"==typeof n.leading&&(l=n.leading),n&&"boolean"==typeof n.trailing&&(d=n.trailing),n&&"number"==typeof n.maxWait&&!isNaN(n.maxWait)&&(m=n.maxWait);var h=function(e){p&&(i.clearTimeout(p),p=null),c=e},y=function(t){h(t),r=e.apply(i._parent,o)},f=function e(t){var n=Date.now(),a=!1;t&&(l&&n-u>=s&&(a=!0),u=n);var o=n-u,h=s-o,f=n-c,I=!1;return null!==m&&(f>=m&&p?I=!0:h=Math.min(h,m-f)),o>=s||I||a?y(n):null!==p&&t||!d||(p=i.setTimeout(e,h)),r},I=function(){return!!p},v=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o=e,f(!0)};return v.cancel=function(){I()&&h(Date.now())},v.flush=function(){return I()&&y(Date.now()),r},v.pending=I,v},e.prototype.requestAnimationFrame=function(e,t){var n=this,i=0,r=a(t);if(!this._isDisposed){this._animationFrameIds||(this._animationFrameIds={});var o=function(){try{n._animationFrameIds&&delete n._animationFrameIds[i],e.apply(n._parent)}catch(e){n._logError(e)}};i=r.requestAnimationFrame?r.requestAnimationFrame(o):r.setTimeout(o,0),this._animationFrameIds[i]=!0}return i},e.prototype.cancelAnimationFrame=function(e,t){var n=a(t);this._animationFrameIds&&this._animationFrameIds[e]&&(n.cancelAnimationFrame?n.cancelAnimationFrame(e):n.clearTimeout(e),delete this._animationFrameIds[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}();const o=FluentUIReactv8290;var s=n.memo((e=>{var t,i,{items:a,onSelected:s,nestedItems:l,ariaLabel:d,selectedKey:m,setFocus:u,themeJSON:c,height:p,width:h,collapseByDefault:y}=e,[f,I]=n.useState([]),v=(t=m,i=(0,n.useRef)(),(0,n.useEffect)((function(){i.current=t})),i.current),[_,g]=n.useState(!1),k=n.useCallback(((e,t,n)=>{var i,r=!1;if(n){e="true"===(null===n.currentTarget.ariaExpanded?null===(i=n.currentTarget.previousElementSibling)||void 0===i?void 0:i.ariaExpanded:n.currentTarget.ariaExpanded);var o=a.find((e=>e.key===t));o&&s(o)}if(e){var l=f.indexOf(t);l>-1&&f.splice(l,1),r=!0}else-1===f.indexOf(t)&&(f.push(t),r=!0);r&&I([...f])}),[a,s,f,I]),b=n.useMemo((()=>{return l.map((t=>Object.assign({key:t.key},null!=t.links&&{links:e(null==t?void 0:t.links)})));function e(n){return n.map((n=>{return Object.assign(Object.assign({key:n.key,name:n.name,disabled:!1===n.enabled},null==n.links&&null!=n.iconName&&{iconProps:(i=n.iconName,a=n.iconColor,{iconName:i,styles:{root:{color:a}}})}),null!=n.links&&{links:e(null==n?void 0:n.links),expandAriaLabel:n.name.concat(" expanded"),collapseAriaLabel:n.name.concat(" collapsed"),isExpanded:t(n)});var i,a}))}function t(e){var t=e.isExpanded,n=null!=t?t:!y;return f.length>0&&(n=f.indexOf(e.key)>-1),n}}),[l,f,y]),x=n.useMemo((()=>{try{return c?(0,o.createTheme)(JSON.parse(c)):void 0}catch(e){console.error("Cannot parse theme",e)}}),[c]),E=n.useRef(null),K=function(){var e,t,i=(e=function(){return new r},void 0===(t=n.useRef()).current&&(t.current={value:e()}),t.current.value);return n.useEffect((function(){return function(){return i.dispose()}}),[i]),i}();n.useEffect((()=>{u&&""!==u&&E&&K.requestAnimationFrame((()=>{var e;null===(e=E.current)||void 0===e||e.focus()}))}),[u,E,K]);var S=n.useMemo((()=>({root:{width:h,height:p,boxSizing:"border-box",overflowY:"auto"},link:{whiteSpace:"normal",lineHeight:"inherit"},groupContent:{marginBottom:0},chevronButton:{"background-color":"transparent","::after":{content:"none"}}})),[h,p]),w=n.useCallback(((e,t)=>{var n=t&&a.find((e=>e.key===(null==t?void 0:t.key)));n&&s(n)}),[a,s]);return n.useEffect((()=>{if(v!==m){var e=a.find((e=>e.key===m));e&&e.parentItemKey&&k(!1,e.parentItemKey)}}),[m,_,a,k,v]),n.useEffect((()=>{var e,t=a.find((e=>e.key===m));!_&&l.length&&(a.filter((e=>!1!==e.visible)).map((e=>{(!1!==e.isExpanded&&!y||!0===e.isExpanded)&&k(!1,e.key)})),(e=a.find((e=>e.key===(null==t?void 0:t.key))))&&function t(n){k(!1,n.key),(e=a.find((e=>e.key===(null==n?void 0:n.parentItemKey)&&e.key!==e.parentItemKey)))&&t(e)}(e),g(!0))}),[m,_,a,l,y,k,v]),n.createElement(o.ThemeProvider,{applyTo:"none",theme:x},n.createElement(o.Nav,{componentRef:E,onLinkClick:w,onLinkExpandClick:(e,t)=>{t&&void 0!==t.key&&k(!1,t.key,e)},selectedKey:m,styles:S,groups:b,ariaLabel:d}))}));s.displayName="CanvasNav";class l{constructor(){this.focusKey="",this.onSelectCalled=!1,this.onSelect=(e,t)=>{void 0!==t&&!0!==t||(this.lastSelected=e,this.notifyOutputChanged()),e&&e.data&&(this.onSelectCalled=!0,this.context.parameters.items.openDatasetItem(e.data.getNamedReference()))}}init(e,t){this.notifyOutputChanged=t,this.context=e,this.context.mode.trackContainerResize(!0),this.context.parameters.items.paging.setPageSize(500)}updateView(e){var t,i,a,r,o,l,d,m=this.context.parameters.InputEvent.raw;m&&this.inputEvent!==m&&m.startsWith("SetFocus")&&(this.focusKey=m);var u=null!==(i=null===(t=e.parameters)||void 0===t?void 0:t.AccessibilityLabel.raw)&&void 0!==i?i:"",c=e.parameters.items;(e.updatedProperties.indexOf("dataset")>-1||!this.items)&&(this.items=function(e){return e.error||void 0===e.paging.totalResultCount?[{id:"1",key:"1",name:"Item 1"},{id:"2",key:"2",name:"Item 2",isExpanded:!0},{id:"3",key:"3",name:"Item 3",isExpanded:!0},{id:"4",key:"4",name:"Item 4",visible:!1},{id:"5",key:"5",name:"Item 5",parentItemKey:"3"},{id:"6",key:"6",name:"Item 6",parentItemKey:"2",isExpanded:!1},{id:"7",key:"7",name:"Item 7",parentItemKey:"6"},{id:"8",key:"8",name:"Item 8",parentItemKey:"7",isExpanded:!0},{id:"9",key:"9",name:"Item 9",parentItemKey:"8"},{id:"10",key:"10",name:"Item 10",parentItemKey:"9",isExpanded:!0},{id:"11",key:"11",name:"Item 11"},{id:"12",key:"12",name:"Item 12"},{id:"13",key:"13",name:"Item 13",parentItemKey:"12"},{id:"14",key:"14",name:"Item 14",parentItemKey:"12"},{id:"15",key:"15",name:"Item 12",parentItemKey:"15"}]:e.sortedRecordIds.map((t=>{var n=e.records[t];return{id:n.getRecordId(),key:n.getValue("ItemKey"),name:n.getValue("ItemDisplayName"),enabled:n.getValue("ItemEnabled"),iconName:n.getValue("ItemIconName"),iconColor:n.getValue("ItemIconColor"),parentItemKey:n.getValue("ItemParentKey"),visible:n.getValue("ItemVisible"),isExpanded:n.getValue("ItemExpanded"),data:n}}))}(c),this.nestedItems=this.items.length>0?function(e){var t=[],n="rootID".concat(e[0].key,e[e.length-1].key);e.map((t=>{void 0!==t.parentItemKey?-1===e.map((e=>e.key)).indexOf(t.parentItemKey)&&(t.parentItemKey=n):t.parentItemKey=n})),e.unshift({id:n,name:n,key:n,parentItemKey:null});var i=e.reduce(((e,t,n)=>(e[t.key]=n,e)),{});return e.map((n=>{if(null!=n.parentItemKey){if(!1!==e[i[n.key]].visible){var a=e[i[n.parentItemKey]];a.links=[...a.links||[],n]}}else t=[n]})),t}(this.items):[],this.onSelectCalled=!1),this.checkSelectedKeyChanged(e);var p=parseInt(e.mode.allocatedWidth),h=parseInt(e.mode.allocatedHeight),y={tabIndex:null!==(r=null===(a=e.accessibility)||void 0===a?void 0:a.assignedTabIndex)&&void 0!==r?r:void 0,width:p,height:h,items:this.items,ariaLabel:u,nestedItems:this.nestedItems,onSelected:this.onSelect,disabled:e.mode.isControlDisabled,selectedKey:null!==(o=e.parameters.SelectedKey.raw)&&void 0!==o?o:"",setFocus:this.focusKey,themeJSON:e.parameters.Theme.raw,collapseByDefault:null!==(d=null===(l=e.parameters)||void 0===l?void 0:l.CollapseByDefault.raw)&&void 0!==d&&d};return n.createElement(s,y)}getOutputs(){var e,t;return{SelectedKey:null!==(t=null===(e=this.lastSelected)||void 0===e?void 0:e.key)&&void 0!==t?t:null}}destroy(){}checkSelectedKeyChanged(e){var t,n=e.parameters.SelectedKey.raw,i=e.updatedProperties.indexOf("SelectedKey")>-1,a=(null===(t=this.lastSelected)||void 0===t?void 0:t.key)!==n;if(!this.onSelectCalled&&void 0!==n||i&&a){var r=this.items.find((e=>e.key===n));this.onSelect(r,!1)}}}pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad=t})();
if (window.ComponentFramework && window.ComponentFramework.registerControl) {
	ComponentFramework.registerControl('PowerCAT.Nav', pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.Nav);
} else {
	var PowerCAT = PowerCAT || {};
	PowerCAT.Nav = pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.Nav;
	pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad = undefined;
}