<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Environment Indicator</title>
    <style>
        body {
            margin: 0;
            padding: 16px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f3f3f3;
        }
        .environment-banner {
            background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%);
            color: white;
            padding: 16px 24px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .env-label {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 4px;
        }
        .env-name {
            font-size: 20px;
            font-weight: 600;
        }
        .env-icon {
            font-size: 32px;
        }
    </style>
</head>
<body>
    <div class="environment-banner">
        <div>
            <div class="env-label">CoE Environment</div>
            <div class="env-name" id="environmentName">Loading...</div>
        </div>
        <div class="env-icon">üåç</div>
    </div>
    
    <script>
        // Get environment name from Dataverse
        (function() {
            try {
                if (window.parent && window.parent.Xrm) {
                    var context = window.parent.Xrm.Utility.getGlobalContext();
                    var orgSettings = context.organizationSettings;
                    var envName = orgSettings.uniqueName || orgSettings.organizationId;
                    
                    // Try to get friendly environment name
                    if (context.getClientUrl) {
                        var url = context.getClientUrl();
                        var match = url.match(/https:\/\/([^.]+)\./);
                        if (match && match[1]) {
                            envName = match[1];
                        }
                    }
                    
                    document.getElementById('environmentName').textContent = envName;
                } else {
                    document.getElementById('environmentName').textContent = 'Unknown Environment';
                }
            } catch (error) {
                console.error('Error getting environment name:', error);
                document.getElementById('environmentName').textContent = 'Error loading environment name';
            }
        })();
    </script>
</body>
</html>
