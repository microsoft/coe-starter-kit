FlowDetailsScreen As screen:
    Height: =Max(App.Height, App.DesignHeight)
    OnVisible: |-
        =If(!IsBlankOrError(SelectedFlow.'Flow Environment'),
        ClearCollect(
            flowRoles,
            PowerAutomateforAdmins.GetAdminFlowOwnerRole(
                SelectedFlow.'Flow Environment'.Name,
                SelectedFlow.Flow
            ).value
        ));
        
        UpdateContext(
            {
                showEmailUsers: false,
                showAddUsers: false,
                showCantShowThat: false,
                CantShowThatText: ""
            }
        )
    Orientation: =If(FlowDetailsScreen.Width < FlowDetailsScreen.Height, Layout.Vertical, Layout.Horizontal)
    Size: =1 + CountRows(App.SizeBreakpoints) - CountIf(App.SizeBreakpoints, Value >= FlowDetailsScreen.Width)
    Width: =Max(App.Width, App.DesignWidth)

    galFlowRoles As gallery.galleryVertical:
        BorderColor: =RGBA(204, 204, 204, 1)
        BorderThickness: =1
        DisabledBorderColor: =galFlowRoles.BorderColor
        DisabledFill: =galFlowRoles.Fill
        Fill: =RGBA(255, 255, 255, 1)
        Height: =703
        HoverBorderColor: =galFlowRoles.BorderColor
        HoverFill: =galFlowRoles.Fill
        Items: =flowRoles
        Layout: =Layout.Vertical
        LoadingSpinnerColor: =galFlowRoles.BorderColor
        PressedBorderColor: =galFlowRoles.BorderColor
        PressedFill: =galFlowRoles.Fill
        TemplateSize: =86
        Width: =1830
        X: =40
        Y: =312
        ZIndex: =1

        lblUserName As label:
            BorderColor: =RGBA(218,218,218,1.00)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(47,41,43,1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70)
            FocusedBorderColor: =lblUserName.BorderColor
            Font: =Font.'Segoe UI'
            Height: =86
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(4,45,81,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(4,45,81,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Text: =If(ThisItem.properties.principal.type="Group", ThisItem.properties.principal.type, LookUp('Power Platform Users', 'Power Platform User'=GUID(ThisItem.properties.principal.id)).'Display Name')
            Width: =333
            X: =98
            ZIndex: =1

        imgUserProfile As image:
            BorderColor: =ColorFade(imgUserProfile.Fill,-20%)
            DisabledBorderColor: =RGBA(159, 167, 165, 1)
            DisabledFill: =RGBA(193, 193, 193, 0.95)
            Fill: =RGBA(244, 244, 244, 1)
            FocusedBorderColor: =imgUserProfile.BorderColor
            Height: =60
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            Image: =If(ThisItem.properties.principal.type <> "User", SampleImage,  LookUp('Power Platform Users', 'Power Platform User'=GUID(ThisItem.properties.principal.id)).PhotoObject)
            ImagePosition: =ImagePosition.Fill
            OnSelect: =Select(Parent)
            PaddingBottom: =imgUserProfile.PaddingTop
            PaddingLeft: =imgUserProfile.PaddingTop
            PaddingRight: =imgUserProfile.PaddingTop
            PaddingTop: =10
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            Width: =64
            X: =14
            Y: =13
            ZIndex: =2

        lblRole As label:
            BorderColor: =RGBA(218,218,218,1.00)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(47,41,43,1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70)
            FocusedBorderColor: =lblRole.BorderColor
            Font: =Font.'Segoe UI'
            Height: =86
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(4,45,81,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(4,45,81,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Text: |-
                ="Role: "& If(ThisItem.properties.principal.id=FlowDerivedOwner, "Owner", If(ThisItem.properties.roleName="Owner", "Creator", ThisItem.properties.roleName))
            X: =400
            ZIndex: =3

        btnMakeOwner As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorValue(Style.Primary)
            FocusedBorderColor: =btnMakeOwner.BorderColor
            Font: =Font.'Segoe UI'
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |-
                =//call helper to reassign
                If('HELPER-ObjectOperations'.Run(ThisItem.properties.principal.id, SelectedFlow.Flow, SelectedFlow.'Flow Environment'.Name, "assign", "flow").thereturnstring="pass",
                
                //if success, refresh data in app
                Refresh('Power Platform Users');
                Refresh(Makers);
                Refresh(Flows);
                Set(SelectedFlow, LookUp(Flows, Flow=SelectedFlow.Flow));
                Set(FlowDerivedOwner, ThisItem.properties.principal.id);
                ClearCollect(
                    flowRoles,
                    PowerAutomateforAdmins.GetAdminFlowOwnerRole(
                        SelectedFlow.'Flow Environment'.Name,
                        SelectedFlow.Flow
                    ).value
                );, 
                
                //else show error message
                UpdateContext({
                        showCantShowThat: true,
                        CantShowThatText: "Changing owner failed, try to set via product UX"
                }));
                
                
                /*UpdateIf(Flows, Flow=SelectedFlow.Flow, {DerivedOwner: LookUp(Makers, Maker=GUID(ThisItem.properties.principal.id))});
                Set(FlowDerivedOwner, LookUp(Flows, Flow=SelectedFlow.Flow).DerivedOwner.Maker);
                UpdateIf(Flows, Flow=SelectedFlow.Flow, {'Flow is Orphaned': "No"});
                */
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnMakeOwner.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Make Owner"
            Visible: |-
                =//only visible to type role type "CanEdit" who is not already the DerivedFlowOwner
                If(ThisItem.properties.principal.id=FlowDerivedOwner || ThisItem.properties.roleName="CanView" || ThisItem.properties.principal.type <> "User", false, true)
            Width: =173
            X: =627
            Y: =22
            ZIndex: =4

        btnChangeRole As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorValue(Style.Primary)
            FocusedBorderColor: =btnChangeRole.BorderColor
            Font: =Font.'Segoe UI'
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |-
                =//call helper to reassign
                If('HELPER-ObjectOperations'.Run(ThisItem.properties.principal.id, SelectedFlow.Flow, SelectedFlow.'Flow Environment'.Name, If(ThisItem.properties.roleName = "CanEdit", "addviewer", "addeditor"), "flow").thereturnstring="pass",
                
                //if success, refresh data in app
                Refresh('Power Platform Users');
                Refresh(Makers);
                Refresh(Flows);
                Set(SelectedFlow, LookUp(Flows, Flow=SelectedFlow.Flow));
                ClearCollect(
                    flowRoles,
                    PowerAutomateforAdmins.GetAdminFlowOwnerRole(
                        SelectedFlow.'Flow Environment'.Name,
                        SelectedFlow.Flow
                    ).value
                );, 
                
                //else show error message
                UpdateContext({
                        showCantShowThat: true,
                        CantShowThatText: "Changing owner failed, try to set via product UX"
                }));
                
                
                /*UpdateIf(Flows, Flow=SelectedFlow.Flow, {DerivedOwner: LookUp(Makers, Maker=GUID(ThisItem.properties.principal.id))});
                Set(FlowDerivedOwner, LookUp(Flows, Flow=SelectedFlow.Flow).DerivedOwner.Maker);
                UpdateIf(Flows, Flow=SelectedFlow.Flow, {'Flow is Orphaned': "No"});
                */
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnChangeRole.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: =If(ThisItem.properties.roleName="CanView", "Make Editor", "Make Viewer")
            Visible: |-
                =// do not show for derived owner. someone must remain derived owner
                // do not show for creator either just to keep things simple
                If(ThisItem.properties.principal.id=FlowDerivedOwner || ThisItem.properties.roleName="Owner" || ThisItem.properties.principal.type <> "User", false, true)
            Width: =173
            X: =865
            Y: =22
            ZIndex: =5

        btnRemovePermission As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorValue(Style.Primary)
            FocusedBorderColor: =btnRemovePermission.BorderColor
            Font: =Font.'Segoe UI'
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |-
                =//call helper to remove permissions
                If('HELPER-ObjectOperations'.Run(ThisItem.properties.principal.id, SelectedFlow.Flow, SelectedFlow.'Flow Environment'.Name, "removeuser", "flow").thereturnstring="pass",
                
                //if success, refresh data in app
                Refresh(Flows);
                ClearCollect(
                    flowRoles,
                    PowerAutomateforAdmins.GetAdminFlowOwnerRole(
                        SelectedFlow.'Flow Environment'.Name,
                        SelectedFlow.Flow
                    ).value
                );, 
                
                //else show error message
                UpdateContext({
                        showCantShowThat: true,
                        CantShowThatText: "Removing permissions failed, try to remove via product UX"
                }));
                
                
                /*UpdateIf(Flows, Flow=SelectedFlow.Flow, {DerivedOwner: LookUp(Makers, Maker=GUID(ThisItem.properties.principal.id))});
                Set(FlowDerivedOwner, LookUp(Flows, Flow=SelectedFlow.Flow).DerivedOwner.Maker);
                UpdateIf(Flows, Flow=SelectedFlow.Flow, {'Flow is Orphaned': "No"});
                */
                
                /*
                PowerAutomateforAdmins.EditAdminFlowOwnerRole(
                    SelectedFlow.'Flow Environment'.Name,
                    SelectedFlow.Flow,
                    {
                        delete: Table(
                            {
                                id: ThisItem.id
                            }
                        )
                    }
                );
                
                Refresh(Flows);
                ClearCollect(
                    flowRoles,
                    PowerAutomateforAdmins.GetAdminFlowOwnerRole(
                        SelectedFlow.'Flow Environment'.Name,
                        SelectedFlow.Flow
                    ).value
                )
                
                */
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnRemovePermission.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Remove Permission"
            Visible: =If(ThisItem.properties.roleName = "Owner" || ThisItem.properties.principal.id=FlowDerivedOwner || ThisItem.properties.principal.type <> "User", false, true)
            Width: =200
            X: =1093
            Y: =22
            ZIndex: =6

        TypeGroupWarning As label:
            Height: =41
            OnSelect: =Select(Parent)
            Text: |-
                ="Type " & ThisItem.properties.principal.type & ": Cannot change permissions for this type in the app, please go to App Setting and change there"
            Visible: =ThisItem.properties.principal.type <> "User"
            Width: =1030
            X: =627
            Y: =22
            ZIndex: =7

        TypeOwnerWarning As label:
            Height: =41
            OnSelect: =Select(Parent)
            Text: |-
                ="Type Owner: Cannot change permissions for owner until you assign a new owner"
            Visible: =ThisItem.properties.principal.id=FlowDerivedOwner
            Width: =1030
            X: =625
            Y: =22
            ZIndex: =8

        lblUserName_2 As label:
            BorderColor: =RGBA(218,218,218,1.00)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(47,41,43,1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70)
            FocusedBorderColor: =lblUserName_2.BorderColor
            Font: =Font.'Segoe UI'
            Height: =86
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(4,45,81,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(4,45,81,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Text: =ThisItem.properties.principal.type
            Width: =333
            X: =1487
            ZIndex: =9

    lblAppOverviewTitle As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppOverviewTitle.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(0,0,0,1.00)
        HoverFill: =RGBA(0, 0, 0, 0)
        PaddingLeft: =0
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =RGBA(0,0,0,1.00)
        PressedFill: =RGBA(0, 0, 0, 0)
        Size: =16
        Text: ="Flow overview"
        Width: =266
        X: =56
        Y: =80
        ZIndex: =4

    lblAppOverviewName As label:
        BorderColor: =RGBA(230, 230, 230, 1)
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppOverviewName.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =60
        HoverBorderColor: =lblAppOverviewName.BorderColor
        HoverColor: =lblAppOverviewName.Color
        HoverFill: =lblAppOverviewName.Fill
        PaddingLeft: =0
        PaddingTop: =0
        PressedBorderColor: =lblAppOverviewName.BorderColor
        PressedColor: =lblAppOverviewName.Color
        PressedFill: =lblAppOverviewName.Fill
        Size: =14
        Text: =SelectedFlow.'Display Name'
        Width: =500
        X: =56
        Y: =152
        ZIndex: =6

    bkgOptionBar As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        DisabledFill: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(244, 244, 244, 1)
        FocusedBorderColor: =bkgOptionBar.BorderColor
        FocusedBorderThickness: =4
        Height: =52
        HoverFill: =bkgOptionBar.Fill
        OnSelect: =
        PressedFill: =bkgOptionBar.Fill
        TabIndex: =0
        Width: =1920
        X: =
        ZIndex: =11

    galFlowOptions As gallery.galleryHorizontal:
        BorderColor: =RGBA(166, 166, 166, 1)
        DisabledBorderColor: =galFlowOptions.BorderColor
        DisabledFill: =galFlowOptions.Fill
        Height: =57
        HoverBorderColor: =galFlowOptions.BorderColor
        HoverFill: =galFlowOptions.Fill
        Items: |-
            =Table({
                id:0,
                label:"Back to dashboard"
            },{
                id:1,
                label:"Flow Settings"
            },{
                id:4,
                label:"Email users"
            },{
                id:5,
                label:"Add new users"
            })
        LoadingSpinnerColor: =galFlowOptions.BorderColor
        OnSelect: |-
            =Switch(
                ThisItem.id,
                0,
                Navigate(
                    If(SearchScreenNumber=1, HomeScreen, If(SearchScreenNumber=2, OwnerScreen, If(SearchScreenNumber=3, OrphanedFlowScreen, HomeScreen))),
                    ScreenTransition.Fade
                ),
                1,
                Launch(theFlowURL & SelectedFlow.'Flow Environment'.Name & "/flows/" & SelectedFlow.Flow & "/details"),
                4,
                Clear(userIDsForMail);
                ForAll(Filter(flowRoles, properties.principal.type="User"), Collect(userIDsForMail, {mailUserID: GUID(properties.principal.id)}));
                UpdateContext({showEmailUsers: true}),
                5,
                UpdateContext({showAddUsers: true});
                If(
                    drpSearchUserRole.Selected.Value = "Editor",
                    UpdateContext({vUserRole: "CanEdit"}),
                    UpdateContext({vUserRole: "CanView"})
                )
            )
        PressedBorderColor: =galFlowOptions.BorderColor
        PressedFill: =galFlowOptions.Fill
        TemplateSize: =454
        Width: =1866
        X: =28
        ZIndex: =12

        lblOption As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblOption.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            HoverBorderColor: =lblOption.BorderColor
            HoverColor: =lblOption.Color
            HoverFill: =lblOption.Fill
            OnSelect: =Select(Parent)
            PaddingTop: =3
            PressedBorderColor: =lblOption.BorderColor
            PressedColor: =lblOption.Color
            PressedFill: =lblOption.Fill
            Size: =14
            Text: =ThisItem.label
            Width: =193
            X: =40
            ZIndex: =1

        iIcon As icon.Add:
            Color: =RGBA(149, 149, 149, 1)
            DisabledFill: =iIcon.Fill
            FocusedBorderColor: =iIcon.BorderColor
            Height: =40
            HoverBorderColor: =ColorFade(iIcon.BorderColor, 20%)
            HoverColor: =ColorFade(iIcon.Color, 20%)
            HoverFill: =iIcon.Fill
            Icon: =Switch(ThisItem.id, 0, Icon.ArrowLeft, 1, Icon.Settings, 3, Icon.Airplane, 4, Icon.Mail, 5, Icon.People)
            OnSelect: =Select(Parent)
            PaddingBottom: =5
            PaddingLeft: =5
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(iIcon.BorderColor, -20%)
            PressedColor: =ColorFade(iIcon.Color, -20%)
            PressedFill: =iIcon.Fill
            Width: =40
            ZIndex: =2

    lblAppBkgColor2 As htmlViewer:
        AutoHeight: =true
        Height: =60
        HoverBorderColor: =lblAppBkgColor2.BorderColor
        HtmlText: =
        OnSelect: =
        PaddingBottom: =-10
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =-10
        PressedBorderColor: =lblAppBkgColor2.BorderColor
        Width: =64
        X: =80
        Y: =143
        ZIndex: =13

    imgAppIcon2 As image:
        BorderColor: =ColorFade(imgAppIcon2.Fill,-20%)
        DisabledBorderColor: =RGBA(159, 167, 165, 1)
        DisabledFill: =RGBA(193, 193, 193, 0.95)
        Fill: =
        FocusedBorderColor: =imgAppIcon2.BorderColor
        Height: =60
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =
        ImagePosition: =ImagePosition.Fill
        OnSelect: =
        PaddingBottom: =imgAppIcon2.PaddingTop
        PaddingLeft: =imgAppIcon2.PaddingTop
        PaddingRight: =imgAppIcon2.PaddingTop
        PaddingTop: =10
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =64
        X: =80
        Y: =143
        ZIndex: =14

    bkgPopUp As rectangle:
        DisabledFill: =bkgPopUp.Fill
        Fill: =RGBA(0, 0, 0, 0.35)
        FocusedBorderColor: =bkgPopUp.BorderColor
        Height: =1080
        HoverFill: =bkgPopUp.Fill
        PressedFill: =bkgPopUp.Fill
        Visible: =showAddUsers || showEmailUsers
        Width: =1920
        ZIndex: =15

    grpAppDetails As group:
        Height: =5
        Width: =5
        X: =3
        Y: =-1
        ZIndex: =25

        lblDescriptionValue As label:
            BorderColor: =RGBA(230, 230, 230, 1)
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblDescriptionValue.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =102
            HoverBorderColor: =lblDescriptionValue.BorderColor
            HoverColor: =lblDescriptionValue.Color
            HoverFill: =lblDescriptionValue.Fill
            PaddingLeft: =10
            PaddingTop: =10
            PressedBorderColor: =lblDescriptionValue.BorderColor
            PressedColor: =lblDescriptionValue.Color
            PressedFill: =lblDescriptionValue.Fill
            Text: =SelectedFlow.'Maker Requirement - Business Justification'
            VerticalAlign: =VerticalAlign.Top
            Width: =896
            X: =971
            Y: =180
            ZIndex: =2

        lblDetails As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(128, 128, 128, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblDetails.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0,0,0,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            PaddingLeft: =0
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(0,0,0,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Size: =12
            Text: ="DETAILS"
            Width: =359
            X: =614
            Y: =105
            ZIndex: =3

        lblModifiedValue As label:
            BorderColor: =RGBA(230, 230, 230, 1)
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblModifiedValue.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =44
            HoverBorderColor: =lblModifiedValue.BorderColor
            HoverColor: =lblModifiedValue.Color
            HoverFill: =lblModifiedValue.Fill
            PaddingLeft: =10
            PressedBorderColor: =lblModifiedValue.BorderColor
            PressedColor: =lblModifiedValue.Color
            PressedFill: =lblModifiedValue.Fill
            Text: =Text(SelectedFlow.'Flow Modified On',"[$-en-US]dd-mmm-yyyy")
            Width: =140
            X: =798
            Y: =180
            ZIndex: =5

        lblModifiedLabel As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(116, 116, 116, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblModifiedLabel.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =35
            HoverBorderColor: =lblModifiedLabel.BorderColor
            HoverColor: =lblModifiedLabel.Color
            HoverFill: =lblModifiedLabel.Fill
            PaddingLeft: =0
            PressedBorderColor: =lblModifiedLabel.BorderColor
            PressedColor: =lblModifiedLabel.Color
            PressedFill: =lblModifiedLabel.Fill
            Size: =10
            Text: ="Modified"
            Width: =232
            X: =798
            Y: =146
            ZIndex: =7

        lblCreatedValue As label:
            BorderColor: =RGBA(230, 230, 230, 1)
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblCreatedValue.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =44
            HoverBorderColor: =lblCreatedValue.BorderColor
            HoverColor: =lblCreatedValue.Color
            HoverFill: =lblCreatedValue.Fill
            PaddingLeft: =10
            PressedBorderColor: =lblCreatedValue.BorderColor
            PressedColor: =lblCreatedValue.Color
            PressedFill: =lblCreatedValue.Fill
            Text: =Text(SelectedFlow.'Flow Created On' ,"[$-en-US]dd-mmm-yyyy")
            Width: =140
            X: =614
            Y: =180
            ZIndex: =8

        lblCreatedLabel As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(116, 116, 116, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblCreatedLabel.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =35
            HoverBorderColor: =lblCreatedLabel.BorderColor
            HoverColor: =lblCreatedLabel.Color
            HoverFill: =lblCreatedLabel.Fill
            PaddingLeft: =0
            PressedBorderColor: =lblCreatedLabel.BorderColor
            PressedColor: =lblCreatedLabel.Color
            PressedFill: =lblCreatedLabel.Fill
            Size: =10
            Text: ="Created"
            Width: =232
            X: =614
            Y: =146
            ZIndex: =9

        lblDescriptionLabel As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(116, 116, 116, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblDescriptionLabel.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =35
            HoverBorderColor: =lblDescriptionLabel.BorderColor
            HoverColor: =lblDescriptionLabel.Color
            HoverFill: =lblDescriptionLabel.Fill
            PaddingLeft: =0
            PressedBorderColor: =lblDescriptionLabel.BorderColor
            PressedColor: =lblDescriptionLabel.Color
            PressedFill: =lblDescriptionLabel.Fill
            Size: =10
            Text: ="Description"
            Width: =335
            X: =973
            Y: =146
            ZIndex: =10

    Label3 As label:
        Align: =LayoutAlignItems.Center
        Fill: =RGBA(244, 244, 244, 1)
        Height: =38
        Italic: =true
        Size: =14
        Text: |-
            ="Changing flow ownership is not possible in the product, so changing it here only changes it in the context of your CoE Toolkit. It is stored and used as a property of the CoE Flow table: DerivedOwner"
        Width: =1920
        Y: =1041
        ZIndex: =38

    cant_do_that_Dialog As group:
        Height: =5
        Width: =5
        X: =100
        Y: =100
        ZIndex: =43

        bg_cant_do_that As rectangle:
            DisabledFill: =bg_cant_do_that.Fill
            Fill: =RGBA(238, 204, 204, 1)
            Height: =If(Self.Visible, 60, 0)
            HoverFill: =bg_cant_do_that.Fill
            PressedFill: =bg_cant_do_that.Fill
            Visible: =showCantShowThat
            Width: =If(Self.Visible, Parent.Width, 0)
            ZIndex: =39

        lbl_cant_do_that As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(51, 51, 51, 1)
            Height: =bg_cant_do_that.Height
            Text: =CantShowThatText
            Visible: =showCantShowThat
            Width: =bg_cant_do_that.Width
            X: =bg_cant_do_that.X
            Y: =bg_cant_do_that.Y
            ZIndex: =40

        x_cant_do_that As icon.Cancel:
            Color: =RGBA(51, 51, 51, 1)
            DisabledFill: =x_cant_do_that.Fill
            Height: =bg_cant_do_that.Height
            HoverBorderColor: =ColorFade(x_cant_do_that.BorderColor, 20%)
            HoverColor: =ColorFade(x_cant_do_that.Color, 20%)
            HoverFill: =x_cant_do_that.Fill
            Icon: =Icon.Cancel
            OnSelect: |-
                =UpdateContext({showCantShowThat: false})
            PressedBorderColor: =ColorFade(x_cant_do_that.BorderColor, -20%)
            PressedColor: =ColorFade(x_cant_do_that.Color, -20%)
            PressedFill: =x_cant_do_that.Fill
            Visible: =showCantShowThat
            Width: =Self.Height
            X: =If(Self.Visible, Parent.Width-Self.Width-5, 0)
            Y: =bg_cant_do_that.Y
            ZIndex: =43

    role_refresh As group:
        Height: =5
        Width: =5
        X: =100
        Y: =100
        ZIndex: =45

        rolesRefresh As icon.Reload:
            DisabledFill: =rolesRefresh.Fill
            Height: =rolesHeader.Height
            HoverBorderColor: =ColorFade(rolesRefresh.BorderColor, 20%)
            HoverColor: =ColorFade(rolesRefresh.Color, 20%)
            HoverFill: =rolesRefresh.Fill
            Icon: =Icon.Reload
            OnSelect: |
                =ClearCollect(
                    flowRoles,
                    PowerAutomateforAdmins.GetAdminFlowOwnerRole(
                        SelectedFlow.'Flow Environment'.Name,
                        SelectedFlow.Flow
                    ).value
                );
            PaddingBottom: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(rolesRefresh.BorderColor, -20%)
            PressedColor: =ColorFade(rolesRefresh.Color, -20%)
            PressedFill: =rolesRefresh.Fill
            Tooltip: ="Refresh Permissions"
            Width: =Self.Height
            X: =190
            Y: =268
            ZIndex: =41

        rolesHeader As label:
            Height: =42
            Text: ="Flow Permissions"
            X: =galFlowRoles.X
            Y: =265
            ZIndex: =42

    grpSendEmail As group:
        Height: =5
        Width: =5
        X: =-395
        Y: =-109
        ZIndex: =53

        bkgSendEmail As rectangle:
            BorderColor: =RGBA(230, 230, 230, 1)
            BorderThickness: =2
            DisabledFill: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =bkgSendEmail.BorderColor
            FocusedBorderThickness: =4
            Height: =616
            HoverFill: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            Visible: =showEmailUsers
            Width: =1011
            X: =454
            Y: =232
            ZIndex: =26

        lblMessage As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(116, 116, 116, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblMessage.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =30
            HoverBorderColor: =lblMessage.BorderColor
            HoverColor: =lblMessage.Color
            HoverFill: =lblMessage.Fill
            PaddingLeft: =0
            PressedBorderColor: =lblMessage.BorderColor
            PressedColor: =lblMessage.Color
            PressedFill: =lblMessage.Fill
            Size: =11
            Text: ="MESSAGE"
            Visible: =showEmailUsers
            Width: =234
            X: =517
            Y: =437
            ZIndex: =27

        lblSendTo As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(116, 116, 116, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblSendTo.BorderColor
            FocusedBorderThickness: =4
            FontWeight: =FontWeight.Semibold
            Height: =30
            HoverBorderColor: =lblSendTo.BorderColor
            HoverColor: =lblSendTo.Color
            HoverFill: =lblSendTo.Fill
            PaddingLeft: =0
            PressedBorderColor: =lblSendTo.BorderColor
            PressedColor: =lblSendTo.Color
            PressedFill: =lblSendTo.Fill
            Size: =11
            Text: ="SEND TO"
            Visible: =showEmailUsers
            Width: =186
            X: =513
            Y: =239
            ZIndex: =28

        "galSendTo As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            BorderColor: =RGBA(230, 230, 230, 1)
            BorderThickness: =1
            DisabledBorderColor: =galSendTo.BorderColor
            DisabledFill: =galSendTo.Fill
            Height: =68
            HoverBorderColor: =galSendTo.BorderColor
            HoverFill: =galSendTo.Fill
            Items: =userIDsForMail
            Layout: =Layout.Vertical
            LoadingSpinnerColor: =galSendTo.BorderColor
            PressedBorderColor: =galSendTo.BorderColor
            PressedFill: =galSendTo.Fill
            TemplatePadding: =0
            TemplateSize: =58
            Visible: =showEmailUsers
            Width: =893
            WrapCount: =5
            X: =511
            Y: =270
            ZIndex: =29

            Label1 As label:
                OnSelect: =Select(Parent)
                Text: =LookUp(Makers, Maker=ThisItem.mailUserID).'Display Name'
                X: =12
                Y: =9
                ZIndex: =1

        lblSubject As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(116, 116, 116, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblSubject.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =30
            HoverBorderColor: =lblSubject.BorderColor
            HoverColor: =lblSubject.Color
            HoverFill: =lblSubject.Fill
            PaddingLeft: =0
            PressedBorderColor: =lblSubject.BorderColor
            PressedColor: =lblSubject.Color
            PressedFill: =lblSubject.Fill
            Size: =11
            Text: ="SUBJECT"
            Visible: =showEmailUsers
            Width: =234
            X: =520
            Y: =338
            ZIndex: =30

        txtEmailSubject As text:
            BorderColor: =RGBA(230, 230, 230, 1)
            BorderThickness: =1
            Color: =RGBA(51, 51, 51, 1)
            Default: ="Update for " & SelectedFlow.'Display Name'
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisplayMode: =If(false,DisplayMode.View,DisplayMode.Edit)
            FocusedBorderColor: =txtEmailSubject.BorderColor
            Font: =Font.'Segoe UI'
            Height: =42
            HintText: =""
            HoverBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            Mode: =TextMode.MultiLine
            PressedBorderColor: =RGBA(0, 120, 212, 1)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Tooltip: ="Message input field, tap again to edit"
            Visible: =showEmailUsers
            Width: =887
            X: =517
            Y: =373
            ZIndex: =31

        txtEmailMessage As richTextEditor:
            BorderColor: =RGBA(230, 230, 230, 1)
            Default: ="Enter some <strong>rich text</strong> here."
            Height: =278
            Size: =14
            Visible: =showEmailUsers
            Width: =884
            X: =521
            Y: =483
            ZIndex: =32

        btnSendEmail As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisplayMode: =If( IsEmpty(galSendTo.AllItems), DisplayMode.Disabled, DisplayMode.Edit)
            Fill: =ColorValue(Style.Primary)
            FocusedBorderColor: =btnSendEmail.BorderColor
            Font: =Font.'Segoe UI'
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |-
                =ForAll(userIDsForMail,
                    Office365.SendEmailV2(
                        LookUp(Makers, Maker=mailUserID).'User Principal Name',
                        galFlows.Selected.'Display Name',
                        txtEmailMessage.HtmlText,
                        {Importance: "Normal"}
                    )
                );
                Notify(
                    "The app users have been emailed successfully.",
                    NotificationType.Success
                );
                UpdateContext({showEmailUsers: false})
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnSendEmail.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Send"
            Visible: =showEmailUsers
            Width: =173
            X: =1032
            Y: =794
            ZIndex: =33

        btnCancelSendEmail As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorValue(Style.Tertiary)
            FocusedBorderColor: =btnCancelSendEmail.BorderColor
            Font: =Font.'Segoe UI'
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |-
                =UpdateContext({showEmailUsers:false})
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnCancelSendEmail.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Cancel"
            Visible: =showEmailUsers
            Width: =173
            X: =1231
            Y: =794
            ZIndex: =34

    grpAddUsers As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =55

        bkgAddNewUsers As rectangle:
            DisabledFill: =bkgAddNewUsers.Fill
            Fill: =RGBA(244, 244, 244, 1)  
            FocusedBorderColor: =bkgAddNewUsers.BorderColor
            Height: =950
            HoverFill: =bkgAddNewUsers.Fill
            PressedFill: =bkgAddNewUsers.Fill
            Visible: =showAddUsers
            Width: =1098
            X: =374
            Y: =65
            ZIndex: =16

        lblAddNewUsers As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblAddNewUsers.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0,0,0,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            PaddingLeft: =0
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(0,0,0,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Size: =16
            Text: ="Add New Users"
            Visible: =showAddUsers
            Width: =266
            X: =385
            Y: =80
            ZIndex: =17

        txtSearchUser As text:
            Align: =LayoutAlignItems.Center
            BorderColor: =RGBA(220,220,220,1)
            BorderThickness: =1
            Color: =Color.Black
            Default: =""
            DisabledBorderColor: =RGBA(159, 167, 165, 1)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            DisabledFill: =ColorFade(RGBA(159, 167, 165, 1), 50%)
            DisplayMode: =If(false,DisplayMode.View,DisplayMode.Edit)
            FocusedBorderColor: =txtSearchUser.BorderColor
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Lighter
            Height: =50
            HintText: ="Type a name or an email address"
            HoverBorderColor: =RGBA(159,159,159,1)
            HoverColor: =Color.Black
            HoverFill: =Color.White
            OnSelect: =
            PressedBorderColor: =txtSearchUser.HoverBorderColor
            PressedColor: =txtSearchUser.Color
            PressedFill: =txtSearchUser.Fill
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Reset: =clearSearchField
            Size: =18
            Tooltip: ="Search people input field"
            Visible: =showAddUsers
            Width: =1049
            X: =395
            Y: =131
            ZIndex: =18

        galSearchPeopleresult As gallery.galleryVertical:
            BorderColor: =RGBA(233, 232, 233, 1)
            BorderStyle: =BorderStyle.None
            DisabledBorderColor: =galSearchPeopleresult.BorderColor
            DisabledFill: =galSearchPeopleresult.Fill
            Height: =476
            HoverBorderColor: =galSearchPeopleresult.BorderColor
            HoverFill: =galSearchPeopleresult.Fill
            Items: =If(Len(txtSearchUser.Text) > 3,searchResultsCol)
            Layout: =Layout.Vertical
            LoadingSpinnerColor: =galSearchPeopleresult.BorderColor
            OnSelect: =
            PressedBorderColor: =galSearchPeopleresult.BorderColor
            PressedFill: =galSearchPeopleresult.Fill
            TemplateFill: =If(ThisItem.IsSelected, ColorValue(Style.Primary), Color.White)
            TemplateSize: =138
            Visible: =showAddUsers
            Width: =1060
            X: =393
            Y: =233
            ZIndex: =19

            imgSearchProfilePic As image:
                ApplyEXIFOrientation: =false
                BorderColor: =RGBA(101, 128, 187, 1)
                DisabledBorderColor: =RGBA(159, 167, 165, 1)
                DisabledFill: =RGBA(193, 193, 193, 0.95)
                Fill: =RGBA(230, 230, 230, 1)
                FocusedBorderColor: =imgSearchProfilePic.BorderColor
                Height: =80
                HoverBorderColor: =ColorFade(imgSearchProfilePic.BorderColor, 20%)
                HoverFill: =ColorFade(imgSearchProfilePic.Fill, 20%)
                Image: |-
                    =If(!IsBlank(ThisItem.UserPrincipalName), Office365Users.UserPhotoV2(ThisItem.UserPrincipalName))  //If(IsBlank(TextBox_hiddenImageState.Text),'preload - user',"data:image/jpeg;base64," & TextBox_hiddenImageState.Text)
                ImagePosition: =ImagePosition.Fill
                PressedBorderColor: =ColorFade(imgSearchProfilePic.BorderColor, -20%)
                PressedFill: =ColorFade(imgSearchProfilePic.Fill, -20%)
                RadiusBottomLeft: =40
                RadiusBottomRight: =40
                RadiusTopLeft: =40
                RadiusTopRight: =40
                TabIndex: =0
                Width: =80
                X: =5
                Y: =27
                ZIndex: =5

            lblSearchUserID As label:
                FocusedBorderColor: =lblSearchUserID.BorderColor
                Font: =Font.'Segoe UI'
                Height: =35
                HoverBorderColor: =lblSearchUserID.BorderColor
                HoverColor: =lblSearchUserID.Color
                HoverFill: =lblSearchUserID.Fill
                OnSelect: =Select(Parent)
                PressedBorderColor: =lblSearchUserID.BorderColor
                PressedColor: =lblSearchUserID.Color
                PressedFill: =lblSearchUserID.Fill
                Text: |-
                    =If( Len(txtSearchUser)>3, "User ID: " & Office365Users.UserProfileV2(ThisItem.UserPrincipalName).id, "")
                Width: =536
                X: =100
                Y: =88
                ZIndex: =8

            lblSearchEmail As label:
                FocusedBorderColor: =lblSearchEmail.BorderColor
                Font: =Font.'Segoe UI'
                Height: =41
                HoverBorderColor: =lblSearchEmail.BorderColor
                HoverColor: =lblSearchEmail.Color
                HoverFill: =lblSearchEmail.Fill
                OnSelect: =Select(Parent)
                PressedBorderColor: =lblSearchEmail.BorderColor
                PressedColor: =lblSearchEmail.Color
                PressedFill: =lblSearchEmail.Fill
                Text: =ThisItem.UserPrincipalName
                Width: =443
                X: =100
                Y: =47
                ZIndex: =9

            lblSearchName As label:
                FocusedBorderColor: =lblSearchName.BorderColor
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Bold
                Height: =48
                HoverBorderColor: =lblSearchName.BorderColor
                HoverColor: =lblSearchName.Color
                HoverFill: =lblSearchName.Fill
                OnSelect: =Select(Parent)
                PressedBorderColor: =lblSearchName.BorderColor
                PressedColor: =lblSearchName.Color
                PressedFill: =lblSearchName.Fill
                Size: =16
                Text: =ThisItem.GivenName & " " & ThisItem.Surname
                Width: =550
                X: =100
                Y: =9
                ZIndex: =10

        iSearch As icon.Search:
            BorderColor: =RGBA(101, 128, 187, 1)
            Color: =RGBA(220,220,220,1)
            DisabledBorderColor: =RGBA(159, 167, 165, 1)
            DisabledColor: =RGBA(193, 193, 193, 0.95)
            DisabledFill: =iSearch.Fill
            FocusedBorderColor: =iSearch.BorderColor
            Height: =50
            HoverBorderColor: =ColorFade(iSearch.BorderColor, 20%)
            HoverColor: =ColorFade(iSearch.Color, 20%)
            HoverFill: =iSearch.Fill
            Icon: =Icon.Search
            PaddingBottom: =5
            PaddingLeft: =5
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(iSearch.BorderColor, -20%)
            PressedColor: =ColorFade(iSearch.Color, -20%)
            PressedFill: =iSearch.Fill
            Visible: =showAddUsers
            Width: =50
            X: =407
            Y: =131
            ZIndex: =20

        lblFetchingData As label:
            BorderColor: =RGBA(101, 128, 187, 1)
            Color: =RGBA(47,41,43,1)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            FocusedBorderColor: =lblFetchingData.BorderColor
            Font: =Font.Arial
            Height: =35
            HoverBorderColor: =lblFetchingData.BorderColor
            HoverColor: =lblFetchingData.Color
            HoverFill: =lblFetchingData.Fill
            PressedBorderColor: =lblFetchingData.BorderColor
            PressedColor: =lblFetchingData.Color
            PressedFill: =lblFetchingData.Fill
            Size: =18
            Text: =searchStatus
            Visible: =false
            Width: =300
            X: =395
            Y: =181
            ZIndex: =21

        imgClearInput As image:
            ApplyEXIFOrientation: =false
            BorderColor: =RGBA(101, 128, 187, 1)
            DisabledBorderColor: =RGBA(159, 167, 165, 1)
            DisabledFill: =RGBA(193, 193, 193, 0.95)
            FocusedBorderColor: =imgClearInput.BorderColor
            Height: =txtSearchUser.Height
            HoverBorderColor: =ColorFade(imgClearInput.BorderColor, 20%)
            HoverFill: =ColorFade(imgClearInput.Fill, 20%)
            Image: =closedark
            OnSelect: |-
                =UpdateContext({clearSearchField:false});UpdateContext({clearSearchField:true})
            PaddingBottom: =15
            PaddingLeft: =15
            PaddingRight: =15
            PaddingTop: =15
            PressedBorderColor: =ColorFade(imgClearInput.BorderColor, -20%)
            PressedFill: =ColorFade(imgClearInput.Fill, -20%)
            Visible: =showAddUsers
            Width: =txtSearchUser.Height
            X: =1394
            Y: =131
            ZIndex: =22

        tmrSearch As timer:
            BorderColor: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            DisabledColor: =RGBA(186, 186, 186, 1)
            DisabledFill: =RGBA(119, 119, 119, 1)
            DisplayMode: =If(false,DisplayMode.View,DisplayMode.Edit)
            Duration: =300
            Fill: =RGBA(69, 69, 69, 1)
            FocusedBorderColor: =tmrSearch.BorderColor
            HoverBorderColor: =ColorFade(tmrSearch.BorderColor, 20%)
            HoverColor: =tmrSearch.Color
            HoverFill: =ColorFade(tmrSearch.Fill, 20%)
            OnTimerEnd: |-
                =If(
                    Len(txtSearchUser.Text) = searchTextCount,
                    ClearCollect(
                        searchResultsCol,       
                            Office365Users.SearchUser({searchTerm: PlainText(txtSearchUser.Text)})
                        
                    );
                    If(
                        IsEmpty(searchResultsCol),
                        UpdateContext({searchStatus: "No match found"}),
                        UpdateContext({searchStatus: "Match found"})
                    )
                )
            OnTimerStart: |-
                =UpdateContext({searchStatus:"Searching...",searchTextCount:Len(txtSearchUser.Text)})
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =ColorFade(tmrSearch.BorderColor, -20%)
            PressedColor: =tmrSearch.Color
            PressedFill: =ColorFade(tmrSearch.Fill, -20%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Repeat: =Len(txtSearchUser.Text)> 2 && Len(txtSearchUser.Text) <> searchTextCount
            Size: =11
            Start: =Len(txtSearchUser.Text) > 2
            Text: |-
                =Text(Time(0, 0, tmrSearch.Value/1000), "hh:mm:ss")
            Visible: =false
            Width: =150
            X: =545
            Y: =194
            ZIndex: =23

        lblSelectedUserRole As label:
            FocusedBorderColor: =lblSelectedUserRole.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Height: =65
            HoverBorderColor: =lblSelectedUserRole.BorderColor
            HoverColor: =lblSelectedUserRole.Color
            HoverFill: =lblSelectedUserRole.Fill
            PressedBorderColor: =lblSelectedUserRole.BorderColor
            PressedColor: =lblSelectedUserRole.Color
            PressedFill: =lblSelectedUserRole.Fill
            Text: |-
                ="Selected User Role:"
            Visible: =showAddUsers
            Width: =210
            X: =407
            Y: =746
            ZIndex: =24

        lblNote As label:
            FocusedBorderColor: =lblNote.BorderColor
            Font: =Font.'Segoe UI'
            Height: =65
            HoverBorderColor: =lblNote.BorderColor
            HoverColor: =lblNote.Color
            HoverFill: =lblNote.Fill
            PressedBorderColor: =lblNote.BorderColor
            PressedColor: =lblNote.Color
            PressedFill: =lblNote.Fill
            Text: |-
                ="Note: You can make them an app owner after you've added them as a user."
            Visible: =showAddUsers
            Width: =1037
            X: =404
            Y: =811
            ZIndex: =25

        btnAddUser As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisplayMode: =If( false, DisplayMode.Disabled, DisplayMode.Edit)
            Fill: =ColorValue(Style.Primary)
            FocusedBorderColor: =btnAddUser.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |-
                =//get user details
                UpdateContext({TargetUserEmail:galSearchPeopleresult.Selected.UserPrincipalName});
                UpdateContext({TargetUser: Office365Users.UserProfileV2(TargetUserEmail)});
                UpdateContext({TargetUserID: GUID(TargetUser.id)});
                UpdateContext({TargetUserDisplayName: TargetUser.displayName});
                UpdateContext({UpdatePermissionsPassed: "fail"});
                UpdateContext({RoleAssignment: drpSearchUserRole.SelectedText.Value});
                
                //if viewer or editor
                If(RoleAssignment = "Viewer" || RoleAssignment = "Editor",
                UpdateContext({returnResult: 'HELPER-ObjectOperations'.Run(TargetUserID, SelectedFlow.Flow, SelectedFlow.'Flow Environment'.Name, If(RoleAssignment = "Viewer", "addviewer", "addeditor"), "flow").thereturnstring}));
                
                //if owner
                If(RoleAssignment = "Owner",
                UpdateContext({returnResult: 'HELPER-ObjectOperations'.Run(TargetUserID, SelectedFlow.Flow, SelectedFlow.'Flow Environment'.Name, "assign", "flow").thereturnstring}));
                
                //update app or show error
                If(returnResult = "pass",
                    Refresh('Power Platform Users');
                    Refresh(Makers);
                    Refresh(Flows);
                    Set(SelectedFlow, LookUp(Flows, Flow=SelectedFlow.Flow));
                    If(RoleAssignment = "Owner", Set(FlowDerivedOwner, galSearchPeopleresult_1.Selected.Id));
                    ClearCollect(
                    flowRoles,
                    PowerAutomateforAdmins.GetAdminFlowOwnerRole(
                        SelectedFlow.'Flow Environment'.Name,
                        SelectedFlow.Flow
                    ).value),
                
                //else show error message
                    UpdateContext({showCantShowThat: true, CantShowThatText: returnResult}));
                
                UpdateContext({showAddUsers: false})
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnAddUser.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Add User"
            Visible: =showAddUsers
            Width: =173
            X: =1083
            Y: =958
            ZIndex: =35

        btnCancelAddUser As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorValue(Style.Tertiary)
            FocusedBorderColor: =btnCancelAddUser.BorderColor
            Font: =Font.'Segoe UI'
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |-
                =UpdateContext({showAddUsers: false})
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnCancelAddUser.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Cancel"
            Visible: =showAddUsers
            Width: =173
            X: =1282
            Y: =958
            ZIndex: =36

        drpSearchUserRole As dropdown:
            BorderColor: =RGBA(116, 116, 116, 1)
            ChevronBackground: =RGBA(202, 202, 202, 1)
            ChevronHoverBackground: =RGBA(116, 116, 116, 1)
            FocusedBorderColor: =drpSearchUserRole.BorderColor
            HoverBorderColor: =ColorFade(drpSearchUserRole.BorderColor, 15%)
            HoverFill: =RGBA(237, 237, 237, 1)
            Items: =["Viewer", "Editor"]
            OnChange: |-
                =If(
                    drpSearchUserRole.Selected.Value = "Editor",
                    UpdateContext({vUserRole: "CanEdit"}),
                    UpdateContext({vUserRole: "CanView"})
                )
            PressedBorderColor: =drpSearchUserRole.HoverBorderColor
            PressedFill: =RGBA(116, 116, 116, 1)
            SelectionFill: =RGBA(219, 219, 219, 1)
            Visible: =showAddUsers
            X: =608
            Y: =758
            ZIndex: =37

