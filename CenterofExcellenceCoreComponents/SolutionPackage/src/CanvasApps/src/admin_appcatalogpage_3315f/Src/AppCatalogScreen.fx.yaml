AppCatalogScreen As screen:
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)

    pnlEmailFeedback As Panel:
        Buttons: |-
            =If(emailUsers,Table({Label: "Cancel", ButtonType:'Microsoft.CoreControls.Button.ButtonType'.Standard } ,{Label: "Send", ButtonType:'Microsoft.CoreControls.Button.ButtonType'.Primary}),
            Table({Label: "Cancel", ButtonType:'Microsoft.CoreControls.Button.ButtonType'.Standard } ,{Label: "Submit", ButtonType:'Microsoft.CoreControls.Button.ButtonType'.Primary}))
        Fill: =pnlEmailFeedback.OverlayColor
        OnButtonSelect: |-
            =Switch(Self.SelectedButton.Label,
            "Send", Office365Outlook.SendEmailV2(vSelectedAppN.'App Owner'.'User Principal Name', txtEmailSubject.Text, RichTextEditor3.HtmlText, {Importance:ScreenSize.Medium});
            Notify("Your email has been sent.", NotificationType.Success);
            UpdateContext({showPopUp:false, emailUsers:false}),
            "Submit",Patch(
                'App Catalog Feedbacks',
                Defaults('App Catalog Feedbacks'),
                {
                    App: vSelectedAppN,
                    'Feedback Title': Left(txtFeedback.Text, 50),
                    Feedback: txtFeedback.Text,
                    Rating:appSubmitRating.Value
                        }
            );
            Refresh('App Catalog Feedbacks');
            Notify("Your review has been submitted, and will show up in the App Catalog shortly.", NotificationType.Success);
            UpdateContext({showPopUp:false, reviewUsers:false}),
            "Cancel",UpdateContext({showPopUp:false, emailUsers:false, reviewUsers:false}))
        OnCloseSelect: |-
            =UpdateContext({showPopUp:false, emailUsers:false, reviewUsers:false})
        Subtitle: =
        Title: =If(emailUsers, "Email maker", "Leave review")
        Visible: =showPopUp
        Width: =1366

    conMain As groupContainer.verticalAutoLayoutContainer:
        Height: =AppCatalogScreen.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =AppCatalogScreen.Width
        ZIndex: =1

        c_ActionHeader As groupContainer.verticalAutoLayoutContainer:
            Fill: =RGBA(243, 242, 241, 1)
            FillPortions: =0
            Height: =44
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutGap: =15
            LayoutJustifyContent: =LayoutJustifyContent.End
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =32
            PaddingRight: =32
            ZIndex: =1

            "txtSearchApps As 'Fluent SearchBox (1.0.18) Preview'":
                AlignInContainer: =AlignInContainer.Center
                DisplayMode: =DisplayMode.Edit
                Height: =33
                LayoutMinHeight: =34
                LayoutMinWidth: =200
                PlaceHolderText: ="Search"
                Theme: =SearchBoxThemeJson
                Underlined: =true
                Width: =300
                X: =0
                Y: =0
                ZIndex: =2

        Header As groupContainer.verticalAutoLayoutContainer:
            FillPortions: =0
            Height: =160
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =40
            PaddingRight: =40
            PaddingTop: =32
            ZIndex: =2

            Label1 As Label:
                AutoHeight: =true
                DisplayMode: =DisplayMode.Edit
                FontSize: =16
                FontWeight: =FontWeight.Semibold
                Height: =43
                LayoutMinHeight: =32
                LayoutMinWidth: =320
                PaddingStart: =0  
                Text: ="App Catalog"
                Width: =320
                X: =35
                Y: =15
                ZIndex: =1

            lblTitle_5 As Label:
                AlignInContainer: =AlignInContainer.Stretch
                AutoHeight: =false
                Color: =    
                DisplayMode: =DisplayMode.View
                FontSize: =11
                FontWeight: =FontWeight.Normal
                Height: =80
                LayoutMinHeight: =80
                LayoutMinWidth: =320
                Text: ="Launch and search for apps available in your organization. Leave feedback for makers to improve their apps, and request access to apps that you think would be useful for your role."
                VerticalAlignment: =VerticalAlign.Top
                Width: =840
                Wrap: =true
                X: =0
                Y: =0
                ZIndex: =2

        Container2 As groupContainer.horizontalAutoLayoutContainer:
            FillPortions: =0
            Height: =70
            LayoutMinHeight: =50
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =40
            PaddingRight: =40
            PaddingTop: =10
            ZIndex: =4

            "pivotNav As 'Fluent Pivot (1.0.18)'.pcfdataset":
                AlignInContainer: =AlignInContainer.Stretch
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =200
                Items: =col_Area
                LayoutMinHeight: =50
                LayoutMinWidth: =200
                Theme: =AppThemeJson
                Width: =200
                X: =0
                Y: =0
                ZIndex: =1

                "'App Display Name2' As pcfDataField.textualColumn":
                    FieldDisplayName: ="App Display Name"
                    FieldName: ="admin_displayname"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =1
                    ZIndex: =7

                "'App Modified On2' As pcfDataField.textualColumn":
                    FieldDisplayName: ="App Modified On"
                    FieldName: ="admin_appmodifiedon"
                    FieldType: ="d"
                    FieldVariantName: ="textualColumn"
                    Order: =4
                    ZIndex: =8

                "'App Last Launched On2' As pcfDataField.textualColumn":
                    FieldDisplayName: ="App Last Launched On"
                    FieldName: ="admin_applastlaunchedon"
                    FieldType: ="d"
                    FieldVariantName: ="textualColumn"
                    Order: =5
                    ZIndex: =9

                "'App Type2' As pcfDataField.textualColumn":
                    FieldDisplayName: ="App Type"
                    FieldName: ="admin_powerappstype"
                    FieldType: ="l"
                    FieldVariantName: ="textualColumn"
                    Order: =6
                    ZIndex: =10

                AppIDString2 As pcfDataField.textualColumn:
                    FieldDisplayName: ="AppIDString"
                    FieldName: ="admin_appidstring"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =7
                    ZIndex: =11

        Container4 As groupContainer.verticalAutoLayoutContainer:
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =40
            PaddingRight: =40
            ZIndex: =6

            "galApps_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
                BorderColor: =RGBA(237, 237, 237, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DisabledBorderColor: =galApps_1.BorderColor
                DisabledFill: =galApps_1.Fill
                Height: =824
                HoverBorderColor: =galApps_1.BorderColor
                HoverFill: =galApps_1.Fill
                Items: |-
                    =tenantApps /*SortByColumns(
                        Filter(
                            If(
                                "All" in pivotNav.Selected.ItemKey || IsBlank(pivotNav.Selected.ItemKey),
                                tenantApps,
                                Filter(
                                    tenantApps,
                                    Text(Category) = pivotNav.Selected.ItemKey
                                )
                            ),
                            txtSearchApps.SearchText in 'App Display Name'
                        ),
                        "admin_displayname",
                        Ascending
                    )*/
                Layout: =Layout.Vertical
                LayoutMinWidth: =App.MinScreenWidth
                LoadingSpinnerColor: =galApps_1.BorderColor
                OnSelect: |-
                    =Set(showAppDetails,true);
                    Set(vSelectedAppN, galApps_1.Selected);
                    ClearCollect(
                        appConnectionCollection,
                        AddColumns(
                            ForAll(Split(
                                vSelectedAppN.'App Connections',
                                ","
                            ), {Result: ThisRecord.Value}).Result,
                            "Name",
                            LookUp(allConnectors, name = Result).properties.displayName,
                            "Picture",
                            IfError(PowerAppsforMakers.GetConnector(
                                LookUp(
                                    allConnectors,
                                    name = Result
                                ).name,
                                {'$filter': "environment eq 'Default-" & defaultEnvironment & "'"}
                            ).properties.iconUri, Blank())
                        )
                    );
                    
                    ClearCollect(
                        appReview,
                        vSelectedAppN.'App Catalog Feedbacks')
                PressedBorderColor: =galApps_1.BorderColor
                PressedFill: =galApps_1.Fill
                TabIndex: =0
                TemplateFill: =Color.White
                TemplatePadding: =16
                TemplateSize: =250
                Width: =500
                WrapCount: =Max(AppCatalogScreen.Size,RoundDown(Self.Width / 318,0))
                X: =110
                Y: =33
                ZIndex: =1

                "Elevation1 As 'Fluent Elevation (1.0.18)'":
                    DisplayMode: =DisplayMode.Edit
                    Height: =Parent.TemplateHeight
                    HoverDepth: ='PowerCAT.Elevation.HoverDepth'.Depth8
                    OnChange: =false
                    Width: =Parent.TemplateWidth
                    X: =0
                    Y: =0
                    ZIndex: =1

                btnSelectGal As rectangle:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =4
                    Height: =Elevation1.Height
                    HoverFill: =RGBA(0, 0, 0, 0)
                    OnSelect: =Select(Parent)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Width: =Elevation1.Width
                    X: =0+0
                    Y: =0+0
                    ZIndex: =2

                Container1 As groupContainer.verticalAutoLayoutContainer:
                    Height: =Parent.TemplateHeight-imgIconHeader.Height
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =16
                    PaddingLeft: =20
                    PaddingRight: =20
                    PaddingTop: =20
                    Width: =Parent.TemplateWidth
                    Y: =imgIconHeader.Height
                    ZIndex: =3

                    Container5 As groupContainer.horizontalAutoLayoutContainer:
                        FillPortions: =0
                        Height: =26
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =1

                        lblDisplayName As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderColor: =lblDisplayName.BorderColor
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Bold
                            Height: =37
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0,0,0,1.00)
                            HoverFill: =RGBA(0, 0, 0, 0)
                            LayoutMinHeight: =26
                            OnSelect: =
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedColor: =RGBA(0,0,0,1.00)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Size: =10
                            TabIndex: =0
                            Text: |+
                                =If(
                                    IsBlank(ThisItem.'App Display Name'), 
                                    "No Name", 
                                    Left(ThisItem.'App Display Name', 25) & If( Len(ThisItem.'App Display Name') > 25, " ...")
                                )
                                
                                
                                
                            VerticalAlign: =VerticalAlign.Top
                            Width: =Container5.Width - 40
                            X: =1
                            Y: =imgIconHeader.Y+imgIconHeader.Height+8
                            ZIndex: =1

                        "Icon3 As 'Fluent Icon (1.0.18)'":
                            AlignInContainer: =AlignInContainer.Stretch
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =1
                            Height: =200
                            IconName: ="FavoriteStarFill"
                            IconType: ='PowerCAT.Icon.IconType'.ActionButton
                            LayoutMinHeight: =30
                            LayoutMinWidth: =30
                            Text: =ThisItem.'Avg Rating'
                            TextAlignment: ='PowerCAT.Icon.TextAlignment'.Left
                            Theme: =AppThemeJson
                            Visible: =ThisItem.'Avg Rating' > 0
                            Width: =200
                            X: =0
                            Y: =0
                            ZIndex: =2

                    lblAppDescription As Label:
                        DisplayMode: =DisplayMode.Edit
                        Height: =50
                        LayoutMinHeight: =32
                        LayoutMinWidth: =100
                        PaddingEnd: =5
                        PaddingStart: =5
                        Text: |+
                            =If(
                                IsBlank(LookUp(tenantApps, App = ThisItem.App).'App Description'), 
                                "No Description", 
                                Left(LookUp(tenantApps, App = ThisItem.App).'App Description', 76) & If( Len(LookUp(tenantApps, App = ThisItem.App).'App Description') > 76, " ...")
                            )
                            
                            
                        VerticalAlignment: =VerticalAlign.Top
                        Width: =
                        X: =0
                        Y: =0
                        ZIndex: =4

                    Container3 As groupContainer.horizontalAutoLayoutContainer:
                        FillPortions: =0
                        Height: =50
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =50
                        LayoutMinWidth: =100
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =5
                        ZIndex: =5

                        Button2 As Button:
                            Alignment: =Align.Left
                            ButtonType: ='Microsoft.CoreControls.Button.ButtonType'.Standard
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            OnSelect: |-
                                =Set(showAppDetails,true);
                                Set(vSelectedAppN, galApps_1.Selected);
                                ClearCollect(
                                    appConnectionCollection,
                                    AddColumns(
                                        ForAll(Split(
                                            vSelectedAppN.'App Connections',
                                            ","
                                        ), {Result: ThisRecord.Value}).Result,
                                        "Name",
                                        LookUp(allConnectors, name = Result).properties.displayName,
                                        "Picture",
                                        IfError(PowerAppsforMakers.GetConnector(
                                            LookUp(
                                                allConnectors,
                                                name = Result
                                            ).name,
                                            {'$filter': "environment eq 'Default-" & defaultEnvironment & "'"}
                                        ).properties.iconUri, Blank())
                                    )
                                );
                            Text: ="Learn more"
                            TextColor: =ColorValue(AppTheme.palette.themePrimary)
                            Width: =96
                            X: =0
                            Y: =0
                            ZIndex: =1

                        "Icon1 As 'Fluent Icon (1.0.18)'":
                            AlignInContainer: =AlignInContainer.Stretch
                            DisplayMode: =DisplayMode.Edit
                            Height: =200
                            IconName: ="OpenInNewTab"
                            LayoutMinHeight: =30
                            LayoutMinWidth: =200
                            OnChange: |-
                                = If(ThisItem.'App Type' = 'PowerApps Type'.Canvas,
                                Launch(theAppPlayerURL & "play/"& ThisItem.App &"?tenantID="& EnvVarTenantID, {}, LaunchTarget.New),
                                Launch(ThisItem.'App Environment'.'Environment CDS Instance URL' & "main.aspx?appid=" & ThisItem.App,{}, LaunchTarget.New))
                            Theme: =AppThemeJson
                            Tooltip: ="Launch app"
                            Width: =30
                            X: =0
                            Y: =0
                            ZIndex: =2

                imgIconHeader As image:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledFill: =Self.Fill
                    Fill: |-
                        =With(
                            Match(
                                LookUp(tenantApps, App = ThisItem.App).'Icon Background Color',
                                "rgba\((?<RedChannel>\d{1,3})\,\s(?<GreenChannel>\d{1,3})\,\s(?<BlueChannel>\d{1,3})\,\s(?<AlphaChannel>\d{1,3})\)"
                            ),
                            If(
                                IsBlank(LookUp(tenantApps, App = ThisItem.App).'Icon Background Color'),
                                ColorValue(AppTheme.palette.themePrimary),
                                RGBA(Value(RedChannel),Value(GreenChannel),Value(BlueChannel),Value(AlphaChannel))
                            )
                        )
                    FocusedBorderThickness: =4
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =Self.Fill
                    Image: |-
                        =IfError(PowerAppsforMakers.GetApp(ThisItem.App).properties.backgroundImageUri, Blank(), PowerAppsforMakers.GetApp(ThisItem.App).properties.backgroundImageUri)
                        
                        //PowerAppsforMakers.GetApp(ThisItem.theGUID).properties.backgroundImageUri
                        
                        //Coalesce(ThisItem.'App Icon Uri',FluentIcon_1.GetIcon("PowerApps",AppTheme.palette.neutralLight))
                        /*
                        If(
                            !IsBlank(ThisItem.AppIDString),
                            PowerAppsforAppMakers.GetApp(ThisItem.AppIDString).properties.backgroundImageUri
                        )
                        */
                        
                        //ThisItem.'App Icon Uri'
                        //Coalesce(ThisItem.'App Icon Uri',FluentIcon_1.GetIcon("PowerApps",AppTheme.palette.neutralLight))
                    OnSelect: =
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedFill: =Self.Fill
                    Width: =Parent.TemplateWidth
                    ZIndex: =4

                "Icon2 As 'Fluent Icon (1.0.18)'":
                    DisplayMode: =DisplayMode.Edit
                    Height: =100
                    IconColor: |-
                        ="#ffffff"
                    IconName: ="PowerApps2Logo"
                    IconSize: =50
                    IconType: ='PowerCAT.Icon.IconType'.Icon
                    TextAlignment: ='PowerCAT.Icon.TextAlignment'.Center
                    Visible: =IfError(PowerAppsforMakers.GetApp(ThisItem.App).properties.backgroundImageUri, true, false)
                    Width: =imgIconHeader.Width
                    X: =0
                    Y: =0
                    ZIndex: =5

                imgIconVignette As image:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =4
                    Height: =imgIconHeader.Height
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Image: =vignette
                    ImagePosition: =ImagePosition.Stretch
                    OnSelect: =
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Transparency: =0.85
                    Width: =Parent.TemplateWidth
                    ZIndex: =6

    conAppDetails As groupContainer.verticalAutoLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =AppCatalogScreen.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Visible: =showAppDetails
        Width: =AppCatalogScreen.Width
        ZIndex: =2

        ActionHeader_2 As groupContainer.verticalAutoLayoutContainer:
            Fill: =RGBA(243, 242, 241, 1)
            FillPortions: =0
            Height: =44
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =32
            PaddingRight: =32
            ZIndex: =1

            "CommandBar1_1 As 'Fluent Command Bar (1.0.18)'.pcfdataset":
                AlignInContainer: =AlignInContainer.Stretch
                DisplayMode: =DisplayMode.Edit
                Height: =200
                Items: |-
                    =Table(
                        {ItemKey:"back",ItemDisplayName:"Back",ItemIconName:"Back"},
                         {ItemKey: "launch", ItemDisplayName: "Launch", ItemIconName: "OpenInNewWindow"},
                            {ItemKey: "review", ItemDisplayName: "Leave review", ItemIconName: "FavoriteStar"},
                            {ItemKey: "email", ItemDisplayName: "Email maker", ItemIconName: "Mail"},
                            {ItemKey: "access", ItemDisplayName: "Request access", ItemIconName: "Permissions"}
                        
                        )
                LayoutMinHeight: =44
                LayoutMinWidth: =200
                OnChange: =
                OnSelect: |-
                    =Switch(
                        Self.Selected.ItemKey,
                        "back", Set(showAppDetails,false),
                        "launch",
                        If(vSelectedAppN.'App Type' = 'PowerApps Type'.Canvas,
                    Launch(theAppPlayerURL & "play/"& vSelectedAppN.App &"?tenantID="& EnvVarTenantID, {}, LaunchTarget.New),
                    Launch(vSelectedAppN.'App Environment'.'Environment CDS Instance URL' & "main.aspx?appid=" & vSelectedAppN.App,{}, LaunchTarget.New)),
                     "review",
                        UpdateContext({showPopUp: true, reviewUsers: true}),
                        "email",
                        UpdateContext({showPopUp: true, emailUsers: true}),
                        "access",
                        'AppCatalog>RequestAccess'.Run(vSelectedAppN.'App Environment'.Name, vSelectedAppN.App, vSelectedAppN.'App Owner'.'User Email', 
                            User().FullName, vSelectedAppN.'App Display Name', User().Email, Office365Users.UserProfileV2(User().Email).id);
                        Notify("An access request has been sent to the owner. You will receive a notification via email if access has been granted.")
                    )
                Theme: =AppThemeJson
                Visible: =true
                Width: =600
                X: =0
                Y: =0
                ZIndex: =1

        c_AppDetailsMain_3 As groupContainer.horizontalAutoLayoutContainer:
            LayoutGap: =24
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowY: =LayoutOverflow.Scroll
            LayoutWrap: =true
            PaddingBottom: =40
            PaddingLeft: =40
            PaddingRight: =40
            PaddingTop: =10
            ZIndex: =2

            c_AppDetailsTop_3 As groupContainer.manualLayoutContainer:
                AlignInContainer: =AlignInContainer.Start
                Height: =eleAppDetailsTop_3.Height
                LayoutMinHeight: =100
                LayoutMinWidth: |-
                    =(App.DesignWidth-Parent.PaddingLeft-Parent.PaddingRight-Parent.LayoutGap*2)/3-200
                    /*
                    Min(
                        Parent.Width-Parent.PaddingLeft-Parent.PaddingRight-Parent.LayoutGap*2,
                        Max(
                            (App.DesignWidth-Parent.PaddingLeft-Parent.PaddingRight-Parent.LayoutGap*2)/3,
                            (Parent.Width-Parent.PaddingLeft-Parent.PaddingRight-Parent.LayoutGap*2)/3
                        )
                    )-10
                    */
                ZIndex: =1

                "eleAppDetailsTop_3 As 'Fluent Elevation (1.0.18)'":
                    DisplayMode: =DisplayMode.Edit
                    Height: =c_AppDetailsMain_3.Height-50
                    HoverDepth: ='PowerCAT.Elevation.HoverDepth'.Depth4
                    OnChange: =false
                    PaddingBottom: =Self.PaddingLeft
                    PaddingLeft: =8
                    PaddingRight: =Self.PaddingLeft
                    PaddingTop: =Self.PaddingLeft
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =1

                c_AppDetailsContent_3 As groupContainer.verticalAutoLayoutContainer:
                    Height: =eleAppDetailsTop_3.Height
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMode: =LayoutMode.Auto
                    Width: =Parent.Width-Self.X*2
                    X: =24
                    Y: =24
                    ZIndex: =2

                    c_AppTitle_3 As groupContainer.horizontalAutoLayoutContainer:
                        FillPortions: =0
                        Height: =150
                        LayoutGap: =10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =200
                        ZIndex: =1

                        imgAppDetailsIcon_3 As image:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            Fill: |-
                                =With(
                                    Match(
                                        LookUp(tenantApps, App = vSelectedAppN.App).'Icon Background Color',
                                        "rgba\((?<RedChannel>\d{1,3})\,\s(?<GreenChannel>\d{1,3})\,\s(?<BlueChannel>\d{1,3})\,\s(?<AlphaChannel>\d{1,3})\)"
                                    ),
                                    If(
                                        IsBlank(LookUp(tenantApps, App = vSelectedAppN.App).'Icon Background Color'),
                                        ColorValue(AppTheme.palette.themePrimary),
                                        RGBA(Value(RedChannel),Value(GreenChannel),Value(BlueChannel),Value(AlphaChannel))
                                    )
                                )
                            FocusedBorderColor: =imgAppDetailsIcon_3.BorderColor
                            FocusedBorderThickness: =4
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverFill: =imgAppDetailsIcon_3.Fill
                            Image: =vSelectedAppN.'App Icon Uri'
                            OnSelect: =
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedFill: =imgAppDetailsIcon_3.Fill
                            Y: =10
                            ZIndex: =1

                        Container1_4 As groupContainer.verticalAutoLayoutContainer:
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingLeft: =12
                            ZIndex: =3

                            lblAppDetailsTitle_3 As label:
                                AlignInContainer: =AlignInContainer.Stretch
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =50
                                Size: =16
                                TabIndex: =0
                                Text: =vSelectedAppN.'App Display Name'
                                ZIndex: =1

                            Label2_3 As label:
                                AlignInContainer: =AlignInContainer.Stretch
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Size: =10.5
                                Text: =Coalesce(vSelectedAppN.'App Description',"No description")
                                ZIndex: =2

                    c_FormAppDetails_3 As groupContainer.verticalAutoLayoutContainer:
                        Height: =Parent.Height-Self.Y*2
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =8
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =c_AppDetailsContent_3.Width
                        X: =24
                        Y: =24
                        ZIndex: =2

                        lblUserSeperator_8 As rectangle:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            DisabledFill: =lblUserSeperator_8.Fill
                            Fill: =RGBA(230, 230, 230, 1)
                            FocusedBorderColor: =lblUserSeperator_8.BorderColor
                            Height: =1
                            HoverFill: =lblUserSeperator_8.Fill
                            OnSelect: =
                            PressedFill: =lblUserSeperator_8.Fill
                            Width: =Parent.Width
                            ZIndex: =3

                        galProperties_3 As gallery.variableTemplateHeightGallery:
                            BorderColor: =RGBA(166, 166, 166, 1)
                            Items: |-
                                =Table(
                                    {Key: "App Environment" , Value: Text(vSelectedAppN.'App Environment'.'Display Name')},
                                        {Key: "App Owner" , Value: Text(vSelectedAppN.'App Owner'.'Display Name')},
                                    {Key: "App Modified On" , Value: Text(vSelectedAppN.'App Modified On')},
                                    {Key: "App Published" , Value: Text(vSelectedAppN.'App Published')},
                                    {Key: "App Type" , Value: Text(vSelectedAppN.'App Type')}
                                )
                            Layout: =Layout.Vertical
                            LayoutMinHeight: =287
                            LayoutMinWidth: =320
                            TemplatePadding: =4
                            TemplateSize: =40
                            X: =40
                            Y: =40
                            ZIndex: =4

                            lblPropertyKey_3 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                OnSelect: =Select(Parent)
                                Size: =10.5
                                TabIndex: =0
                                Text: =ThisItem.Key
                                Width: =170
                                ZIndex: =1

                            lblPropertyValue_3 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                OnSelect: =Select(Parent)
                                Size: =10.5
                                TabIndex: =0
                                Text: =ThisItem.Value
                                Width: =Parent.TemplateWidth-Self.X
                                X: =lblPropertyKey_3.X + lblPropertyKey_3.Width
                                ZIndex: =2

                            lblUserSeperator_9 As rectangle:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                DisabledFill: =lblUserSeperator_9.Fill
                                Fill: =RGBA(230, 230, 230, 1)
                                FocusedBorderColor: =lblUserSeperator_9.BorderColor
                                Height: =1
                                HoverFill: =lblUserSeperator_9.Fill
                                OnSelect: =
                                PressedFill: =lblUserSeperator_9.Fill
                                Visible: =false
                                Width: =Parent.TemplateWidth
                                Y: =39
                                ZIndex: =3

            c_AppSupportDetails_3 As groupContainer.manualLayoutContainer:
                LayoutMinHeight: =eleAppSupportDetails_3.Height
                LayoutMinWidth: =c_AppDetailsTop_3.LayoutMinWidth
                Width: =c_AppDetailsTop_3.LayoutMinWidth
                ZIndex: =2

                "eleAppSupportDetails_3 As 'Fluent Elevation (1.0.18)'":
                    DisplayMode: =DisplayMode.Edit
                    Height: =c_AppDetailsMain_3.Height-50
                    HoverDepth: ='PowerCAT.Elevation.HoverDepth'.Depth4
                    OnChange: =false
                    PaddingBottom: =Self.PaddingLeft
                    PaddingLeft: =8
                    PaddingRight: =Self.PaddingLeft
                    PaddingTop: =Self.PaddingLeft
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =1

                c_FormAppSupportDetails_3 As groupContainer.verticalAutoLayoutContainer:
                    Height: =Parent.Height
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =24
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =10
                    PaddingRight: =10
                    Width: =c_AppDetailsContent_3.Width
                    X: =24
                    Y: =24
                    ZIndex: =2

                    c_AppConnections As groupContainer.verticalAutoLayoutContainer:
                        Height: =lblAppConnections.Height+dlConnections.Height*dlConnections.Visible+Self.LayoutGap
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =8
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =200
                        ZIndex: =5

                        lblAppConnections As Label:
                            AlignInContainer: =AlignInContainer.Stretch
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =12
                            FontWeight: =FontWeight.Semibold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            Text: ="Connections"
                            TextRole: ='Microsoft.CoreControls.Label.TextRole'.Heading2
                            Width: =150
                            X: =41
                            Y: =652
                            ZIndex: =1

                        "dlConnections As 'Fluent Details List (1.0.18)'.pcfdataset":
                            AlignInContainer: =AlignInContainer.Stretch
                            columns_Items: |-
                                =Table(
                                     {
                                        ColName: "Picture",
                                        ColDisplayName: "",
                                        ColCellType:"image",
                                        ColWidth: 40,
                                        ColImageWidth: 30,
                                        ColImagePadding: 0,
                                        ColVerticalAlign: "Top"
                                },
                                    {
                                        ColName: "Name",
                                        ColDisplayName: "Name",
                                        ColWidth: 200,
                                        ColSortable: true,
                                        ColIsBold: false,
                                        ColResizable: true
                                    })
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =1
                            HeaderVisible: =false
                            Height: =200
                            Items: =appConnectionCollection
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.None
                            Width: =200
                            X: =0
                            Y: =0
                            ZIndex: =2

                            Name3 As pcfDataField.textualColumn:
                                FieldDisplayName: ="Name"
                                FieldName: ="Name"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =1
                                ZIndex: =12

                            Picture1 As pcfDataField.textualColumn:
                                FieldDisplayName: ="Picture"
                                FieldName: ="Picture"
                                FieldType: ="h"
                                FieldVariantName: ="textualColumn"
                                Order: =2
                                ZIndex: =13

            c_AppDetailsForm_3 As groupContainer.manualLayoutContainer:
                AlignInContainer: =AlignInContainer.Start
                Height: =eleAppDetailsForm_3.Height
                LayoutMinHeight: =540
                LayoutMinWidth: =c_AppDetailsTop_3.LayoutMinWidth
                Width: =c_AppDetailsTop_3.LayoutMinWidth
                ZIndex: =3

                "eleAppDetailsForm_3 As 'Fluent Elevation (1.0.18)'":
                    DisplayMode: =DisplayMode.Edit
                    Height: =c_AppDetailsMain_3.Height-50
                    HoverDepth: ='PowerCAT.Elevation.HoverDepth'.Depth4
                    OnChange: =false
                    PaddingBottom: =Self.PaddingLeft
                    PaddingLeft: =8
                    PaddingRight: =Self.PaddingLeft
                    PaddingTop: =Self.PaddingLeft
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =1

                c_FormAppSupportDetails_4 As groupContainer.verticalAutoLayoutContainer:
                    Height: =Parent.Height
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =24
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =10
                    PaddingRight: =10
                    Width: =c_AppDetailsContent_3.Width
                    X: =24
                    Y: =24
                    ZIndex: =2

                    c_AppConnections_1 As groupContainer.verticalAutoLayoutContainer:
                        Height: =lblAppConnections_1.Height+galFeedback.Height+Self.LayoutGap
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =8
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =200
                        ZIndex: =5

                        lblAppConnections_1 As Label:
                            AlignInContainer: =AlignInContainer.Stretch
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =12
                            FontWeight: =FontWeight.Semibold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            Text: ="Ratings and Reviews"
                            TextRole: ='Microsoft.CoreControls.Label.TextRole'.Heading2
                            Width: =150
                            X: =41
                            Y: =652
                            ZIndex: =1

                        galFeedback As gallery.galleryVertical:
                            BorderColor: =RGBA(166, 166, 166, 1)
                            Items: =appReview
                            Layout: =Layout.Vertical
                            LayoutMinHeight: =50
                            LayoutMinWidth: =320
                            TemplateSize: =If(Self.Layout = Layout.Horizontal, Min(150, Self.Width - 60), Min(100, Self.Height - 60))
                            ZIndex: =2

                            Container6 As groupContainer.verticalAutoLayoutContainer:
                                Height: =100
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMode: =LayoutMode.Auto
                                Width: =345
                                ZIndex: =3

                                appRating As rating:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Default: =ThisItem.Rating
                                    DisabledBorderColor: =RGBA(159, 167, 165, 1)
                                    DisabledFill: =Self.Fill
                                    DisplayMode: =DisplayMode.View
                                    Fill: =RGBA(0, 0, 0, 0)
                                    FocusedBorderColor: =Self.BorderColor
                                    FocusedBorderThickness: =4
                                    Height: =20
                                    HoverFill: =Self.Fill
                                    LayoutMinHeight: =40
                                    LayoutMinWidth: =200
                                    Max: =5
                                    OnSelect: =
                                    PressedFill: =Self.Fill
                                    RatingFill: =ColorValue(AppTheme.palette.themePrimary)
                                    Width: =200
                                    X: =0
                                    Y: =0
                                    ZIndex: =1

                                lblFeedback As label:
                                    Align: =Align.Justify
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(51, 51, 51, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(166, 166, 166, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    Height: =120
                                    OnSelect: =
                                    PaddingLeft: =12
                                    PaddingTop: =10
                                    Size: =10.5
                                    Text: =ThisItem.Feedback
                                    Width: =galFeedback.Width - galFeedback.Y
                                    Y: =52
                                    ZIndex: =2

    c_feedback As groupContainer.verticalAutoLayoutContainer:
        Height: =pnlEmailFeedback.ContentHeight
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =10
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =10
        PaddingLeft: =10
        PaddingRight: =10
        PaddingTop: =10
        Visible: =reviewUsers
        Width: =pnlEmailFeedback.ContentWidth
        X: =pnlEmailFeedback.ContentX
        Y: =pnlEmailFeedback.ContentY
        ZIndex: =4

        lblSubmitFeedback As label:
            AlignInContainer: =AlignInContainer.Stretch
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =10.5
            Text: ="Rate the " & vSelectedAppN.'App Display Name' & " app"
            ZIndex: =1

        appSubmitRating As rating:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Default: =3
            DisabledBorderColor: =RGBA(159, 167, 165, 1)
            DisabledFill: =Self.Fill
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =Self.BorderColor
            FocusedBorderThickness: =4
            Height: =30
            HoverFill: =Self.Fill
            LayoutMinHeight: =40
            LayoutMinWidth: =200
            PressedFill: =Self.Fill
            RatingFill: =ColorValue(AppTheme.palette.themePrimary)
            Width: =200
            X: =0
            Y: =0
            ZIndex: =2

        txtFeedback As text:
            AlignInContainer: =AlignInContainer.Stretch
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            Default: =""
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            FillPortions: =1
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            HintText: ="Share feedback about this app"
            HoverBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            Mode: =TextMode.MultiLine
            PressedBorderColor: =RGBA(135, 100, 184, 1)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10.5
            ZIndex: =3

    c_contactmaker As groupContainer.verticalAutoLayoutContainer:
        Height: =pnlEmailFeedback.ContentHeight
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =10
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =10
        PaddingLeft: =10
        PaddingRight: =10
        PaddingTop: =10
        Visible: =emailUsers
        Width: =pnlEmailFeedback.ContentWidth
        X: =pnlEmailFeedback.ContentX
        Y: =pnlEmailFeedback.ContentY
        ZIndex: =5

        lblContactMaker As label:
            AlignInContainer: =AlignInContainer.Stretch
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =10.5
            Text: ="Contact " & vSelectedAppN.'App Owner'.'Display Name'
            ZIndex: =1

        txtEmailSubject As text:
            AlignInContainer: =AlignInContainer.Stretch
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            Default: =""
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            HintText: ="eMail Subject"
            HoverBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            PressedBorderColor: =RGBA(135, 100, 184, 1)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10.5
            ZIndex: =2

        RichTextEditor3 As richTextEditor:
            AlignInContainer: =AlignInContainer.Stretch
            BorderColor: =RGBA(166, 166, 166, 1)
            Default: =""
            FillPortions: =1
            LayoutMinWidth: =200
            Size: =10.5
            ZIndex: =3

