"scr_Policies As screen.'tabletAutoLayout_HeaderMainFooter_ver1.0'":
    LoadingSpinnerColor: =RGBA(105, 121, 126, 1)
    OnVisible: =

    c_screen_1 As groupContainer.verticalAutoLayoutContainer:
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =App.Width
        ZIndex: =1

        HeaderContainer2_3 As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Fill: =RGBA(52, 60, 63, 1)
            FillPortions: =0
            Height: =50
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            Visible: =Text(Param("hideNavBar")) = "true"
            ZIndex: =2

            lbl_mainheader_1 As label:
                AlignInContainer: =AlignInContainer.Stretch
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(255, 255, 255, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(68, 68, 68, 1)
                FillPortions: =1
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                PaddingLeft: =20
                Text: ="Power Platform Resource Request Management System | Admin"
                ZIndex: =1

        MainSectionContainer2_3 As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            ZIndex: =3

            Navigation_4 As Navigation:
                AlignInContainer: =AlignInContainer.Stretch
                Items: =col_nav
                ItemsBottom: =col_navBtm
                LayoutMinHeight: =600
                LayoutMinWidth: =640
                Width: =If(Navigation_4.IsExpanded, 200, 60)

            c_mainContent_1 As groupContainer.verticalAutoLayoutContainer:
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =3

                Container5_5 As groupContainer.horizontalAutoLayoutContainer:
                    Fill: =RGBA(243, 242, 241, 1)
                    FillPortions: =0
                    Height: =50
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =30
                    ZIndex: =2

                    c_action_refresh_2 As groupContainer.manualLayoutContainer:
                        FillPortions: =0
                        LayoutMinHeight: =50
                        LayoutMinWidth: =250
                        Width: =105
                        ZIndex: =1

                        lbl_act_refreshPolicies As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =50
                            PaddingLeft: =10
                            Size: =12
                            Text: ="Refresh"
                            Width: =Parent.Width - Self.X
                            X: =icn_refresh_5.X + icn_refresh_5.Width
                            ZIndex: =1

                        icn_refresh_5 As icon.Reload:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Color: =var_powerappspurple
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(220, 220, 220, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            DisplayMode: =DisplayMode.View
                            FocusedBorderThickness: =0
                            Height: =50
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =Self.Fill
                            HoverFill: =RGBA(0, 0, 0, 0)
                            Icon: =Icon.Reload
                            OnSelect: =
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Width: =16
                            X: =10
                            ZIndex: =2

                        btn_refresh_2 As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderThickness: =0
                            Color: =RGBA(0, 0, 0, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            Fill: =RGBA(0,0,0,0)
                            FocusedBorderColor: =Self.Fill
                            FocusedBorderThickness: =0
                            Font: =Font.'Segoe UI'
                            Height: =Parent.Height
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(0, 0, 0, 0.1)
                            OnSelect: |-
                                =UpdateContext({ var_pagesize : 1000, var_loading: true });
                                Refresh('Environment Creation Requests');
                                Concurrent(
                                    /* Get policies */
                                    ClearCollect(col_allPolicies, AddColumns(Filter(PowerPlatformforAdmins.ListPoliciesV2().value, environmentType<>"SingleEnvironment"), 
                                        "blocked", LookUp(connectorGroups, classification="Blocked").connectors, 
                                        "general", LookUp(connectorGroups, classification="General").connectors, 
                                        "confidential", LookUp(connectorGroups, classification="Confidential").connectors
                                        )    
                                    );
                                    ClearCollect(col_allPolicieswithConflicts, Filter( col_allPolicies, !IsEmpty(general) && !IsEmpty(confidential)));
                                    ClearCollect(col_allNonIncludePolicies, Filter(col_allPolicies, environmentType <> "OnlyEnvironments"));
                                    ,
                                
                                    /* Get standard connectors */
                                    ClearCollect(col_connectors, PowerAppsforMakers.GetConnectors({ '$filter':"environment eq '"& First(col_allEnvironments).name &"'", '$top':1000 }).value);
                                    ,
                                    /* Get Environment regions*/
                                    ClearCollect( col_regions, 
                                        AddColumns(PowerPlatformforAdmins.ListSupportedLocations().value,
                                        "DisplayName",properties.displayName & If(properties.isDefault," (default)"))
                                    );
                                    /* Get all currencies and languages from the first Environment */
                                    Concurrent(
                                        ClearCollect(col_currencies, 
                                        {name:""},AddColumns(PowerPlatformforAdmins.ListEnvironmentCurrencies(First(col_regions).name).value,"DisplayName",properties.localizedName))
                                        ,
                                        ClearCollect(col_languages, 
                                        {name:""},AddColumns(PowerPlatformforAdmins.ListEnvironmentLanguages(First(col_regions).name).value,"DisplayName",properties.displayName))
                                    );
                                    ,
                                
                                    /* Get entire existing makers table */
                                    ClearCollect(col_allmakers, Makers);
                                    ,
                                
                                    Set( var_myProfile, Office365Users.MyProfileV2() );
                                    Set( var_myUserRecord, LookUp(Users, 'Azure AD Object ID' = GUID(var_myProfile.id)) );
                                    ,
                                    ClearCollect(col_pendingECRs, Filter('Environment Creation Requests', 'Environment Creation Requests (Views)'.'Requests for New Environments'));
                                    Patch( col_nav, First(col_nav), { Notifications: CountRows(col_pendingECRs) });
                                    ,
                                    Set( var_today, Today());
                                    ,
                                    /* Call the	ListGroups operation and save response to a variable */
                                    Set( var_response, Office365Groups.ListGroups({'$filter':"securityEnabled eq true or groupTypes/any(s:s eq 'Unified')",'$top':500 }) );
                                
                                    /* Parse the $skipToken value from the @odata.nextLink value in the response */
                                    Set( var_nextLink, Last(ForAll(Split( var_response.'@odata.nextLink', "="), {Result: ThisRecord.Value})).Result );
                                
                                    /* Save the response into a collection */
                                    ClearCollect( col_groups, var_response.value );
                                    ,
                                    ClearCollect( col_coeStandardConnectors, 'PowerApps Connectors');
                                    ,
                                
                                    ClearCollect( col_sharedPolicies, LookUp( 'DLP Policies', 'Is Shared' = 'Is Shared (DLP Policies)'.Yes ));
                                );
                                
                                UpdateContext({ var_loading: false });
                            PaddingLeft: =10
                            PressedBorderColor: =ColorFade(Self.BorderColor, 0%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =ColorFade(Self.Fill, -20%)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: =""
                            Width: =Parent.Width
                            ZIndex: =3

                    c_action_sync As groupContainer.manualLayoutContainer:
                        FillPortions: =0
                        LayoutMinHeight: =50
                        LayoutMinWidth: =250
                        Visible: =!(gal_allPolicies.Selected.name in Filter('DLP Policies', 'Is Shared' = 'Is Shared (DLP Policies)'.Yes).'Policy Id') && !IsBlank(gal_allPolicies)
                        Width: =135
                        ZIndex: =2

                        Image3_4 As image:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            FocusedBorderThickness: =4
                            Height: =50
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverFill: =RGBA(0, 0, 0, 0)
                            Image: |-
                                ="data:image/svg+xml;utf8, " & EncodeUrl("
                                <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2048 2048'>
                                  <path d='M2048 128v1024h-128V640H128v1152h896v128H0V128h384V0h128v128h1024V0h128v128h384zm-128 384V256h-256v128h-128V256H512v128H384V256H128v256h1792zm19 851l90 90-557 558-269-270 90-90 179 178 467-466z' fill='#742774' /></svg>")
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Width: =16
                            X: =12
                            ZIndex: =1

                        lbl_act_showPolicy As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =50
                            PaddingLeft: =10
                            Size: =12
                            Text: ="Make visible"
                            Width: =Parent.Width - Self.X
                            X: =28
                            ZIndex: =2

                        btn_newecr_8 As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderThickness: =0
                            Color: =RGBA(0, 0, 0, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            Fill: =RGBA(0,0,0,0)
                            FocusedBorderColor: =Self.Fill
                            FocusedBorderThickness: =0
                            Font: =Font.'Segoe UI'
                            Height: =Parent.Height
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(0, 0, 0, 0.1)
                            OnSelect: |
                                =UpdateContext({var_loading: true});
                                UpdateContext(
                                    {
                                        var_selectedPolicy: Coalesce(
                                            LookUp(
                                                'DLP Policies',
                                                'Policy Id' = (gal_allPolicies.Selected.name)
                                            ),
                                            Defaults('DLP Policies')
                                        )
                                    }
                                );
                                Patch(
                                    'DLP Policies',
                                    var_selectedPolicy,
                                    {
                                        'Policy Id': gal_allPolicies.Selected.name,
                                        Name: gal_allPolicies.Selected.displayName,
                                        'Is Shared': 'Is Shared (DLP Policies)'.Yes
                                    }
                                );
                                
                                ClearCollect(col_blockedConnectors, LookUp(gal_allPolicies.Selected.connectorGroups, classification="Blocked").connectors);
                                ClearCollect( col_blockedPowerAppsConnectors, Filter( 'PowerApps Connectors', Name in col_blockedConnectors.name ));
                                ForAll(col_blockedPowerAppsConnectors, Relate(var_selectedPolicy.'PowerApps Connectors (admin_blocked_policy_connectors)', ThisRecord));
                                
                                Select( btn_details_1 );
                                
                                UpdateContext({var_loading: false});
                            PaddingLeft: =10
                            PressedBorderColor: =ColorFade(Self.BorderColor, 0%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =ColorFade(Self.Fill, -20%)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: =""
                            Width: =Parent.Width
                            ZIndex: =4

                    c_action_hide As groupContainer.manualLayoutContainer:
                        FillPortions: =0
                        LayoutMinHeight: =50
                        LayoutMinWidth: =250
                        Visible: =gal_allPolicies.Selected.name in Filter('DLP Policies', 'Is Shared' = 'Is Shared (DLP Policies)'.Yes).'Policy Id'
                        Width: =80
                        ZIndex: =3

                        lbl_btn_hide As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =50
                            PaddingLeft: =10
                            Size: =12
                            Text: ="Hide"
                            Width: =Parent.Width - Self.X
                            X: =icn_refresh_7.X + icn_refresh_7.Width
                            ZIndex: =1

                        icn_refresh_7 As icon.Reload:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Color: =var_powerappspurple
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(220, 220, 220, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            DisplayMode: =DisplayMode.View
                            FocusedBorderThickness: =0
                            Height: =50
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =Self.Fill
                            HoverFill: =RGBA(0, 0, 0, 0)
                            Icon: =Icon.Hide
                            OnSelect: =
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Width: =16
                            X: =10
                            ZIndex: =2

                        btn_refresh_4 As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderThickness: =0
                            Color: =RGBA(0, 0, 0, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            Fill: =RGBA(0,0,0,0)
                            FocusedBorderColor: =Self.Fill
                            FocusedBorderThickness: =0
                            Font: =Font.'Segoe UI'
                            Height: =Parent.Height
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(0, 0, 0, 0.1)
                            OnSelect: |
                                =UpdateContext({var_loading: true});
                                UpdateContext(
                                    {
                                        var_selectedPolicy: Coalesce(
                                            LookUp(
                                                'DLP Policies',
                                                'Policy Id' = (gal_allPolicies.Selected.name)
                                            ),
                                            Defaults('DLP Policies')
                                        )
                                    }
                                );
                                Patch(
                                    'DLP Policies',
                                    var_selectedPolicy,
                                    {
                                        'Policy Id': gal_allPolicies.Selected.name,
                                        Name: gal_allPolicies.Selected.displayName,
                                        'Is Shared': 'Is Shared (DLP Policies)'.No
                                    }
                                );
                                Refresh('DLP Policies');
                                UpdateContext({var_loading: false});
                            PaddingLeft: =10
                            PressedBorderColor: =ColorFade(Self.BorderColor, 0%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =ColorFade(Self.Fill, -20%)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: =""
                            Width: =Parent.Width
                            ZIndex: =3

                    c_action_details_1 As groupContainer.manualLayoutContainer:
                        FillPortions: =0
                        LayoutMinHeight: =50
                        LayoutMinWidth: =250
                        Visible: =gal_allPolicies.Selected.name in 'DLP Policies'.'Policy Id'
                        Width: =90
                        ZIndex: =5

                        lbl_btn_details_1 As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =50
                            PaddingRight: =0
                            Size: =12
                            Text: ="Details"
                            Width: =Parent.Width - Self.X
                            X: =28
                            ZIndex: =1

                        img_details_1 As image:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            FocusedBorderThickness: =4
                            Height: =50
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverFill: =RGBA(0, 0, 0, 0)
                            Image: |-
                                ="data:image/svg+xml;utf8, " & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2048 2048'>
                                  <path d='M960 1920q-133 0-255-34t-230-96-194-150-150-195-97-229T0 960q0-133 34-255t96-230 150-194 195-150 229-97T960 0q133 0 255 34t230 96 194 150 150 195 97 229 34 256q0 133-34 255t-96 230-150 194-195 150-229 97-256 34zm0-1792q-115 0-221 30t-198 84-169 130-130 168-84 199-30 221q0 114 30 220t84 199 130 169 168 130 199 84 221 30q114 0 220-30t199-84 169-130 130-168 84-199 30-221q0-114-30-220t-84-199-130-169-168-130-199-84-221-30zm-64 640h128v640H896V768zm0-256h128v128H896V512z' fill='#742774' />
                                </svg>")
                            PaddingLeft: =5
                            PaddingRight: =5
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Width: =28
                            X: =5
                            ZIndex: =2

                        btn_details_1 As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderThickness: =0
                            Color: =RGBA(0, 0, 0, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            Fill: =RGBA(0,0,0,0)
                            FocusedBorderColor: =Self.Fill
                            FocusedBorderThickness: =0
                            Font: =Font.'Segoe UI'
                            Height: =Parent.Height
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(0, 0, 0, 0.1)
                            OnSelect: |-
                                =UpdateContext({var_selectedPolicy:LookUp('DLP Policies','Policy Id'=(gal_allPolicies.Selected.name))});
                                UpdateContext({var_showflyout: true });
                            PaddingLeft: =10
                            PressedBorderColor: =ColorFade(Self.BorderColor, 0%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =ColorFade(Self.Fill, -20%)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: =""
                            Width: =Parent.Width
                            ZIndex: =3

                    Container6_1 As groupContainer.horizontalAutoLayoutContainer:
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGap: =10
                        LayoutJustifyContent: =LayoutJustifyContent.End
                        LayoutMinHeight: =30
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =6

                        c_action_launchppac_2 As groupContainer.manualLayoutContainer:
                            FillPortions: =0
                            LayoutMinHeight: =50
                            LayoutMinWidth: =250
                            Width: =280
                            ZIndex: =1

                            lbl_launchppac_2 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =50
                                PaddingRight: =0
                                Size: =12
                                Text: ="Edit policies in the admin center"
                                Width: =Parent.Width - Self.X
                                X: =28
                                ZIndex: =1

                            img_launchppac_1 As image:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                FocusedBorderThickness: =4
                                Height: =50
                                HoverBorderColor: =RGBA(0, 0, 0, 0)
                                HoverFill: =RGBA(0, 0, 0, 0)
                                Image: |-
                                    ="data:image/svg+xml;utf8, " & EncodeUrl("<svg width='16' height='16' viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' fill='currentColor'>
                                      <path d='M1.5 1H6v1H2v12h12v-4h1v4.5l-.5.5h-13l-.5-.5v-13l.5-.5z' fill='#742774' />
                                      <path d='M15 1.5V8h-1V2.707L7.243 9.465l-.707-.708L13.293 2H8V1h6.5l.5.5z' fill='#742774' />
                                    </svg>")
                                PaddingLeft: =5
                                PaddingRight: =5
                                PressedBorderColor: =RGBA(0, 0, 0, 0)
                                PressedFill: =RGBA(0, 0, 0, 0)
                                Width: =28
                                X: =3
                                ZIndex: =2

                            btn_launchppac_2 As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderThickness: =0
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =Self.Fill
                                FocusedBorderThickness: =0
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height
                                HoverBorderColor: =RGBA(0, 0, 0, 0)
                                HoverColor: =RGBA(0, 0, 0, 1)
                                HoverFill: =RGBA(0, 0, 0, 0.1)
                                OnSelect: |-
                                    =Launch("https://admin.powerplatform.microsoft.com/dlp")
                                PaddingLeft: =10
                                PressedBorderColor: =ColorFade(Self.BorderColor, 0%)
                                PressedColor: =RGBA(0, 0, 0, 1)
                                PressedFill: =ColorFade(Self.Fill, -20%)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Text: =""
                                Width: =Parent.Width
                                ZIndex: =3

                        Rectangle1 As rectangle:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Fill: =RGBA(230,230,230, 1)
                            FocusedBorderThickness: =4
                            LayoutMinHeight: =Parent.Height
                            Width: =1
                            ZIndex: =2

                        c_action_1 As groupContainer.manualLayoutContainer:
                            Fill: =RGBA(253, 253, 253, 0)
                            FillPortions: =0
                            LayoutMinHeight: =50
                            LayoutMinWidth: =250
                            Width: =200
                            ZIndex: =3

                            tin_searchRequests_1 As text:
                                BorderColor: =RGBA(166, 166, 166, 1)
                                BorderThickness: =0
                                Color: =RGBA(51, 51, 51, 1)
                                Default: =""
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                Fill: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =var_powerappspurple
                                FocusedBorderThickness: =1
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height
                                HintText: ="Search"
                                HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(105, 121, 126, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Width: =Parent.Width - Self.X
                                X: =32
                                ZIndex: =1

                            icn_searchPolicies As icon.Search:
                                BorderColor: =RGBA(166, 166, 166, 1)
                                Color: =var_powerappspurple
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(220, 220, 220, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                FocusedBorderThickness: =4
                                Height: =50
                                HoverBorderColor: =RGBA(0, 0, 0, 0)
                                HoverColor: =Self.Color
                                HoverFill: =RGBA(0, 0, 0, 0)
                                Icon: =Icon.Search
                                PaddingBottom: =10
                                PaddingLeft: =5
                                PaddingRight: =5
                                PaddingTop: =10
                                PressedBorderColor: =RGBA(0, 0, 0, 0)
                                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                                PressedFill: =RGBA(0, 0, 0, 0)
                                Rotation: =90
                                Width: =32
                                ZIndex: =2

                Container10_5 As groupContainer.horizontalAutoLayoutContainer:
                    FillPortions: =0
                    Height: =60
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingTop: =10
                    ZIndex: =4

                    Label6_1 As label:
                        AlignInContainer: =AlignInContainer.End
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(50, 49, 48, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FillPortions: =1
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        PaddingLeft: =40
                        Size: =16
                        Text: ="Data policies"
                        VerticalAlign: =VerticalAlign.Top
                        ZIndex: =2

                Label15_2 As label:
                    AlignInContainer: =AlignInContainer.Stretch
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(50, 49, 48, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    PaddingLeft: =40
                    Size: =10
                    Text: ="Select a data policy and make it visible by selecting the 'Make visible' action in the ribbon. Then open the details and provide a description of its purpose."
                    Visible: =var_loading <> true
                    ZIndex: =5

                Container23_1 As groupContainer.verticalAutoLayoutContainer:
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =20
                    PaddingRight: =20
                    Visible: =var_loading <> true
                    ZIndex: =6

                    Container8_1 As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: =50
                        LayoutAlignItems: =LayoutAlignItems.End
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =20
                        ZIndex: =1

                        img_checkmark_3 As image:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            FocusedBorderThickness: =4
                            Height: =60
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverFill: =RGBA(0, 0, 0, 0)
                            Image: =""
                            LayoutMinHeight: =60
                            PaddingBottom: =20
                            PaddingTop: =20
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Width: =60
                            ZIndex: =1

                        btn_header_environment_1 As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(244, 244, 244, 1)
                            DisplayMode: =DisplayMode.View
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =3
                            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =ColorFade(Self.Fill, -0%)
                            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =Color.White
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: ="Name"
                            ZIndex: =3

                        btn_header_expiration_1 As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(244, 244, 244, 1)
                            DisplayMode: =DisplayMode.View
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =2
                            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =ColorFade(Self.Fill, -0%)
                            LayoutMinWidth: =200
                            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =Color.White
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: ="Applied to"
                            Width: =140
                            ZIndex: =4

                        Button2_4 As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(244, 244, 244, 1)
                            DisplayMode: =DisplayMode.View
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =Self.Fill
                            PaddingLeft: =0
                            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =Color.White
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: ="Created by"
                            Width: =200
                            ZIndex: =5

                        btn_h_visible As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(244, 244, 244, 1)
                            DisplayMode: =DisplayMode.View
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =Self.Fill
                            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =Color.White
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: ="Visible to Makers"
                            Width: =200
                            ZIndex: =6

                    gal_allPolicies As gallery.galleryVertical:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =0
                        Height: =525
                        Items: =Filter(col_allPolicies, environmentType <> "AllEnvironments")
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =287
                        LayoutMinWidth: =320
                        OnSelect: =
                        TabIndex: =1
                        TemplateFill: =If(ThisItem.IsSelected, RGBA(250,250,250,1), RGBA(0,0,0,0))
                        TemplatePadding: =0
                        TemplateSize: =If(Self.Layout = Layout.Horizontal, Min(60, Self.Width - 60), Min(60, Self.Height - 60))
                        Width: =1273
                        X: =16
                        Y: =57
                        ZIndex: =2

                        Container9_1 As groupContainer.horizontalAutoLayoutContainer:
                            Height: =60
                            LayoutAlignItems: =LayoutAlignItems.Stretch
                            LayoutMode: =LayoutMode.Auto
                            PaddingLeft: =20
                            Width: =Parent.Width
                            ZIndex: =1

                            img_checkmark_4 As image:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                FocusedBorderThickness: =4
                                Height: =60
                                HoverBorderColor: =RGBA(0, 0, 0, 0)
                                HoverFill: =RGBA(0, 0, 0, 0)
                                Image: |-
                                    =If(ThisItem.IsSelected, "data:image/svg+xml;utf8, " & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2048 2048'>
                                      <path d='M1024 0q141 0 272 36t244 104 207 160 161 207 103 245 37 272q0 141-36 272t-104 244-160 207-207 161-245 103-272 37q-141 0-272-36t-244-104-207-160-161-207-103-245-37-272q0-141 36-272t104-244 160-207 207-161T752 37t272-37zM832 1480l795-795-136-136-659 659-275-275-136 136 411 411z' fill='#742774' stroke-width='4' stroke='#fff'/>
                                    </svg>"))
                                LayoutMinHeight: =60
                                PaddingBottom: =23
                                PaddingTop: =23
                                PressedBorderColor: =RGBA(0, 0, 0, 0)
                                PressedFill: =RGBA(0, 0, 0, 0)
                                Width: =60
                                ZIndex: =1

                            Label8_5 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                LayoutMinWidth: =btn_header_environment_1.Width
                                Size: =11
                                Text: =ThisItem.displayName
                                Width: =btn_header_environment_1.Width
                                Wrap: =false
                                ZIndex: =3

                            Label8_6 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FillPortions: =1
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Size: =11
                                Text: |-
                                    =Switch(ThisItem.environmentType, 
                                    "OnlyEnvironments", If(CountRows(ThisItem.environments) > 1, CountRows(ThisItem.environments) & " environments", LookUp(col_allEnvironments, name = First(ThisItem.environments).name).properties.displayName),
                                    "ExceptEnvironments", "All environments except " & CountRows(ThisItem.environments)
                                    )
                                Width: =btn_header_expiration_1.Width
                                Wrap: =false
                                ZIndex: =4

                            Label8_13 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Size: =11
                                Text: =ThisItem.createdBy.displayName
                                Width: =Button2_4.Width
                                Wrap: =false
                                ZIndex: =5

                            lbl_visible As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =Color.Purple
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                PaddingLeft: =60
                                Size: =11
                                Text: =If(ThisItem.name in Filter('DLP Policies', 'Is Shared' = 'Is Shared (DLP Policies)'.Yes).'Policy Id', "✔", "")
                                Width: =btn_h_visible.Width
                                Wrap: =false
                                ZIndex: =6

                        btn_viewRequest_1 As button:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =0
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(230, 230, 230, 0.1)
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.TemplateHeight
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(255, 255, 255, 1)
                            HoverFill: =ColorFade(RGBA(105, 121, 126, 0.1), -10%)
                            OnSelect: =
                            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 0), -50%)
                            PressedColor: =RGBA(255, 255, 255, 1)
                            PressedFill: =ColorFade(RGBA(105, 121, 126, 0.05 ), -30%)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =15
                            Text: =""
                            Width: =53
                            ZIndex: =2

                        Rectangle2_22 As rectangle:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Fill: =RGBA(230, 230, 230, 1)
                            FocusedBorderThickness: =4
                            Height: =1
                            Width: =Parent.TemplateWidth
                            ZIndex: =3

                    Rectangle2_1 As rectangle:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        DisabledFill: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(204, 204, 204, 1)
                        FocusedBorderThickness: =4
                        Height: =1
                        ZIndex: =3

    btn_getNextPageENV_1 As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(105, 121, 126, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =25
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
        OnSelect: |-
            =/* assumes first page has already been retrieved */
            If( !IsBlank(var_getEnvResponse),
                /* isolate skiptoken */
                ClearCollect( col_tempnextlink, ForAll(Split(var_getEnvResponse.nextLink,"&%24"), {Result: ThisRecord.Value}).Result );
                ClearCollect( col_tempnextlink, LookUp(col_tempnextlink, "skiptoken=" in Result) );
                UpdateContext({ var_skiptoken : Substitute(First(col_tempnextlink).Result, "skiptoken=","") });
            
                /* use skiptoken to get next page */
                UpdateContext({ var_getEnvResponse : PowerPlatformforAdmins.GetAdminEnvironment({ '$top':var_pagesize, '$skiptoken': var_skiptoken }) });
                Collect( col_allEnvironments, var_getEnvResponse.value );
            )
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =15
        Text: ="Recurse"
        Visible: =false
        Width: =103
        X: =1263
        Y: =743
        ZIndex: =2

    Container21_1 As groupContainer.horizontalAutoLayoutContainer:
        BorderColor: =RGBA(0, 0, 0, 0)
        Fill: =RGBA(255, 255, 255, 0.5)
        Height: =Parent.Height
        LayoutJustifyContent: =LayoutJustifyContent.End
        LayoutMode: =LayoutMode.Auto
        Visible: =var_showflyout
        Width: =Parent.Width
        ZIndex: =3

        Rectangle3_1 As rectangle:
            AlignInContainer: =AlignInContainer.Stretch
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(230, 230, 230, 1)
            FocusedBorderThickness: =4
            Width: =1
            ZIndex: =1

        Container22_1 As groupContainer.verticalAutoLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            FillPortions: =0
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            ZIndex: =2

            Container25_1 As groupContainer.horizontalAutoLayoutContainer:
                FillPortions: =0
                Height: =60
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingRight: =10
                PaddingTop: =5
                ZIndex: =1

                Label22_1 As label:
                    AlignInContainer: =AlignInContainer.Stretch
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FillPortions: =1
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    PaddingBottom: =10
                    PaddingLeft: =25
                    PaddingTop: =20
                    Size: =16
                    Text: =gal_allPolicies.Selected.displayName
                    ZIndex: =1

                icn_exitFlyout_1 As icon.Cancel:
                    BorderColor: =RGBA(166, 166, 166, 1)
                    Color: =RGBA(105, 121, 126, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(220, 220, 220, 1)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =4
                    Height: =30
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.Cancel
                    OnSelect: |-
                        =UpdateContext({var_showflyout: false })
                    PaddingLeft: =5
                    PaddingRight: =10
                    PaddingTop: =10
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    TabIndex: =3
                    Width: =30
                    ZIndex: =2

            c_policyForm As groupContainer.verticalAutoLayoutContainer:
                Height: =190
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =400
                LayoutMode: =LayoutMode.Auto
                ZIndex: =2

                form_policy As form:
                    AcceptsFocus: =false
                    BorderColor: =RGBA(166, 166, 166, 1)
                    DataSource: ='DLP Policies'
                    Height: =190
                    Item: =var_selectedPolicy
                    LayoutMinHeight: =250
                    LayoutMinWidth: =400
                    OnFailure: =Notify("Failed to update Policy.", NotificationType.Error)
                    OnSuccess: =Notify("Policy updated successfully", NotificationType.Success)
                    ZIndex: =1

                    Description_DataCard1 As typedDataCard.textualMultiLineEditCard:
                        BorderColor: =RGBA(166, 166, 166, 1)
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="admin_description"
                        Default: =ThisItem.Description
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: ="Description"
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height
                        Required: =false
                        Update: =DataCardValue3.Text
                        Width: =480
                        WidthFit: =true
                        X: =0
                        Y: =0
                        ZIndex: =1

                        DataCardKey3 As label:
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =34
                            PaddingLeft: =0
                            Size: =12
                            Text: =Parent.DisplayName
                            Width: =Parent.Width - 60
                            Wrap: =false
                            X: =30
                            Y: =10
                            ZIndex: =1

                        DataCardValue3 As text:
                            BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                            Color: =RGBA(51, 51, 51, 1)
                            Default: =Parent.Default
                            DelayOutput: =true
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(244, 244, 244, 1)
                            DisplayMode: =Parent.DisplayMode
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =Parent.Height / 2
                            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                            HoverColor: =RGBA(51, 51, 51, 1)
                            HoverFill: =RGBA(255, 255, 255, 1)
                            Mode: =TextMode.MultiLine
                            PaddingLeft: =10
                            PaddingRight: =10
                            PaddingTop: =10
                            PressedBorderColor: =RGBA(105, 121, 126, 1)
                            PressedColor: =RGBA(51, 51, 51, 1)
                            PressedFill: =RGBA(255, 255, 255, 1)
                            RadiusBottomLeft: =3
                            RadiusBottomRight: =3
                            RadiusTopLeft: =3
                            RadiusTopRight: =3
                            Size: =12
                            Tooltip: =Parent.DisplayName
                            Width: =Parent.Width - 60
                            X: =30
                            Y: =lbl_descriptionText.Y + lbl_descriptionText.Height + 5
                            ZIndex: =2

                        ErrorMessage2 As label:
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(168, 0, 0, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(168, 0, 0, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =10
                            Live: =Live.Assertive
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =13
                            Text: =Parent.Error
                            Visible: =Parent.DisplayMode=DisplayMode.Edit
                            Width: =Parent.Width - 60
                            X: =30
                            Y: =DataCardValue3.Y + DataCardValue3.Height
                            ZIndex: =3

                        StarVisible2 As label:
                            Align: =Align.Center
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =DataCardKey3.Height
                            PaddingLeft: =0
                            Size: =13
                            Text: ="*"
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            Wrap: =false
                            Y: =DataCardKey3.Y
                            ZIndex: =4

                        lbl_descriptionText As label:
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =27
                            PaddingBottom: =10
                            PaddingLeft: =30
                            PaddingRight: =20
                            Size: =11
                            Text: ="Provide a description about this policy that explains it's purpose and scope. It will be visible to makers in the 'Maker - Environment Request' application."
                            Visible: =var_loading <> true
                            Width: =500
                            Y: =41
                            ZIndex: =5

            c_sc_connectors As groupContainer.verticalAutoLayoutContainer:
                FillPortions: =0
                Height: =lbl_s_connectors.Height + lbl_descriptionText_1.Height + Search_1.Height
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                Visible: =false
                ZIndex: =3

                Search_1 As Search:
                    AlignInContainer: =AlignInContainer.Stretch
                    LayoutMinHeight: =640
                    LayoutMinWidth: =200

                lbl_s_connectors As label:
                    AlignInContainer: =AlignInContainer.Stretch
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =34
                    PaddingLeft: =30
                    Size: =12
                    Text: ="Connectors"
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                lbl_descriptionText_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(50, 49, 48, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =27
                    PaddingLeft: =30
                    Size: =12
                    Text: ="View the prebuilt connector classifications for this policy."
                    Visible: =var_loading <> true
                    Width: =500
                    Y: =31
                    ZIndex: =2

            gal_connectorPolicyImpact_1 As gallery.variableTemplateHeightGallery:
                AccessibleLabel: ="Policy Impact"
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                Height: =50
                Items: =gal_allPolicies.Selected.connectorGroups
                Layout: =Layout.Vertical
                LayoutMinHeight: =287
                LayoutMinWidth: =320
                TabIndex: =1
                TemplateFill: |-
                    =If( gal_policies.Selected.hasBlockedConnectors && ThisItem.classification = "Blocked", RGBA(255, 240,240,1),
                    If( gal_policies.Selected.hasConfidentialConnectors && gal_policies.Selected.hasGeneralConnectors && ThisItem.classification <> "Blocked", RGBA(250,250,220,1))
                    )
                TemplatePadding: =0
                TemplateSize: =200
                Visible: =false
                X: =20
                Y: =291
                ZIndex: =4

                Container3 As groupContainer.verticalAutoLayoutContainer:
                    Height: =gal_groupConnectors_1.Height
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =30
                    PaddingRight: =10
                    Y: =40
                    ZIndex: =5

                    gal_groupConnectors_1 As gallery.galleryVertical:
                        BorderColor: =RGBA(166, 166, 166, 1)
                        FillPortions: =0
                        Height: |-
                            =If(!IsEmpty(Self.AllItems) && ThisItem.IsSelected && var_expandCollapse, (Max((CountRows(Self.AllItems) / 8),2) * 40 )+15,0)
                            //If(!IsEmpty(Self.AllItems) && ThisItem.IsSelected && var_expandCollapse,Max((CountRows(Self.AllItems) / 6),1) * 50,0)
                        Items: |-
                            =If( !IsBlank(Search_1.SearchText),
                            	Filter(col_connectors, name in ThisItem.connectors.name && Search_1.SearchText in DataSourceInfo.DisplayName)
                                ,
                                Filter( col_connectors, id in ThisItem.connectors.id )
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =287
                        LayoutMinWidth: =320
                        ShowScrollbar: =false
                        TabIndex: =1
                        TemplatePadding: =0
                        TemplateSize: =40
                        Visible: =true //ThisItem.IsSelected && var_expand
                        Width: =Parent.Width
                        WrapCount: =8
                        Y: =40
                        ZIndex: =2

                        Image1_1 As image:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            FocusedBorderThickness: =4
                            Height: =Parent.TemplateHeight
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverFill: =RGBA(0, 0, 0, 0)
                            Image: =ThisItem.properties.iconUri
                            OnSelect: =Select(Parent)
                            PaddingBottom: =5
                            PaddingTop: =5
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Tooltip: =ThisItem.properties.displayName
                            Width: =40
                            ZIndex: =1

                c_connectorGroup As groupContainer.horizontalAutoLayoutContainer:
                    Height: =40
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =30
                    PaddingRight: =10
                    Width: =Parent.Width
                    ZIndex: =6

                    lbl_conectorGroup As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(36, 42, 44, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FillPortions: =1
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        OnSelect: =
                        PaddingLeft: =0
                        Size: =10
                        Text: =Proper(ThisItem.classification & " (" & CountRows(ThisItem.connectors) & ")")
                        ZIndex: =1

                    icn_connectorFlyoutImage_1 As icon.ChevronUp:
                        AccessibleLabel: ="Connector"
                        BorderColor: =RGBA(166, 166, 166, 1)
                        Color: =RGBA(105, 121, 126, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(220, 220, 220, 1)
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        FocusedBorderThickness: =4
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        Icon: =If(ThisItem.IsSelected && var_expand, Icon.ChevronUp, Icon.ChevronDown)
                        OnSelect: |-
                            =UpdateContext({ var_expand: !var_expand });
                        PaddingBottom: =10
                        PaddingTop: =10
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        TabIndex: =2
                        Visible: =false
                        X: =386
                        ZIndex: =2

                    icn_down As icon.ChevronDown:
                        AlignInContainer: =AlignInContainer.Stretch
                        BorderColor: =RGBA(166, 166, 166, 1)
                        Color: =RGBA(133, 138, 140, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(220, 220, 220, 1)
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        FocusedBorderThickness: =4
                        Height: =40
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        Icon: =If( ThisItem.IsSelected && var_expandCollapse = true, Icon.ChevronUp, Icon.ChevronDown)
                        LayoutMinHeight: =40
                        OnSelect: |-
                            =UpdateContext({ var_expandCollapse: !var_expandCollapse })
                        PaddingBottom: =10
                        PaddingTop: =10
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        ZIndex: =3

            Container10_6 As groupContainer.horizontalAutoLayoutContainer:
                FillPortions: =0
                Height: =60
                LayoutGap: =10
                LayoutJustifyContent: =LayoutJustifyContent.End
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingRight: =30
                PaddingTop: =5
                ZIndex: =5

                Button5_28 As button:
                    BorderColor: =RGBA(47, 54, 57, 1)
                    BorderThickness: =1
                    Color: =RGBA(0, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    HoverBorderColor: =RGBA(36, 42, 44, 1)
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =ColorFade(RGBA(105, 121, 126, 0.1), -10%)
                    OnSelect: |-
                        =UpdateContext({var_showflyout: false })
                    PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                    PressedColor: =RGBA(0, 0, 0, 1)
                    PressedFill: =ColorFade(RGBA(105, 121, 126, 0.01), -30%)
                    RadiusBottomLeft: =3
                    RadiusBottomRight: =3
                    RadiusTopLeft: =3
                    RadiusTopRight: =3
                    Size: =12
                    Text: ="Cancel"
                    Width: =100
                    ZIndex: =1

                btn_doneWithPolicies_1 As button:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderThickness: =0
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayMode: =If( form_policy.Unsaved, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: =var_powerappspurple
                    FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                    FocusedBorderThickness: =1
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =ColorFade(Self.Fill, -10%)
                    OnSelect: |-
                        =SubmitForm(form_policy); UpdateContext({var_showflyout: false })
                    PressedBorderColor: =ColorFade(Self.BorderColor, -50%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =ColorFade(Self.Fill, -30%)
                    RadiusBottomLeft: =3
                    RadiusBottomRight: =3
                    RadiusTopLeft: =3
                    RadiusTopRight: =3
                    Size: =12
                    Text: ="Save"
                    Width: =100
                    ZIndex: =2

