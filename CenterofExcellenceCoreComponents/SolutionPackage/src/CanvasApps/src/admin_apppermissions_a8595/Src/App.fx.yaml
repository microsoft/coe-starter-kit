App As appinfo:
    BackEnabled: =true
    Formulas: |-
        =/*CheckIfSingleSelection():Boolean=((selectedTab = "Environment" && CountRows(EnvCheckedApps) = 1) || (selectedTab = "Owner" && CountRows(EnvCheckedOwnerApps) = 1) || (selectedTab = "Orphaned apps" && CountRows(OrphanedCheckedApps) = 1));*/
    OnStart: |
        =Concurrent(
            Set(
                AppTheme,
                {
                    palette: {
                        themePrimary: ColorValue("#0078d4"),
                        themeLighterAlt: ColorValue("#eff6fc"),
                        themeLighter: ColorValue("#deecf9"),
                        themeLight: ColorValue("#c7e0f4"),
                        themeTertiary: ColorValue("#71afe5"),
                        themeSecondary: ColorValue("#2b88d8"),
                        themeDarkAlt: ColorValue("#106ebe"),
                        themeDark: ColorValue("#005a9e"),
                        themeDarker: ColorValue("#004578"),
                        neutralLighterAlt: ColorValue("#faf9f8"),
                        neutralLighter: ColorValue("#f3f2f1"),
                        neutralLight: ColorValue("#edebe9"),
                        neutralQuaternaryAlt: ColorValue("#e1dfdd"),
                        neutralQuaternary: ColorValue("#d0d0d0"),
                        neutralTertiaryAlt: ColorValue("#c8c6c4"),
                        neutralTertiary: ColorValue("#a19f9d"),
                        neutralSecondary: ColorValue("#605e5c"),
                        neutralPrimaryAlt: ColorValue("#3b3a39"),
                        neutralPrimary: ColorValue("#323130"),
                        neutralDark: ColorValue("#201f1e"),
                        black: ColorValue("#000000"),
                        white: ColorValue("#ffffff")
                    }
                }
            ),
            Set(
                SearchBoxTheme,
                {
                    palette: {
                        themePrimary: ColorValue("#0078d4"),
                        themeLighterAlt: ColorValue("#eff6fc"),
                        themeLighter: ColorValue("#deecf9"),
                        themeLight: ColorValue("#c7e0f4"),
                        themeTertiary: ColorValue("#71afe5"),
                        themeSecondary: ColorValue("#2b88d8"),
                        themeDarkAlt: ColorValue("#106ebe"),
                        themeDark: ColorValue("#005a9e"),
                        themeDarker: ColorValue("#004578"),
                        neutralLighterAlt: ColorValue("#faf9f8"),
                        neutralLighter: ColorValue("#f3f2f1"),
                        neutralLight: ColorValue("#edebe9"),
                        neutralQuaternaryAlt: ColorValue("#e1dfdd"),
                        neutralQuaternary: ColorValue("#d0d0d0"),
                        neutralTertiaryAlt: ColorValue("#c8c6c4"),
                        neutralTertiary: ColorValue("#a19f9d"),
                        neutralSecondary: ColorValue("#605e5c"),
                        neutralPrimaryAlt: ColorValue("#3b3a39"),
                        neutralPrimary: ColorValue("#323130"),
                        neutralDark: ColorValue("#201f1e"),
                        black: ColorValue("#000000"),
                        white: ColorValue("#f3f2f1")
                    }
                }
            ),
            Set(
                EnvVarDefnID,
                LookUp(
                    'Environment Variable Definitions',
                    'Schema Name' = "admin_PowerAppEnvironmentVariable"
                ).'Environment Variable Definition'
            )
        );
        Concurrent(
            Set(
                AppThemeJson,
                JSON(AppTheme)
            ),
            Set(
                SearchBoxThemeJson,
                JSON(SearchBoxTheme)
            ),
            Set(
                txtPhotosForbidden,
                First(
                    Filter(
                        'Environment Variable Values',
                        'Environment Variable Definition'.'Environment Variable Definition' = GUID(EnvVarDefnID)
                    )
                ).Value
            ),
            Set(
                theAppMakerURL,
                First(
                    Filter(
                        'Environment Variable Values',
                        'Environment Variable Definition'.'Environment Variable Definition' = GUID(EnvVarDefnID)
                    )
                ).Value
            ),
            ClearCollect(
                vEnvironments,
                Filter(
                    Environments,
                    'Environment Deleted' = 'Environment Deleted (Environments)'.No
                )
            );
            Set(
                Style,
                {
                    Primary: "#70daef",
                    Secondary: "#8fcad6",
                    Tertiary: "#ededed",
                    PrimaryTextColor: "#000000",
                    Logo: "http://pngimg.com/uploads/microsoft/microsoft_PNG16.png"
                }
            );
            
        );
        If(
            IsBlank(txtPhotosForbidden),
            Set(
                txtPhotosForbidden,
                LookUp(
                    'Environment Variable Definitions',
                    'Environment Variable Definition' = GUID(EnvVarDefnID)
                ).'Default Value'
            )
        );
        Set(
            boolPhotosForbidden,
            If(
                txtPhotosForbidden = "yes",
                true,
                false
            )
        );
        If(
            IsBlank(theAppMakerURL),
            Set(
                theAppMakerURL,
                LookUp(
                    'Environment Variable Definitions',
                    'Environment Variable Definition' = GUID(EnvVarDefnID)
                ).'Default Value'
            )
        );
        Clear(EnvCheckedApps);
        Clear(EnvCheckedOwnerApps);
        Clear(OrphanedCheckedApps);
        Set(
            selectedTab,
            "Environment"
        );
    StartScreen: =
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

