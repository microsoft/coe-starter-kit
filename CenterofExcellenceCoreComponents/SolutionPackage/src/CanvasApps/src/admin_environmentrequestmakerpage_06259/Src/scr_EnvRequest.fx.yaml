scr_EnvRequest As screen:
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)

    pnlRequestDetails As Panel:
        DialogWidth: =500
        Fill: =pnlRequestDetails.OverlayColor
        OnButtonSelect: |
            =Switch(
                Self.SelectedButton.Label,
                "Cancel",
                Set(
                    showPanel,
                    false
                ),
                "Next",
                Set(
                    addStep,
                    addStep + 1
                );
                If(
                    addStep = 2,
                    ClearCollect(
                        col_makers,
                        Filter(
                            Makers,
                            Maker in col_selectedUsers.Id
                        )
                    );
                    ClearCollect(col_myconnectors, Filter('PowerApps Connectors', Connector in col_selectedConnectors.admin_connectorid));
                    ClearCollect(
                        col_tempMakerDelta,
                        Filter(
                            col_selectedUsers,
                            !(Id in col_makers.Maker)
                        )
                    );
                    If(
                        !IsEmpty(col_tempMakerDelta),
                        ForAll(
                            col_tempMakerDelta,
                            Patch(
                                Makers,
                                {
                                    Maker: GUID(ThisRecord.Id),
                                    'Display Name': ThisRecord.DisplayName,
                                    'User Principal Name': ThisRecord.UserPrincipalName,
                                    'Job Title': ThisRecord.JobTitle,
                                    City: ThisRecord.City
                                }
                            )
                        );
                        ClearCollect(
                            col_makers,
                            Filter(
                                Makers,
                                Maker in col_selectedUsers.Id
                            )
                        );
                    );
                ),
                "Back",
                Set(
                    addStep,
                    addStep - 1
                ),
                "Save",
                SubmitForm(formEnvRequestDetails);
                UpdateIf(
                    'Environment Creation Requests',
                    'Environment Creation Request' = formEnvRequestDetails.LastSubmit.'Environment Creation Request',
                    {'Record GUID as String': formEnvRequestDetails.LastSubmit.'Environment Creation Request'}
                );
                
            );
        OnCloseSelect: =Set(showPanel, false)
        Subtitle: |-
            =Switch(addStep,
            1, "Select connectors needed to create canvas apps and cloud flows.",
            2, "Select admins for the new Environment. You are automatically selected as an admin.",
            3, "Provide details about the environment.",
            4, "Provide values to provision the Dataverse database.")
        Title: |-
            =Switch(pnlContext,
            "add", "New Environment Creation Request",
            "view", dlEnvRequests.Selected.'Request  No')
        Visible: =showPanel
        Width: =App.Width

    conMain As groupContainer.verticalAutoLayoutContainer:
        Height: =scr_EnvRequest.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =scr_EnvRequest.Width
        ZIndex: =1

        c_ActionHeader As groupContainer.verticalAutoLayoutContainer:
            Fill: =RGBA(243, 242, 241, 1)
            FillPortions: =0
            Height: =44
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutGap: =15
            LayoutJustifyContent: =LayoutJustifyContent.End
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =32
            PaddingRight: =32
            ZIndex: =1

            "cbEnvList As 'Fluent Command Bar (1.0.22)'.pcfdataset":
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =200
                Items: |-
                    =Table(
                        {
                          ItemKey: "add",
                          ItemDisplayName: "New",
                          ItemIconName: "Add",
                          ItemEnabled: true
                      },
                      {
                          ItemKey: "refresh",
                          ItemDisplayName: "Refresh",
                          ItemIconName: "Refresh",
                          ItemEnabled: true
                      },
                      {
                          ItemKey: "delete",
                          ItemDisplayName: "Cancel request",
                          ItemIconName: "Delete",
                          ItemEnabled: !IsBlank(dlEnvRequests.Selected)
                      }
                     /* {
                          ItemKey: "view",
                          ItemDisplayName: "View Details",
                          ItemIconName: "Info",
                          ItemEnabled: !IsBlank(dlEnvRequests.Selected)
                      }*/
                    )
                LayoutMinHeight: =33
                LayoutMinWidth: =200
                OnSelect: |-
                    =Switch(
                        Self.Selected.ItemKey,
                        /* Action for ItemKey 'new' (e.g., Patch function) */
                        "refresh",
                        Refresh('Environment Creation Requests'),
                        "view",
                        Set(
                            showPanel,
                            true
                        );
                        Set(
                            pnlContext,
                            "view"
                        ),
                        "delete",
                        Set(
                            showDelete,
                            true
                        ),
                        "add",
                        Set(
                            showPanel,
                            true
                        );NewForm(formEnvRequestDetails);
                        Set(
                            pnlContext,
                            "add"
                        );
                        Set(
                            addStep,
                            1
                        )
                    )
                Theme: =SearchBoxThemeJson
                Visible: |
                    =true
                Width: =200
                X: =0
                Y: =0
                ZIndex: =1

            cbx_view As combobox:
                AlignInContainer: =AlignInContainer.Center
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderThickness: =1
                ChevronBackground: =Self.Fill
                ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                ChevronFill: =RGBA(32, 31, 30, 1)
                ChevronHoverBackground: =Self.Fill
                ChevronHoverFill: =RGBA(33, 33, 33, 1)
                Color: =RGBA(51, 51, 51, 1)
                DefaultSelectedItems: =['Approval Status'.Pending]
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                DisplayFields: =["Value"]
                Fill: =RGBA(243, 242, 241, 1)
                Font: =Font.'Segoe UI'
                Height: =33
                HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverColor: =RGBA(51, 51, 51, 1)
                HoverFill: =Self.Fill
                IsSearchable: =false
                Items: =Sort(col_requestStatuses, Text(Value), SortOrder.Ascending)
                LayoutMinHeight: =33
                NoSelectionText: ="Any status"
                OnChange: =Set(var_selectedItem, Blank())
                PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =RGBA(105, 121, 126, 1)
                SearchFields: =["Value"]
                SearchItems: =[]
                SelectionColor: =RGBA(0, 0, 0, 1)
                SelectionFill: =RGBA(230, 230, 230, 1)
                SelectMultiple: =false
                Width: =180
                X: =957
                Y: =64
                ZIndex: =2

            "tin_searchRequests As 'Fluent SearchBox (1.0.22) Preview'":
                AlignInContainer: =AlignInContainer.Center
                DisplayMode: =DisplayMode.Edit
                Height: =33
                LayoutMinHeight: =33
                LayoutMinWidth: =200
                Theme: =SearchBoxThemeJson
                Width: =200
                X: =0
                Y: =0
                ZIndex: =3

        conMainHeader As groupContainer.horizontalAutoLayoutContainer:
            FillPortions: =0
            Height: =150
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutJustifyContent: =LayoutJustifyContent.Center
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =40
            PaddingRight: =Self.PaddingLeft
            PaddingTop: =32
            X: =40
            Y: =40
            ZIndex: =2

            conMainHeaderLeft As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Height: =100
                LayoutDirection: =LayoutDirection.Vertical
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =3

                lblHeader As Label:
                    AlignInContainer: =AlignInContainer.Stretch
                    AutoHeight: =true
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =16
                    FontWeight: =FontWeight.Semibold
                    Height: =43
                    LayoutMinHeight: =32
                    LayoutMinWidth: =320
                    PaddingStart: =0  
                    Text: =Coalesce(Text(cbx_view.Selected.Value), "All") &" Environment Creation Requests"
                    Width: =320
                    X: =35
                    Y: =15
                    ZIndex: =1

        conMainBody As groupContainer.horizontalAutoLayoutContainer:
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            X: =40
            Y: =40
            ZIndex: =4

            conMainDetails As groupContainer.verticalAutoLayoutContainer:
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =40
                PaddingRight: =Self.PaddingLeft
                PaddingTop: =16
                ZIndex: =3

                "dlEnvRequests As 'Fluent Details List (1.0.22)'.pcfdataset":
                    AlignInContainer: =AlignInContainer.Stretch
                    columns_Items: |-
                        =Table(
                                {
                                ColName: "coe_name",
                                ColDisplayName: "ID",
                                ColWidth: 100,
                                ColSortable: true,
                                ColIsBold: false,
                                ColResizable: true
                            }, 
                            {
                                ColName: "coe_envdisplayname",
                                ColDisplayName: "Name",
                                ColWidth: 200,
                                ColSortable: true,
                                ColIsBold: false,
                                ColResizable: true
                            },
                             {
                                ColName: "coe_envsku",
                                ColDisplayName: "Type",
                                ColWidth: 200,
                                ColSortable: true,
                                ColIsBold: false,
                                ColResizable: true
                            },
                             {
                                ColName: "coe_envregion",
                                ColDisplayName: "Region",
                                ColWidth: 200,
                                ColSortable: true,
                                ColIsBold: false,
                                ColResizable: true
                            },    
                            {
                                ColName: "cExpiration",
                                ColDisplayName: "Expiration",
                                ColWidth: 200,
                                ColSortable: true,
                                ColIsBold: false,
                                ColResizable: true
                            },
                         
                              {
                                ColName: "coe_requeststatus",
                                ColDisplayName: "Status",
                                ColWidth: 200,
                                ColSortable: true,
                                ColIsBold: false,
                                ColResizable: true
                            },
                            {
                                ColName: "cRequestedBy",
                                ColDisplayName: "Requested by",
                                ColWidth: 200,
                                ColSortable: true,
                                ColIsBold: false,
                                ColResizable: true
                            },
                         
                              {
                                ColName: "cRequestedOn",
                                ColDisplayName: "Requested On",
                                ColWidth: 200,
                                ColSortable: true,
                                ColIsBold: false,
                                ColResizable: true
                            }
                            )
                    Compact: =false
                    DisplayMode: =DisplayMode.Edit
                    FillPortions: =1
                    Height: =200
                    InputEvent: =""
                    Items: |-
                        =Search( AddColumns(
                                    Filter('Environment Creation Requests', 'Environment Creation Requests (Views)'.'My Environment Creation Requests','Request status'=cbx_view.Selected.Value || IsBlank(cbx_view.Selected)),
                                    "cExpiration",
                                    If(
                                        ThisRecord.'Has expiration date',
                                        Coalesce(
                                            Text(
                                                ThisRecord.'Expiration date',
                                                "mm/dd/yyyy"
                                            ) & If(
                                                ThisRecord.'Has Extension Request',
                                                " (" & ThisRecord.'Duration Requested' & " day extension requested)"
                                            ),
                                            Text(ThisRecord.'Duration Requested') & " days (requested)",
                                            "--"
                                        ),
                                        "None"
                                    ),
                                    "cRequestedBy",
                                    ThisRecord.'Created By'.'Full Name',
                                    "cRequestedOn",
                                    Text(
                                        ThisRecord.'Created On',
                                        "mm/dd/yyyy"
                                    )
                                )
                            , tin_searchRequests.SearchText, "coe_envdisplayname", "coe_name")
                    LayoutMinHeight: =200
                    LayoutMinWidth: =200
                    OnChange: =
                    OnSelect: =
                    RaiseOnRowSelectionChangeEvent: =false
                    RecordKey: ="coe_name"
                    SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.Single
                    Theme: =AppThemeJson
                    Width: =200
                    X: =0
                    Y: =0
                    ZIndex: =1

                    "'Request  No2' As pcfDataField.textualColumn":
                        FieldDisplayName: ="Request  No"
                        FieldName: ="coe_name"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =1
                        ZIndex: =13

                    "'Environment display name2' As pcfDataField.textualColumn":
                        FieldDisplayName: ="Environment display name"
                        FieldName: ="coe_envdisplayname"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =2
                        ZIndex: =14

                    "'Environment type1' As pcfDataField.textualColumn":
                        FieldDisplayName: ="Environment type"
                        FieldName: ="coe_envsku"
                        FieldType: ="l"
                        FieldVariantName: ="textualColumn"
                        Order: =3
                        ZIndex: =15

                    "'Environment region1' As pcfDataField.textualColumn":
                        FieldDisplayName: ="Environment region"
                        FieldName: ="coe_envregion"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =4
                        ZIndex: =16

                    "'Created By2' As pcfDataField":
                        FieldDisplayName: ="Created By"
                        FieldName: ="createdby"
                        FieldType: ="E"
                        FieldVariantName: ="complexTypeColumn"
                        Order: =5
                        ZIndex: =17

                    "'Created On2' As pcfDataField.textualColumn":
                        FieldDisplayName: ="Created On"
                        FieldName: ="createdon"
                        FieldType: ="d"
                        FieldVariantName: ="textualColumn"
                        Order: =6
                        ZIndex: =18

                    "'Has expiration date2' As pcfDataField.textualColumn":
                        FieldDisplayName: ="Has expiration date"
                        FieldName: ="coe_canexpire"
                        FieldType: ="l"
                        FieldVariantName: ="textualColumn"
                        Order: =7
                        ZIndex: =19

                    "'Request status2' As pcfDataField.textualColumn":
                        FieldDisplayName: ="Request status"
                        FieldName: ="coe_requeststatus"
                        FieldType: ="l"
                        FieldVariantName: ="textualColumn"
                        Order: =8
                        ZIndex: =20

                    cExpiration1 As pcfDataField.textualColumn:
                        FieldDisplayName: ="cExpiration"
                        FieldName: ="cExpiration"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =9
                        ZIndex: =21

    "'old_ pnlRequestDetails' As Panel_1":
        Buttons: |-
            =Table(
                {
                    Label: "Cancel",
                    ButtonType: 'Button.ButtonType'.Standard,
                    Visible: true,
                    Enabled: true
                },
                    {
                    Label: "Back",
                    ButtonType: 'Button.ButtonType'.Standard,
                    Visible: addStep>1,
                    Enabled: true
                },
                {
                    Label: "Next",
                    ButtonType: 'Button.ButtonType'.Primary,
                    Visible: tgl_hasDatabase.Value && addStep = 3 || addStep < 3,
                    Enabled: true
                },
                    {
                    Label: "Save",
                    ButtonType: 'Button.ButtonType'.Primary,
                    Visible: !tgl_hasDatabase.Value && addStep = 3 || addStep = 4,
                    Enabled: true
                }
            )
        DialogWidth: =500
        Fill: ='old_ pnlRequestDetails'.OverlayColor
        Height: =scr_EnvRequest.Height
        OnButtonSelect: |
            =Switch(
                Self.SelectedButton.Label,
                "Cancel",
                Set(
                    showPanel,
                    false
                ),
                "Next",
                Set(
                    addStep,
                    addStep + 1
                );
                If(
                    addStep = 2,
                    ClearCollect(
                        col_makers,
                        Filter(
                            Makers,
                            Maker in col_selectedUsers.Id
                        )
                    );
                    ClearCollect(col_myconnectors, Filter('PowerApps Connectors', Connector in col_selectedConnectors.admin_connectorid));
                    ClearCollect(
                        col_tempMakerDelta,
                        Filter(
                            col_selectedUsers,
                            !(Id in col_makers.Maker)
                        )
                    );
                    If(
                        !IsEmpty(col_tempMakerDelta),
                        ForAll(
                            col_tempMakerDelta,
                            Patch(
                                Makers,
                                {
                                    Maker: GUID(ThisRecord.Id),
                                    'Display Name': ThisRecord.DisplayName,
                                    'User Principal Name': ThisRecord.UserPrincipalName,
                                    'Job Title': ThisRecord.JobTitle,
                                    City: ThisRecord.City
                                }
                            )
                        );
                        ClearCollect(
                            col_makers,
                            Filter(
                                Makers,
                                Maker in col_selectedUsers.Id
                            )
                        );
                    );
                ),
                "Back",
                Set(
                    addStep,
                    addStep - 1
                ),
                "Save",
                SubmitForm(formEnvRequestDetails);
                UpdateIf(
                    'Environment Creation Requests',
                    'Environment Creation Request' = formEnvRequestDetails.LastSubmit.'Environment Creation Request',
                    {'Record GUID as String': formEnvRequestDetails.LastSubmit.'Environment Creation Request'}
                );
                
            );
        OnCloseSelect: =Set(showPanel, false)
        Subtitle: |-
            =Switch(addStep,
            1, "Select connectors needed to create canvas apps and cloud flows.",
            2, "Select admins for the new Environment. You are automatically selected as an admin.",
            3, "Provide details about the environment.",
            4, "Provide values to provision the Dataverse database.")
        Title: |-
            =Switch(pnlContext,
            "add", "New Environment Creation Request",
            "view", dlEnvRequests.Selected.'Request  No')
        Visible: =false //showPanel
        Width: =scr_EnvRequest.Width
        ZIndex: =2

    conNewRequest As groupContainer.verticalAutoLayoutContainer:
        Height: ='pnlRequestDetails'.ContentHeight
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Visible: =showPanel
        Width: ='pnlRequestDetails'.ContentWidth
        X: ='pnlRequestDetails'.ContentX
        Y: ='pnlRequestDetails'.ContentY+30
        ZIndex: =4

        conNewConnectors As groupContainer.verticalAutoLayoutContainer:
            DropShadow: =DropShadow.Light
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =25
            PaddingRight: =10
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Visible: =addStep=1
            ZIndex: =1

            "sbConnectors As 'Fluent SearchBox (1.0.22) Preview'":
                AlignInContainer: =AlignInContainer.Stretch
                DisplayMode: =DisplayMode.Edit
                Height: =50
                LayoutMinHeight: =200
                LayoutMinWidth: =200
                OnChange: =
                Theme: =AppThemeJson
                Width: =200
                X: =0
                Y: =0
                ZIndex: =1

            conConnectorActions As groupContainer.horizontalAutoLayoutContainer:
                FillPortions: =0
                Height: =50
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                LayoutMinHeight: =50
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                ZIndex: =2

                "cbConnectors As 'Fluent Command Bar (1.0.22)'.pcfdataset":
                    DisplayMode: =DisplayMode.Edit
                    Height: =50
                    Items: |-
                        =Table(
                            {
                              ItemKey: "add",
                              ItemDisplayName: "Add to request",
                              ItemIconName: "Add",
                              ItemEnabled: !IsBlank(dlConnectorsAll.Selected),
                             ItemVisible: cbx_connectorView.Selected.Value = "All connectors"
                          },
                          {
                              ItemKey: "delete",
                              ItemDisplayName: "Remove from request",
                              ItemIconName: "Delete",
                              ItemEnabled: !IsBlank(dlConnectorsSelected.Selected),
                              ItemVisible: cbx_connectorView.Selected.Value = "Selected connectors"
                          }
                        )
                    LayoutMinHeight: =200
                    LayoutMinWidth: =200
                    OnSelect: |-
                        =Switch(
                            Self.Selected.ItemKey,
                            /* Action for ItemKey 'new' (e.g., Patch function) */
                            "add",
                            Collect(
                                col_selectedConnectors,
                                ShowColumns(dlConnectorsAll.SelectedItems, "admin_displayname", "admin_connectorid")
                            );
                            ForAll(
                                dlConnectorsAll.SelectedItems As nConnector,
                                Remove(
                                    col_allConnectors,
                                    nConnector
                                )
                            ),
                            "delete",
                            ForAll(
                                dlConnectorsAll.SelectedItems As sConnector,
                                RemoveIf(
                                    col_selectedConnectors,
                                    sConnector.admin_connectorid = admin_connectorid
                                );
                                Patch(
                                    col_allConnectors,
                                    Defaults(col_allConnectors),
                                    sConnector
                                )
                            )
                        )
                    Theme: =AppThemeJson
                    Width: =200
                    X: =0
                    Y: =0
                    ZIndex: =1

                "cbx_connectorView As 'Combo box'.pcfdataset":
                    DefaultSelectedItems: =["All connectors"]
                    DisplayMode: =DisplayMode.Edit
                    Height: =32
                    Items: |-
                        =["All connectors", "Selected connectors"]
                        //\Table({name: "All Connectors"}, {name: "Selected Connectors"})
                    LayoutMinHeight: =32
                    LayoutMinWidth: =320
                    Visible: =true
                    Width: =160
                    X: =0
                    Y: =0
                    ZIndex: =2

                    Value1 As pcfDataField.textualColumn:
                        FieldDisplayName: ="Value"
                        FieldName: ="Value"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =1
                        ZIndex: =27

            "dlConnectorsSelected As 'Fluent Details List (1.0.22)'.pcfdataset":
                AlignInContainer: =AlignInContainer.Stretch
                columns_Items: |-
                    =Table(
                         {
                            ColName: "admin_iconuri",
                            ColDisplayName: "",
                            ColWidth: 30,
                            ColIsBold:false,
                             ColCellType:"image"
                        },
                        {
                            ColName: "admin_displayname",
                            ColDisplayName: "Name",
                            ColWidth: 180,
                            ColIsBold:false
                        }
                        )
                Compact: =false
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =200
                InputEvent: =""
                Items: =col_selectedConnectors
                LayoutMinHeight: =200
                LayoutMinWidth: =200
                OnChange: |+
                    =
                    //Notify( "Row Select " & Self.Selected.'Connector Display Name' )
                    
                OnSelect: =
                RaiseOnRowSelectionChangeEvent: =true
                RecordKey: ="admin_connectorid"
                SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.Multiple
                Theme: =AppThemeJson
                Visible: =cbx_connectorView.Selected.Value = "Selected connectors"
                Width: =200
                X: =0
                Y: =0
                ZIndex: =3

                "'Connector Display Name1_2' As pcfDataField.textualColumn":
                    FieldDisplayName: ="Connector Display Name"
                    FieldName: ="admin_displayname"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =1
                    ZIndex: =22

                Tier1_2 As pcfDataField.textualColumn:
                    FieldDisplayName: ="Tier"
                    FieldName: ="admin_tier"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =2
                    ZIndex: =23

                Publisher1_2 As pcfDataField.textualColumn:
                    FieldDisplayName: ="Publisher"
                    FieldName: ="admin_publisher"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =3
                    ZIndex: =24

                "'Is Custom Api1_2' As pcfDataField.textualColumn":
                    FieldDisplayName: ="Is Custom Api"
                    FieldName: ="admin_iscustomapi"
                    FieldType: ="l"
                    FieldVariantName: ="textualColumn"
                    Order: =4
                    ZIndex: =25

                "'Connector Icon Uri1_2' As pcfDataField.textualColumn":
                    FieldDisplayName: ="Connector Icon Uri"
                    FieldName: ="admin_iconuri"
                    FieldType: ="h"
                    FieldVariantName: ="textualColumn"
                    Order: =5
                    ZIndex: =26

            "dlConnectorsAll As 'Fluent Details List (1.0.22)'.pcfdataset":
                AlignInContainer: =AlignInContainer.Stretch
                columns_Items: |-
                    =Table(
                         {
                            ColName: "admin_iconuri",
                            ColDisplayName: "",
                            ColWidth: 30,
                            ColIsBold:false,
                             ColCellType:"image"
                        },
                        {
                            ColName: "admin_displayname",
                            ColDisplayName: "Name",
                            ColWidth: 180,
                            ColIsBold:false
                        }
                        )
                Compact: =false
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =200
                InputEvent: =""
                Items: |-
                    =
                        Search(
                            Sort(
                                col_allConnectors,
                                "admin_displayname",
                                SortOrder.Ascending
                            ),
                            sbConnectors.SearchText,
                            "admin_displayname"
                        )
                LayoutMinHeight: =200
                LayoutMinWidth: =200
                OnChange: |+
                    =
                    //Notify( "Row Select " & Self.Selected.'Connector Display Name' )
                    
                OnSelect: =
                RaiseOnRowSelectionChangeEvent: =true
                RecordKey: ="admin_connectorid"
                SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.Multiple
                Theme: =AppThemeJson
                Visible: =cbx_connectorView.Selected.Value = "All connectors"
                Width: =200
                X: =0
                Y: =0
                ZIndex: =4

                "'Connector Display Name1_1' As pcfDataField.textualColumn":
                    FieldDisplayName: ="Connector Display Name"
                    FieldName: ="admin_displayname"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =1
                    ZIndex: =22

                Tier1_1 As pcfDataField.textualColumn:
                    FieldDisplayName: ="Tier"
                    FieldName: ="admin_tier"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =2
                    ZIndex: =23

                Publisher1_1 As pcfDataField.textualColumn:
                    FieldDisplayName: ="Publisher"
                    FieldName: ="admin_publisher"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =3
                    ZIndex: =24

                "'Is Custom Api1_1' As pcfDataField.textualColumn":
                    FieldDisplayName: ="Is Custom Api"
                    FieldName: ="admin_iscustomapi"
                    FieldType: ="l"
                    FieldVariantName: ="textualColumn"
                    Order: =4
                    ZIndex: =25

                "'Connector Icon Uri1_1' As pcfDataField.textualColumn":
                    FieldDisplayName: ="Connector Icon Uri"
                    FieldName: ="admin_iconuri"
                    FieldType: ="h"
                    FieldVariantName: ="textualColumn"
                    Order: =5
                    ZIndex: =26

            lblSelectedConnectors As Label:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =320
                Text: =CountRows(col_selectedConnectors) & " selected"
                Width: =320
                X: =0
                Y: =0
                ZIndex: =5

        conNewAdmins As groupContainer.verticalAutoLayoutContainer:
            DropShadow: =DropShadow.Light
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =25
            PaddingRight: =10
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Visible: =addStep=2
            ZIndex: =2

            "sbAdmins As 'Fluent SearchBox (1.0.22) Preview'":
                AlignInContainer: =AlignInContainer.Stretch
                DisplayMode: =DisplayMode.Edit
                Height: =50
                LayoutMinHeight: =200
                LayoutMinWidth: =200
                OnChange: =
                Theme: =AppThemeJson
                Width: =200
                X: =0
                Y: =0
                ZIndex: =1

            conAdminActions As groupContainer.horizontalAutoLayoutContainer:
                FillPortions: =0
                Height: =50
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                LayoutMinHeight: =50
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                ZIndex: =2

                "cbAdmin As 'Fluent Command Bar (1.0.22)'.pcfdataset":
                    DisplayMode: =DisplayMode.Edit
                    Height: =50
                    Items: |-
                        =Table(
                            {
                              ItemKey: "add",
                              ItemDisplayName: "Add to request",
                              ItemIconName: "Add",
                              ItemEnabled: !IsBlank(dlAdminsAll.Selected),
                             ItemVisible: cbx_adminView.Selected.Value = "All users"
                          },
                          {
                              ItemKey: "delete",
                              ItemDisplayName: "Remove from request",
                              ItemIconName: "Delete",
                              ItemEnabled: !IsBlank(dlAdminsSelected.Selected),
                              ItemVisible: cbx_adminView.Selected.Value = "Selected users"
                          }
                        )
                    LayoutMinHeight: =200
                    LayoutMinWidth: =200
                    OnSelect: |-
                        =Switch(
                            Self.Selected.ItemKey,
                            /* Action for ItemKey 'new' (e.g., Patch function) */
                            "add",
                            Collect(
                                col_selectedUsers, ShowColumns(dlAdminsAll.SelectedItems, "DisplayName", "Id", "JobTitle", "UserPrincipalName", "City")
                            ),
                            "delete",
                            ForAll(
                                dlAdminsSelected.SelectedItems As sAdmin,
                                Remove(
                                    col_selectedUsers,
                                    sAdmin
                                );
                            )
                        )
                        
                        // // AddColumns(dlAdmins.SelectedItems, "id", Id)
                    Theme: =AppThemeJson
                    Width: =200
                    X: =0
                    Y: =0
                    ZIndex: =1

                "cbx_adminView As 'Combo box'.pcfdataset":
                    DefaultSelectedItems: =["All users"]
                    DisplayMode: =DisplayMode.Edit
                    Height: =32
                    Items: |-
                        =["All users", "Selected users"]
                        //\Table({name: "All Connectors"}, {name: "Selected Connectors"})
                    LayoutMinHeight: =32
                    LayoutMinWidth: =320
                    Width: =160
                    X: =0
                    Y: =0
                    ZIndex: =2

                    Value1_1 As pcfDataField.textualColumn:
                        FieldDisplayName: ="Value"
                        FieldName: ="Value"
                        FieldType: ="s"
                        FieldVariantName: ="textualColumn"
                        Order: =1
                        ZIndex: =27

            "dlAdminsSelected As 'Fluent Details List (1.0.22)'.pcfdataset":
                AlignInContainer: =AlignInContainer.Stretch
                columns_Items: |-
                    =Table(
                         {
                            ColName: "DisplayName",
                            ColDisplayName: "Name",
                            ColWidth: 150,
                            ColIsBold:false
                        },
                        {
                            ColName: "Mail",
                            ColDisplayName: "Mail",
                            ColWidth: 180,
                            ColIsBold:false
                        }
                        )
                Compact: =false
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =200
                InputEvent: =""
                Items: =col_selectedUsers
                LayoutMinHeight: =200
                LayoutMinWidth: =200
                OnChange: |+
                    =
                    //Notify( "Row Select " & Self.Selected.'Connector Display Name' )
                    
                OnSelect: =
                RaiseOnRowSelectionChangeEvent: =true
                RecordKey: =""
                SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.Multiple
                Theme: =AppThemeJson
                Visible: =cbx_adminView.Selected.Value = "Selected users"
                Width: =200
                X: =25
                Y: =100
                ZIndex: =3

                DisplayName2 As pcfDataField.textualColumn:
                    FieldDisplayName: ="DisplayName"
                    FieldName: ="DisplayName"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =1
                    ZIndex: =28

                Mail2 As pcfDataField.textualColumn:
                    FieldDisplayName: ="Mail"
                    FieldName: ="Mail"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =2
                    ZIndex: =29

                Id2 As pcfDataField.textualColumn:
                    FieldDisplayName: ="Id"
                    FieldName: ="Id"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =3
                    ZIndex: =30

            "dlAdminsAll As 'Fluent Details List (1.0.22)'.pcfdataset":
                AlignInContainer: =AlignInContainer.Stretch
                columns_Items: |-
                    =Table(
                         {
                            ColName: "DisplayName",
                            ColDisplayName: "Name",
                            ColWidth: 150,
                            ColIsBold:false
                        },
                        {
                            ColName: "Mail",
                            ColDisplayName: "Mail",
                            ColWidth: 180,
                            ColIsBold:false
                        }
                        )
                Compact: =false
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =200
                InputEvent: =""
                Items: |-
                    =    Filter(
                            Office365Users.SearchUserV2(
                                {
                                    searchTerm: sbAdmins.SearchText,
                                    top: 50,
                                    isSearchTermRequired: false
                                }
                            ).value,
                            AccountEnabled
                        )
                LayoutMinHeight: =200
                LayoutMinWidth: =200
                OnChange: |+
                    =
                    //Notify( "Row Select " & Self.Selected.'Connector Display Name' )
                    
                OnSelect: =
                RaiseOnRowSelectionChangeEvent: =true
                RecordKey: =""
                SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.Multiple
                Theme: =AppThemeJson
                Visible: =cbx_adminView.Selected.Value = "All users"
                Width: =200
                X: =25
                Y: =100
                ZIndex: =4

                DisplayName2_1 As pcfDataField.textualColumn:
                    FieldDisplayName: ="DisplayName"
                    FieldName: ="DisplayName"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =1
                    ZIndex: =28

                Mail2_1 As pcfDataField.textualColumn:
                    FieldDisplayName: ="Mail"
                    FieldName: ="Mail"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =2
                    ZIndex: =29

                Id2_1 As pcfDataField.textualColumn:
                    FieldDisplayName: ="Id"
                    FieldName: ="Id"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =3
                    ZIndex: =30

            lblSelectedAdmins As Label:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =320
                Text: =CountRows(col_selectedUsers) & " selected"
                Width: =320
                X: =0
                Y: =0
                ZIndex: =5

        conNewDetails As groupContainer.verticalAutoLayoutContainer:
            DropShadow: =DropShadow.Light
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =25
            PaddingRight: =10
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Visible: =addStep=3 || addStep=4
            ZIndex: =3

            formEnvRequestDetails As form:
                AcceptsFocus: =false
                BorderColor: =RGBA(166, 166, 166, 1)
                DataSource: ='Environment Creation Requests'
                DefaultMode: =FormMode.New
                LayoutMinHeight: =250
                LayoutMinWidth: =400
                NumberOfColumns: =1
                OnFailure: =Notify("Error submitting form, please try again.", NotificationType.Error);
                OnReset: |-
                    =UpdateContext({ var_selectSecurityGroup: false });
                OnSuccess: |-
                    =Notify("Form submitted successfully", NotificationType.Success);
                    
                    Set(showPanel,false);
                    Set(addStep, 1);
                    
                    ClearCollect(col_myconnectors, Filter('PowerApps Connectors', Connector in col_selectedConnectors.admin_connectorid));
                    /* Relate the selected Connectors */
                    ForAll(col_myconnectors, Relate(formEnvRequestDetails.LastSubmit.'PowerApps Connectors', ThisRecord));
                    
                      ClearCollect(
                                col_makers,
                                Filter(
                                    Makers,
                                    Maker in col_selectedUsers.Id
                                )
                            );
                    
                            ClearCollect(
                                col_tempMakerDelta,
                                Filter(
                                    col_selectedUsers,
                                    !(Id in col_makers.Maker)
                                )
                            );
                            If(
                                !IsEmpty(col_tempMakerDelta),
                                ForAll(
                                    col_tempMakerDelta,
                                    Patch(
                                        Makers,
                                        {
                                            Maker: GUID(ThisRecord.Id),
                                            'Display Name': ThisRecord.DisplayName,
                                            'User Principal Name': ThisRecord.UserPrincipalName,
                                            'Job Title': ThisRecord.JobTitle,
                                            City: ThisRecord.City
                                        }
                                    )
                                );
                                ClearCollect(
                                    col_makers,
                                    Filter(
                                        Makers,
                                        Maker in col_selectedUsers.Id
                                    )
                                );
                            );
                    
                    
                    
                    /* Relate the selected Makers */
                    ForAll(col_makers, Relate(formEnvRequestDetails.LastSubmit.Makers, ThisRecord));
                    
                    Clear(col_selectedConnectors);
                    Clear(col_selectedUsers);
                    Clear(col_makers);
                    ResetForm(formEnvRequestDetails);
                X: =20
                Y: =20
                ZIndex: =1

                dc_purpose As typedDataCard.textualMultiLineEditCard:
                    BorderColor: =RGBA(36, 42, 44, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="coe_justification"
                    Default: =ThisItem.Justification
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Justification"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =50
                    Required: =true
                    Update: =DataCardValue7_1.Text
                    Visible: =addStep = 3
                    Width: =465
                    WidthFit: =true
                    X: =0
                    Y: =1
                    ZIndex: =1

                    DataCardKey7_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        PaddingLeft: =0
                        Size: =11
                        Text: ="Purpose"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    DataCardValue7_1 As text:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Color: =RGBA(51, 51, 51, 1)
                        Default: =Parent.Default
                        DelayOutput: =true
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayMode: =Parent.DisplayMode
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        Height: =80
                        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverColor: =RGBA(51, 51, 51, 1)
                        HoverFill: =RGBA(255, 255, 255, 1)
                        Mode: =TextMode.MultiLine
                        PaddingLeft: =5
                        PressedBorderColor: =RGBA(105, 121, 126, 1)
                        PressedColor: =RGBA(51, 51, 51, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        RadiusBottomLeft: =2
                        RadiusBottomRight: =2
                        RadiusTopLeft: =2
                        RadiusTopRight: =2
                        Size: =13
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardKey7_1.Y + DataCardKey7_1.Height + 5
                        ZIndex: =2

                    ErrorMessage5_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =13
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue7_1.Y + DataCardValue7_1.Height
                        ZIndex: =3

                    StarVisible5_1 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(118, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey7_1.Height
                        PaddingLeft: =0
                        Size: =13
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        X: =87
                        Y: =DataCardKey7_1.Y
                        ZIndex: =4

                "'Business Area_DataCard1' As typedDataCard.comboBoxEditCard":
                    BorderColor: =RGBA(166, 166, 166, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="admin_BusinessArea"
                    Default: =ThisItem.'Business Area'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@'Environment Creation Requests'],DataSourceInfo.DisplayName,"admin_BusinessArea")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =50
                    Required: =false
                    Update: =DataCardValue7.Selected
                    Visible: =addStep = 3 && LookUp( 'Environment Variable Values', 'Schema Name'="admin_EnvRequestEnableCostTracking").Value = "yes"
                    Width: =465
                    X: =0
                    Y: =2
                    ZIndex: =1

                    DataCardKey8 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        PaddingLeft: =0
                        Size: =11
                        Text: =Parent.DisplayName
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    DataCardValue7 As combobox:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                        ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                        ChevronFill: =RGBA(33, 33, 33, 1)
                        ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                        ChevronHoverFill: =RGBA(33, 33, 33, 1)
                        Color: =RGBA(51, 51, 51, 1)
                        DefaultSelectedItems: =Parent.Default
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayFields: =["admin_areaname"]
                        DisplayMode: =Parent.DisplayMode
                        Font: =Font.'Segoe UI'
                        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverColor: =RGBA(51, 51, 51, 1)
                        HoverFill: =RGBA(212, 212, 212, 1)
                        IsSearchable: =false
                        Items: ='Environment Business Areas'
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(105, 121, 126, 1)
                        SearchFields: =["admin_areaname"]
                        SearchItems: =[]
                        SelectionFill: =RGBA(105, 121, 126, 1)
                        SelectMultiple: =false
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardKey8.Y + DataCardKey8.Height + 5
                        ZIndex: =2

                    ErrorMessage7 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =13
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue7.Y + DataCardValue7.Height
                        ZIndex: =3

                    StarVisible7 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(118, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey8.Height
                        PaddingLeft: =0
                        Size: =13
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        X: =126
                        Y: =DataCardKey8.Y
                        ZIndex: =4

                "'Has expiration date_DataCard1_1' As typedDataCard.comboBoxOptionSetSingleEditCard":
                    BorderColor: =RGBA(36, 42, 44, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="coe_canexpire"
                    Default: =ThisItem.'Has expiration date'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Has expiration date"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    Required: =false
                    Update: =If(tgl_canExpire.Value, 'Has expiration date (Environment Creation Requests)'.Yes, 'Has expiration date (Environment Creation Requests)'.No)
                    Visible: =addStep = 3
                    Width: =465
                    WidthFit: =true
                    X: =0
                    Y: =5
                    ZIndex: =1

                    DataCardKey11 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        PaddingLeft: =0
                        Size: =11
                        Text: ="Automatically delete environment after use?"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    ErrorMessage9 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =13
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =tgl_canExpire.Y + tgl_canExpire.Height
                        ZIndex: =3

                    StarVisible9 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(118, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey11.Height
                        PaddingLeft: =0
                        Size: =13
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        X: =375
                        Y: =10
                        ZIndex: =4

                    tgl_canExpire As toggleSwitch:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FalseFill: =RGBA(230, 230, 230, 1)
                        FalseHoverFill: =ColorFade(Self.FalseFill, -10%)
                        FalseText: ="No"
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        HandleFill: =If(Self.Value, Color.White, RGBA(133, 138, 140, 1))
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        OnUncheck: =Reset(ComboBox2);
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        Size: =11
                        TrueFill: =ColorValue(AppTheme.palette.themePrimary)
                        TrueHoverFill: =ColorFade(Self.TrueFill, -30%)
                        TrueText: ="Yes"
                        X: =30
                        Y: =54
                        ZIndex: =5

                "'Duration Requested_DataCard1' As typedDataCard.numberEditCard":
                    BorderColor: =RGBA(133, 138, 140, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="coe_durationrequested"
                    Default: =ThisItem.'Duration Requested'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Duration Requested"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =50
                    Required: =tgl_canExpire.Value
                    Update: =ComboBox2.Selected.Value
                    Visible: =addStep = 3 && tgl_canExpire.Value
                    Width: =465
                    WidthFit: =true
                    X: =0
                    Y: =6
                    ZIndex: =1

                    DataCardKey12 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        PaddingLeft: =0
                        Size: =11
                        Text: ="How long is the environment needed?"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    DataCardValue12 As text:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        Default: =Parent.Default
                        DelayOutput: =true
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayMode: =Parent.DisplayMode
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        Format: =TextFormat.Number
                        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverColor: =RGBA(51, 51, 51, 1)
                        HoverFill: =RGBA(255, 255, 255, 1)
                        PaddingLeft: =5
                        PressedBorderColor: =RGBA(105, 121, 126, 1)
                        PressedColor: =RGBA(51, 51, 51, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =13
                        Tooltip: =Parent.DisplayName
                        Visible: =false
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardKey12.Y + DataCardKey12.Height + 5
                        ZIndex: =2

                    ErrorMessage10 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =13
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue12.Y + DataCardValue12.Height
                        ZIndex: =3

                    StarVisible10 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(118, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey12.Height
                        PaddingLeft: =0
                        Size: =13
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        X: =308
                        Y: =DataCardKey12.Y
                        ZIndex: =4

                    ComboBox2 As combobox:
                        BorderColor: =RGBA(36, 42, 44, 1)
                        BorderThickness: =1
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                        ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                        ChevronFill: =RGBA(133, 138, 140, 1)
                        ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                        ChevronHoverFill: =RGBA(33, 33, 33, 1)
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayFields: =["Label"]
                        Font: =Font.'Segoe UI'
                        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverColor: =RGBA(51, 51, 51, 1)
                        HoverFill: =RGBA(212, 212, 212, 1)
                        IsSearchable: =false
                        Items: |-
                            =Table({Value:30, Label: "30 days"},{Value:60, Label: "60 days"},{Value:90, Label: "90 days"},{Value:120, Label: "120 days"})
                        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(105, 121, 126, 1)
                        SearchFields: =["Label"]
                        SearchItems: =[]
                        SelectionFill: =RGBA(105, 121, 126, 1)
                        SelectMultiple: =false
                        Width: =Parent.Width - Self.X * 2
                        X: =30
                        Y: =48
                        ZIndex: =5

                "'Database language_DataCard1_1' As typedDataCard.textualEditCard":
                    BorderColor: =RGBA(166, 166, 166, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="coe_dblanguage"
                    Default: =ThisItem.'Database language'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Database language"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =138
                    MaxLength: =DataSourceInfo([@'Environment Creation Requests'], DataSourceInfo.MaxLength, "coe_dblanguage")
                    Required: =tgl_hasDatabase.Value
                    Update: =ComboBox2_2.Selected.name
                    Visible: =addStep = 4
                    Width: =465
                    WidthFit: =true
                    X: =0
                    Y: =8
                    ZIndex: =1

                    DataCardKey8_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        PaddingLeft: =0
                        Size: =11
                        Text: ="Language"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    ErrorMessage6_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =13
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =ComboBox2_2.Y + ComboBox2_2.Height
                        ZIndex: =3

                    StarVisible6_1 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(118, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey8_1.Height
                        PaddingLeft: =0
                        Size: =13
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        X: =103
                        Y: =10
                        ZIndex: =4

                    ComboBox2_2 As combobox:
                        BorderColor: =RGBA(36, 42, 44, 1)
                        BorderThickness: =1
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                        ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                        ChevronFill: =RGBA(133, 138, 140, 1)
                        ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                        ChevronHoverFill: =RGBA(33, 33, 33, 1)
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayFields: =["DisplayName"]
                        Font: =Font.'Segoe UI'
                        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverColor: =RGBA(51, 51, 51, 1)
                        HoverFill: =RGBA(212, 212, 212, 1)
                        Items: =col_languages
                        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(105, 121, 126, 1)
                        SearchFields: =["DisplayName"]
                        SearchItems: =Search(col_languages,ComboBox2_2.SearchText,"DisplayName")
                        SelectionFill: =RGBA(105, 121, 126, 1)
                        SelectMultiple: =false
                        Width: =Parent.Width - Self.X * 2
                        X: =30
                        Y: =88
                        ZIndex: =5

                    Label8 As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(133, 138, 140, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        PaddingLeft: =0
                        Size: =10
                        Text: ="Default language for user interfaces in this environment"
                        Width: =440
                        X: =30
                        Y: =39
                        ZIndex: =6

                "'Database currency_DataCard1_1' As typedDataCard.textualEditCard":
                    BorderColor: =RGBA(166, 166, 166, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="coe_dbcurrency"
                    Default: =ThisItem.'Database currency'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Database currency"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =122
                    MaxLength: =DataSourceInfo([@'Environment Creation Requests'], DataSourceInfo.MaxLength, "coe_dbcurrency")
                    Required: =tgl_hasDatabase.Value
                    Update: =ComboBox2_3.Selected.name
                    Visible: =addStep = 4
                    Width: =465
                    WidthFit: =true
                    X: =0
                    Y: =9
                    ZIndex: =1

                    DataCardKey9_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        PaddingLeft: =0
                        Size: =11
                        Text: ="Currency"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    ErrorMessage7_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =13
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =ComboBox2_3.Y + ComboBox2_3.Height
                        ZIndex: =3

                    StarVisible7_1 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(118, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey9_1.Height
                        PaddingLeft: =0
                        Size: =13
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        X: =98
                        Y: =DataCardKey9_1.Y
                        ZIndex: =4

                    ComboBox2_3 As combobox:
                        BorderColor: =RGBA(36, 42, 44, 1)
                        BorderThickness: =1
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                        ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                        ChevronFill: =RGBA(133, 138, 140, 1)
                        ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                        ChevronHoverFill: =RGBA(33, 33, 33, 1)
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayFields: =["name"]
                        Font: =Font.'Segoe UI'
                        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverColor: =RGBA(51, 51, 51, 1)
                        HoverFill: =RGBA(212, 212, 212, 1)
                        Items: =col_currencies
                        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(105, 121, 126, 1)
                        SearchFields: =["name"]
                        SearchItems: =Search(col_currencies,ComboBox2_3.SearchText,"name")
                        SelectionFill: =RGBA(105, 121, 126, 1)
                        SelectMultiple: =false
                        Width: =Parent.Width - Self.X * 2
                        X: =30
                        Y: =84
                        ZIndex: =5

                    Label8_1 As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(133, 138, 140, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        PaddingLeft: =0
                        Size: =10
                        Text: ="Reports will use this currency"
                        Width: =440
                        X: =30
                        Y: =34
                        ZIndex: =6

                "'Database security group ID_DataCard1' As typedDataCard.textualEditCard":
                    BorderColor: =RGBA(36, 42, 44, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="coe_databasesecuritygroupid"
                    Default: =ThisItem.'Database security group ID'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Database security group ID"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =257
                    MaxLength: =DataSourceInfo([@'Environment Creation Requests'], DataSourceInfo.MaxLength, "coe_databasesecuritygroupid")
                    Required: =false
                    Update: =DataCardValue1.Text
                    Visible: =addStep = 4
                    Width: =465
                    X: =0
                    Y: =10
                    ZIndex: =1

                    DataCardKey1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        PaddingLeft: =0
                        Size: =11
                        Text: ="Security group"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    DataCardValue1 As text:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Color: =RGBA(51, 51, 51, 1)
                        Default: =var_selectedSecurityGroup.id
                        DelayOutput: =true
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayMode: =Parent.DisplayMode
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverColor: =RGBA(51, 51, 51, 1)
                        HoverFill: =RGBA(255, 255, 255, 1)
                        MaxLength: =Parent.MaxLength
                        OnChange: =
                        PaddingLeft: =5
                        PressedBorderColor: =RGBA(105, 121, 126, 1)
                        PressedColor: =RGBA(51, 51, 51, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =13
                        Tooltip: =Parent.DisplayName
                        Visible: =false
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =227
                        ZIndex: =2

                    ErrorMessage1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =13
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue1.Y + DataCardValue1.Height
                        ZIndex: =3

                    StarVisible1 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey1.Height
                        PaddingLeft: =0
                        Size: =13
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey1.Y
                        ZIndex: =4

                    HtmlText1 As htmlViewer:
                        AutoHeight: =true
                        Color: =RGBA(133, 138, 140, 1)
                        Font: =Font.'Segoe UI'
                        Height: =50
                        HtmlText: |-
                            ="Restrict environment access to people in this security group. Otherwise, everyone can access. <a style='color:#0078d4;' href='https://docs.microsoft.com/en-us/power-platform/admin/control-user-access'>Learn more</a>"
                        PaddingLeft: =0
                        Size: =10
                        Tooltip: |-
                            ="Restrict environment access to people in this security group. Otherwise, everyone can access. <a href='https://docs.microsoft.com/en-us/power-platform/admin/control-user-access'>Learn more</a>"
                        Width: =440
                        X: =30
                        Y: =43
                        ZIndex: =6

                    c_editGroup As groupContainer.horizontalAutoLayoutContainer:
                        Height: =50
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =25
                        Width: =440
                        Y: =100
                        ZIndex: =8

                        lbl_securityGroup_1 As label:
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FillPortions: =1
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            LayoutMinHeight: =30
                            LayoutMinWidth: =80
                            PaddingTop: =0
                            Size: =11
                            Text: =Coalesce(var_selectedSecurityGroup.displayName,"None")
                            Wrap: =false
                            ZIndex: =4

                        "cbSgActions As 'Fluent Command Bar (1.0.22)'.pcfdataset":
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =1
                            Height: =33
                            Items: |-
                                =Table(
                                      {
                                      ItemKey: "add",
                                      ItemDisplayName: "Add",
                                      ItemIconName: "Add",
                                      ItemEnabled: true,
                                      ItemIconOnly: true
                                  },
                                  {
                                      ItemKey: "edit",
                                      ItemDisplayName: "Edit",
                                      ItemIconName: "Edit",
                                      ItemEnabled: true,
                                      ItemIconOnly: true
                                  },
                                    {
                                      ItemKey: "remove",
                                      ItemDisplayName: "Remove",
                                      ItemIconName: "Delete",
                                      ItemEnabled: true,
                                      ItemIconOnly: true
                                  }
                                )
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            OnSelect: |
                                =Switch(
                                    Self.Selected.ItemKey,
                                    /* Action for ItemKey 'new' (e.g., Patch function) */
                                    "add", Set(showSecurityPanel, true);,
                                    "edit", Set(showSecurityPanel, true);,
                                  //  "refresh", UpdateContext({ var_selectedSecurityGroup: LookUp( col_groups, id=var_selectedCreateReq.'Database security group ID' ) });,
                                    "remove", UpdateContext({ var_selectedSecurityGroup: Blank() })
                                
                                  )
                            Theme: =AppThemeJson
                            Width: =200
                            X: =0
                            Y: =0
                            ZIndex: =5

                "'Request status_DataCard1' As typedDataCard.comboBoxOptionSetSingleEditCard":
                    BorderColor: =RGBA(166, 166, 166, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="coe_requeststatus"
                    Default: =ThisItem.'Request status'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Request status"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =50
                    Required: =false
                    Update: =DataCardValue10_1.Selected.Value
                    Visible: =false
                    Width: =465
                    WidthFit: =true
                    X: =0
                    Y: =11
                    ZIndex: =1

                    DataCardKey10_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        PaddingLeft: =0
                        Size: =13
                        Text: =Parent.DisplayName
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    DataCardValue10_1 As combobox:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                        ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                        ChevronFill: =RGBA(33, 33, 33, 1)
                        ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                        ChevronHoverFill: =RGBA(33, 33, 33, 1)
                        Color: =RGBA(51, 51, 51, 1)
                        DefaultSelectedItems: =[If(formEnvRequestDetails.Mode = FormMode.New, 'Approval Status'.Pending, Parent.Default)]
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayFields: =["Value"]
                        DisplayMode: =Parent.DisplayMode
                        Font: =Font.'Segoe UI'
                        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverColor: =RGBA(51, 51, 51, 1)
                        HoverFill: =RGBA(212, 212, 212, 1)
                        IsSearchable: =false
                        Items: =Choices('Approval Status')
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(105, 121, 126, 1)
                        SearchFields: =["Value"]
                        SearchItems: =[]
                        SelectionFill: =RGBA(105, 121, 126, 1)
                        SelectMultiple: =false
                        Size: =13
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardKey10_1.Y + DataCardKey10_1.Height + 5
                        ZIndex: =2

                    ErrorMessage8_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =13
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue10_1.Y + DataCardValue10_1.Height
                        ZIndex: =3

                    StarVisible8_1 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey10_1.Height
                        PaddingLeft: =0
                        Size: =13
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey10_1.Y
                        ZIndex: =4

                dc_name As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 42, 44, 1)
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =0
                    DataField: ="coe_envdisplayname"
                    Default: =ThisItem.'Environment display name'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Environment display name"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =50
                    MaxLength: =DataSourceInfo([@'Environment Creation Requests'], DataSourceInfo.MaxLength, "coe_envdisplayname")
                    Required: =true
                    Update: =DataCardValue2.Text
                    Visible: =addStep = 3
                    Width: =465
                    WidthFit: =true
                    X: =0
                    Y: =0
                    ZIndex: =2

                    DataCardKey2 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        PaddingLeft: =0
                        Size: =11
                        Text: ="Name"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    DataCardValue2 As text:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Color: =RGBA(51, 51, 51, 1)
                        Default: =Parent.Default
                        DelayOutput: =true
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayMode: =Parent.DisplayMode
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverColor: =RGBA(51, 51, 51, 1)
                        HoverFill: =RGBA(255, 255, 255, 1)
                        MaxLength: =Parent.MaxLength
                        PaddingLeft: =5
                        PressedBorderColor: =RGBA(105, 121, 126, 1)
                        PressedColor: =RGBA(51, 51, 51, 1)
                        PressedFill: =RGBA(255, 255, 255, 1)
                        RadiusBottomLeft: =1
                        RadiusBottomRight: =1
                        RadiusTopLeft: =1
                        RadiusTopRight: =1
                        Size: =11
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardKey2.Y + DataCardKey2.Height + 5
                        ZIndex: =2

                    ErrorMessage1_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =13
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue2.Y + DataCardValue2.Height
                        ZIndex: =3

                    StarVisible1_1 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(118, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey2.Height
                        PaddingLeft: =0
                        Size: =13
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        X: =70
                        Y: =DataCardKey2.Y
                        ZIndex: =4

                dc_region As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(166, 166, 166, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="coe_envregion"
                    Default: =LookUp(col_regions, properties.isDefault = true).name
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Environment region"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =117
                    MaxLength: =DataSourceInfo([@'Environment Creation Requests'], DataSourceInfo.MaxLength, "coe_envregion")
                    Required: =true
                    Update: =ComboBox2_4.Selected.name
                    Visible: =addStep = 3
                    Width: =465
                    WidthFit: =true
                    X: =0
                    Y: =3
                    ZIndex: =2

                    DataCardKey4_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        PaddingLeft: =0
                        Size: =11
                        Text: ="Region"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    ErrorMessage3_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =13
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =ComboBox2_4.Y + ComboBox2_4.Height
                        ZIndex: =3

                    ComboBox2_4 As combobox:
                        BorderColor: =RGBA(36, 42, 44, 1)
                        BorderThickness: =1
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                        ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                        ChevronFill: =RGBA(133, 138, 140, 1)
                        ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                        ChevronHoverFill: =RGBA(33, 33, 33, 1)
                        Color: =RGBA(51, 51, 51, 1)
                        DefaultSelectedItems: =LookUp(col_regions, properties.isDefault = true)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayFields: =["DisplayName"]
                        Font: =Font.'Segoe UI'
                        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverColor: =RGBA(51, 51, 51, 1)
                        HoverFill: =RGBA(212, 212, 212, 1)
                        IsSearchable: =false
                        Items: =col_regions
                        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(105, 121, 126, 1)
                        SearchFields: =["DisplayName"]
                        SearchItems: =[]
                        SelectionFill: =RGBA(105, 121, 126, 1)
                        SelectMultiple: =false
                        Width: =Parent.Width - Self.X * 2
                        X: =30
                        Y: =46
                        ZIndex: =5

                    StarVisible2_2 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(118, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey3_1.Height
                        PaddingLeft: =0
                        Size: =13
                        Text: ="*"
                        Tooltip: ="Required field"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        X: =77
                        Y: =DataCardKey3_1.Y
                        ZIndex: =6

                    Icon10_1 As icon.Information:
                        BorderColor: =RGBA(166, 166, 166, 1)
                        Color: =Color.Purple
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(220, 220, 220, 1)
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        FocusedBorderThickness: =0
                        Height: =22
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        Icon: =Icon.Information
                        OnSelect: |-
                            =UpdateContext({var_showEnvTypeInfo: false , var_message: "" });
                            UpdateContext({var_showEnvTypeInfo: true });
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        Visible: =false
                        Width: =31
                        X: =101
                        Y: =15
                        ZIndex: =7

                    Label4 As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(128, 128, 128, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        Height: =24
                        Size: =10
                        Text: ="A local region can provide quicker data access"
                        Width: =430
                        X: =30
                        Y: =93
                        ZIndex: =8

                dc_type As typedDataCard.comboBoxOptionSetSingleEditCard:
                    BorderColor: =RGBA(36, 42, 44, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="coe_envsku"
                    Default: ='Environment type'.Sandbox
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Environment type"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =50
                    Required: =true
                    Update: =DataCardValue3_1.Selected.Value
                    Visible: =addStep = 3
                    Width: =465
                    WidthFit: =true
                    X: =0
                    Y: =4
                    ZIndex: =2

                    StarVisible2_1 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(118, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey3_1.Height
                        PaddingLeft: =0
                        Size: =13
                        Text: ="*"
                        Tooltip: ="Required field"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        X: =66
                        Y: =DataCardKey3_1.Y
                        ZIndex: =1

                    DataCardKey3_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        PaddingLeft: =0
                        Size: =11
                        Text: ="Type"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =2

                    DataCardValue3_1 As combobox:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        BorderThickness: =1
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                        ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                        ChevronFill: =RGBA(133, 138, 140, 1)
                        ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                        ChevronHoverFill: =RGBA(33, 33, 33, 1)
                        Color: =RGBA(51, 51, 51, 1)
                        DefaultSelectedItems: =[Parent.Default]
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayFields: =["Value"]
                        DisplayMode: =Parent.DisplayMode
                        Font: =Font.'Segoe UI'
                        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        HoverColor: =RGBA(51, 51, 51, 1)
                        HoverFill: =RGBA(212, 212, 212, 1)
                        IsSearchable: =false
                        Items: =Choices('Environment type')
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(105, 121, 126, 1)
                        SearchFields: =["Value"]
                        SearchItems: =[]
                        SelectionFill: =RGBA(105, 121, 126, 1)
                        SelectMultiple: =false
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardKey3_1.Y + DataCardKey3_1.Height + 5
                        ZIndex: =3

                    ErrorMessage2_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =13
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue3_1.Y + DataCardValue3_1.Height
                        ZIndex: =4

                    "Icon1 As 'Fluent Icon (1.0.22)'":
                        DisplayMode: =DisplayMode.Edit
                        Height: =30
                        IconName: ="Info"
                        IconType: ='PowerCAT.Icon.IconType'.Icon
                        Theme: ="AppThemeJson"
                        Tooltip: ="Choose production type if you're ready to deploy. If you're still developing or testing, choose Sandbox for a non-production environment."
                        Width: =30
                        X: =100
                        Y: =10
                        ZIndex: =5

                "'Has database_DataCard1_1' As typedDataCard.comboBoxOptionSetSingleEditCard":
                    BorderColor: =RGBA(36, 42, 44, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="coe_hasdatabase"
                    Default: =ThisItem.'Has database'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Has database"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =50
                    Required: =false
                    Update: =If(tgl_hasDatabase.Value, 'Has database (Environment Creation Requests)'.Yes, 'Has database (Environment Creation Requests)'.No)
                    Visible: =addStep = 3
                    Width: =465
                    WidthFit: =true
                    X: =0
                    Y: =7
                    ZIndex: =2

                    DataCardKey5_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        PaddingLeft: =0
                        Size: =11
                        Text: ="Create a database for this environment?"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    ErrorMessage4_1 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =13
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =tgl_hasDatabase.Y + tgl_hasDatabase.Height
                        ZIndex: =3

                    StarVisible4_1 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey5_1.Height
                        PaddingLeft: =0
                        Size: =13
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey5_1.Y
                        ZIndex: =4

                    tgl_hasDatabase As toggleSwitch:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FalseFill: =RGBA(230, 230, 230, 1)
                        FalseHoverFill: =ColorFade(Self.FalseFill,-10%)
                        FalseText: ="No"
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        HandleFill: =If(Self.Value, Color.White, RGBA(133, 138, 140, 1))
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        Size: =11
                        TrueFill: =ColorValue(AppTheme.palette.themePrimary)
                        TrueHoverFill: =ColorFade(Self.TrueFill, -30%)
                        TrueText: ="Yes"
                        X: =30
                        Y: =52
                        ZIndex: =5

    pnlViewDetails As Panel_1:
        Buttons: |-
            =Table(
                {
                    Label: "Cancel",
                    ButtonType: 'Button.ButtonType'.Standard,
                    Visible: true,
                    Enabled: true
                },
                {
                    Label: "Save",
                    ButtonType: 'Button.ButtonType'.Primary,
                    Visible: true,
                    Enabled: true
                }
            )
        Fill: =pnlViewDetails.OverlayColor
        Height: =scr_EnvRequest.Height
        OnButtonSelect: |-
            =If(
                Self.SelectedButton.Label = "Cancel",
                Set(
                    showSecurityPanel,
                    false
                ),
                UpdateContext({ var_selectSecurityGroup: false , var_selectedSecurityGroup: dlSearchGroups.Selected});
                Set(
                    showSecurityPanel,
                    false
                );
                
            )
        OnCloseSelect: =Set(showSecurityPanel, false)
        Subtitle: =""
        Title: ="Edit Security group"
        Visible: =showSecurityPanel
        Width: =scr_EnvRequest.Width
        ZIndex: =5

    conSecurityGroup As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Light
        Height: =pnlViewDetails.ContentHeight
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =10
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =10
        PaddingLeft: =10
        PaddingRight: =10
        PaddingTop: =10
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Visible: =showSecurityPanel
        Width: =pnlViewDetails.ContentWidth
        X: =pnlViewDetails.ContentX
        Y: =pnlViewDetails.ContentY+20
        ZIndex: =6

        "sbSearchGroups As 'Fluent SearchBox (1.0.22) Preview'":
            AlignInContainer: =AlignInContainer.Stretch
            DisplayMode: =DisplayMode.Edit
            Height: =33
            LayoutMinHeight: =200
            LayoutMinWidth: =200
            Theme: =AppThemeJson
            Width: =200
            X: =0
            Y: =0
            ZIndex: =1

        "dlSearchGroups As 'Fluent Details List (1.0.22)'.pcfdataset":
            AlignInContainer: =AlignInContainer.Stretch
            columns_Items: |-
                =Table(
                    {
                        ColName: "displayName",
                        ColDisplayName: "Name",
                        ColWidth: 300,
                        ColSortable: true,
                        ColIsBold: false,
                        ColResizable: true
                    })
            Compact: =false
            DisplayMode: =DisplayMode.Edit
            FillPortions: =1
            Height: =200
            Items: |-
                =If(
                    !IsBlank(sbSearchGroups.SearchText),
                    Sort(
                        Office365Groups.ListGroups({'$filter': "startswith(displayName," & "'" & sbSearchGroups.SearchText & "'" & ")"}).value,
                        displayName,
                        SortOrder.Ascending
                    ),
                    Sort(
                        Office365Groups.ListGroups().value,
                        displayName,
                        SortOrder.Ascending
                    )
                )
            LayoutMinHeight: =200
            LayoutMinWidth: =200
            Theme: =AppThemeJson
            Width: =200
            X: =0
            Y: =0
            ZIndex: =2

            id1 As pcfDataField.textualColumn:
                FieldDisplayName: ="id"
                FieldName: ="id"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =1
                ZIndex: =40

            displayName2 As pcfDataField.textualColumn:
                FieldDisplayName: ="displayName"
                FieldName: ="displayName"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =2
                ZIndex: =41

    dlgDelete As Dialog:
        Buttons: |-
            =Table({Label: "Cancel", ButtonType:'Button.ButtonType'.Standard, HasBorder: false }, {Label: "Ok", ButtonType:'Button.ButtonType'.Primary, HasBorder: false })
        Fill: =dlgDelete.OverlayColor
        Height: =scr_EnvRequest.Height
        OnButtonSelect: |-
            =Switch(
                Self.SelectedButton.Label,
                "Cancel",
                Set(
                    showDelete,
                    false
                ),
                "Ok",
                Patch(
                    'Environment Creation Requests',
                    LookUp(
                        'Environment Creation Requests',
                        'Environment Creation Request' = dlEnvRequests.Selected.'Environment Creation Request'
                    ),
                    {
                        'Request status': 'Approval Status'.Cancelled,
                        Status: 'Status (Environment Creation Requests)'.Inactive,
                        Notes: "Requestor deleted request in the app"
                    }
                );
                Set(
                    showDelete,
                    false
                )
            )
        OnCloseSelect: |-
            =  Set(
                    showDelete,
                    false
              )
        SubTitle: ="Confirm the cancellation of your environment request."
        Title: ="Cancel Environment Request?"
        Visible: =showDelete
        Width: =scr_EnvRequest.Width
        ZIndex: =7

