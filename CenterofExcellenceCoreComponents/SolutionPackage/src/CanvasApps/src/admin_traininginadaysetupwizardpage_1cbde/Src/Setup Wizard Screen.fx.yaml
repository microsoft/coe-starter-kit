"'Setup Wizard Screen' As screen":
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: =

    conMain As groupContainer.verticalAutoLayoutContainer:
        Height: =Parent.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width
        X: =0+0
        Y: =0+0
        ZIndex: =1

        conMainHeader As groupContainer.horizontalAutoLayoutContainer:
            FillPortions: =0
            Height: =100
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutJustifyContent: =LayoutJustifyContent.Center
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =24
            PaddingRight: =Self.PaddingLeft
            ZIndex: =1

            conMainHeaderLeft As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Height: =100
                LayoutDirection: =LayoutDirection.Vertical
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =3

                lblMainHeader As Label:
                    AlignInContainer: =AlignInContainer.Stretch
                    Alignment: =Align.Left
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =20
                    FontWeight: =FontWeight.Semibold
                    Height: =40
                    LayoutMinHeight: =32
                    LayoutMinWidth: =320
                    Text: ="Center of Excellence Setup Wizard - Training in a day"
                    Width: =512
                    X: =0
                    Y: =0
                    ZIndex: =1

                lblMainSubheading As Label:
                    AlignInContainer: =AlignInContainer.Stretch
                    Alignment: =Align.Left
                    DisplayMode: =DisplayMode.Edit
                    Height: =24
                    LayoutMinHeight: =32
                    LayoutMinWidth: =320
                    Text: ="A setup wizard provides a guided step by step experience to configure the Training in a day components of the CoE Starter Kit."
                    VerticalAlignment: ="middle"
                    Width: =320
                    X: =40
                    Y: =40
                    ZIndex: =2

            "FluentIcon As 'Fluent Icon (1.0.18)'":
                DisplayMode: =DisplayMode.Edit
                FontColor: =AppTheme.palette.themePrimary
                FontSize: =18
                Height: =48
                HoverFontColor: =AppTheme.palette.themePrimary
                HoverIconColor: =AppTheme.palette.themePrimary
                IconColor: =AppTheme.palette.themePrimary
                IconName: ="Unknown"
                IconType: ='''PowerCAT.Icon.IconType'''.ActionButton
                LayoutMinHeight: =200
                LayoutMinWidth: =200
                OnChange: |-
                    =UpdateContext({showHelp: true})
                Text: ="Help"
                TextAlignment: ='''PowerCAT.Icon.TextAlignment'''.Center
                Tooltip: ="Help and Documentation"
                Width: =100
                X: =40
                Y: =40
                ZIndex: =4

        Rectangle2 As rectangle:
            AlignInContainer: =AlignInContainer.Stretch
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =ColorValue(AppTheme.palette.neutralLight)
            FocusedBorderColor: =RGBA(0, 120, 212, 1)
            Height: =1
            HoverFill: =RGBA(0, 120, 212, 1)
            PressedFill: =RGBA(0, 120, 212, 1)
            ZIndex: =2

        conMainBody As groupContainer.horizontalAutoLayoutContainer:
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            ZIndex: =3

            conMainSteps As groupContainer.verticalAutoLayoutContainer:
                FillPortions: =0
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =conMainHeader.PaddingLeft
                PaddingRight: =Self.PaddingLeft
                PaddingTop: =24
                Width: =280
                ZIndex: =1

                "SubwayNav1 As 'SubwayNav (1.0.18) Preview'.pcfdataset":
                    AlignInContainer: =AlignInContainer.Stretch
                    DisplayMode: =DisplayMode.Disabled
                    FillPortions: =1
                    Height: =200
                    Items: |-
                        =AddColumns(
                            colSetupSteps,
                            "ItemState",
                            If(
                                ItemKey=configStep,"Current",
                                ItemKey exactin colStepsCompleted.Value,"Completed",
                                ""
                            )
                        )
                    LayoutMinHeight: =200
                    LayoutMinWidth: =200
                    Theme: =AppThemeJson
                    Width: =200
                    X: =0
                    Y: =0
                    ZIndex: =3

            Rectangle2_1 As rectangle:
                AlignInContainer: =AlignInContainer.Stretch
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledFill: =RGBA(166, 166, 166, 1)
                Fill: =ColorValue(AppTheme.palette.neutralLight)
                FocusedBorderColor: =RGBA(0, 120, 212, 1)
                Height: =1
                HoverFill: =RGBA(0, 120, 212, 1)
                PressedFill: =RGBA(0, 120, 212, 1)
                Width: =1
                ZIndex: =2

            conMainDetails As groupContainer.verticalAutoLayoutContainer:
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingRight: =Self.PaddingLeft
                PaddingTop: =16
                ZIndex: =3

                lblStepName As Label:
                    Alignment: =Align.Left
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =16
                    FontWeight: =FontWeight.Semibold
                    Height: =40
                    LayoutMinHeight: =32
                    LayoutMinWidth: =640
                    PaddingStart: =24
                    Text: =LookUp(colSetupSteps, ItemKey = configStep).ItemLabel
                    Width: =640
                    X: =0
                    Y: =0
                    ZIndex: =1

                lblStepDescription As htmlViewer:
                    AlignInContainer: =AlignInContainer.Stretch
                    AutoHeight: =true
                    Font: =Font.'Segoe UI'
                    HtmlText: =LookUp(colSetupSteps, ItemKey = configStep).ItemDescription
                    LayoutMinWidth: =100
                    PaddingLeft: =24
                    Width: =640
                    X: =40
                    Y: =40
                    ZIndex: =2

                conContentAll As groupContainer.horizontalAutoLayoutContainer:
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =24
                    PaddingRight: =Self.PaddingLeft
                    PaddingTop: =24
                    ZIndex: =4

                    conContentDocs As groupContainer.verticalAutoLayoutContainer:
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Visible: =configStep=1
                        ZIndex: =1

                        galDocs As gallery.galleryVertical:
                            BorderColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderColor: =RGBA(0, 120, 212, 1)
                            FocusedBorderThickness: =2
                            Items: |-
                                =Table(
                                    {
                                        header: "Documentation",
                                        url: "https://learn.microsoft.com/power-platform/guidance/coe/example-processes",
                                        description: "Learn how to use apps and flows to manage attendees for training events.",
                                        icon: '10330-icon-eBooks-Intune'
                                    },
                                     {
                                        header: "Instructor-led training content",
                                        url: "https://powerplatform.microsoft.com/en-au/instructor-led-training/",
                                        description: "Download Microsofts instructor led training content and host one-day workshops and classes on Power Apps, Power Automate, Power Virtual Agents, and Power BI.",
                                        icon: '10797-icon-Download-General'
                                    },
                                    {
                                        header: "Hackathon Planning workbook",
                                        url: "https://aka.ms/powerplatformhackathonworkbook",
                                        description: "If you are looking for more content on organizing and running successful Hackathons, check out the Hackathon Planning workbook",
                                        icon: IconLightBrandPowerPoint
                                    },
                                    {
                                        header: "Adoption Guidance",
                                        url: "https://adoption.microsoft.com/powerplatform",
                                        description: "If you are looking for more content on how to engage and train your org, check out our Adoption guidance.",
                                        icon: '02256-icon-Ruleset-menu'
                                    }
                                )
                            Layout: =Layout.Vertical
                            LayoutMinHeight: =287
                            LayoutMinWidth: =320
                            OnSelect: =Launch(ThisItem.url)
                            TemplateSize: =If(Self.Layout = Layout.Horizontal, Min(280, Self.Width - 60), Min(280, Self.Height - 60))
                            WrapCount: =4
                            ZIndex: =1

                            "Elevation3_1 As 'Fluent Elevation (1.0.18)'":
                                DisplayMode: =DisplayMode.Edit
                                Height: =conDocs.Height
                                HoverDepth: ='''PowerCAT.Elevation.HoverDepth'''.Depth8
                                Width: =conDocs.Width
                                X: =0+0
                                Y: =0+0
                                ZIndex: =1

                            conDocs As groupContainer.verticalAutoLayoutContainer:
                                Height: =Parent.TemplateHeight-20
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMode: =LayoutMode.Auto
                                Width: =Parent.TemplateWidth-20
                                X: =0+0
                                Y: =0+0
                                ZIndex: =2

                                conDocsHeader As groupContainer.horizontalAutoLayoutContainer:
                                    AlignInContainer: =AlignInContainer.SetByContainer
                                    FillPortions: =0
                                    Height: =48
                                    LayoutMinHeight: =100
                                    LayoutMinWidth: =250
                                    LayoutMode: =LayoutMode.Auto
                                    ZIndex: =1

                                    Image1_1 As image:
                                        BorderColor: =RGBA(0, 0, 0, 0)
                                        BorderStyle: =BorderStyle.None
                                        BorderThickness: =2
                                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                        DisabledFill: =RGBA(0, 0, 0, 0)
                                        Height: =48
                                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                                        HoverFill: =RGBA(0, 0, 0, 0)
                                        Image: =ThisItem.icon
                                        PaddingBottom: =10
                                        PaddingLeft: =10
                                        PaddingRight: =10
                                        PaddingTop: =10
                                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                                        PressedFill: =RGBA(0, 0, 0, 0)
                                        Width: =48
                                        ZIndex: =1

                                    Label2_1 As Label:
                                        AlignInContainer: =AlignInContainer.Stretch
                                        DisplayMode: =DisplayMode.Edit
                                        FontWeight: =FontWeight.Semibold
                                        Height: =32
                                        LayoutMinHeight: =32
                                        LayoutMinWidth: =100
                                        PaddingStart: =12
                                        Text: =ThisItem.header
                                        Width: =galDocs.TemplateWidth - Image1_1.Width - 20
                                        X: =0
                                        Y: =0
                                        ZIndex: =2

                                    "Icon7_6 As 'Fluent Icon (1.0.18)'":
                                        DisplayMode: =DisplayMode.Edit
                                        Height: =48
                                        IconName: ="OpenInNewWindow"
                                        IconSize: =20
                                        LayoutMinHeight: =200
                                        LayoutMinWidth: =200
                                        OnChange: =Launch(ThisItem.url, {}, LaunchTarget.New)
                                        Theme: =AppThemeJson
                                        Width: =40
                                        X: =0
                                        Y: =0
                                        ZIndex: =4

                                Rectangle2_16 As rectangle:
                                    BorderColor: =RGBA(166, 166, 166, 1)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    DisabledFill: =RGBA(166, 166, 166, 1)
                                    Fill: =ColorValue(AppTheme.palette.neutralLight)
                                    FocusedBorderColor: =RGBA(0, 120, 212, 1)
                                    Height: =1
                                    HoverFill: =RGBA(0, 120, 212, 1)
                                    PressedFill: =RGBA(0, 120, 212, 1)
                                    Width: =1
                                    ZIndex: =2

                                conAppsBody_1 As groupContainer.verticalAutoLayoutContainer:
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutMinHeight: =100
                                    LayoutMinWidth: =250
                                    LayoutMode: =LayoutMode.Auto
                                    PaddingBottom: =Self.PaddingTop
                                    PaddingLeft: =16
                                    PaddingRight: =Self.PaddingLeft
                                    PaddingTop: =12
                                    ZIndex: =3

                                    Label4_1 As Label:
                                        DisplayMode: =DisplayMode.Edit
                                        FillPortions: =1
                                        Height: =32
                                        LayoutMinHeight: =32
                                        LayoutMinWidth: =100
                                        Text: =ThisItem.description
                                        VerticalAlignment: =VerticalAlign.Top
                                        Width: =galDocs.TemplateWidth - 50
                                        X: =0
                                        Y: =0
                                        ZIndex: =1

                                    Button2 As Button:
                                        AlignInContainer: =AlignInContainer.End
                                        ButtonType: ='''Microsoft.CoreControls.Button.ButtonType'''.Standard
                                        DisplayMode: =DisplayMode.Edit
                                        Height: =32
                                        LayoutMinHeight: =32
                                        LayoutMinWidth: =96
                                        OnSelect: =Launch(ThisItem.url)
                                        Text: ="Learn more"
                                        TextColor: =ColorValue(AppTheme.palette.themePrimary)
                                        Width: =96
                                        X: =0
                                        Y: =0
                                        ZIndex: =2

                    conContentForm As groupContainer.verticalAutoLayoutContainer:
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Visible: =configStep=2
                        ZIndex: =2

                        galFeedbackForm As gallery.galleryVertical:
                            BorderColor: =RGBA(166, 166, 166, 1)
                            Height: =200
                            Items: |-
                                =Table(
                                    {
                                        Value: "Open the template form.",
                                        Status: "Open form",
                                        URL: "https://forms.office.com/Pages/ShareFormPage.aspx?id=v4j5cvGGr0GRqy180BHbR8FBqAfISVJDqMM6DZbPmghUMUxUS1EwSVkxRExKVzdET1lZTTdWQ0FaOS4u&sharetoken=xjgXNluBcJOrLb2xg0TI"
                                    },
                                    {
                                        Value: "Select duplicate it.",
                                        Status: "",
                                        URL: ""
                                    },
                                    {
                                        Value: "Edit the form to add your own questions and theme",
                                        Status: "",
                                        URL: ""
                                    },
                                    {
                                        Value: "Select Share and copy the link for Send and collect responses",
                                        Status: "",
                                        URL: ""
                                    }
                                )
                            Layout: =Layout.Vertical
                            LayoutMinHeight: =287
                            LayoutMinWidth: =320
                            TemplateFill: =ColorValue(AppTheme.palette.white)
                            TemplateSize: =50
                            Width: =conContentVariables.Width
                            ZIndex: =4

                            Rectangle4_4 As rectangle:
                                BorderColor: =RGBA(166, 166, 166, 1)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                DisabledFill: =RGBA(166, 166, 166, 1)
                                Fill: =ColorValue(AppTheme.palette.neutralLight)
                                FocusedBorderColor: =RGBA(0, 120, 212, 1)
                                Height: =1
                                HoverFill: =ColorValue(AppTheme.palette.neutralLight)
                                OnSelect: =Select(Parent)
                                PressedFill: =ColorValue(AppTheme.palette.neutralLight)
                                Width: =galFeedbackForm.TemplateWidth
                                ZIndex: =5

                            Container1 As groupContainer.horizontalAutoLayoutContainer:
                                Height: =50
                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                LayoutMode: =LayoutMode.Auto
                                Width: =galFeedbackForm.TemplateWidth
                                ZIndex: =7

                                lblEnvVarTitle_1 As label:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(51, 51, 51, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(166, 166, 166, 1)
                                    FillPortions: =1
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    Height: =50
                                    OnSelect: =
                                    Size: =10
                                    Text: =ThisItem.Value
                                    Width: =350
                                    ZIndex: =1

                                Button3 As Button:
                                    AlignInContainer: =AlignInContainer.Center
                                    ButtonType: ='''Microsoft.CoreControls.Button.ButtonType'''.Standard
                                    DisplayMode: =DisplayMode.Edit
                                    Height: =40
                                    LayoutMinHeight: =32
                                    LayoutMinWidth: =96
                                    OnSelect: =Launch(ThisItem.URL)
                                    Text: ="Open form"
                                    TextColor: =ColorValue(AppTheme.palette.themePrimary)
                                    Visible: =!IsBlank(ThisItem.URL)
                                    Width: =96
                                    X: =40
                                    Y: =40
                                    ZIndex: =2

                    conContentVariables As groupContainer.verticalAutoLayoutContainer:
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Visible: =configStep=3
                        ZIndex: =3

                        conVariables As groupContainer.verticalAutoLayoutContainer:
                            LayoutAlignItems: =LayoutAlignItems.Stretch
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            LayoutOverflowY: =LayoutOverflow.Scroll
                            ZIndex: =1

                            galMandatoryEnvVars As gallery.galleryVertical:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                BorderColor: =RGBA(166, 166, 166, 1)
                                Height: =200
                                Items: =Filter('Environment Variable Definitions', Or("Training" in 'Display Name', "Community" in 'Display Name'))
                                Layout: =Layout.Vertical
                                LayoutMinHeight: =287
                                LayoutMinWidth: =320
                                TemplateFill: =ColorValue(AppTheme.palette.white)
                                TemplatePadding: =10
                                TemplateSize: =If(Self.Layout = Layout.Horizontal, Min(60, Self.Width - 60), Min(80, Self.Height - 60))
                                Width: =conContentVariables.Width
                                ZIndex: =9

                                lblEnvVarTitle As label:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(51, 51, 51, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(166, 166, 166, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    OnSelect: =Select(Parent)
                                    Size: =10
                                    Text: =ThisItem.'Display Name'
                                    Width: =350
                                    ZIndex: =2

                                txtEnvVarValue As text:
                                    BorderColor: =RGBA(128, 128, 128, 1)
                                    Color: =RGBA(51, 51, 51, 1)
                                    Default: =ThisItem.'Default Value'
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(166, 166, 166, 1)
                                    DisabledFill: =RGBA(244, 244, 244, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    HintText: =""
                                    HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                                    HoverColor: =RGBA(51, 51, 51, 1)
                                    HoverFill: =RGBA(255, 255, 255, 1)
                                    OnSelect: =Select(Parent)
                                    PressedBorderColor: =RGBA(105, 121, 126, 1)
                                    PressedColor: =RGBA(51, 51, 51, 1)
                                    PressedFill: =RGBA(255, 255, 255, 1)
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Size: =10
                                    Width: =416
                                    X: =galMandatoryEnvVars.Width - txtEnvVarValue.Width - galMandatoryEnvVars.TemplatePadding - 20
                                    Y: =galMandatoryEnvVars.TemplateHeight / 2 - txtEnvVarValue.Height / 2
                                    ZIndex: =3

                                lblEnvVarDescription As label:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(51, 51, 51, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(166, 166, 166, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    OnSelect: =Select(Parent)
                                    Size: =10
                                    Text: =Substitute(ThisItem.Description, "REQUIRED. ", "")
                                    VerticalAlign: =VerticalAlign.Top
                                    Width: =galMandatoryEnvVars.TemplateWidth - txtEnvVarValue.Width - 50   
                                    Y: =lblEnvVarTitle.Height
                                    ZIndex: =4

                                Rectangle4_3 As rectangle:
                                    BorderColor: =RGBA(166, 166, 166, 1)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    DisabledFill: =RGBA(166, 166, 166, 1)
                                    Fill: =ColorValue(AppTheme.palette.neutralLight)
                                    FocusedBorderColor: =RGBA(0, 120, 212, 1)
                                    Height: =1
                                    HoverFill: =ColorValue(AppTheme.palette.neutralLight)
                                    OnSelect: =Select(Parent)
                                    PressedFill: =ColorValue(AppTheme.palette.neutralLight)
                                    Width: =galMandatoryEnvVars.TemplateWidth
                                    ZIndex: =5

                                lblEnvVarSchema As label:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(51, 51, 51, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(166, 166, 166, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    Height: =0
                                    OnSelect: =Select(Parent)
                                    Size: =10
                                    Text: =ThisItem.'Schema Name'
                                    VerticalAlign: =VerticalAlign.Top
                                    Width: =0
                                    X: =1
                                    Y: =lblEnvVarTitle.Height
                                    ZIndex: =6

                    conContentOtherFlows As groupContainer.verticalAutoLayoutContainer:
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Visible: =configStep=4
                        ZIndex: =4

                        galOtherFlows As gallery.galleryVertical:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderColor: =RGBA(0, 120, 212, 1)
                            FocusedBorderThickness: =2
                            Items: =FlowsWithMetadata
                            Layout: =Layout.Vertical
                            LayoutMinHeight: =287
                            LayoutMinWidth: =320
                            TemplateSize: |
                                =48
                            ZIndex: =1

                            conInventoryFlows_2 As groupContainer.horizontalAutoLayoutContainer:
                                Height: =Parent.TemplateHeight
                                LayoutMode: =LayoutMode.Auto
                                Width: =Parent.TemplateWidth
                                X: =0+0
                                Y: =0+0
                                ZIndex: =1

                                "icoInventoryFlow_2 As 'Fluent Icon (1.0.18)'":
                                    DisplayMode: =DisplayMode.Edit
                                    Height: =48
                                    IconName: ="Flow"
                                    LayoutMinHeight: =200
                                    LayoutMinWidth: =200
                                    Theme: =AppThemeJson
                                    Width: =40
                                    X: =0
                                    Y: =0
                                    ZIndex: =1

                                lblInventoryFlow_2 As Label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    DisplayMode: =DisplayMode.Edit
                                    FillPortions: =1
                                    Height: =32
                                    LayoutMinHeight: =32
                                    LayoutMinWidth: =100
                                    Text: =ThisItem.theName
                                    Width: =320
                                    X: =0
                                    Y: =0
                                    ZIndex: =2

                                togInventoryFlow_2 As Toggle:
                                    AlignInContainer: =AlignInContainer.Center
                                    Checked: |-
                                        =And(
                                            ThisItem.thePublishedState = [@'Component State'].Published,
                                            !ThisItem.theIsErrorState,
                                            Text(ThisItem.theState) = "Activated"
                                        )
                                    DisplayMode: =DisplayMode.Edit
                                    Height: =32
                                    LayoutMinHeight: =32
                                    LayoutMinWidth: =160
                                    OnCheck: |-
                                        =IfError(Patch(
                                            Processes,
                                            LookUp(Processes, WorkflowIdUnique = ThisItem.theGUID), 
                                            {
                                                Status: 'Status (Processes)'.Activated
                                            }
                                        ),Notify("Failed to turn on this flow. Open the Power Automate details page and turn on the flow there.", Error))
                                        
                                        /* UpdateContext({flowPass: 'CommandCenterApp>SetCoEFlowsState'.Run(coeEnv, true, ThisItem.theGUID).return = "pass"});
                                        If(flowPass, 
                                            UpdateIf(FlowsWithMetadata, theGUID=ThisItem.theGUID, {theState: 'Status (Processes)'.Activated}), 
                                            UpdateIf(FlowsWithMetadata, theGUID=ThisItem.theGUID, {theIsErrorState: true}));
                                        If(flowPass, Notify("This flow has been turned on successfully", Success), Notify("Failed to turn on this flow. Open the Power Automate details page and turn on the flow there.", Error)) */
                                    Width: =100
                                    X: =0
                                    Y: =0
                                    ZIndex: =3

                            Rectangle2_15 As rectangle:
                                BorderColor: =RGBA(166, 166, 166, 1)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                DisabledFill: =RGBA(166, 166, 166, 1)
                                Fill: =ColorValue(AppTheme.palette.neutralLight)
                                FocusedBorderColor: =RGBA(0, 120, 212, 1)
                                Height: =1
                                HoverFill: =RGBA(0, 120, 212, 1)
                                PressedFill: =RGBA(0, 120, 212, 1)
                                Width: =Parent.TemplateWidth
                                Y: =47
                                ZIndex: =2

                    conContentApps As groupContainer.verticalAutoLayoutContainer:
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =24
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Visible: =configStep=5
                        ZIndex: =5

                        galApps As gallery.galleryVertical:
                            BorderColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderColor: =RGBA(0, 120, 212, 1)
                            FocusedBorderThickness: =2
                            Items: =Filter('CoE Solution Metadata', ObjectType = "CanvasApp", CoESolution = "Nurture", Or("Training" in ObjectName, "Nurture" in ObjectName), !("deprecated" in ObjectName))
                            Layout: =Layout.Vertical
                            LayoutMinHeight: =287
                            LayoutMinWidth: =320
                            TemplateSize: =If(Self.Layout = Layout.Horizontal, Min(280, Self.Width - 60), Min(280, Self.Height - 60))
                            WrapCount: =3
                            ZIndex: =1

                            "Elevation3_2 As 'Fluent Elevation (1.0.18)'":
                                DisplayMode: =DisplayMode.Edit
                                Height: =conApps_1.Height
                                HoverDepth: ='''PowerCAT.Elevation.HoverDepth'''.Depth8
                                Width: =conApps_1.Width
                                X: =0+0
                                Y: =0+0
                                ZIndex: =1

                            conApps_1 As groupContainer.verticalAutoLayoutContainer:
                                Height: =Parent.TemplateHeight-20
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMode: =LayoutMode.Auto
                                Width: =Parent.TemplateWidth-20
                                X: =0+0
                                Y: =0+0
                                ZIndex: =2

                                conAppsHeader_1 As groupContainer.horizontalAutoLayoutContainer:
                                    FillPortions: =0
                                    Height: =48
                                    LayoutMinHeight: =100
                                    LayoutMinWidth: =250
                                    LayoutMode: =LayoutMode.Auto
                                    ZIndex: =1

                                    Image1_2 As image:
                                        BorderColor: =RGBA(0, 0, 0, 0)
                                        BorderStyle: =BorderStyle.None
                                        BorderThickness: =2
                                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                        DisabledFill: =RGBA(0, 0, 0, 0)
                                        Fill: =White
                                        Height: =48
                                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                                        HoverFill: =RGBA(0, 0, 0, 0)
                                        Image: =PowerApps_scalable
                                        PaddingBottom: =5
                                        PaddingLeft: =5
                                        PaddingRight: =5
                                        PaddingTop: =5
                                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                                        PressedFill: =RGBA(0, 0, 0, 0)
                                        Width: =48
                                        ZIndex: =1

                                    Label2_2 As Label:
                                        AlignInContainer: =AlignInContainer.Stretch
                                        DisplayMode: =DisplayMode.Edit
                                        FillPortions: =1
                                        FontWeight: =FontWeight.Semibold
                                        Height: =32
                                        LayoutMinHeight: =32
                                        LayoutMinWidth: =100
                                        PaddingStart: =12
                                        Text: =ThisItem.ObjectName
                                        Width: =320
                                        X: =0
                                        Y: =0
                                        ZIndex: =2

                                    "Icon7_2 As 'Fluent Icon (1.0.18)'":
                                        DisplayMode: =DisplayMode.Edit
                                        Height: =48
                                        IconName: ="Share"
                                        IconSize: =20
                                        LayoutMinHeight: =200
                                        LayoutMinWidth: =200
                                        OnChange: =Launch(coeAppMakerURL & "environments/" & coeEnv & "/apps/" & ThisItem.ObjectGUID & "/share", {}, LaunchTarget.New)
                                        Theme: =AppThemeJson
                                        Width: =40
                                        X: =0
                                        Y: =0
                                        ZIndex: =3

                                    "Icon7_4 As 'Fluent Icon (1.0.18)'":
                                        DisplayMode: =DisplayMode.Edit
                                        Height: =48
                                        IconName: ="Info"
                                        IconSize: =20
                                        LayoutMinHeight: =200
                                        LayoutMinWidth: =200
                                        OnChange: =Launch(ThisItem.HelpLink, {}, LaunchTarget.New)
                                        Theme: =AppThemeJson
                                        Width: =40
                                        X: =0
                                        Y: =0
                                        ZIndex: =4

                                Rectangle2_12 As rectangle:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    BorderColor: =RGBA(166, 166, 166, 1)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    DisabledFill: =RGBA(166, 166, 166, 1)
                                    Fill: =ColorValue(AppTheme.palette.neutralLight)
                                    FocusedBorderColor: =RGBA(0, 120, 212, 1)
                                    Height: =1
                                    HoverFill: =RGBA(0, 120, 212, 1)
                                    PressedFill: =RGBA(0, 120, 212, 1)
                                    Width: =1
                                    ZIndex: =2

                                conAppsBody_2 As groupContainer.verticalAutoLayoutContainer:
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutMinHeight: =100
                                    LayoutMinWidth: =250
                                    LayoutMode: =LayoutMode.Auto
                                    PaddingBottom: =Self.PaddingTop
                                    PaddingLeft: =16
                                    PaddingRight: =Self.PaddingLeft
                                    PaddingTop: =12
                                    ZIndex: =3

                                    Label4_2 As Label:
                                        AlignInContainer: =AlignInContainer.Stretch
                                        DisplayMode: =DisplayMode.Edit
                                        FillPortions: =1
                                        Height: =32
                                        LayoutMinHeight: =32
                                        LayoutMinWidth: =100
                                        Text: =LookUp('Canvas Apps', DisplayName = ThisItem.ObjectName).'The description.'
                                        VerticalAlignment: =VerticalAlign.Top
                                        Width: =
                                        X: =0
                                        Y: =0
                                        ZIndex: =1

                                    lblAppPersona As label:
                                        Align: =Align.Center
                                        Color: =RGBA(51, 51, 51, 1)
                                        DisabledColor: =RGBA(166, 166, 166, 1)
                                        Fill: =ColorValue(AppTheme.palette.neutralLight)
                                        Font: =Font.'Segoe UI'
                                        Height: =25
                                        OnSelect: =
                                        PaddingBottom: =0
                                        PaddingLeft: =10
                                        PaddingRight: =10
                                        PaddingTop: =0
                                        Size: =10
                                        Text: =ThisItem.Persona
                                        Width: =60
                                        Wrap: =false
                                        X: =10
                                        Y: =galApps.TemplateHeight - lblAppPersona.Height - 10
                                        ZIndex: =2

                Rectangle2_2 As rectangle:
                    AlignInContainer: =AlignInContainer.Stretch
                    BorderColor: =RGBA(166, 166, 166, 1)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledFill: =RGBA(166, 166, 166, 1)
                    Fill: =ColorValue(AppTheme.palette.neutralLight)
                    FocusedBorderColor: =RGBA(0, 120, 212, 1)
                    Height: =1
                    HoverFill: =RGBA(0, 120, 212, 1)
                    PressedFill: =RGBA(0, 120, 212, 1)
                    ZIndex: =5

                conMainNav As groupContainer.horizontalAutoLayoutContainer:
                    FillPortions: =0
                    Height: =80
                    LayoutGap: =24
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =conContentAll.PaddingLeft
                    ZIndex: =6

                    btnBack As Button:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =ColorValue(AppTheme.palette.neutralPrimary)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        ButtonType: ='''Microsoft.CoreControls.Button.ButtonType'''.Standard
                        DisplayMode: |-
                            =If(
                                configStep=1,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        OnSelect: |-
                            =If(
                                configStep>1,
                                With(
                                    {
                                        nextConfigStep: configStep-1
                                    },
                            
                                    // Go to the next step.
                                    Set(configStep,nextConfigStep)
                                )
                            )
                        Text: ="Back"
                        Width: =72
                        X: =40
                        Y: =40
                        ZIndex: =1

                    btnNext As Button:
                        AlignInContainer: =AlignInContainer.Center
                        DisplayMode: =DisplayMode.Edit
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        OnSelect: |-
                            =With(
                                {
                                    nextConfigStep: configStep+1,
                                    maxConfigStep: Max(colSetupSteps,Value(ItemKey))
                                },
                                If(
                                    configStep<maxConfigStep,
                            
                                    Switch(
                                        nextConfigStep,
                                        4,
                                          Clear(colMandatoryEnvVars);
                            ForAll(
                                galMandatoryEnvVars.AllItems,
                                Collect(
                                    colMandatoryEnvVars,
                                    {
                                        'Schema Name': ThisRecord.lblEnvVarSchema.Text,
                                        Value: ThisRecord.txtEnvVarValue.Text
                                    }
                                )
                            );
                            ForAll(
                                colMandatoryEnvVars As aPatch,
                                Patch(
                                    [@'Environment Variable Values'],
                                    Defaults([@'Environment Variable Values']),
                                    {
                                        'Schema Name': aPatch.'Schema Name',
                                        Value: aPatch.Value
                                    }
                                )
                            );
                                    );
                            
                                    // Complete the current step.
                                    If(
                                        !(configStep exactin colStepsCompleted.Value),
                                        Collect(colStepsCompleted,configStep)
                                    );
                            
                                    // Go to the next step.
                                    Set(configStep,nextConfigStep)
                                )
                            )
                        Text: ="Next"
                        Visible: =configStep<>Max(colSetupSteps,Value(ItemKey))
                        Width: =72
                        X: =0
                        Y: =0
                        ZIndex: =2

    panHelp As Panel:
        Buttons: |-
            =/*Table(
                {
                    Label: "Cancel",
                    ButtonType: 'Microsoft.CoreControls.Button.ButtonType'.Standard
                },
                {
                    Label: "Ok",
                    ButtonType: 'Microsoft.CoreControls.Button.ButtonType'.Primary
                }
            )*/
        Fill: =panHelp.OverlayColor
        OnCloseSelect: |-
            =UpdateContext({showHelp: false})
        Subtitle: ="Explore these links to documentation and filing issues."
        Theme: =AppTheme
        Title: ="Help"
        Visible: =showHelp
        Width: =Parent.Width
        ZIndex: =2

    conHelpPanel As groupContainer.verticalAutoLayoutContainer:
        Height: =panHelp.ContentHeight-40
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Visible: =panHelp.Visible
        Width: =panHelp.ContentWidth-20
        X: =panHelp.ContentX
        Y: =panHelp.ContentY+20
        ZIndex: =3

        galLinks As gallery.galleryVertical:
            BorderColor: =RGBA(166, 166, 166, 1)
            FocusedBorderColor: =RGBA(0, 120, 212, 1)
            FocusedBorderThickness: =2
            Height: =panHelp.ContentHeight
            Items: |-
                =Table(
                    {
                        value: "Documentation",
                        url: "https://aka.ms/coestarterkit"
                    },
                    {
                        value: "Power Platform guidance",
                        url: "https://learn.microsoft.com/en-us/power-platform/guidance/"
                    },
                    {
                        value: "Walkthrough Videos",
                        url: "https://aka.ms/coekitvideos"
                    },
                    {
                        value: "Latest release",
                        url: "https://github.com/microsoft/coe-starter-kit/releases/latest"
                    },
                    {
                        value: "Raise an issue, question or feature ask",
                        url: "https://github.com/microsoft/coe-starter-kit/issues/new/choose"
                    },
                    {
                        value: "Office hours",
                        url: "https://aka.ms/coeofficehours"
                    }
                )
            Layout: =Layout.Vertical
            LayoutMinHeight: =287
            LayoutMinWidth: =320
            TemplateSize: =40
            Visible: =showHelp
            Width: =panHelp.ContentWidth - 10
            X: =panHelp.ContentX
            Y: =panHelp.ContentY + 10
            ZIndex: =2

            btnHelpLink As Button:
                Alignment: =Align.Left
                ButtonType: ='''Microsoft.CoreControls.Button.ButtonType'''.Standard
                DisplayMode: =DisplayMode.Edit
                Height: =32
                OnSelect: =Launch(ThisItem.url)
                Text: =ThisItem.value
                TextColor: =ColorValue(AppTheme.palette.themePrimary)
                Width: =galLinks.TemplateWidth
                X: =0
                Y: =0
                ZIndex: =1

    dialogCantProceed As Dialog:
        Buttons: =
        DialogHeight: =450
        DialogWidth: =800
        Fill: =dialogCantProceed.OverlayColor
        Height: ='Setup Wizard Screen'.Height
        OnCloseSelect: =false
        SubTitle: ="Finish the Initial Setup first before proceeding. Use the 'Initial Setup' page to set up the inventory (core) components. Then import the Nurture components solution (CenterofExcellenceNurtureComponents) that you find in your CoEStarterKit.zip file. Check out the documentation and video below to learn more about this feature."
        Title: ="Missing prerequisite"
        Visible: =IsBlank(LookUp(Solutions, Name = "CenterofExcellenceNurtureComponents"))
        Width: ='Setup Wizard Screen'.Width
        ZIndex: =4

    galDocs_1 As gallery.galleryVertical:
        BorderColor: =RGBA(166, 166, 166, 1)
        FocusedBorderColor: =RGBA(0, 120, 212, 1)
        FocusedBorderThickness: =2
        Height: =dialogCantProceed.ContentHeight - 60
        Items: |-
            =Table(
                    {
                    header: "Import Nurture components",
                    url: "https://learn.microsoft.com/power-platform/guidance/coe/setup-nurture-components#import-the-solution",
                    description: "Import the Nurture components solution before continuing.",
                    icon: '10330-icon-eBooks-Intune'
                },
                {
                    header: "Documentation",
                    url: "https://learn.microsoft.com/power-platform/guidance/coe/example-processes",
                    description: "Learn how to use apps and flows to manage attendees for training events.",
                    icon: '10330-icon-eBooks-Intune'
                }
            )
        Layout: =Layout.Vertical
        ShowScrollbar: =false
        TemplateSize: =220
        Visible: =IsBlank(LookUp(Solutions, Name = "CenterofExcellenceNurtureComponents"))
        Width: =dialogCantProceed.ContentWidth
        WrapCount: =2
        X: =dialogCantProceed.ContentX + 10
        Y: =dialogCantProceed.ContentY + 80
        ZIndex: =5

        "Elevation3_3 As 'Fluent Elevation (1.0.18)'":
            DisplayMode: =DisplayMode.Edit
            Height: =conDocs_1.Height
            HoverDepth: ='''PowerCAT.Elevation.HoverDepth'''.Depth8
            Width: =conDocs_1.Width
            X: =0+0
            Y: =0+0
            ZIndex: =1

        conDocs_1 As groupContainer.verticalAutoLayoutContainer:
            Height: =Parent.TemplateHeight-20
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMode: =LayoutMode.Auto
            Width: =Parent.TemplateWidth-20
            X: =0+0
            Y: =0+0
            ZIndex: =2

            conDocsHeader_1 As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =48
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =1

                Image1_3 As image:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    Height: =48
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Image: =ThisItem.icon
                    PaddingBottom: =10
                    PaddingLeft: =10
                    PaddingRight: =10
                    PaddingTop: =10
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Width: =48
                    ZIndex: =1

                Label2_3 As Label:
                    AlignInContainer: =AlignInContainer.Stretch
                    DisplayMode: =DisplayMode.Edit
                    FontWeight: =FontWeight.Semibold
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =100
                    PaddingStart: =12
                    Text: =ThisItem.header
                    Width: =galDocs_1.TemplateWidth - Image1_3.Width - 20
                    X: =0
                    Y: =0
                    ZIndex: =2

                "Icon7_7 As 'Fluent Icon (1.0.18)'":
                    DisplayMode: =DisplayMode.Edit
                    Height: =48
                    IconName: ="OpenInNewWindow"
                    IconSize: =20
                    LayoutMinHeight: =200
                    LayoutMinWidth: =200
                    OnChange: =Launch(ThisItem.url, {}, LaunchTarget.New)
                    Theme: =AppThemeJson
                    Width: =40
                    X: =0
                    Y: =0
                    ZIndex: =4

            Rectangle2_17 As rectangle:
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledFill: =RGBA(166, 166, 166, 1)
                Fill: =ColorValue(AppTheme.palette.neutralLight)
                FocusedBorderColor: =RGBA(0, 120, 212, 1)
                Height: =1
                HoverFill: =RGBA(0, 120, 212, 1)
                PressedFill: =RGBA(0, 120, 212, 1)
                Width: =1
                ZIndex: =2

            conAppsBody_3 As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =Self.PaddingTop
                PaddingLeft: =16
                PaddingRight: =Self.PaddingLeft
                PaddingTop: =12
                ZIndex: =3

                Label4_3 As Label:
                    AlignInContainer: =AlignInContainer.Start
                    DisplayMode: =DisplayMode.Edit
                    FillPortions: =1
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =100
                    Text: =ThisItem.description
                    VerticalAlignment: =VerticalAlign.Top
                    Width: =galDocs_1.TemplateWidth - 50
                    X: =0
                    Y: =0
                    ZIndex: =1

                Button2_2 As Button:
                    AlignInContainer: =AlignInContainer.End
                    ButtonType: ='''Microsoft.CoreControls.Button.ButtonType'''.Standard
                    DisplayMode: =DisplayMode.Edit
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    OnSelect: =Launch(ThisItem.url)
                    Text: ="Learn more"
                    TextColor: =ColorValue(AppTheme.palette.themePrimary)
                    Width: =96
                    X: =0
                    Y: =0
                    ZIndex: =2

