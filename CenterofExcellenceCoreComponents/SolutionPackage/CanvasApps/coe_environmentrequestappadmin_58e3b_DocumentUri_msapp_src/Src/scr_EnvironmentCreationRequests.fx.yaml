"scr_EnvironmentCreationRequests As screen.'tabletAutoLayout_HeaderMainFooter_ver1.0'":
    LoadingSpinnerColor: =RGBA(105, 121, 126, 1)
    OnVisible: |-
        =If( !var_initialized,
            
            Select(btn_refresh);
        
            UpdateContext({ var_initialized: true });
        );
        
        Clear(col_policyImpact); Clear(col_requestedConnectors); Clear(col_requestedMakers); Clear(col_selectedPolicies); Clear(col_selectedIncludeEnvironments);
        ClearCollect(col_pendingECRs, Filter('Environment Creation Requests', 'Environment Creation Requests (Views)'.'Pending Environment Creation Requests'));
        Patch( col_nav, First(col_nav), { Notifications: CountRows(col_pendingECRs) });

    c_screen As groupContainer.verticalAutoLayoutContainer:
        DisplayMode: =DisplayMode.Edit
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        Width: =App.Width
        ZIndex: =1

        HeaderContainer2 As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(52, 60, 63, 1)
            FillPortions: =0
            Height: =50
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            Visible: =Text(Param("hideNavBar")) = "true"
            ZIndex: =2

            lbl_mainheader As label:
                AlignInContainer: =AlignInContainer.Stretch
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(255, 255, 255, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(68, 68, 68, 1)
                FillPortions: =1
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                PaddingLeft: =20
                Text: ="Power Platform Resource Request Management System | Admin"
                ZIndex: =1

        MainSectionContainer2 As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DisplayMode: =DisplayMode.Edit
            LayoutDirection: =LayoutDirection.Horizontal
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            ZIndex: =3

            Navigation_1 As Navigation:
                AlignInContainer: =AlignInContainer.Stretch
                Items: =col_nav
                LayoutMinHeight: =600
                LayoutMinWidth: =640
                Width: =If(Navigation_1.IsExpanded, 200, 60)

            Rectangle2_8 As rectangle:
                AlignInContainer: =AlignInContainer.Stretch
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                Fill: =RGBA(210, 208, 206, 1)
                FocusedBorderThickness: =4
                Height: =1
                Visible: =false
                Width: =1
                ZIndex: =2

            c_mainContent As groupContainer.verticalAutoLayoutContainer:
                DisplayMode: =DisplayMode.Edit
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                ZIndex: =3

                Container5 As groupContainer.horizontalAutoLayoutContainer:
                    DisplayMode: =DisplayMode.Edit
                    Fill: =RGBA(243, 242, 241, 1)
                    FillPortions: =0
                    Height: =50
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    PaddingLeft: =30
                    ZIndex: =2

                    c_action_refresh As groupContainer.manualLayoutContainer:
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =0
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutMinHeight: =50
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Manual
                        Width: =110
                        ZIndex: =1

                        Label10_1 As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =50
                            PaddingLeft: =10
                            Text: ="Refresh"
                            Width: =Parent.Width - Self.X
                            X: =icn_refresh_3.X + icn_refresh_3.Width
                            ZIndex: =1

                        icn_refresh_3 As icon.Reload:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Color: =var_powerappspurple
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(220, 220, 220, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            DisplayMode: =DisplayMode.View
                            FocusedBorderThickness: =0
                            Height: =50
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =Self.Fill
                            HoverFill: =RGBA(0, 0, 0, 0)
                            Icon: =Icon.Reload
                            OnSelect: =
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Width: =16
                            X: =10
                            ZIndex: =2

                        btn_refresh As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderThickness: =0
                            Color: =RGBA(0, 0, 0, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            Fill: =RGBA(0,0,0,0)
                            FocusedBorderColor: =Self.Fill
                            FocusedBorderThickness: =0
                            Font: =Font.'Segoe UI'
                            FontWeight: =Normal
                            Height: =Parent.Height
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(0, 0, 0, 0.1)
                            OnSelect: |-
                                =UpdateContext({var_pagesize:1000,var_loading: true });Refresh('Environment Creation Requests');Concurrent(
                                    ClearCollect(col_requestStatuses, Choices('Environment Creation Requests'.'Request status'));
                                    ,
                                    /* Get policies */
                                ClearCollect(col_allPoliciesv2,AddColumns(Filter(PowerPlatformforAdmins.ListPoliciesV2().value,environmentType<>"SingleEnvironment"),"blocked",LookUp(connectorGroups,classification="Blocked").connectors,"general",LookUp(connectorGroups,classification="General").connectors,"confidential",LookUp(connectorGroups,classification="Confidential").connectors));ClearCollect(col_allPolicieswithConflicts,Filter(col_allPoliciesv2,!IsEmpty(general)&&!IsEmpty(confidential)));ClearCollect(col_allNonIncludePolicies,Filter(col_allPoliciesv2,environmentType<>"OnlyEnvironments"));,
                                    /* Get Environments */
                                UpdateContext({var_getEnvResponse:PowerPlatformforAdmins.GetAdminEnvironment({'$top':var_pagesize})});ClearCollect(col_allEnvironments,var_getEnvResponse.value);Select(btn_getNextPageENV);// copy and paste this line to load more environments on start
                                
                                    /* Get standard connectors */
                                ClearCollect(col_connectors,PowerAppsforMakers.GetConnectors({'$filter':"environment eq '"&First(col_allEnvironments).name&"'",'$top':1000}).value);,
                                    /* Get Environment regions*/
                                ClearCollect(col_regions,AddColumns(PowerPlatformforAdmins.ListSupportedLocations().value,"DisplayName",properties.displayName&If(properties.isDefault," (default)")));
                                    /* Get all currencies and languages from the first Environment */
                                Concurrent(ClearCollect(col_currencies,{name:""},AddColumns(PowerPlatformforAdmins.ListEnvironmentCurrencies(First(col_regions).name).value,"DisplayName",properties.localizedName)),ClearCollect(col_languages,{name:""},AddColumns(PowerPlatformforAdmins.ListEnvironmentLanguages(First(col_regions).name).value,"DisplayName",properties.displayName)));,
                                    /* Get entire existing makers table */
                                ClearCollect(col_allmakers,Makers);,Set(var_myProfile,Office365Users.MyProfileV2());Set(var_myUserRecord,LookUp(Users,azureactivedirectoryobjectid=GUID(var_myProfile.id)));,ClearCollect(col_pendingECRs,Filter('Environment Creation Requests','Environment Creation Requests (Views)'.'Pending Environment Creation Requests'));Patch(col_nav,First(col_nav),{Notifications:CountRows(col_pendingECRs)});,Set(var_today,Today());,ClearCollect(col_groups,Filter(Office365Groups.ListOwnedGroupsV3().value,securityEnabled)););UpdateContext({var_loading: false });
                            PaddingLeft: =10
                            PressedBorderColor: =ColorFade(Self.BorderColor, 0%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =ColorFade(Self.Fill, -20%)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: =""
                            Width: =Parent.Width
                            ZIndex: =3

                    c_action_extend As groupContainer.manualLayoutContainer:
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =0
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutMinHeight: =50
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Manual
                        Width: =90
                        ZIndex: =2

                        img_btn_view As image:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            FocusedBorderThickness: =4
                            Height: =50
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverFill: =RGBA(0, 0, 0, 0)
                            Image: |-
                                ="data:image/svg+xml;utf8, " & EncodeUrl("
                                <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2048 2048'>
                                  <path d='M1024 768q79 0 149 30t122 82 83 123 30 149q0 80-30 149t-82 122-123 83-149 30q-80 0-149-30t-122-82-83-122-30-150q0-79 30-149t82-122 122-83 150-30zm0 640q53 0 99-20t82-55 55-81 20-100q0-53-20-99t-55-82-81-55-100-20q-53 0-99 20t-82 55-55 81-20 100q0 53 20 99t55 82 81 55 100 20zm0-1152q143 0 284 35t266 105 226 170 166 234q40 83 61 171t21 181h-128q0-118-36-221t-99-188-150-152-185-113-209-70-217-24q-108 0-217 24t-208 70-186 113-149 152-100 188-36 221H0q0-92 21-180t61-172q64-132 165-233t227-171 266-104 284-36z' fill='#742774' /></svg>")
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Width: =20
                            X: =10
                            ZIndex: =1

                        lbl_btn_view As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =Normal
                            Height: =50
                            PaddingLeft: =10
                            Text: ="View"
                            Width: =Parent.Width - Self.X
                            X: =img_btn_view.X + img_btn_view.Width
                            ZIndex: =2

                        btn_newecr_6 As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderThickness: =0
                            Color: =RGBA(0, 0, 0, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            Fill: =RGBA(0,0,0,0)
                            FocusedBorderColor: =Self.Fill
                            FocusedBorderThickness: =0
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Lighter
                            Height: =Parent.Height
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(0, 0, 0, 0.1)
                            OnSelect: |-
                                =Set(var_selectedCreateReq, gal_ecrs.Selected); Clear(col_selectedPolicies);
                                ClearCollect( col_requestedConnectors, gal_ecrs.Selected.'PowerApps Connectors');
                                Collect( col_requestedMakers, LookUp(Makers, Maker=gal_ecrs.Selected.'Created By'.'Azure AD Object ID')); 
                                ClearCollect( col_requestedMakers, gal_ecrs.Selected.Makers); 
                                ClearCollect( col_reqConnBlockedStatus, ShowColumns(col_requestedConnectors, "admin_id", "admin_displayname", "admin_iconuri"));
                                Navigate(scr_ViewCreationRequest, Fade, { triggerRefresh: true
                                    , var_notes: gal_ecrs.Selected.Notes
                                    , var_adminControlsMode: If(gal_ecrs.Selected.Status = 'Status (Environment Creation Requests)'.Active, DisplayMode.Edit, DisplayMode.Disabled)
                                    , var_securityGroupId: gal_ecrs.Selected.'Database security group ID' 
                                    , var_init_row: true
                                }); 
                                If( !IsBlank(gal_ecrs.Selected.'Database security group ID'), 
                                    Set( var_selectedSecurityGroup, LookUp(col_groups, id=gal_ecrs.Selected.'Database security group ID')),
                                    Set( var_selectedSecurityGroup, Blank() );
                                );
                            PaddingLeft: =10
                            PressedBorderColor: =ColorFade(Self.BorderColor, 0%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =ColorFade(Self.Fill, -20%)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: =""
                            Width: =Parent.Width
                            ZIndex: =4

                    c_action_extend_1 As groupContainer.manualLayoutContainer:
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =0
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutMinHeight: =50
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Manual
                        Visible: = gal_ecrs.Selected.'Has Extension Request' // gal_ecrs.Selected.'Has expiration date' &&
                        Width: =200
                        ZIndex: =3

                        Image3_3 As image:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            FocusedBorderThickness: =4
                            Height: =50
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverFill: =RGBA(0, 0, 0, 0)
                            Image: |-
                                ="data:image/svg+xml;utf8, " & EncodeUrl("
                                <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2048 2048'>
                                  <path d='M2048 128v1024h-128V640H128v1152h896v128H0V128h384V0h128v128h1024V0h128v128h384zm-128 384V256h-256v128h-128V256H512v128H384V256H128v256h1792zm19 851l90 90-557 558-269-270 90-90 179 178 467-466z' fill='#742774' /></svg>")
                            PaddingLeft: =5
                            PaddingRight: =5
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Width: =30
                            ZIndex: =1

                        Label10_9 As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =50
                            Size: =12
                            Text: ="Extend expiration date"
                            Width: =Parent.Width - Self.X
                            X: =28
                            ZIndex: =2

                        btn_newecr_7 As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderThickness: =0
                            Color: =RGBA(0, 0, 0, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            Fill: =RGBA(0,0,0,0)
                            FocusedBorderColor: =Self.Fill
                            FocusedBorderThickness: =0
                            Font: =Font.'Segoe UI'
                            FontWeight: =Normal
                            Height: =Parent.Height
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(0, 0, 0, 0.1)
                            OnSelect: |-
                                =UpdateContext({ var_newExpirationDate: DateAdd(gal_ecrs.Selected.'Expiration date', gal_ecrs.Selected.'Extended Duration Requested', Days) });
                                Patch( 'Environment Creation Requests', gal_ecrs.Selected, { 'Has Extension Request': false, 'Expiration date': var_newExpirationDate })
                            PaddingLeft: =10
                            PressedBorderColor: =ColorFade(Self.BorderColor, 0%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =ColorFade(Self.Fill, -20%)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: =""
                            Width: =Parent.Width
                            ZIndex: =4

                    Container6 As groupContainer.horizontalAutoLayoutContainer:
                        DisplayMode: =DisplayMode.Edit
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGap: =10
                        LayoutJustifyContent: =LayoutJustifyContent.End
                        LayoutMinHeight: =30
                        LayoutMinWidth: =250
                        ZIndex: =4

                        cbx_view As combobox:
                            AlignInContainer: =AlignInContainer.Stretch
                            BorderColor: =RGBA(166, 166, 166, 1)
                            BorderThickness: =0
                            ChevronBackground: =Self.Fill
                            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                            ChevronFill: =RGBA(32, 31, 30, 1)
                            ChevronHoverBackground: =Self.Fill
                            ChevronHoverFill: =RGBA(33, 33, 33, 1)
                            Color: =RGBA(51, 51, 51, 1)
                            DefaultSelectedItems: =['Approval Status'.Pending]
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(244, 244, 244, 1)
                            DisplayFields: =["Value"]
                            Fill: =RGBA(243, 242, 241, 1)
                            Font: =Font.'Segoe UI'
                            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                            HoverColor: =RGBA(51, 51, 51, 1)
                            HoverFill: =Self.Fill
                            IsSearchable: =false
                            Items: =Sort(col_requestStatuses, Text(Value), Ascending)
                            NoSelectionText: ="Any status"
                            OnChange: =Set(var_selectedItem, Blank())
                            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                            PressedColor: =RGBA(255, 255, 255, 1)
                            PressedFill: =RGBA(105, 121, 126, 1)
                            SearchFields: =["coe_name"]
                            SearchItems: =[]
                            SelectionColor: =RGBA(0, 0, 0, 1)
                            SelectionFill: =RGBA(230, 230, 230, 1)
                            SelectMultiple: =false
                            Size: =14
                            Width: =180
                            X: =957
                            Y: =64
                            ZIndex: =2

                        c_action As groupContainer.manualLayoutContainer:
                            DisplayMode: =DisplayMode.Edit
                            Fill: =RGBA(253, 253, 253, 0)
                            FillPortions: =0
                            LayoutDirection: =LayoutDirection.Horizontal
                            LayoutMinHeight: =50
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Manual
                            Width: =200
                            ZIndex: =4

                            tin_searchRequests As text:
                                BorderColor: =RGBA(166, 166, 166, 1)
                                BorderThickness: =0
                                Color: =RGBA(51, 51, 51, 1)
                                Default: =""
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                Fill: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =var_powerappspurple
                                FocusedBorderThickness: =1
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height
                                HintText: ="Search"
                                HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(105, 121, 126, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Width: =Parent.Width - Self.X
                                X: =32
                                ZIndex: =1

                            Icon1 As icon.Search:
                                BorderColor: =RGBA(166, 166, 166, 1)
                                Color: =var_powerappspurple
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(220, 220, 220, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                FocusedBorderThickness: =4
                                Height: =50
                                HoverBorderColor: =RGBA(0, 0, 0, 0)
                                HoverColor: =Self.Color
                                HoverFill: =RGBA(0, 0, 0, 0)
                                Icon: =Icon.Search
                                PaddingBottom: =10
                                PaddingLeft: =5
                                PaddingRight: =5
                                PaddingTop: =10
                                PressedBorderColor: =RGBA(0, 0, 0, 0)
                                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                                PressedFill: =RGBA(0, 0, 0, 0)
                                Rotation: =90
                                Width: =32
                                ZIndex: =2

                Container10_1 As groupContainer.horizontalAutoLayoutContainer:
                    DisplayMode: =DisplayMode.Edit
                    FillPortions: =0
                    Height: =60
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    PaddingTop: =10
                    ZIndex: =4

                    Label6 As label:
                        AlignInContainer: =AlignInContainer.End
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(50, 49, 48, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FillPortions: =1
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =Normal
                        PaddingLeft: =40
                        Size: =18
                        Text: =Coalesce(Text(cbx_view.Selected.Value), "All") &" Environment Creation Requests" & If(!var_loading, " ("& CountRows(gal_ecrs.AllItems)&")")
                        VerticalAlign: =VerticalAlign.Top
                        ZIndex: =2

                Label15 As label:
                    AlignInContainer: =AlignInContainer.Stretch
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(50, 49, 48, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =60
                    PaddingLeft: =40
                    Size: =12
                    Text: ="Select one of the requests below to view details. Admins can approve or reject Pending requests in the details page."
                    VerticalAlign: =VerticalAlign.Top
                    Visible: =var_loading <> true
                    ZIndex: =5

                Container23 As groupContainer.verticalAutoLayoutContainer:
                    DisplayMode: =DisplayMode.Edit
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    PaddingLeft: =40
                    PaddingRight: =20
                    Visible: =var_loading <> true
                    ZIndex: =6

                    Container8 As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =0
                        Height: =42
                        LayoutAlignItems: =LayoutAlignItems.End
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        PaddingLeft: =20
                        ZIndex: =1

                        img_checkmark_2 As image:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            FocusedBorderThickness: =4
                            Height: =60
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverFill: =RGBA(0, 0, 0, 0)
                            Image: =""
                            LayoutMinHeight: =60
                            PaddingBottom: =20
                            PaddingTop: =20
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Width: =60
                            ZIndex: =1

                        btn_header_id As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(244, 244, 244, 1)
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                            Font: =Font.'Segoe UI'
                            FontWeight: =Semibold
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =ColorFade(Self.Fill, -0%)
                            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =White
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: ="Id"
                            Width: =130
                            ZIndex: =2

                        btn_header_environment As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(244, 244, 244, 1)
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =2
                            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                            Font: =Font.'Segoe UI'
                            FontWeight: =Semibold
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =ColorFade(Self.Fill, -0%)
                            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =White
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: ="Name"
                            ZIndex: =3

                        btn_header_expiration As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(244, 244, 244, 1)
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =1
                            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                            Font: =Font.'Segoe UI'
                            FontWeight: =Semibold
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =ColorFade(Self.Fill, -0%)
                            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =White
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: ="Expiration date"
                            Width: =140
                            ZIndex: =4

                        Button2_3 As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(244, 244, 244, 1)
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                            Font: =Font.'Segoe UI'
                            FontWeight: =Semibold
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =Self.Fill
                            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =White
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: ="State"
                            Width: =180
                            ZIndex: =5

                        btn_header_created As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(244, 244, 244, 1)
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                            Font: =Font.'Segoe UI'
                            FontWeight: =Semibold
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =ColorFade(Self.Fill, -0%)
                            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                            PressedColor: =RGBA(0, 0, 0, 1)
                            PressedFill: =White
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =12
                            Text: ="Created date"
                            Width: =200
                            ZIndex: =6

                    Rectangle2 As rectangle:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        DisabledFill: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(204, 204, 204, 1)
                        FocusedBorderThickness: =4
                        Height: =1
                        HoverFill: =RGBA(105, 121, 126, 1)
                        PressedFill: =RGBA(105, 121, 126, 1)
                        ZIndex: =2

                    gal_ecrs As gallery.galleryVertical:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =0
                        Height: =525
                        Items: =Search(Filter('Environment Creation Requests', 'Request status'=cbx_view.Selected.Value), tin_searchRequests.Text, "coe_envdisplayname", "coe_name")
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =287
                        LayoutMinWidth: =320
                        OnSelect: =
                        TabIndex: =1
                        TemplateFill: =If(ThisItem.IsSelected, RGBA(250, 250, 250, 1))
                        TemplatePadding: =0
                        TemplateSize: =If(Self.Layout = Layout.Horizontal, Min(60, Self.Width - 60), Min(60, Self.Height - 60))
                        Width: =1273
                        X: =16
                        Y: =57
                        ZIndex: =3

                        Container9 As groupContainer.horizontalAutoLayoutContainer:
                            DisplayMode: =DisplayMode.Edit
                            Height: =60
                            LayoutAlignItems: =LayoutAlignItems.Stretch
                            PaddingLeft: =20
                            Width: =Parent.Width
                            ZIndex: =1

                            img_checkmark_1 As image:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                FocusedBorderThickness: =4
                                Height: =60
                                HoverBorderColor: =RGBA(0, 0, 0, 0)
                                HoverFill: =RGBA(0, 0, 0, 0)
                                Image: |-
                                    =If(ThisItem.IsSelected, "data:image/svg+xml;utf8, " & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2048 2048'>
                                      <path d='M1024 0q141 0 272 36t244 104 207 160 161 207 103 245 37 272q0 141-36 272t-104 244-160 207-207 161-245 103-272 37q-141 0-272-36t-244-104-207-160-161-207-103-245-37-272q0-141 36-272t104-244 160-207 207-161T752 37t272-37zM832 1480l795-795-136-136-659 659-275-275-136 136 411 411z' fill='#742774' stroke-width='4' stroke='#fff'/>
                                    </svg>"))
                                LayoutMinHeight: =60
                                PaddingBottom: =23
                                PaddingTop: =23
                                PressedBorderColor: =RGBA(0, 0, 0, 0)
                                PressedFill: =RGBA(0, 0, 0, 0)
                                Width: =60
                                ZIndex: =1

                            Label8 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Size: =11
                                Text: =ThisItem.'Request  No'
                                Width: =btn_header_id.Width
                                Wrap: =false
                                ZIndex: =2

                            Label8_1 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                LayoutMinWidth: =btn_header_environment.Width
                                Size: =12
                                Text: =ThisItem.'Environment display name'
                                Width: =btn_header_environment.Width
                                Wrap: =false
                                ZIndex: =3

                            Label8_2 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(151, 151, 151, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FillPortions: =1
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Size: =11
                                Text: |-
                                    =If(ThisItem.'Has expiration date',
                                        Coalesce(
                                            Text(ThisItem.'Expiration date', "mm/dd/yyyy") & If(ThisItem.'Has Extension Request', " (" & ThisItem.'Duration Requested' & " day extension requested)")
                                            , Text(ThisItem.'Duration Requested') & " days (requested)"
                                            , "--")
                                    , 
                                    "None")
                                Width: =btn_header_expiration.Width
                                Wrap: =false
                                ZIndex: =4

                            Label8_4 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(151, 151, 151, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Size: =11
                                Text: =ThisItem.'Request status'
                                Width: =Button2_3.Width
                                Wrap: =false
                                ZIndex: =5

                            Label8_10 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(151, 151, 151, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Size: =11
                                Text: =Text(ThisItem.'Created On', "mm/dd/yyyy")
                                Width: =btn_header_created.Width
                                Wrap: =false
                                ZIndex: =6

                        btn_viewRequest As button:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =0
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(230, 230, 230, 0.1)
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.TemplateHeight
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(255, 255, 255, 1)
                            HoverFill: =RGBA(243, 242, 241, 0.1)
                            OnSelect: =
                            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 0), -50%)
                            PressedColor: =RGBA(255, 255, 255, 1)
                            PressedFill: =ColorFade(RGBA(105, 121, 126, 0.05 ), -30%)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =15
                            Text: =""
                            Width: =Parent.Width
                            ZIndex: =2

                        Rectangle2_12 As rectangle:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Fill: =RGBA(230, 230, 230, 1)
                            FocusedBorderThickness: =4
                            Height: =1
                            Width: =Parent.TemplateWidth
                            Y: =59
                            ZIndex: =3

    btn_getNextPageENV As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(105, 121, 126, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =25
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
        OnSelect: |-
            =/* assumes first page has already been retrieved */
            If( !IsBlank(var_getEnvResponse),
                /* isolate skiptoken */
                ClearCollect( col_tempnextlink, Split(var_getEnvResponse.nextLink,"&%24").Result );
                ClearCollect( col_tempnextlink, LookUp(col_tempnextlink, "skiptoken=" in Result) );
                UpdateContext({ var_skiptoken : Substitute(First(col_tempnextlink).Result, "skiptoken=","") });
            
                /* use skiptoken to get next page */
                UpdateContext({ var_getEnvResponse : PowerPlatformforAdmins.GetAdminEnvironment({ '$top':var_pagesize, '$skiptoken': var_skiptoken }) });
                Collect( col_allEnvironments, var_getEnvResponse.value );
            )
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =15
        Text: ="Recurse"
        Visible: =false
        Width: =103
        X: =1263
        Y: =743
        ZIndex: =2

