HomeScreen As screen:
    Height: =Max(App.Height, App.DesignHeight)
    OnVisible: |-
        =//Set(SelectedApp, galApps.Selected);
        Set(SearchScreenNumber, 1);
    Orientation: =If(HomeScreen.Width < HomeScreen.Height, Layout.Vertical, Layout.Horizontal)
    Size: =1 + CountRows(App.SizeBreakpoints) - CountIf(App.SizeBreakpoints, Value >= HomeScreen.Width)
    Width: =Max(App.Width, App.DesignWidth)

    galApps As gallery.galleryVertical:
        BorderColor: =ColorValue(Style.Tertiary)
        BorderStyle: =BorderStyle.None
        DisabledBorderColor: =galApps.BorderColor
        DisabledFill: =galApps.Fill
        Fill: =RGBA(255, 255, 255, 1)
        Height: =845
        HoverBorderColor: =galApps.BorderColor
        HoverFill: =galApps.Fill
        Items: |-
            =SortByColumns(Filter(
                Filter(
                    'PowerApps Apps',
                        'App Environment'.admin_displayname = Text(galEnvironments.Selected.admin_displayname) And 'App Type'= 'PowerApps Type'.Canvas And 'App Deleted' = 'App Deleted (PowerApps Apps)'.No
                ),
                txtSearchText.Text in 'App Display Name' || txtSearchText.Text in 'App Owner Display Name' || txtSearchText.Text in AppIDString
            ), "admin_displayname")
        Layout: =Layout.Vertical
        LoadingSpinnerColor: =galApps.BorderColor
        OnSelect: |-
            =Set(SelectedApp, galApps.Selected);
            Navigate(AppDetailsScreen)
        PressedBorderColor: =galApps.BorderColor
        PressedFill: =galApps.Fill
        TemplateSize: =86
        Width: =1426
        X: =479
        Y: =229
        ZIndex: =1

        lblAppBkgColor As htmlViewer:
            AutoHeight: =true
            Height: =60
            HoverBorderColor: =lblAppBkgColor.BorderColor
            HtmlText: |-
                ="<div style='width:"&imgAppIcon.Width&"px;height=10px;height:60px;background:" & ThisItem.'Icon Background Color' & "'></div>"
            OnSelect: =Select(Parent)
            PaddingBottom: =-10
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =-10
            PressedBorderColor: =lblAppBkgColor.BorderColor
            Width: =64
            X: =67
            Y: =13
            ZIndex: =1

        lblAppname As label:
            BorderColor: =RGBA(218,218,218,1.00)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(47,41,43,1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70)
            FocusedBorderColor: =lblAppname.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =86
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(4,45,81,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(4,45,81,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Size: =16
            Text: |
                =ThisItem.'App Display Name'
            Width: =424
            X: =149
            ZIndex: =2

        lblAppID As label:
            BorderColor: =RGBA(218,218,218,1.00)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(47,41,43,1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70)
            FocusedBorderColor: =lblAppID.BorderColor
            Font: =Font.'Segoe UI'
            Height: =49
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(4,45,81,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(4,45,81,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Text: =ThisItem.App
            Width: =380
            X: =1036
            Y: =20
            ZIndex: =3

        imgAppIcon As image:
            BorderColor: =ColorFade(imgAppIcon.Fill,-20%)
            DisabledBorderColor: =RGBA(159, 167, 165, 1)
            DisabledFill: =RGBA(193, 193, 193, 0.95)
            Fill: =ColorValue(ThisItem.'Icon Background Color')
            FocusedBorderColor: =imgAppIcon.BorderColor
            Height: =60
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            Image: =ThisItem.'App Icon Uri'
            ImagePosition: =ImagePosition.Fill
            OnSelect: =Select(Parent)
            PaddingBottom: =imgAppIcon.PaddingTop
            PaddingLeft: =imgAppIcon.PaddingTop
            PaddingRight: =imgAppIcon.PaddingTop
            PaddingTop: =10
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            Width: =64
            X: =67
            Y: =13
            ZIndex: =4

        lblOwner As label:
            BorderColor: =RGBA(218,218,218,1.00)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(47,41,43,1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70)
            FocusedBorderColor: =lblOwner.BorderColor
            Font: =Font.'Segoe UI'
            Height: =50
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(4,45,81,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(4,45,81,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Text: =If(!IsBlank(ThisItem.'App Owner'.'Display Name'),ThisItem.'App Owner'.'Display Name',ThisItem.'App Owner Display Name')
            Width: =218
            X: =601
            Y: =19
            ZIndex: =5

        chkSelectApp As checkbox:
            BorderColor: =ColorValue(Style.Primary)
            CheckboxBorderColor: =RGBA(128, 128, 128, 1)
            Default: =chkSelectAll.Value
            FocusedBorderColor: =chkSelectApp.BorderColor
            Height: =40
            HoverBorderColor: =ColorFade(chkSelectApp.BorderColor, 30%)
            HoverFill: =ColorFade(chkSelectApp.Fill, 30%)
            OnCheck: |-
                =Collect(EnvCheckedApps, {AppName:ThisItem.App})
            OnUncheck: =Remove(EnvCheckedApps,LookUp(EnvCheckedApps,AppName=ThisItem.App));
            PressedBorderColor: =ColorFade(chkSelectApp.BorderColor, -30%)
            PressedColor: =ColorValue(Style.Primary)
            PressedFill: =ColorFade(chkSelectApp.Fill, -30%)
            Text: =""
            Width: =40
            Y: =20
            ZIndex: =6

        lblOwner_5 As label:
            BorderColor: =RGBA(218,218,218,1.00)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(47,41,43,1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70)
            FocusedBorderColor: =lblOwner_5.BorderColor
            Font: =Font.'Segoe UI'
            Height: =47
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(4,45,81,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(4,45,81,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Text: =Text(ThisItem.'App Last Launched On',"[$-en-US]dd-mmm-yyyy")
            Width: =129
            X: =848
            Y: =13
            ZIndex: =7

    galEnvironments As gallery.galleryVertical:
        BorderColor: =ColorValue(Style.Tertiary)
        BorderStyle: =BorderStyle.None
        DisabledBorderColor: =galEnvironments.BorderColor
        DisabledFill: =galEnvironments.Fill
        Fill: =RGBA(255, 255, 255, 1)
        Height: =845
        HoverBorderColor: =galEnvironments.BorderColor
        HoverFill: =galEnvironments.Fill
        Items: =SortByColumns( Filter(vEnvironments,txtSearchText_2.Text in 'Display Name'),"admin_displayname", If(SortDescending1, Descending, Ascending))
        Layout: =Layout.Vertical
        LoadingSpinnerColor: =galEnvironments.BorderColor
        OnSelect: |
            =Reset(chkSelectAll);
            If(
                CountRows(EnvCheckedApps) > 0,
                Clear(EnvCheckedApps)
            );
        PressedBorderColor: =galEnvironments.BorderColor
        PressedFill: =galEnvironments.Fill
        TemplateFill: =If(ThisItem.IsSelected, ColorValue(Style.Tertiary), White)
        TemplateSize: =65
        Width: =390
        X: =62
        Y: =235
        ZIndex: =2

        lblDisplayname As label:
            BorderColor: =RGBA(218,218,218,1.00)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(47,41,43,1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70)
            FocusedBorderColor: =lblDisplayname.BorderColor
            Font: =Font.'Segoe UI'
            Height: =63
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(4,45,81,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(4,45,81,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Text: =ThisItem.'Display Name'
            Width: =300
            X: =76
            Y: =1
            ZIndex: =2

        iEnvironment As icon.LevelsLayersItems:
            Color: =RGBA(202, 202, 202, 1)
            DisabledFill: =iEnvironment.Fill
            FocusedBorderColor: =iEnvironment.BorderColor
            Height: =50
            HoverBorderColor: =ColorFade(iEnvironment.BorderColor, 20%)
            HoverColor: =ColorFade(iEnvironment.Color, 20%)
            HoverFill: =iEnvironment.Fill
            Icon: =Icon.LevelsLayersItems
            OnSelect: =Select(Parent)
            PaddingBottom: =7
            PaddingLeft: =1
            PaddingTop: =7
            PressedBorderColor: =ColorFade(iEnvironment.BorderColor, -20%)
            PressedColor: =ColorFade(iEnvironment.Color, -20%)
            PressedFill: =iEnvironment.Fill
            Width: =50
            X: =8
            Y: =8
            ZIndex: =9

    bkgHeader As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        DisabledFill: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(244, 244, 244, 1)
        FocusedBorderColor: =bkgHeader.BorderColor
        FocusedBorderThickness: =4
        Height: =52
        HoverFill: =bkgHeader.Fill
        OnSelect: =
        PressedFill: =bkgHeader.Fill
        TabIndex: =0
        Width: =1920
        X: =
        ZIndex: =3

    lblAppTitle As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppTitle.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =Bold
        Height: =48
        HoverBorderColor: =lblAppTitle.BorderColor
        HoverColor: =lblAppTitle.Color
        HoverFill: =lblAppTitle.Fill
        PaddingLeft: =0
        PressedBorderColor: =lblAppTitle.BorderColor
        PressedColor: =lblAppTitle.Color
        PressedFill: =lblAppTitle.Fill
        Size: =20
        Text: ="Admin - App Permission Center"
        Width: =575
        X: =80
        Y: =68
        ZIndex: =4

    imgLogo As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =imgLogo.BorderColor
        FocusedBorderThickness: =4
        Height: =39
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =Style.Logo
        PaddingBottom: =10
        PaddingTop: =5
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =233
        X: =5
        Y: =10
        ZIndex: =5

    Rectangle1 As rectangle:
        DisabledFill: =Rectangle1.Fill
        Fill: =ColorValue(Style.Tertiary)
        FocusedBorderColor: =Rectangle1.BorderColor
        Height: =2
        HoverFill: =Rectangle1.Fill
        PressedFill: =Rectangle1.Fill
        Width: =1821
        X: =62
        Y: =231
        ZIndex: =8

    grpSearch As group:
        Height: =5
        Width: =5
        X: =-1258
        Y: =-97
        ZIndex: =8

        txtSearchText As text:
            BorderColor: =ColorValue(Style.Tertiary)
            BorderThickness: =1
            Default: =""
            DisabledBorderColor: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =txtSearchText.BorderColor
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            Height: =45
            HintText: ="Search apps ..."
            HoverBorderColor: =RGBA(255, 255, 255, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            PaddingBottom: =0
            PaddingLeft: =20
            PaddingRight: =10
            PaddingTop: =0
            PressedBorderColor: =RGBA(0, 120, 212, 1)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Width: =600
            X: =1266
            Y: =71
            ZIndex: =6

        iDeleteSearchText As icon.Cancel:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(128, 128, 128, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =iDeleteSearchText.BorderColor
            FocusedBorderThickness: =4
            Height: =45
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(55, 14, 64, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Cancel
            OnSelect: =Reset(txtSearchText)
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Width: =34
            X: =1832
            Y: =71
            ZIndex: =7

    lblAppTitle_2 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(128, 128, 128, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppTitle_2.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =28
        HoverBorderColor: =lblAppTitle_2.BorderColor
        HoverColor: =lblAppTitle_2.Color
        HoverFill: =lblAppTitle_2.Fill
        PaddingLeft: =0
        PressedBorderColor: =lblAppTitle_2.BorderColor
        PressedColor: =lblAppTitle_2.Color
        PressedFill: =lblAppTitle_2.Fill
        Size: =11
        Text: ="APP DISPLAY NAME"
        Width: =151
        X: =552
        Y: =203
        ZIndex: =11

    lblAppTitle_3 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(128, 128, 128, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppTitle_3.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =28
        HoverBorderColor: =lblAppTitle_3.BorderColor
        HoverColor: =lblAppTitle_3.Color
        HoverFill: =lblAppTitle_3.Fill
        PaddingLeft: =0
        PressedBorderColor: =lblAppTitle_3.BorderColor
        PressedColor: =lblAppTitle_3.Color
        PressedFill: =lblAppTitle_3.Fill
        Size: =11
        Text: ="CURRENT OWNER"
        Width: =151
        X: =1083
        Y: =203
        ZIndex: =12

    lblAppTitle_4 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(128, 128, 128, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppTitle_4.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =28
        HoverBorderColor: =lblAppTitle_4.BorderColor
        HoverColor: =lblAppTitle_4.Color
        HoverFill: =lblAppTitle_4.Fill
        PaddingLeft: =0
        PressedBorderColor: =lblAppTitle_4.BorderColor
        PressedColor: =lblAppTitle_4.Color
        PressedFill: =lblAppTitle_4.Fill
        Size: =11
        Text: ="APP ID (NAME)"
        Width: =151
        X: =1525
        Y: =203
        ZIndex: =13

    grpTabs As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =23

        lblTabEnvironment As label:
            Align: =Center
            FocusedBorderColor: =lblTabEnvironment.BorderColor
            Height: =37
            HoverBorderColor: =lblTabEnvironment.BorderColor
            HoverColor: =lblTabEnvironment.Color
            HoverFill: =lblTabEnvironment.Fill
            OnSelect: =Navigate(HomeScreen)
            PressedBorderColor: =lblTabEnvironment.BorderColor
            PressedColor: =lblTabEnvironment.Color
            PressedFill: =lblTabEnvironment.Fill
            Text: ="ENVIRONMENT"
            X: =88
            Y: =125
            ZIndex: =19

        clrSelectTab As rectangle:
            DisabledFill: =clrSelectTab.Fill
            Fill: =ColorValue(Style.Primary)
            FocusedBorderColor: =clrSelectTab.BorderColor
            Height: =4
            HoverFill: =clrSelectTab.Fill
            PressedFill: =clrSelectTab.Fill
            Width: =lblTabEnvironment.Width
            X: =88
            Y: =167
            ZIndex: =20

        lblTabOwner As label:
            Align: =Center
            FocusedBorderColor: =lblTabOwner.BorderColor
            Height: =37
            HoverBorderColor: =lblTabOwner.BorderColor
            HoverColor: =lblTabOwner.Color
            HoverFill: =lblTabOwner.Fill
            OnSelect: =Navigate(OwnerScreen)
            PressedBorderColor: =lblTabOwner.BorderColor
            PressedColor: =lblTabOwner.Color
            PressedFill: =lblTabOwner.Fill
            Text: ="OWNER"
            X: =264
            Y: =125
            ZIndex: =21

        lblTabOrphanedApp As label:
            Align: =Center
            FocusedBorderColor: =lblTabOrphanedApp.BorderColor
            Height: =37
            HoverBorderColor: =lblTabOrphanedApp.BorderColor
            HoverColor: =lblTabOrphanedApp.Color
            HoverFill: =lblTabOrphanedApp.Fill
            OnSelect: =Navigate(OrphanedAppScreen)
            PressedBorderColor: =lblTabOrphanedApp.BorderColor
            PressedColor: =lblTabOrphanedApp.Color
            PressedFill: =lblTabOrphanedApp.Fill
            Text: ="ORPHANED APP"
            X: =437
            Y: =125
            ZIndex: =22

    chkSelectAll As checkbox:
        BorderColor: =ColorValue(Style.Primary)
        CheckboxBorderColor: =RGBA(128, 128, 128, 1)
        FocusedBorderColor: =chkSelectAll.BorderColor
        Height: =40
        HoverBorderColor: =ColorFade(chkSelectAll.BorderColor, 30%)
        HoverFill: =ColorFade(chkSelectAll.Fill, 30%)
        OnCheck: |-
            =Clear(EnvCheckedApps);ForAll(galApps.AllItems, Collect(EnvCheckedApps,{AppName:App}))
        OnUncheck: =Clear(EnvCheckedApps)
        PressedBorderColor: =ColorFade(chkSelectAll.BorderColor, -30%)
        PressedColor: =ColorValue(Style.Primary)
        PressedFill: =ColorFade(chkSelectAll.Fill, -30%)
        Text: =""
        Width: =40
        X: =483
        Y: =192
        ZIndex: =26

    grpSortSearch As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =26

        txtSearchText_2 As text:
            BorderColor: =ColorValue(Style.Tertiary)
            BorderThickness: =1
            Default: =""
            DisabledBorderColor: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =txtSearchText_2.BorderColor
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            Height: =45
            HintText: ="Search environments ..."
            HoverBorderColor: =RGBA(255, 255, 255, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            PaddingBottom: =0
            PaddingLeft: =20
            PaddingRight: =10
            PaddingTop: =0
            PressedBorderColor: =RGBA(0, 120, 212, 1)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Width: =330
            X: =105
            Y: =184
            ZIndex: =23

        iDeleteSearchText_2 As icon.Cancel:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(128, 128, 128, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =iDeleteSearchText_2.BorderColor
            FocusedBorderThickness: =4
            Height: =45
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(55, 14, 64, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Cancel
            OnSelect: =Reset(txtSearchText_2)
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Width: =34
            X: =400
            Y: =184
            ZIndex: =24

        iSort As icon.ArrowsUpDown:
            Color: =RGBA(128, 128, 128, 1)
            DisabledFill: =iSort.Fill
            FocusedBorderColor: =iSort.BorderColor
            Height: =40
            HoverBorderColor: =ColorFade(iSort.BorderColor, 20%)
            HoverColor: =ColorFade(iSort.Color, 20%)
            HoverFill: =iSort.Fill
            Icon: =Icon.Sort
            OnSelect: |-
                =UpdateContext({SortDescending1:!SortDescending1})
            PressedBorderColor: =ColorFade(iSort.BorderColor, -20%)
            PressedColor: =ColorFade(iSort.Color, -20%)
            PressedFill: =iSort.Fill
            Width: =40
            X: =62
            Y: =186
            ZIndex: =25

    btnEditSelected_1 As button:
        AutoDisableOnSelect: =false
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        Color: =RGBA(0, 0, 0, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisplayMode: =If(!IsEmpty(galApps.AllItems)&&CountRows(EnvCheckedApps)>0, DisplayMode.Edit, DisplayMode.Disabled)
        Fill: =ColorValue(Style.Primary)
        FocusedBorderColor: =btnEditSelected_1.BorderColor
        Font: =Font.'Segoe UI'
        FontWeight: =Semibold
        Height: =41
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =ColorValue(Style.Secondary)
        OnSelect: |-
            =UpdateContext({showAddPermissions:true});If(
                drpSearchUserRole_5.Selected.Value = "Editor",
                UpdateContext({vUserRole: "CanEdit"}),
                If(
                    drpSearchUserRole_5.Selected.Value = "Viewer",
                    UpdateContext({vUserRole: "CanView"}),
                    UpdateContext({vUserRole: "Owner"})
                )
            )
        PaddingBottom: =10
        PaddingLeft: =10
        PaddingRight: =10
        PaddingTop: =10
        PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =ColorFade(btnEditSelected_1.Fill, -30%)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =14
        Text: ="Add Permissions"
        Width: =175
        X: =1691
        Y: =125
        ZIndex: =27

    bkgPopUp_4 As rectangle:
        DisabledFill: =bkgPopUp_4.Fill
        Fill: =RGBA(0, 0, 0, 0.35)
        FocusedBorderColor: =bkgPopUp_4.BorderColor
        Height: =1080
        HoverFill: =bkgPopUp_4.Fill
        PressedFill: =bkgPopUp_4.Fill
        Visible: =showAddPermissions
        Width: =1920
        ZIndex: =28

    grpAddUsers_5 As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =42

        bkgAddNewUsers_5 As rectangle:
            DisabledFill: =bkgAddNewUsers_5.Fill
            Fill: =RGBA(244, 244, 244, 1)  
            FocusedBorderColor: =bkgAddNewUsers_5.BorderColor
            Height: =950
            HoverFill: =bkgAddNewUsers_5.Fill
            PressedFill: =bkgAddNewUsers_5.Fill
            Visible: =showAddPermissions
            Width: =1098
            X: =374
            Y: =65
            ZIndex: =29

        lblAddNewUsers_5 As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblAddNewUsers_5.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =Bold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0,0,0,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            PaddingLeft: =0
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(0,0,0,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Size: =16
            Text: ="Add New Users"
            Visible: =showAddPermissions
            Width: =266
            X: =385
            Y: =80
            ZIndex: =30

        txtSearchUser_5 As text:
            Align: =Center
            BorderColor: =RGBA(220,220,220,1)
            BorderThickness: =1
            Color: =Black
            Default: =""
            DisabledBorderColor: =RGBA(159, 167, 165, 1)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            DisabledFill: =ColorFade(RGBA(159, 167, 165, 1), 50%)
            DisplayMode: =If(false,DisplayMode.View,DisplayMode.Edit)
            FocusedBorderColor: =txtSearchUser_5.BorderColor
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            FontWeight: =Lighter
            Height: =50
            HintText: ="Type a name or an email address"
            HoverBorderColor: =RGBA(159,159,159,1)
            HoverColor: =Black
            HoverFill: =White
            OnSelect: =
            PressedBorderColor: =txtSearchUser_5.HoverBorderColor
            PressedColor: =txtSearchUser_5.Color
            PressedFill: =txtSearchUser_5.Fill
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Reset: =clearSearchField
            Size: =18
            Tooltip: ="Search people input field"
            Visible: =showAddPermissions
            Width: =1049
            X: =395
            Y: =131
            ZIndex: =31

        galSearchPeopleresult_5 As gallery.galleryVertical:
            BorderColor: =RGBA(233, 232, 233, 1)
            BorderStyle: =BorderStyle.None
            DisabledBorderColor: =galSearchPeopleresult_5.BorderColor
            DisabledFill: =galSearchPeopleresult_5.Fill
            Height: =476
            HoverBorderColor: =galSearchPeopleresult_5.BorderColor
            HoverFill: =galSearchPeopleresult_5.Fill
            Items: =If(Len(txtSearchUser_5.Text) > 3,searchResultsCol)
            Layout: =Layout.Vertical
            LoadingSpinnerColor: =galSearchPeopleresult_5.BorderColor
            OnSelect: =
            PressedBorderColor: =galSearchPeopleresult_5.BorderColor
            PressedFill: =galSearchPeopleresult_5.Fill
            TemplateFill: =If(ThisItem.IsSelected, ColorValue(Style.Primary), White)
            TemplateSize: =138
            Visible: =showAddPermissions
            Width: =1060
            X: =393
            Y: =233
            ZIndex: =32

            imgSearchProfilePic_5 As image:
                ApplyEXIFOrientation: =false
                BorderColor: =RGBA(101, 128, 187, 1)
                DisabledBorderColor: =RGBA(159, 167, 165, 1)
                DisabledFill: =RGBA(193, 193, 193, 0.95)
                Fill: =RGBA(230, 230, 230, 1)
                FocusedBorderColor: =imgSearchProfilePic_5.BorderColor
                Height: =80
                HoverBorderColor: =ColorFade(imgSearchProfilePic_5.BorderColor, 20%)
                HoverFill: =ColorFade(imgSearchProfilePic_5.Fill, 20%)
                Image: |-
                    =If(!IsBlank(ThisItem.UserPrincipalName), Office365Users.UserPhotoV2(ThisItem.UserPrincipalName))  //If(IsBlank(TextBox_hiddenImageState.Text),'preload - user',"data:image/jpeg;base64," & TextBox_hiddenImageState.Text)
                ImagePosition: =ImagePosition.Fill
                PressedBorderColor: =ColorFade(imgSearchProfilePic_5.BorderColor, -20%)
                PressedFill: =ColorFade(imgSearchProfilePic_5.Fill, -20%)
                RadiusBottomLeft: =40
                RadiusBottomRight: =40
                RadiusTopLeft: =40
                RadiusTopRight: =40
                TabIndex: =0
                Width: =80
                X: =5
                Y: =27
                ZIndex: =5

            lblSearchUserID_5 As label:
                FocusedBorderColor: =lblSearchUserID_5.BorderColor
                Font: =Font.'Segoe UI'
                Height: =35
                HoverBorderColor: =lblSearchUserID_5.BorderColor
                HoverColor: =lblSearchUserID_5.Color
                HoverFill: =lblSearchUserID_5.Fill
                OnSelect: =Select(Parent)
                PressedBorderColor: =lblSearchUserID_5.BorderColor
                PressedColor: =lblSearchUserID_5.Color
                PressedFill: =lblSearchUserID_5.Fill
                Text: |-
                    =If( !IsBlank(txtSearchUser_5), "User ID: " & Office365Users.UserProfileV2(ThisItem.UserPrincipalName).id)
                Width: =536
                X: =100
                Y: =88
                ZIndex: =8

            lblSearchEmail_5 As label:
                FocusedBorderColor: =lblSearchEmail_5.BorderColor
                Font: =Font.'Segoe UI'
                Height: =41
                HoverBorderColor: =lblSearchEmail_5.BorderColor
                HoverColor: =lblSearchEmail_5.Color
                HoverFill: =lblSearchEmail_5.Fill
                OnSelect: =Select(Parent)
                PressedBorderColor: =lblSearchEmail_5.BorderColor
                PressedColor: =lblSearchEmail_5.Color
                PressedFill: =lblSearchEmail_5.Fill
                Text: =ThisItem.UserPrincipalName
                Width: =443
                X: =100
                Y: =47
                ZIndex: =9

            lblSearchName_5 As label:
                FocusedBorderColor: =lblSearchName_5.BorderColor
                Font: =Font.'Segoe UI'
                FontWeight: =Bold
                Height: =48
                HoverBorderColor: =lblSearchName_5.BorderColor
                HoverColor: =lblSearchName_5.Color
                HoverFill: =lblSearchName_5.Fill
                OnSelect: =Select(Parent)
                PressedBorderColor: =lblSearchName_5.BorderColor
                PressedColor: =lblSearchName_5.Color
                PressedFill: =lblSearchName_5.Fill
                Size: =16
                Text: =ThisItem.GivenName & " " & ThisItem.Surname
                Width: =550
                X: =100
                Y: =9
                ZIndex: =10

        iSearch_5 As icon.Search:
            BorderColor: =RGBA(101, 128, 187, 1)
            Color: =RGBA(220,220,220,1)
            DisabledBorderColor: =RGBA(159, 167, 165, 1)
            DisabledColor: =RGBA(193, 193, 193, 0.95)
            DisabledFill: =iSearch_5.Fill
            FocusedBorderColor: =iSearch_5.BorderColor
            Height: =50
            HoverBorderColor: =ColorFade(iSearch_5.BorderColor, 20%)
            HoverColor: =ColorFade(iSearch_5.Color, 20%)
            HoverFill: =iSearch_5.Fill
            Icon: =Icon.Search
            PaddingBottom: =5
            PaddingLeft: =5
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(iSearch_5.BorderColor, -20%)
            PressedColor: =ColorFade(iSearch_5.Color, -20%)
            PressedFill: =iSearch_5.Fill
            Visible: =showAddPermissions
            Width: =50
            X: =407
            Y: =131
            ZIndex: =33

        lblFetchingData_5 As label:
            BorderColor: =RGBA(101, 128, 187, 1)
            Color: =RGBA(47,41,43,1)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            FocusedBorderColor: =lblFetchingData_5.BorderColor
            Font: =Font.Arial
            Height: =35
            HoverBorderColor: =lblFetchingData_5.BorderColor
            HoverColor: =lblFetchingData_5.Color
            HoverFill: =lblFetchingData_5.Fill
            PressedBorderColor: =lblFetchingData_5.BorderColor
            PressedColor: =lblFetchingData_5.Color
            PressedFill: =lblFetchingData_5.Fill
            Size: =18
            Text: =searchStatus
            Visible: =false
            Width: =300
            X: =395
            Y: =181
            ZIndex: =34

        imgClearInput_5 As image:
            ApplyEXIFOrientation: =false
            BorderColor: =RGBA(101, 128, 187, 1)
            DisabledBorderColor: =RGBA(159, 167, 165, 1)
            DisabledFill: =RGBA(193, 193, 193, 0.95)
            FocusedBorderColor: =imgClearInput_5.BorderColor
            Height: =txtSearchUser_5.Height
            HoverBorderColor: =ColorFade(imgClearInput_5.BorderColor, 20%)
            HoverFill: =ColorFade(imgClearInput_5.Fill, 20%)
            Image: =closedark
            OnSelect: |-
                =UpdateContext({clearSearchField:false});UpdateContext({clearSearchField:true})
            PaddingBottom: =15
            PaddingLeft: =15
            PaddingRight: =15
            PaddingTop: =15
            PressedBorderColor: =ColorFade(imgClearInput_5.BorderColor, -20%)
            PressedFill: =ColorFade(imgClearInput_5.Fill, -20%)
            Visible: =showAddPermissions
            Width: =txtSearchUser_5.Height
            X: =1394
            Y: =131
            ZIndex: =35

        tmrSearch_5 As timer:
            BorderColor: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            DisabledColor: =RGBA(186, 186, 186, 1)
            DisabledFill: =RGBA(119, 119, 119, 1)
            DisplayMode: =If(false,DisplayMode.View,DisplayMode.Edit)
            Duration: =300
            Fill: =RGBA(69, 69, 69, 1)
            FocusedBorderColor: =tmrSearch_5.BorderColor
            HoverBorderColor: =ColorFade(tmrSearch_5.BorderColor, 20%)
            HoverColor: =tmrSearch_5.Color
            HoverFill: =ColorFade(tmrSearch_5.Fill, 20%)
            OnTimerEnd: |-
                =If(
                    Len(txtSearchUser_5.Text) = searchTextCount,
                    ClearCollect(
                        searchResultsCol,       
                            Office365Users.SearchUser({searchTerm: PlainText(txtSearchUser_5.Text)})
                        
                    );
                    If(
                        IsEmpty(searchResultsCol),
                        UpdateContext({searchStatus: "No match found"}),
                        UpdateContext({searchStatus: "Match found"})
                    )
                )
            OnTimerStart: |-
                =UpdateContext({searchStatus:"Searching...",searchTextCount:Len(txtSearchUser_5.Text)})
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =ColorFade(tmrSearch_5.BorderColor, -20%)
            PressedColor: =tmrSearch_5.Color
            PressedFill: =ColorFade(tmrSearch_5.Fill, -20%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Repeat: =Len(txtSearchUser_5.Text)> 2 && Len(txtSearchUser_5.Text) <> searchTextCount
            Size: =11
            Start: =Len(txtSearchUser_5.Text) > 2
            Text: |-
                =Text(Time(0, 0, tmrSearch_5.Value/1000), "hh:mm:ss")
            Visible: =false
            Width: =150
            X: =545
            Y: =194
            ZIndex: =36

        lblSelectedUserRole_5 As label:
            FocusedBorderColor: =lblSelectedUserRole_5.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =Bold
            Height: =65
            HoverBorderColor: =lblSelectedUserRole_5.BorderColor
            HoverColor: =lblSelectedUserRole_5.Color
            HoverFill: =lblSelectedUserRole_5.Fill
            PressedBorderColor: =lblSelectedUserRole_5.BorderColor
            PressedColor: =lblSelectedUserRole_5.Color
            PressedFill: =lblSelectedUserRole_5.Fill
            Text: |-
                ="Selected User Role:"
            Visible: =showAddPermissions
            Width: =210
            X: =407
            Y: =746
            ZIndex: =37

        lblNote_5 As label:
            FocusedBorderColor: =lblNote_5.BorderColor
            Font: =Font.'Segoe UI'
            Height: =65
            HoverBorderColor: =lblNote_5.BorderColor
            HoverColor: =lblNote_5.Color
            HoverFill: =lblNote_5.Fill
            PressedBorderColor: =lblNote_5.BorderColor
            PressedColor: =lblNote_5.Color
            PressedFill: =lblNote_5.Fill
            Text: |-
                ="Note: You can make them an app owner after you've added them as a user."
            Visible: =showAddPermissions
            Width: =1037
            X: =404
            Y: =811
            ZIndex: =38

        btnAddUser_5 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisplayMode: =If( IsEmpty(galSearchPeopleresult_5.Selected), DisplayMode.Disabled, DisplayMode.Edit)
            Fill: =ColorValue(Style.Primary)
            FocusedBorderColor: =btnAddUser_5.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =Semibold
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |
                =ForAll(
                    EnvCheckedApps,
                    If(
                        drpSearchUserRole_5.SelectedText.Value = "Viewer" || drpSearchUserRole_5.SelectedText.Value = "Editor",
                        PowerAppsforAdmins.EditAdminAppRoleAssignment(
                            galEnvironments.Selected.Name,
                            AppName,
                            {
                                '$filter': "enviornment eq '" & galEnvironments.Selected.Environment & "'",
                                put: Table(
                                    {
                                        properties: {
                                            roleName: vUserRole,
                                            capabilities: [""],
                                            NotifyShareTargetOption: "Notify",
                                            principal: {
                                                email: galSearchPeopleresult_5.Selected.UserPrincipalName,
                                                id: Office365Users.UserProfileV2(galSearchPeopleresult_5.Selected.UserPrincipalName).id,
                                                type: "User",
                                                tenantId: "null"
                                            }
                                        }
                                    }
                                )
                            }
                        )
                    );
                    If(
                        drpSearchUserRole_5.SelectedText.Value = "Owner",
                        PowerAppsforAdmins.SetAdminAppOwner(
                            galEnvironments.Selected.Name,
                            AppName,
                            {
                                newAppOwner: Text(galSearchPeopleresult_5.Selected.Id),
                                roleForOldAppOwner: "CanEdit"
                            }
                        );
                        Patch(
                            'PowerApps Apps',
                            LookUp(
                                'PowerApps Apps',
                                App = AppName
                            ),
                            {
                                'App Owner': LookUp(
                                    Makers,
                                    'User Principal Name' = galSearchPeopleresult_5.Selected.UserPrincipalName
                                )
                            }
                        );
                        Refresh('PowerApps Apps')
                    )
                );
                UpdateContext({showAddPermissions: false});
                Reset(chkSelectAll);
                Clear(EnvCheckedApps);
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnAddUser_5.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Save"
            Visible: =showAddPermissions
            Width: =173
            X: =1083
            Y: =958
            ZIndex: =39

        btnCancelAddUser_5 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorValue(Style.Tertiary)
            FocusedBorderColor: =btnCancelAddUser_5.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =Semibold
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |-
                =UpdateContext({showAddPermissions: false})
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnCancelAddUser_5.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Cancel"
            Visible: =showAddPermissions
            Width: =173
            X: =1282
            Y: =958
            ZIndex: =40

        drpSearchUserRole_5 As dropdown:
            BorderColor: =RGBA(116, 116, 116, 1)
            ChevronBackground: =RGBA(202, 202, 202, 1)
            ChevronHoverBackground: =RGBA(116, 116, 116, 1)
            FocusedBorderColor: =drpSearchUserRole_5.BorderColor
            HoverBorderColor: =ColorFade(drpSearchUserRole_5.BorderColor, 15%)
            HoverFill: =RGBA(237, 237, 237, 1)
            Items: =["Viewer", "Editor","Owner"]
            OnChange: |-
                =If(
                    drpSearchUserRole_5.Selected.Value = "Editor",
                    UpdateContext({vUserRole: "CanEdit"}),
                    If(
                        drpSearchUserRole_5.Selected.Value = "Viewer",
                        UpdateContext({vUserRole: "CanView"}),
                        UpdateContext({vUserRole: "Owner"})
                    )
                )
            PressedBorderColor: =drpSearchUserRole_5.HoverBorderColor
            PressedFill: =RGBA(116, 116, 116, 1)
            SelectionFill: =RGBA(219, 219, 219, 1)
            Visible: =showAddPermissions
            X: =608
            Y: =758
            ZIndex: =41

    lblAppTitle_5 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(128, 128, 128, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppTitle_5.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =28
        HoverBorderColor: =lblAppTitle_5.BorderColor
        HoverColor: =lblAppTitle_5.Color
        HoverFill: =lblAppTitle_5.Fill
        PaddingLeft: =0
        PressedBorderColor: =lblAppTitle_5.BorderColor
        PressedColor: =lblAppTitle_5.Color
        PressedFill: =lblAppTitle_5.Fill
        Size: =11
        Text: ="LAST LAUNCHED"
        Width: =151
        X: =1327
        Y: =204
        ZIndex: =43

