OrphanedFlowScreen As screen:
    Height: =Max(App.Height, App.DesignHeight)
    OnVisible: =Set(SearchScreenNumber, 3);
    Orientation: =If(OrphanedFlowScreen.Width < OrphanedFlowScreen.Height, Layout.Vertical, Layout.Horizontal)
    Size: =1 + CountRows(App.SizeBreakpoints) - CountIf(App.SizeBreakpoints, Value >= OrphanedFlowScreen.Width)
    Width: =Max(App.Width, App.DesignWidth)

    galFlows_2 As gallery.galleryVertical:
        BorderColor: =ColorValue(Style.Tertiary)
        BorderStyle: =BorderStyle.None
        DisabledBorderColor: =galFlows_2.BorderColor
        DisabledFill: =galFlows_2.Fill
        Fill: =RGBA(255, 255, 255, 1)
        Height: =845
        HoverBorderColor: =galFlows_2.BorderColor
        HoverFill: =galFlows_2.Fill
        Items: |-
            =SortByColumns(Filter(
                Filter(
                    Flows, 'Flow is Orphaned'= "Yes" And 'Flow Deleted'='Flow Deleted (Flows)'.No
                ),
                txtSearchText_4.Text in 'Display Name' || txtSearchText_3.Text in FlowIDString
            ), "admin_displayname")
        Layout: =Layout.Vertical
        LoadingSpinnerColor: =galFlows_2.BorderColor
        OnSelect: |-
            =//select the flow
            Set(SelectedFlow, galFlows_2.Selected);
            
            //set the owner
            Set(FlowDerivedOwner, LookUp(Flows, Flow=SelectedFlow.Flow).DerivedOwner.Maker);
            If(IsBlank(FlowDerivedOwner), Set(FlowDerivedOwner, LookUp(Flows, Flow=SelectedFlow.Flow).'Flow Creator UPN'));
            
            //navigate
            Navigate(FlowDetailsScreen)
        PressedBorderColor: =galFlows_2.BorderColor
        PressedFill: =galFlows_2.Fill
        TemplateSize: =86
        Width: =1780
        X: =80
        Y: =235
        ZIndex: =1

        lblAppname_3 As label:
            BorderColor: =RGBA(218,218,218,1.00)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(47,41,43,1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70)
            FocusedBorderColor: =lblAppname_3.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =86
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(4,45,81,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(4,45,81,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Size: =16
            Text: |
                =ThisItem.'Display Name'
            Width: =500
            X: =81
            ZIndex: =2

        lblAppID_3 As label:
            BorderColor: =RGBA(218,218,218,1.00)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(47,41,43,1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70)
            FocusedBorderColor: =lblAppID_3.BorderColor
            Font: =Font.'Segoe UI'
            Height: =50
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(4,45,81,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(4,45,81,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Text: =ThisItem.'Flow Environment'.admin_displayname
            Width: =380
            X: =1100
            Y: =19
            ZIndex: =3

        lblOwner_2 As label:
            BorderColor: =RGBA(218,218,218,1.00)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(47,41,43,1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70)
            FocusedBorderColor: =lblOwner_2.BorderColor
            Font: =Font.'Segoe UI'
            Height: =50
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(4,45,81,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(4,45,81,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Text: =Text(ThisItem.'Flow Modified On',"[$-en-US]dd-mmm-yyyy")
            Width: =200
            X: =592
            Y: =19
            ZIndex: =5

        chkSelectApp_2 As checkbox:
            BorderColor: =ColorValue(Style.Primary)
            CheckboxBorderColor: =RGBA(128, 128, 128, 1)
            Default: =chkSelectAll_2.Value
            FocusedBorderColor: =chkSelectApp_2.BorderColor
            Height: =40
            HoverBorderColor: =ColorFade(chkSelectApp_2.BorderColor, 30%)
            HoverFill: =ColorFade(chkSelectApp_2.Fill, 30%)
            OnCheck: |-
                =Collect(
                    OrphanedCheckedFlows,
                    {
                        FlowName: ThisItem.Flow,
                        EnvName: ThisItem.'Flow Environment'.Name,
                        Environment: ThisItem.'Flow Environment'.Environment
                    }
                )
            OnUncheck: =Remove(OrphanedCheckedFlows,LookUp(OrphanedCheckedFlows,FlowName=ThisItem.Flow));
            PressedBorderColor: =ColorFade(chkSelectApp_2.BorderColor, -30%)
            PressedColor: =ColorValue(Style.Primary)
            PressedFill: =ColorFade(chkSelectApp_2.Fill, -30%)
            Text: =""
            Width: =40
            Y: =20
            ZIndex: =6

        btnEditSelected_5 As button:
            AutoDisableOnSelect: =false
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorValue(Style.Primary)
            FocusedBorderColor: =btnEditSelected_5.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =Semibold
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: =Launch(theFlowURL & ThisItem.'Flow Environment'.Name & "/flows/" & ThisItem.Flow & "/details")
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnEditSelected_5.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Launch"
            Width: =125
            X: =1500
            Y: =22
            ZIndex: =7

        Icon1_3 As icon.Warning:
            Color: =RGBA(253, 222, 207, 1)
            DisabledFill: =Icon1_3.Fill
            Height: =57
            HoverBorderColor: =ColorFade(Icon1_3.BorderColor, 20%)
            HoverColor: =ColorFade(Icon1_3.Color, 20%)
            HoverFill: =Icon1_3.Fill
            Icon: =Icon.Warning
            OnSelect: =Select(Parent)
            PressedBorderColor: =ColorFade(Icon1_3.BorderColor, -20%)
            PressedColor: =ColorFade(Icon1_3.Color, -20%)
            PressedFill: =Icon1_3.Fill
            TabIndex: ="Solution Flows cannot yet have their permissions edited programatically"
            Tooltip: ="Flows in Solutions can only be deleted or assigned new owners. They cannot have other permission types edited programmatically"
            Visible: =If(IsBlankOrError(ThisItem.WorkflowEntityId), false, true)
            Width: =44
            X: =1670
            Y: =12
            ZIndex: =9

        Label2 As label:
            Align: =Center
            Height: =50
            OnSelect: =Select(Parent)
            Text: |-
                =CountRows(
                    PowerAutomateforAdmins.GetAdminFlowOwnerRole(
                        ThisItem.'Flow Environment'.Name,
                        ThisItem.Flow
                    ).value
                )
            Width: =78
            X: =853
            Y: =19
            ZIndex: =10

    bkgHeader_3 As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        DisabledFill: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(244, 244, 244, 1)
        FocusedBorderColor: =bkgHeader_3.BorderColor
        FocusedBorderThickness: =4
        Height: =52
        HoverFill: =bkgHeader_3.Fill
        OnSelect: =
        PressedFill: =bkgHeader_3.Fill
        TabIndex: =0
        Width: =1920
        X: =
        ZIndex: =3

    lblAppTitle_12 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppTitle_12.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =Bold
        Height: =48
        HoverBorderColor: =lblAppTitle_12.BorderColor
        HoverColor: =lblAppTitle_12.Color
        HoverFill: =lblAppTitle_12.Fill
        PaddingLeft: =0
        PressedBorderColor: =lblAppTitle_12.BorderColor
        PressedColor: =lblAppTitle_12.Color
        PressedFill: =lblAppTitle_12.Fill
        Size: =20
        Text: ="Admin - Flow Permission Center"
        Width: =575
        X: =80
        Y: =68
        ZIndex: =4

    imgLogo_3 As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =imgLogo_3.BorderColor
        FocusedBorderThickness: =4
        Height: =39
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =Style.Logo
        PaddingBottom: =10
        PaddingTop: =5
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =233
        X: =5
        Y: =10
        ZIndex: =5

    Rectangle1_3 As rectangle:
        DisabledFill: =Rectangle1_3.Fill
        Fill: =ColorValue(Style.Tertiary)
        FocusedBorderColor: =Rectangle1_3.BorderColor
        Height: =2
        HoverFill: =Rectangle1_3.Fill
        PressedFill: =Rectangle1_3.Fill
        Width: =1821
        X: =62
        Y: =231
        ZIndex: =8

    grpSearch_3 As group:
        Height: =5
        Width: =5
        X: =-1258
        Y: =-97
        ZIndex: =8

        txtSearchText_4 As text:
            BorderColor: =ColorValue(Style.Tertiary)
            BorderThickness: =1
            Default: =""
            DisabledBorderColor: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =txtSearchText_4.BorderColor
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            Height: =45
            HintText: ="Search flows ..."
            HoverBorderColor: =RGBA(255, 255, 255, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            PaddingBottom: =0
            PaddingLeft: =20
            PaddingRight: =10
            PaddingTop: =0
            PressedBorderColor: =RGBA(0, 120, 212, 1)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Width: =600
            X: =1266
            Y: =71
            ZIndex: =6

        iDeleteSearchText_4 As icon.Cancel:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(128, 128, 128, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =iDeleteSearchText_4.BorderColor
            FocusedBorderThickness: =4
            Height: =45
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(55, 14, 64, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Cancel
            OnSelect: =Reset(txtSearchText_4)
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Width: =34
            X: =1832
            Y: =71
            ZIndex: =7

    lblAppTitle_13 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(128, 128, 128, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppTitle_13.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =28
        HoverBorderColor: =lblAppTitle_13.BorderColor
        HoverColor: =lblAppTitle_13.Color
        HoverFill: =lblAppTitle_13.Fill
        PaddingLeft: =0
        PressedBorderColor: =lblAppTitle_13.BorderColor
        PressedColor: =lblAppTitle_13.Color
        PressedFill: =lblAppTitle_13.Fill
        Size: =11
        Text: ="FLOW DISPLAY NAME"
        Width: =151
        X: =170
        Y: =203
        ZIndex: =11

    lblAppTitle_14 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(128, 128, 128, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppTitle_14.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =28
        HoverBorderColor: =lblAppTitle_14.BorderColor
        HoverColor: =lblAppTitle_14.Color
        HoverFill: =lblAppTitle_14.Fill
        PaddingLeft: =0
        PressedBorderColor: =lblAppTitle_14.BorderColor
        PressedColor: =lblAppTitle_14.Color
        PressedFill: =lblAppTitle_14.Fill
        Size: =11
        Text: ="LAST MODIFIED DATE"
        Width: =151
        X: =677
        Y: =203
        ZIndex: =12

    lblAppTitle_15 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(128, 128, 128, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppTitle_15.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =28
        HoverBorderColor: =lblAppTitle_15.BorderColor
        HoverColor: =lblAppTitle_15.Color
        HoverFill: =lblAppTitle_15.Fill
        PaddingLeft: =0
        PressedBorderColor: =lblAppTitle_15.BorderColor
        PressedColor: =lblAppTitle_15.Color
        PressedFill: =lblAppTitle_15.Fill
        Size: =11
        Text: ="ENVIRONMENT"
        Width: =151
        X: =1176
        Y: =203
        ZIndex: =13

    grpTabs_2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =23

        lblTabEnvironment_2 As label:
            Align: =Center
            FocusedBorderColor: =lblTabEnvironment_2.BorderColor
            Height: =37
            HoverBorderColor: =lblTabEnvironment_2.BorderColor
            HoverColor: =lblTabEnvironment_2.Color
            HoverFill: =lblTabEnvironment_2.Fill
            OnSelect: =Navigate(HomeScreen)
            PressedBorderColor: =lblTabEnvironment_2.BorderColor
            PressedColor: =lblTabEnvironment_2.Color
            PressedFill: =lblTabEnvironment_2.Fill
            Text: ="ENVIRONMENT"
            Width: =160
            X: =88
            Y: =125
            ZIndex: =19

        clrSelectTab_2 As rectangle:
            DisabledFill: =clrSelectTab_2.Fill
            Fill: =ColorValue(Style.Primary)
            FocusedBorderColor: =clrSelectTab_2.BorderColor
            Height: =4
            HoverFill: =clrSelectTab_2.Fill
            PressedFill: =clrSelectTab_2.Fill
            Width: =160
            X: =408
            Y: =167
            ZIndex: =20

        lblTabOwner_2 As label:
            Align: =Center
            FocusedBorderColor: =lblTabOwner_2.BorderColor
            Height: =37
            HoverBorderColor: =lblTabOwner_2.BorderColor
            HoverColor: =lblTabOwner_2.Color
            HoverFill: =lblTabOwner_2.Fill
            OnSelect: =Navigate(OwnerScreen)
            PressedBorderColor: =lblTabOwner_2.BorderColor
            PressedColor: =lblTabOwner_2.Color
            PressedFill: =lblTabOwner_2.Fill
            Text: ="OWNER"
            Width: =160
            X: =248
            Y: =125
            ZIndex: =21

        lblTabOrphanedApp_2 As label:
            Align: =Center
            FocusedBorderColor: =lblTabOrphanedApp_2.BorderColor
            Height: =37
            HoverBorderColor: =lblTabOrphanedApp_2.BorderColor
            HoverColor: =lblTabOrphanedApp_2.Color
            HoverFill: =lblTabOrphanedApp_2.Fill
            OnSelect: =
            PressedBorderColor: =lblTabOrphanedApp_2.BorderColor
            PressedColor: =lblTabOrphanedApp_2.Color
            PressedFill: =lblTabOrphanedApp_2.Fill
            Text: ="ORPHANED FLOW"
            Width: =160
            X: =408
            Y: =125
            ZIndex: =22

    chkSelectAll_2 As checkbox:
        BorderColor: =ColorValue(Style.Primary)
        CheckboxBorderColor: =RGBA(128, 128, 128, 1)
        FocusedBorderColor: =chkSelectAll_2.BorderColor
        Height: =40
        HoverBorderColor: =ColorFade(chkSelectAll_2.BorderColor, 30%)
        HoverFill: =ColorFade(chkSelectAll_2.Fill, 30%)
        OnCheck: |-
            =Clear(OrphanedCheckedFlows);
            ForAll(
                galFlows_2.AllItems,
                Collect(
                    OrphanedCheckedFlows,
                    {
                        FlowName: Flow,
                        EnvName: 'Flow Environment'.Name,
                        Environment: 'Flow Environment'.Environment
                    }
                )
            )
        OnUncheck: =Clear(OrphanedCheckedFlows)
        PressedBorderColor: =ColorFade(chkSelectAll_2.BorderColor, -30%)
        PressedColor: =ColorValue(Style.Primary)
        PressedFill: =ColorFade(chkSelectAll_2.Fill, -30%)
        Text: =""
        Width: =40
        X: =86
        Y: =192
        ZIndex: =26

    btnEditSelected_4 As button:
        AutoDisableOnSelect: =false
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        Color: =RGBA(0, 0, 0, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisplayMode: =If(!IsEmpty(galFlows_2.AllItems)&&CountRows(OrphanedCheckedFlows)>0, DisplayMode.Edit, DisplayMode.Disabled)
        Fill: =ColorValue(Style.Primary)
        FocusedBorderColor: =btnEditSelected_4.BorderColor
        Font: =Font.'Segoe UI'
        FontWeight: =Semibold
        Height: =41
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =ColorValue(Style.Secondary)
        OnSelect: |-
            =UpdateContext({showDeleteSelected:true})
        PaddingBottom: =10
        PaddingLeft: =10
        PaddingRight: =10
        PaddingTop: =10
        PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =ColorFade(btnEditSelected_4.Fill, -30%)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =14
        Text: ="Delete Selected"
        Width: =175
        X: =1691
        Y: =125
        ZIndex: =42

    bkgPopUp_6 As rectangle:
        DisabledFill: =bkgPopUp_6.Fill
        Fill: =RGBA(0, 0, 0, 0.35)
        FocusedBorderColor: =bkgPopUp_6.BorderColor
        Height: =1080
        HoverFill: =bkgPopUp_6.Fill
        PressedFill: =bkgPopUp_6.Fill
        Visible: =showAddPermissions || showDeleteSelected
        Width: =1920
        ZIndex: =47

    grpAddUsers_7 As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =61

        bkgAddNewUsers_7 As rectangle:
            DisabledFill: =bkgAddNewUsers_7.Fill
            Fill: =RGBA(244, 244, 244, 1)  
            FocusedBorderColor: =bkgAddNewUsers_7.BorderColor
            Height: =950
            HoverFill: =bkgAddNewUsers_7.Fill
            PressedFill: =bkgAddNewUsers_7.Fill
            Visible: =showAddPermissions
            Width: =1098
            X: =374
            Y: =65
            ZIndex: =48

        lblAddNewUsers_7 As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =lblAddNewUsers_7.BorderColor
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =Bold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0,0,0,1.00)
            HoverFill: =RGBA(0, 0, 0, 0)
            PaddingLeft: =0
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(0,0,0,1.00)
            PressedFill: =RGBA(0, 0, 0, 0)
            Size: =16
            Text: ="Add New Users"
            Visible: =showAddPermissions
            Width: =266
            X: =385
            Y: =80
            ZIndex: =49

        txtSearchUser_7 As text:
            Align: =Center
            BorderColor: =RGBA(220,220,220,1)
            BorderThickness: =1
            Color: =Black
            Default: =""
            DisabledBorderColor: =RGBA(159, 167, 165, 1)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            DisabledFill: =ColorFade(RGBA(159, 167, 165, 1), 50%)
            DisplayMode: =If(false,DisplayMode.View,DisplayMode.Edit)
            FocusedBorderColor: =txtSearchUser_7.BorderColor
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            FontWeight: =Lighter
            Height: =50
            HintText: ="Type a name or an email address"
            HoverBorderColor: =RGBA(159,159,159,1)
            HoverColor: =Black
            HoverFill: =White
            OnSelect: =
            PressedBorderColor: =txtSearchUser_7.HoverBorderColor
            PressedColor: =txtSearchUser_7.Color
            PressedFill: =txtSearchUser_7.Fill
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Reset: =clearSearchField
            Size: =18
            Tooltip: ="Search people input field"
            Visible: =showAddPermissions
            Width: =1049
            X: =395
            Y: =131
            ZIndex: =50

        galSearchPeopleresult_7 As gallery.galleryVertical:
            BorderColor: =RGBA(233, 232, 233, 1)
            BorderStyle: =BorderStyle.None
            DisabledBorderColor: =galSearchPeopleresult_7.BorderColor
            DisabledFill: =galSearchPeopleresult_7.Fill
            Height: =476
            HoverBorderColor: =galSearchPeopleresult_7.BorderColor
            HoverFill: =galSearchPeopleresult_7.Fill
            Items: =If(Len(txtSearchUser_7.Text) > 3,searchResultsCol)
            Layout: =Layout.Vertical
            LoadingSpinnerColor: =galSearchPeopleresult_7.BorderColor
            OnSelect: =
            PressedBorderColor: =galSearchPeopleresult_7.BorderColor
            PressedFill: =galSearchPeopleresult_7.Fill
            TemplateFill: =If(ThisItem.IsSelected, ColorValue(Style.Primary), White)
            TemplateSize: =138
            Visible: =showAddPermissions
            Width: =1060
            X: =393
            Y: =233
            ZIndex: =51

            imgSearchProfilePic_7 As image:
                ApplyEXIFOrientation: =false
                BorderColor: =RGBA(101, 128, 187, 1)
                DisabledBorderColor: =RGBA(159, 167, 165, 1)
                DisabledFill: =RGBA(193, 193, 193, 0.95)
                Fill: =RGBA(230, 230, 230, 1)
                FocusedBorderColor: =imgSearchProfilePic_7.BorderColor
                Height: =80
                HoverBorderColor: =ColorFade(imgSearchProfilePic_7.BorderColor, 20%)
                HoverFill: =ColorFade(imgSearchProfilePic_7.Fill, 20%)
                Image: |-
                    =If(!IsBlank(ThisItem.UserPrincipalName), Office365Users.UserPhotoV2(ThisItem.UserPrincipalName))  //If(IsBlank(TextBox_hiddenImageState.Text),'preload - user',"data:image/jpeg;base64," & TextBox_hiddenImageState.Text)
                ImagePosition: =ImagePosition.Fill
                PressedBorderColor: =ColorFade(imgSearchProfilePic_7.BorderColor, -20%)
                PressedFill: =ColorFade(imgSearchProfilePic_7.Fill, -20%)
                RadiusBottomLeft: =40
                RadiusBottomRight: =40
                RadiusTopLeft: =40
                RadiusTopRight: =40
                TabIndex: =0
                Width: =80
                X: =5
                Y: =27
                ZIndex: =5

            lblSearchUserID_7 As label:
                FocusedBorderColor: =lblSearchUserID_7.BorderColor
                Font: =Font.'Segoe UI'
                Height: =35
                HoverBorderColor: =lblSearchUserID_7.BorderColor
                HoverColor: =lblSearchUserID_7.Color
                HoverFill: =lblSearchUserID_7.Fill
                OnSelect: =Select(Parent)
                PressedBorderColor: =lblSearchUserID_7.BorderColor
                PressedColor: =lblSearchUserID_7.Color
                PressedFill: =lblSearchUserID_7.Fill
                Text: |-
                    =If( !IsBlank(txtSearchUser_7), "User ID: " & Office365Users.UserProfileV2(ThisItem.UserPrincipalName).id)
                Width: =536
                X: =100
                Y: =88
                ZIndex: =8

            lblSearchEmail_7 As label:
                FocusedBorderColor: =lblSearchEmail_7.BorderColor
                Font: =Font.'Segoe UI'
                Height: =41
                HoverBorderColor: =lblSearchEmail_7.BorderColor
                HoverColor: =lblSearchEmail_7.Color
                HoverFill: =lblSearchEmail_7.Fill
                OnSelect: =Select(Parent)
                PressedBorderColor: =lblSearchEmail_7.BorderColor
                PressedColor: =lblSearchEmail_7.Color
                PressedFill: =lblSearchEmail_7.Fill
                Text: =ThisItem.UserPrincipalName
                Width: =443
                X: =100
                Y: =47
                ZIndex: =9

            lblSearchName_7 As label:
                FocusedBorderColor: =lblSearchName_7.BorderColor
                Font: =Font.'Segoe UI'
                FontWeight: =Bold
                Height: =48
                HoverBorderColor: =lblSearchName_7.BorderColor
                HoverColor: =lblSearchName_7.Color
                HoverFill: =lblSearchName_7.Fill
                OnSelect: =Select(Parent)
                PressedBorderColor: =lblSearchName_7.BorderColor
                PressedColor: =lblSearchName_7.Color
                PressedFill: =lblSearchName_7.Fill
                Size: =16
                Text: =ThisItem.GivenName & " " & ThisItem.Surname
                Width: =550
                X: =100
                Y: =9
                ZIndex: =10

        iSearch_7 As icon.Search:
            BorderColor: =RGBA(101, 128, 187, 1)
            Color: =RGBA(220,220,220,1)
            DisabledBorderColor: =RGBA(159, 167, 165, 1)
            DisabledColor: =RGBA(193, 193, 193, 0.95)
            DisabledFill: =iSearch_7.Fill
            FocusedBorderColor: =iSearch_7.BorderColor
            Height: =50
            HoverBorderColor: =ColorFade(iSearch_7.BorderColor, 20%)
            HoverColor: =ColorFade(iSearch_7.Color, 20%)
            HoverFill: =iSearch_7.Fill
            Icon: =Icon.Search
            PaddingBottom: =5
            PaddingLeft: =5
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(iSearch_7.BorderColor, -20%)
            PressedColor: =ColorFade(iSearch_7.Color, -20%)
            PressedFill: =iSearch_7.Fill
            Visible: =showAddPermissions
            Width: =50
            X: =407
            Y: =131
            ZIndex: =52

        lblFetchingData_7 As label:
            BorderColor: =RGBA(101, 128, 187, 1)
            Color: =RGBA(47,41,43,1)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            FocusedBorderColor: =lblFetchingData_7.BorderColor
            Font: =Font.Arial
            Height: =35
            HoverBorderColor: =lblFetchingData_7.BorderColor
            HoverColor: =lblFetchingData_7.Color
            HoverFill: =lblFetchingData_7.Fill
            PressedBorderColor: =lblFetchingData_7.BorderColor
            PressedColor: =lblFetchingData_7.Color
            PressedFill: =lblFetchingData_7.Fill
            Size: =18
            Text: =searchStatus
            Visible: =false
            Width: =300
            X: =395
            Y: =181
            ZIndex: =53

        imgClearInput_7 As image:
            ApplyEXIFOrientation: =false
            BorderColor: =RGBA(101, 128, 187, 1)
            DisabledBorderColor: =RGBA(159, 167, 165, 1)
            DisabledFill: =RGBA(193, 193, 193, 0.95)
            FocusedBorderColor: =imgClearInput_7.BorderColor
            Height: =txtSearchUser_7.Height
            HoverBorderColor: =ColorFade(imgClearInput_7.BorderColor, 20%)
            HoverFill: =ColorFade(imgClearInput_7.Fill, 20%)
            Image: =closedark
            OnSelect: |-
                =UpdateContext({clearSearchField:false});UpdateContext({clearSearchField:true})
            PaddingBottom: =15
            PaddingLeft: =15
            PaddingRight: =15
            PaddingTop: =15
            PressedBorderColor: =ColorFade(imgClearInput_7.BorderColor, -20%)
            PressedFill: =ColorFade(imgClearInput_7.Fill, -20%)
            Visible: =showAddPermissions
            Width: =txtSearchUser_7.Height
            X: =1394
            Y: =131
            ZIndex: =54

        tmrSearch_7 As timer:
            BorderColor: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            DisabledColor: =RGBA(186, 186, 186, 1)
            DisabledFill: =RGBA(119, 119, 119, 1)
            DisplayMode: =If(false,DisplayMode.View,DisplayMode.Edit)
            Duration: =300
            Fill: =RGBA(69, 69, 69, 1)
            FocusedBorderColor: =tmrSearch_7.BorderColor
            HoverBorderColor: =ColorFade(tmrSearch_7.BorderColor, 20%)
            HoverColor: =tmrSearch_7.Color
            HoverFill: =ColorFade(tmrSearch_7.Fill, 20%)
            OnTimerEnd: |-
                =If(
                    Len(txtSearchUser_7.Text) = searchTextCount,
                    ClearCollect(
                        searchResultsCol,       
                            Office365Users.SearchUser({searchTerm: PlainText(txtSearchUser_7.Text)})
                        
                    );
                    If(
                        IsEmpty(searchResultsCol),
                        UpdateContext({searchStatus: "No match found"}),
                        UpdateContext({searchStatus: "Match found"})
                    )
                )
            OnTimerStart: |-
                =UpdateContext({searchStatus:"Searching...",searchTextCount:Len(txtSearchUser_7.Text)})
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =ColorFade(tmrSearch_7.BorderColor, -20%)
            PressedColor: =tmrSearch_7.Color
            PressedFill: =ColorFade(tmrSearch_7.Fill, -20%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Repeat: =Len(txtSearchUser_7.Text)> 2 && Len(txtSearchUser_7.Text) <> searchTextCount
            Size: =11
            Start: =Len(txtSearchUser_7.Text) > 2
            Text: |-
                =Text(Time(0, 0, tmrSearch_7.Value/1000), "hh:mm:ss")
            Visible: =false
            Width: =150
            X: =545
            Y: =194
            ZIndex: =55

        lblSelectedUserRole_7 As label:
            FocusedBorderColor: =lblSelectedUserRole_7.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =Bold
            Height: =65
            HoverBorderColor: =lblSelectedUserRole_7.BorderColor
            HoverColor: =lblSelectedUserRole_7.Color
            HoverFill: =lblSelectedUserRole_7.Fill
            PressedBorderColor: =lblSelectedUserRole_7.BorderColor
            PressedColor: =lblSelectedUserRole_7.Color
            PressedFill: =lblSelectedUserRole_7.Fill
            Text: |-
                ="Selected User Role:"
            Visible: =showAddPermissions
            Width: =210
            X: =407
            Y: =746
            ZIndex: =56

        lblNote_7 As label:
            FocusedBorderColor: =lblNote_7.BorderColor
            Font: =Font.'Segoe UI'
            Height: =65
            HoverBorderColor: =lblNote_7.BorderColor
            HoverColor: =lblNote_7.Color
            HoverFill: =lblNote_7.Fill
            PressedBorderColor: =lblNote_7.BorderColor
            PressedColor: =lblNote_7.Color
            PressedFill: =lblNote_7.Fill
            Text: |-
                ="Note: You can make them an app owner after you've added them as a user."
            Visible: =showAddPermissions
            Width: =1037
            X: =404
            Y: =811
            ZIndex: =57

        btnAddUser_7 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisplayMode: =If( IsEmpty(galSearchPeopleresult_7.Selected), DisplayMode.Disabled, DisplayMode.Edit)
            Fill: =ColorValue(Style.Primary)
            FocusedBorderColor: =btnAddUser_7.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =Semibold
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |
                =ForAll(
                    OrphanedCheckedFlows,
                    PowerAutomateforAdmins.EditAdminFlowOwnerRole(
                        EnvName,
                        FlowName,
                        {
                            put: Table(
                                {
                                    properties: {
                                        roleName: vUserRole,
                                        capabilities: [""],
                                        NotifyShareTargetOption: "Notify",
                                        principal: {
                                            email: galSearchPeopleresult_7.Selected.UserPrincipalName,
                                            id: Office365Users.UserProfileV2(galSearchPeopleresult_7.Selected.UserPrincipalName).id,
                                            displayName: galSearchPeopleresult_7.Selected.DisplayName,
                                            type: "User",
                                            tenantId: "null"
                                        }
                                    }
                                }
                            )
                        }
                    );
                    Patch(
                        Flows,
                        LookUp(
                            Flows,
                            Flow = FlowName
                        ),
                        {'Flow is Orphaned': "no"}
                    )
                );    Refresh(Flows);
                UpdateContext({showAddPermissions: false});
                Reset(chkSelectAll_2);
                Clear(OrphanedCheckedFlows);
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnAddUser_7.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Save"
            Visible: =showAddPermissions
            Width: =173
            X: =1083
            Y: =958
            ZIndex: =58

        btnCancelAddUser_7 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorValue(Style.Tertiary)
            FocusedBorderColor: =btnCancelAddUser_7.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =Semibold
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |-
                =UpdateContext({showAddPermissions: false})
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnCancelAddUser_7.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Cancel"
            Visible: =showAddPermissions
            Width: =173
            X: =1282
            Y: =958
            ZIndex: =59

        drpSearchUserRole_7 As dropdown:
            BorderColor: =RGBA(116, 116, 116, 1)
            ChevronBackground: =RGBA(202, 202, 202, 1)
            ChevronHoverBackground: =RGBA(116, 116, 116, 1)
            FocusedBorderColor: =drpSearchUserRole_7.BorderColor
            HoverBorderColor: =ColorFade(drpSearchUserRole_7.BorderColor, 15%)
            HoverFill: =RGBA(237, 237, 237, 1)
            Items: =["Viewer", "Editor","Owner"]
            OnChange: |-
                =If(
                    drpSearchUserRole_7.Selected.Value = "Editor",
                    UpdateContext({vUserRole: "CanEdit"}),
                    If(
                        drpSearchUserRole_7.Selected.Value = "Viewer",
                        UpdateContext({vUserRole: "CanView"}),
                        UpdateContext({vUserRole: "Owner"})
                    )
                )
            PressedBorderColor: =drpSearchUserRole_7.HoverBorderColor
            PressedFill: =RGBA(116, 116, 116, 1)
            SelectionFill: =RGBA(219, 219, 219, 1)
            Visible: =showAddPermissions
            X: =608
            Y: =758
            ZIndex: =60

    lblAppTitle_16 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(128, 128, 128, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppTitle_16.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =28
        HoverBorderColor: =lblAppTitle_16.BorderColor
        HoverColor: =lblAppTitle_16.Color
        HoverFill: =lblAppTitle_16.Fill
        PaddingLeft: =0
        PressedBorderColor: =lblAppTitle_16.BorderColor
        PressedColor: =lblAppTitle_16.Color
        PressedFill: =lblAppTitle_16.Fill
        Size: =11
        Text: ="FLOW SETTINGS"
        Width: =151
        X: =1590
        Y: =203
        ZIndex: =65

    grpDeletedUser As group:
        Height: =5
        Width: =5
        X: =-236
        Y: =-286
        ZIndex: =65

        bkgAddNewUsers_8 As rectangle:
            DisabledFill: =bkgAddNewUsers_8.Fill
            Fill: =RGBA(244, 244, 244, 1)  
            FocusedBorderColor: =bkgAddNewUsers_8.BorderColor
            Height: =286
            HoverFill: =bkgAddNewUsers_8.Fill
            PressedFill: =bkgAddNewUsers_8.Fill
            Visible: =showDeleteSelected
            Width: =699
            X: =573
            Y: =397
            ZIndex: =61

        lblNoteDeleteApp As label:
            FocusedBorderColor: =lblNoteDeleteApp.BorderColor
            Font: =Font.'Segoe UI'
            Height: =65
            HoverBorderColor: =lblNoteDeleteApp.BorderColor
            HoverColor: =lblNoteDeleteApp.Color
            HoverFill: =lblNoteDeleteApp.Fill
            PressedBorderColor: =lblNoteDeleteApp.BorderColor
            PressedColor: =lblNoteDeleteApp.Color
            PressedFill: =lblNoteDeleteApp.Fill
            Text: ="Are you sure you want to delete the selected App(s)?"
            Visible: =showDeleteSelected
            Width: =500
            X: =718
            Y: =466
            ZIndex: =62

        btnDeleteAppYes As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisplayMode: =If( IsEmpty(galSearchPeopleresult_7.Selected), DisplayMode.Disabled, DisplayMode.Edit)
            Fill: =ColorValue(Style.Primary)
            FocusedBorderColor: =btnDeleteAppYes.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =Semibold
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |
                =ForAll(
                    OrphanedCheckedFlows,
                    PowerAutomateforAdmins.RemoveAdminFlow(
                        EnvName,
                        FlowName,
                        {'api-version': "2016-11-01"}
                    );
                    Patch(
                        Flows,
                        LookUp(
                            Flows,
                            Flow = FlowName
                        ),{'Flow Deleted':true,'Flow Deleted On':Now()}
                    );Refresh(Flows)
                );
                UpdateContext({showDeleteSelected: false});
                Reset(chkSelectAll_2);
                Clear(OrphanedCheckedFlows);
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnDeleteAppYes.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Yes"
            Visible: =showDeleteSelected
            Width: =173
            X: =740
            Y: =579
            ZIndex: =63

        btnDeleteAppNo As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorValue(Style.Tertiary)
            FocusedBorderColor: =btnDeleteAppNo.BorderColor
            Font: =Font.'Segoe UI'
            FontWeight: =Semibold
            Height: =41
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =ColorValue(Style.Secondary)
            OnSelect: |-
                =UpdateContext({showDeleteSelected: false})
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(btnDeleteAppNo.Fill, -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="No"
            Visible: =showDeleteSelected
            Width: =173
            X: =939
            Y: =579
            ZIndex: =64

    lblAppTitle_17 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(128, 128, 128, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: =lblAppTitle_17.BorderColor
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =28
        HoverBorderColor: =lblAppTitle_17.BorderColor
        HoverColor: =lblAppTitle_17.Color
        HoverFill: =lblAppTitle_17.Fill
        PaddingLeft: =0
        PressedBorderColor: =lblAppTitle_17.BorderColor
        PressedColor: =lblAppTitle_17.Color
        PressedFill: =lblAppTitle_17.Fill
        Size: =11
        Text: ="NUMBER EDITORS"
        Width: =128
        X: =924
        Y: =203
        ZIndex: =66

