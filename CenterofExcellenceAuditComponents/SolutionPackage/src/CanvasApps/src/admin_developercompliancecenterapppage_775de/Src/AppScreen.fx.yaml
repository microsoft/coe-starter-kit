AppScreen As screen:
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: |-
        =UpdateContext({selectedKey:"missingdetails"});
        UpdateContext({ varRootName:"My Apps", varRootIcon: "List", varRootKey: "MyApps" });

    diagPublish As Dialog:
        Buttons: |-
            =If(
                DateValue(vSelectedAppN.'App Modified On') = DateValue(vSelectedAppN.'App Published'),
                Table(
                    {
                        Label: "Cancel",
                        ButtonType: 'Button.ButtonType'.Standard
                    }
                ),
                Table(
                    {
                        Label: "Publish",
                        ButtonType: 'Button.ButtonType'.Primary
                    },
                    {
                        Label: "Cancel",
                        ButtonType: 'Button.ButtonType'.Standard
                    }
                )
            )
        DialogHeight: =220
        DialogWidth: =500
        Fill: =diagPublish.OverlayColor
        Height: =App.Height
        OnButtonSelect: |-
            =Switch(
                Self.SelectedButton.Label,
                "Publish",
                //show spinner
                Set(showLoader, true);
                Set(showLoaderText, "Republishing ...");
                
                //republish the app
                PowerAppsforMakers.PublishApp(vSelectedAppN.App);
                
                //update inventory
                UpdateIf('PowerApps Apps', App=vSelectedAppN.App, {'App Published': Now(), 'Admin Requirement - Republish State':'Risk Assessment State Choice'.Complete});
                
                //update collection
                UpdateIf(myApps, App=vSelectedAppN.App, {'App Published': Now(), 'Admin Requirement - Republish State':'Risk Assessment State Choice'.Complete});
                
                //update current selection
                Set(vSelectedAppN, LookUp(myApps, App=vSelectedAppN.App));
                
                //close dialog
                Set(showLoader, false);
                Set(showLoaderText, "");
                UpdateContext({showPopUp: false, showRepublish: false}),
            
                UpdateContext({showPopUp: false, showRepublish: false})
            )
        OnCloseSelect: |-
            =UpdateContext({showPopUp: false, showRepublish: false})
        OverlayColor: =RGBA(0, 0, 0, 0.2)
        SubTitle: |-
            =If(
                DateValue(vSelectedAppN.'App Modified On') = DateValue(vSelectedAppN.'App Published'),
                "The latest version of the app is already published. Re-publishing is not available.",
            
            "Have you tested the app in current builds of the Power Platform? If so, select Publish below to mark the task as complete. If not, please test the app first.")
        Title: ="Publish"
        Visible: =showPopUp && showRepublish
        Width: =App.Width

    c_MainContent As groupContainer.verticalAutoLayoutContainer:
        Fill: =ColorValue(AppTheme.palette.white)
        Height: =Parent.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width
        ZIndex: =1

        c_ActionHeader As groupContainer.verticalAutoLayoutContainer:
            Fill: =RGBA(243, 242, 241, 1)
            FillPortions: =0
            Height: =44
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutGap: =15
            LayoutJustifyContent: =LayoutJustifyContent.End
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =32
            PaddingRight: =32
            ZIndex: =1

            Label4 As Label:
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =0
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =320
                OnChange: =false
                Text: =CountRows(myEnvs)
                Width: =320
                X: =0
                Y: =0
                ZIndex: =1

            "cnxOwned As 'Fluent Context Menu (1.0.19)'.pcfdataset":
                AlignInContainer: =AlignInContainer.Center
                BorderColor: =
                Chevron: =true
                DisplayMode: =DisplayMode.Edit
                FontSize: =0
                Height: =33
                ItemDisplayName: ="ItemDisplayName"
                Items: |-
                    =Table(
                          {
                              ItemKey: "root",
                              ItemIconName: "List",
                              ItemDisplayName: Coalesce(varRootName,"My Apps")
                          },
                           {
                              ItemKey: "MyApps",
                              ItemIconName: "",
                              ItemDisplayName: "My own apps",
                              ItemOverflow:true,
                              ItemChecked: varRootKey="MyApps",
                              ItemWidth:140
                          },
                           {
                              ItemKey: "CoApps",
                              ItemIconName: "",
                              ItemDisplayName: "My and co-owned apps",
                              ItemOverflow:true,
                              ItemChecked: varRootKey="CoApps",
                              ItemWidth:200
                          })
                LayoutMinHeight: =33
                LayoutMinWidth: =200
                OnSelect: |-
                    =UpdateContext(
                        {
                            varRootKey: Self.Selected.ItemKey,
                            varRootName: Self.Selected.ItemDisplayName,
                            varRootIcon: Self.Selected.ItemIconName
                        }
                    )
                Theme: =SearchBoxThemeJson
                Width: =250
                X: =0
                Y: =0
                ZIndex: =2

                ItemDisplayName3 As pcfDataField.textualColumn:
                    FieldDisplayName: ="ItemDisplayName"
                    FieldName: ="ItemDisplayName"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =1
                    ZIndex: =14

            "inpSearchText As 'Fluent SearchBox (1.0.19) Preview'":
                AlignInContainer: =AlignInContainer.Center
                DisplayMode: =DisplayMode.Edit
                Height: =33
                LayoutMinHeight: =34
                LayoutMinWidth: =200
                PlaceHolderText: ="Search"
                Theme: =SearchBoxThemeJson
                Underlined: =true
                Width: =300
                X: =0
                Y: =0
                ZIndex: =3

            "chkOwned As 'Check box'":
                AccessibleLabel: ="Filter objects in which the logged-in user is an Owner."
                AlignInContainer: =AlignInContainer.Center
                Checked: =false
                CheckedCheckboxBackgroundFill: =
                CheckedCheckboxBorderColor: =
                CheckmarkFill: =
                Color: =
                DisplayMode: =DisplayMode.Edit
                Height: =32
                HoverCheckboxBackgroundFill: =
                HoverCheckboxBorderColor: =
                Label: ="Only owned apps"
                LayoutMinHeight: =32
                LayoutMinWidth: =160
                OnCheck: =false
                OnUncheck: =false
                UncheckedCheckboxBackgroundFill: =
                UncheckedCheckboxBorderColor: =
                Visible: =false
                Width: =160
                X: =548
                Y: =73
                ZIndex: =4

        Header As groupContainer.verticalAutoLayoutContainer:
            FillPortions: =0
            Height: =160
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =40
            PaddingRight: =40
            PaddingTop: =32
            ZIndex: =2

            Label1 As Label:
                AutoHeight: =true
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =16
                FontWeight: =FontWeight.Semibold
                Height: =43
                LayoutMinHeight: =32
                LayoutMinWidth: =320
                OnChange: =false
                PaddingStart: =0  
                Text: ="Canvas Apps"
                Width: =320
                X: =35
                Y: =15
                ZIndex: =1

            lblTitle_5 As Label:
                AlignInContainer: =AlignInContainer.Start
                AutoHeight: =false
                Color: =    
                DisplayMode: =DisplayMode.View
                FontSize: =11
                FontWeight: =FontWeight.Normal
                Height: =80
                LayoutMinHeight: =80
                LayoutMinWidth: =320
                OnChange: =false
                Text: ="Review canvas apps that you own or co-own that may need additional attention - your Power Platform admin team may have requested additional details, your app may be inactive or non-compliant. Provide additional Support Details to help keep your app in compliance."
                VerticalAlignment: =VerticalAlign.Top
                Width: =840
                Wrap: =true
                X: =0
                Y: =0
                ZIndex: =2

        c_Filters As groupContainer.horizontalAutoLayoutContainer:
            FillPortions: =0
            Height: =60
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutWrap: =true
            PaddingLeft: =40
            PaddingRight: =Self.PaddingLeft
            ZIndex: =3

            "pivotNav As 'Fluent Pivot (1.0.19)'.pcfdataset":
                AlignInContainer: =AlignInContainer.Stretch
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =200
                Items: |-
                    =Table({ItemKey:"all",ItemDisplayName:"All",ItemIconName:"ViewAll2"},
                                {ItemKey:"missingdetails",ItemDisplayName:"Missing Details",ItemIconName:"Info"},
                                {ItemKey:"inactive",ItemDisplayName:"Flagged as inactive",ItemIconName:"Clock"},
                                {ItemKey:"noncompliant",ItemDisplayName:"Non-Compliant",ItemIconName:"Warning"},
                                {ItemKey:"republish",ItemDisplayName:"Re-publish needed",ItemIconName:"WebPublish"}
                                
                                )
                LayoutMinHeight: =80
                LayoutMinWidth: =200
                SelectedKey: =selectedKey
                Theme: =AppThemeJson
                Width: =200
                X: =0
                Y: =0
                ZIndex: =2

                ItemDisplayName1 As pcfDataField.textualColumn:
                    FieldDisplayName: ="ItemDisplayName"
                    FieldName: ="ItemDisplayName"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =1
                    ZIndex: =5

        c_Empty As groupContainer.verticalAutoLayoutContainer:
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =24
            LayoutJustifyContent: =LayoutJustifyContent.Center
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            Visible: =CountRows(galApps.AllItems)=0
            ZIndex: =4

            lblEmpty As label:
                Align: =Align.Center
                AlignInContainer: =AlignInContainer.Stretch
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Size: =10.5
                TabIndex: =0
                Text: ="There are no apps to show based on the filters selected."
                ZIndex: =1

            btnShowAll As Button:
                AccessibleLabel: ="Select to show all apps."
                BorderColor: =
                ButtonType: ='Button.ButtonType'.Standard
                DisabledBorderColor: =
                DisabledFillColor: =
                DisabledTextColor: =
                DisplayMode: =DisplayMode.Edit
                FillColor: =ColorValue(AppTheme.palette.themePrimary)
                Height: =32
                HoverBorderColor: =
                HoverFillColor: =
                HoverTextColor: =
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                OnChange: =false
                OnSelect: |-
                    =UpdateContext({selectedKey:"all"});
                PressedBorderColor: =
                PressedFillColor: =
                PressedTextColor: =
                Text: ="Show all"
                TextColor: =ColorValue(AppTheme.palette.white)
                Width: =96
                X: =68
                Y: =155
                ZIndex: =2

        c_Apps As groupContainer.verticalAutoLayoutContainer:
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =Min(Last(App.SizeBreakpoints).Value, Parent.Width)
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =40
            PaddingRight: =40
            ZIndex: =6

            "galApps As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(237, 237, 237, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                DisabledBorderColor: =galApps.BorderColor
                DisabledFill: =galApps.Fill
                FillPortions: =7
                Height: =824
                HoverBorderColor: =galApps.BorderColor
                HoverFill: =galApps.Fill
                Items: |-
                    =With(
                        {
                            myAppOwnerId: GUID(myMakerProfile.Maker),
                            mySearchText: Trim(inpSearchText.SearchText)
                        },
                        If(pivotNav.SelectedKey = "all", Filter(myApps,  Or('App Type' = 'PowerApps Type'.Canvas, 'App Type' = 'PowerApps Type'.SharePointFormApp),   Or(
                                And(
                                    cnxOwned.Selected.ItemKey = "MyApps",
                                    'App Owner'.Maker = GUID(myMakerProfile.Maker)
                                ),
                                !chkOwned.Checked
                            ),Or(
                                IsBlank(mySearchText),
                                mySearchText in 'App Display Name',
                                mySearchText in 'App Environment Display Name'
                            )),
                    
                      Filter(
                            myApps,
                    
                            //filter by object type
                    
                            Or('App Type' = 'PowerApps Type'.Canvas, 'App Type' = 'PowerApps Type'.SharePointFormApp),
                    
                             //filter by owner as logged-in user or show all
                            Or(
                                And(
                                    cnxOwned.Selected.ItemKey = "MyApps",
                                    'App Owner'.Maker = GUID(myMakerProfile.Maker)
                                ),
                                !chkOwned.Checked
                            ),
                    
                            Switch(pivotNav.SelectedKey,
                            "missingdetails", 'Admin Requirement - Risk Assessment State' = 'Risk Assessment State Choice'.Requested,
                            "inactive",CountRows(Filter(myArchivalTasks, 'App Name' = Text(App))) > 0,
                            "republish",'Admin Requirement - Republish State' = 'Risk Assessment State Choice'.Requested,
                            "noncompliant",Or(
                                                'DLP Evaluation Status' = "NonCompliant",
                                                'Quarantine App'
                                            )
                            
                    
                            ),
                    
                         /*   //filter by issue
                            With(
                                {
                                    HasIssues:
                                    Or(
                                        //filter by missing details
                                        And(
                                            chkMissingDetails.Checked,
                                            'Admin Requirement - Risk Assessment State' = 'Risk Assessment State Choice'.Requested
                                        ),
                    
                                        //filter by republish requested
                                        And(
                                            chkRepublish.Checked,
                                            'Admin Requirement - Republish State' = 'Risk Assessment State Choice'.Requested
                                        ),
                    
                                        //filter by flagged as inactive
                                        And(
                                            chkInactive.Checked,
                                            CountRows(Filter(myArchivalTasks, 'App Name' = Text(App))) > 0
                                        ),
                    
                                        //filter by non-compliant
                                        And(
                                            chkNonCompliant.Checked,
                                            Or(
                                                'DLP Evaluation Status' = "NonCompliant",
                                                'Quarantine App'
                                            )
                                        )
                                    )
                                },
                                Or(
                                    //no filters, show all
                                    And(
                                        !chkNonCompliant.Checked && !chkMissingDetails.Checked && !chkInactive.Checked && !chkRepublish.Checked,
                                        !HasIssues
                                    ),
                    
                                    HasIssues
                                )
                            ),*/
                    
                            //filter by search text if available
                            Or(
                                IsBlank(mySearchText),
                                mySearchText in 'App Display Name',
                                mySearchText in 'App Environment Display Name'
                            )
                        )))
                Layout: =Layout.Vertical
                LayoutMinWidth: =App.MinScreenWidth
                LoadingSpinnerColor: =galApps.BorderColor
                OnSelect: |
                    =Set(
                        showLoader,
                        true
                    );
                    Set(
                        vSelectedAppN,
                        LookUp(
                            'PowerApps Apps',
                            App = ThisItem.App
                        )
                    );
                    ClearCollect(
                        appUserCollection,
                        AddColumns(
                            PowerAppsforMakers.GetAppRoleAssignment(vSelectedAppN.App).value.properties,
                            "Picture",
                            If(
                                And(
                                    properties.principal.type = "User",
                                    Office365Users.UserPhotoMetadata(properties.principal.id).HasPhoto
                                ),
                                Office365Users.UserPhotoV2(properties.principal.id),
                                properties.principal.type <> "Tenant",
                                Person,
                                Org
                            ),
                            "Name",
                            If(
                                properties.principal.type = "Tenant",
                                "Everyone in the organization",
                                properties.principal.displayName
                            ),
                            "Role",
                            properties.roleName,
                            "Type",
                            properties.principal.type
                        )
                    );
                    ClearCollect(
                        emailAppUserCollection,
                        PowerAppsforMakers.GetAppRoleAssignment(vSelectedAppN.App).value.properties
                    );
                    ClearCollect(
                        appConnectionCollection,
                        AddColumns(
                            ForAll(Split(
                                vSelectedAppN.'App Connections',
                                ","
                            ), {Result: ThisRecord.Value}).Result,
                            "Name",
                            LookUp(allConnectors, name = Result).properties.displayName,
                            "Picture",
                            PowerAppsforMakers.GetConnector(
                                LookUp(
                                    allConnectors,
                                    name = Result
                                ).name,
                                {'$filter': "environment eq 'Default-" & defaultEnvironment & "'"}
                            ).properties.iconUri
                        )
                    );
                    Set(showAppDetails,true);
                    Set(
                        showLoader,
                        false
                    );
                PressedBorderColor: =galApps.BorderColor
                PressedFill: =galApps.Fill
                TabIndex: =0
                TemplateFill: =Color.White
                TemplatePadding: =16
                TemplateSize: =350
                Visible: =CountRows(Self.AllItems)>0
                Width: =500
                WrapCount: =Max(AppScreen.Size,RoundDown(Self.Width / 300,0))
                X: =110
                Y: =33
                ZIndex: =1

                "Elevation1 As 'Fluent Elevation (1.0.19)'":
                    DisplayMode: =DisplayMode.Edit
                    Height: =Parent.TemplateHeight
                    HoverDepth: ='PowerCAT.Elevation.HoverDepth'.Depth8
                    OnChange: =false
                    Width: =Parent.TemplateWidth
                    X: =0
                    Y: =0
                    ZIndex: =1

                c_Compliance As groupContainer.horizontalAutoLayoutContainer:
                    Height: |-
                        =Sum(
                            c_MissingDetails.Visible*c_MissingDetails.Height,
                            c_RepublishNeeded.Visible*c_RepublishNeeded.Height,
                            c_Inactive.Visible*c_Inactive.Height,
                            c_NonCompliant.Visible*c_NonCompliant.Height
                        )
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =16
                    PaddingLeft: =20
                    PaddingRight: =Self.PaddingLeft
                    Width: =Parent.TemplateWidth
                    Y: =Parent.TemplateHeight-Self.Height-8
                    ZIndex: =2

                    c_MissingDetails As groupContainer.horizontalAutoLayoutContainer:
                        FillPortions: =0
                        Height: =32
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =100
                        LayoutMinWidth: =100
                        LayoutMode: =LayoutMode.Auto
                        Visible: =ThisItem.admin_adminrequirementriskassessmentstate = 'Risk Assessment State Choice'.Requested
                        ZIndex: =4

                        "Icon1_4 As 'Fluent Icon (1.0.19)'":
                            DisplayMode: =DisplayMode.Edit
                            Height: =40
                            IconName: ="Info"
                            LayoutMinHeight: =40
                            LayoutMinWidth: =200
                            Theme: =AppThemeJson
                            Width: =30
                            X: =0
                            Y: =0
                            ZIndex: =3

                        lblMissingDetails As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FillPortions: =1
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =32
                            Size: =10
                            TabIndex: =0
                            Text: ="Missing details"
                            ZIndex: =4

                    c_RepublishNeeded As groupContainer.horizontalAutoLayoutContainer:
                        FillPortions: =0
                        Height: =32
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =100
                        LayoutMinWidth: =100
                        LayoutMode: =LayoutMode.Auto
                        Visible: =ThisItem.admin_adminrequirementrepublishstate = 'Risk Assessment State Choice'.Requested
                        ZIndex: =5

                        "Icon1_3 As 'Fluent Icon (1.0.19)'":
                            DisplayMode: =DisplayMode.Edit
                            Height: =40
                            IconName: ="WebPublish"
                            LayoutMinHeight: =40
                            LayoutMinWidth: =200
                            Theme: =AppThemeJson
                            Width: =30
                            X: =0
                            Y: =0
                            ZIndex: =4

                        lblRepublishNeeded As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FillPortions: =1
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =32
                            Size: =10
                            TabIndex: =0
                            Text: ="Republish needed"
                            ZIndex: =5

                    c_Inactive As groupContainer.horizontalAutoLayoutContainer:
                        FillPortions: =0
                        Height: =32
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =100
                        LayoutMinWidth: =100
                        LayoutMode: =LayoutMode.Auto
                        Visible: =CountRows(Filter(myArchivalTasks, 'App Name' = Text(ThisItem.admin_appid))) > 0
                        ZIndex: =6

                        "Icon1_1 As 'Fluent Icon (1.0.19)'":
                            DisplayMode: =DisplayMode.Edit
                            Height: =40
                            IconName: ="Clock"
                            LayoutMinHeight: =40
                            LayoutMinWidth: =200
                            Theme: =AppThemeJson
                            Width: =30
                            X: =0
                            Y: =0
                            ZIndex: =1

                        lblInactive As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FillPortions: =1
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =32
                            Size: =10
                            TabIndex: =0
                            Text: ="Flagged as inactive"
                            ZIndex: =2

                    c_NonCompliant As groupContainer.horizontalAutoLayoutContainer:
                        Fill: |-
                            =If(ThisItem.admin_quarantineapp, ColorValue("#fde7e9"), RGBA(0,0,0,0))
                        FillPortions: =0
                        Height: =32
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =100
                        LayoutMinWidth: =100
                        LayoutMode: =LayoutMode.Auto
                        Visible: |-
                            =Or(
                                ThisItem.admin_dlpevaluationstatus = "NonCompliant",
                                ThisItem.admin_quarantineapp
                            )
                        ZIndex: =7

                        "Icon1_2 As 'Fluent Icon (1.0.19)'":
                            DisplayMode: =DisplayMode.Edit
                            Height: =40
                            IconColor: |-
                                =If(ThisItem.admin_quarantineapp, "#a80000", "#0078d4")
                            IconName: ="Warning"
                            LayoutMinHeight: =40
                            LayoutMinWidth: =200
                            Theme: =AppThemeJson
                            Width: =30
                            X: =0
                            Y: =0
                            ZIndex: =4

                        lblNonCompliant As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: |-
                                =If(ThisItem.admin_quarantineapp, ColorValue("#a80000"), RGBA(51, 51, 51, 1))
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FillPortions: =1
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =32
                            Size: =10
                            TabIndex: =0
                            Text: |-
                                =If(
                                    ThisItem.admin_quarantineapp,
                                    "Quarantined",
                                    "Non-compliant"
                                )
                            ZIndex: =5

                c_Details As groupContainer.verticalAutoLayoutContainer:
                    Height: =140
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =16
                    PaddingLeft: =20
                    PaddingRight: =20
                    PaddingTop: =12
                    Width: =Parent.TemplateWidth
                    Y: =imgIconHeader.Height
                    ZIndex: =3

                    lblDisplayName As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderColor: =lblDisplayName.BorderColor
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Bold
                        Height: =27
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =RGBA(0,0,0,1.00)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        LayoutMinHeight: =20
                        OnSelect: =
                        PaddingLeft: =0
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedColor: =RGBA(0,0,0,1.00)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        Size: =10
                        TabIndex: =0
                        Text: =ThisItem.admin_displayname
                        VerticalAlign: =VerticalAlign.Top
                        Width: =galApps.TemplateWidth - Self.X*2
                        X: =1
                        ZIndex: =1

                    lblEnvironment As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(128, 128, 128, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderColor: =lblEnvironment.BorderColor
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =lblEnvironment.BorderColor
                        HoverColor: =lblEnvironment.Color
                        HoverFill: =lblEnvironment.Fill
                        OnSelect: =
                        PaddingLeft: =0
                        PressedBorderColor: =lblEnvironment.BorderColor
                        PressedColor: =lblEnvironment.Color
                        PressedFill: =lblEnvironment.Fill
                        Size: =10
                        TabIndex: =0
                        Text: =ThisItem.admin_appenvironmentdisplayname
                        VerticalAlign: =VerticalAlign.Top
                        Width: =lblDisplayName.Width
                        Wrap: =false
                        X: =1
                        Y: =338
                        ZIndex: =2

                    lblDescription As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =1
                        Color: =RGBA(70,70, 70, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderColor: =lblDescription.BorderColor
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =50
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =RGBA(0,0,0,1.00)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        LayoutMinHeight: =60
                        OnSelect: =
                        PaddingLeft: =0
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedColor: =RGBA(0,0,0,1.00)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        Size: =10
                        TabIndex: =0
                        Text: |-
                            =If(
                                IsBlank(ThisItem.admin_appdescription), 
                                "No Description", 
                                Left(ThisItem.admin_appdescription, 100) & If( Len(ThisItem.admin_appdescription) > 100, " ...")
                            )
                        VerticalAlign: =VerticalAlign.Top
                        Width: =lblDisplayName.Width
                        X: =1
                        Y: =323
                        ZIndex: =3

                Label5 As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =135
                    OnSelect: =Select(Parent)
                    Size: =8
                    Text: =ThisItem.admin_appiconuri
                    Visible: =false
                    Width: =1
                    ZIndex: =4

                imgIconHeader As image:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledFill: =Self.Fill
                    Fill: |-
                        =With(
                            Match(
                                ThisItem.admin_iconbackgroundcolor,
                                "rgba\((?<RedChannel>\d{1,3})\,\s(?<GreenChannel>\d{1,3})\,\s(?<BlueChannel>\d{1,3})\,\s(?<AlphaChannel>\d{1,3})\)"
                            ),
                            If(
                                IsBlank(ThisItem.admin_iconbackgroundcolor),
                                ColorValue(AppTheme.palette.themePrimary),
                                RGBA(Value(RedChannel),Value(GreenChannel),Value(BlueChannel),Value(AlphaChannel))
                            )
                        )
                    FocusedBorderThickness: =4
                    Height: =118
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =Self.Fill
                    Image: |-
                        =IfError(PowerAppsforMakers.GetApp(ThisItem.admin_appidstring).properties.backgroundImageUri, "")
                        
                        //Coalesce(ThisItem.'App Icon Uri',FluentIcon_1.GetIcon("PowerApps",AppTheme.palette.neutralLight))
                        /*
                        If(
                            !IsBlank(ThisItem.AppIDString),
                            PowerAppsforAppMakers.GetApp(ThisItem.AppIDString).properties.backgroundImageUri
                        )
                        */
                        
                        //ThisItem.'App Icon Uri'
                        //Coalesce(ThisItem.'App Icon Uri',FluentIcon_1.GetIcon("PowerApps",AppTheme.palette.neutralLight))
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedFill: =Self.Fill
                    Width: =Parent.TemplateWidth
                    ZIndex: =5

                Image3 As image:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    Height: =imgIconHeader.Height
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Image: =ThisItem.admin_sharepointformurl
                    ImagePosition: =ImagePosition.Stretch
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Transparency: =0.85
                    Width: =imgIconHeader.Width
                    ZIndex: =6

                Image4 As image:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    Height: =imgIconHeader.Height
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Image: =vignette
                    ImagePosition: =ImagePosition.Stretch
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Transparency: =0.85
                    Width: =imgIconHeader.Width
                    ZIndex: =7

                btnSelectGal As rectangle:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =4
                    Height: =Elevation1.Height
                    HoverFill: =RGBA(0, 0, 0, 0)
                    OnSelect: =Select(Parent)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Width: =Elevation1.Width
                    X: =0+0
                    Y: =0+0
                    ZIndex: =8

    c_AppDetailsScreen As groupContainer.verticalAutoLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =Parent.Height-Self.Y
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Visible: =showAppDetails
        Width: =App.Width
        ZIndex: =2

        ActionHeader_1 As groupContainer.verticalAutoLayoutContainer:
            Fill: =RGBA(243, 242, 241, 1)
            FillPortions: =0
            Height: =44
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =32
            PaddingRight: =32
            ZIndex: =1

            "CommandBar1_1 As 'Fluent Command Bar (1.0.19)'.pcfdataset":
                AlignInContainer: =AlignInContainer.Stretch
                DisplayMode: =DisplayMode.Edit
                Height: =200
                Items: |-
                    =Table(
                        {ItemKey:"back",ItemDisplayName:"Back",ItemIconName:"Back"},
                         {ItemKey: "launch", ItemDisplayName: "Launch", ItemIconName: "OpenInNewWindow"},
                            {ItemKey: "settings", ItemDisplayName: "App settings", ItemIconName: "Settings"},
                            {ItemKey: "details", ItemDisplayName: "Support details", ItemIconName: "BulletedList"},
                            {ItemKey: "republish", ItemDisplayName: "Re-publish", ItemIconName: "WebPublish"},
                            {ItemKey: "email", ItemDisplayName: "Email users", ItemIconName: "Mail"},
                            {ItemKey: "reassign", ItemDisplayName: "Assign New Owner", ItemIconName: "AddFriend"},
                            {ItemKey: "delete", ItemDisplayName: "Delete App", ItemIconName: "Trash"}
                        
                        )
                LayoutMinHeight: =44
                LayoutMinWidth: =200
                OnChange: =
                OnSelect: |-
                    =Switch(
                        Self.Selected.ItemKey,
                        "back", Set(showAppDetails,false),
                        "launch",
                        If(
                            LookUp(Environments, Environment=vSelectedAppN.'App Environment'.Environment).'Environment Sku'="Teams",
                            UpdateContext({showCantShowThat: true, CantShowThatText: "Cannot browse to apps for Teams environments"}), 
                            Launch(theAppPlayerURL & "play/" & vSelectedAppN.App & "?tenatID=" & EnvVarTenantID)
                        ),
                    
                        "settings",
                        If(
                            LookUp(Environments, Environment=vSelectedAppN.'App Environment'.Environment).'Environment Sku'="Teams", 
                            UpdateContext({showCantShowThat: true, CantShowThatText: "Cannot browse to apps for Teams environments"}), 
                            Launch(theAppMakerURL &  "environments/" & vSelectedAppN.'App Environment ID' & "/apps/" & vSelectedAppN.App & "/details")
                        ),
                    
                        "details",
                        UpdateContext({showHidePanel: true}),
                    
                        "republish",
                        UpdateContext({showPopUp: true, showRepublish: true}),
                        
                        "email",
                        UpdateContext({showPopUp: true, emailUsers: true}),
                    
                        "reassign",
                        If(
                            LookUp(Environments, Environment=vSelectedAppN.'App Environment'.Environment).'Environment Sku'="Teams", 
                            UpdateContext({showCantShowThat: true, CantShowThatText: "Cannot assign ownership here for apps in Teams environments"}), 
                            
                            UpdateContext(
                                {
                                    showPopUp: true,
                                    showNewOwner: true,
                                    NewOwner: "",
                                    NewOwnerError: false
                                }
                            );
                        ),
                    
                        "delete",
                        UpdateContext({showPopUp: true, confirmDeletion: true})
                    )
                Theme: =AppThemeJson
                Width: =600
                X: =0
                Y: =0
                ZIndex: =1

        c_AppDetailsMain As groupContainer.horizontalAutoLayoutContainer:
            LayoutGap: =24
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowY: =LayoutOverflow.Scroll
            LayoutWrap: =true
            PaddingBottom: =40
            PaddingLeft: =40
            PaddingRight: =40
            PaddingTop: =10
            ZIndex: =3

            c_AppDetailsTop As groupContainer.manualLayoutContainer:
                AlignInContainer: =AlignInContainer.Start
                Height: =eleAppDetailsTop.Height
                LayoutMinHeight: =100
                LayoutMinWidth: |-
                    =(App.DesignWidth-Parent.PaddingLeft-Parent.PaddingRight-Parent.LayoutGap*2)/3-200
                    /*
                    Min(
                        Parent.Width-Parent.PaddingLeft-Parent.PaddingRight-Parent.LayoutGap*2,
                        Max(
                            (App.DesignWidth-Parent.PaddingLeft-Parent.PaddingRight-Parent.LayoutGap*2)/3,
                            (Parent.Width-Parent.PaddingLeft-Parent.PaddingRight-Parent.LayoutGap*2)/3
                        )
                    )-10
                    */
                ZIndex: =1

                "eleAppDetailsTop As 'Fluent Elevation (1.0.19)'":
                    DisplayMode: =DisplayMode.Edit
                    Height: =c_AppDetailsMain.Height-50
                    HoverDepth: ='PowerCAT.Elevation.HoverDepth'.Depth4
                    OnChange: =false
                    PaddingBottom: =Self.PaddingLeft
                    PaddingLeft: =8
                    PaddingRight: =Self.PaddingLeft
                    PaddingTop: =Self.PaddingLeft
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =1

                c_AppDetailsContent As groupContainer.verticalAutoLayoutContainer:
                    Height: =c_AppTitle.Height+c_ComplianceDetails.Height
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMode: =LayoutMode.Auto
                    Width: =Parent.Width-Self.X*2
                    X: =24
                    Y: =24
                    ZIndex: =2

                    c_AppTitle As groupContainer.horizontalAutoLayoutContainer:
                        Height: =150
                        LayoutGap: =10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =200
                        ZIndex: =1

                        imgAppDetailsIcon As image:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            Fill: |-
                                =With(
                                    Match(
                                        vSelectedAppN.admin_iconbackgroundcolor,
                                        "rgba\((?<RedChannel>\d{1,3})\,\s(?<GreenChannel>\d{1,3})\,\s(?<BlueChannel>\d{1,3})\,\s(?<AlphaChannel>\d{1,3})\)"
                                    ),
                                    If(
                                        IsBlank(vSelectedAppN.admin_iconbackgroundcolor),
                                        ColorValue(AppTheme.palette.themePrimary),
                                        RGBA(Value(RedChannel),Value(GreenChannel),Value(BlueChannel),Value(AlphaChannel))
                                    )
                                )
                            FocusedBorderColor: =imgAppDetailsIcon.BorderColor
                            FocusedBorderThickness: =4
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverFill: =imgAppDetailsIcon.Fill
                            Image: =IfError(PowerAppsforMakers.GetApp(vSelectedAppN.admin_appidstring).properties.backgroundImageUri, "")
                            OnSelect: =
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedFill: =imgAppDetailsIcon.Fill
                            Y: =10
                            ZIndex: =1

                        Container1 As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingLeft: =12
                            ZIndex: =3

                            lblAppDetailsTitle As label:
                                AlignInContainer: =AlignInContainer.Stretch
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =50
                                Size: =16
                                TabIndex: =0
                                Text: =vSelectedAppN.'App Display Name'
                                ZIndex: =1

                            Label2 As label:
                                AlignInContainer: =AlignInContainer.Stretch
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FillPortions: =1
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Size: =10.5
                                Text: =Coalesce(vSelectedAppN.'App Description',"No description")
                                ZIndex: =2

                    c_ComplianceDetails As groupContainer.verticalAutoLayoutContainer:
                        FillPortions: =0
                        Height: |-
                            =lblComplianceDetails.Height+
                            Sum(
                                lblCompliant.Visible*lblCompliant.Height,
                                c_MissingDetails_7.Visible*c_MissingDetails_7.Height,
                                c_Republish_7.Visible*c_Republish_7.Height,
                                c_Inactive_7.Visible*c_Inactive_7.Height,
                                c_NonCompliant_7.Visible*c_NonCompliant_7.Height
                            )
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =8
                        PaddingRight: =Self.PaddingLeft
                        Width: =300
                        ZIndex: =4

                        lblComplianceDetails As Label:
                            AlignInContainer: =AlignInContainer.Stretch
                            Color: =
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =12
                            FontWeight: =FontWeight.Semibold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            OnChange: =false
                            Text: ="App Compliance"
                            TextRole: ='Label.TextRole'.Heading2
                            Width: =150
                            X: =41
                            Y: =652
                            ZIndex: =1

                        lblCompliant As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Size: =10.5
                            Text: ="This app is in compliance and has no outstanding tasks."
                            Visible: |-
                                =!Or(
                                    c_MissingDetails_7.Visible,
                                    c_Republish_7.Visible,
                                    c_Inactive_7.Visible,
                                    c_NonCompliant_7.Visible
                                )
                            X: =40
                            Y: =40
                            ZIndex: =2

                        c_MissingDetails_7 As groupContainer.horizontalAutoLayoutContainer:
                            FillPortions: =0
                            Height: =32
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            Visible: =vSelectedAppN.'Admin Requirement - Risk Assessment State' = 'Risk Assessment State Choice'.Requested
                            ZIndex: =3

                            "icoNonCompliantLaunch_3 As 'Fluent Icon (1.0.19)'":
                                DisplayMode: =DisplayMode.Edit
                                Height: =30
                                IconName: ="Info"
                                LayoutMinHeight: =200
                                LayoutMinWidth: =200
                                OnChange: |-
                                    =UpdateContext({showHidePanel: true})
                                Theme: =AppThemeJson
                                Width: =30
                                X: =0
                                Y: =0
                                ZIndex: =5

                            lblMissingDetails_7 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FillPortions: =1
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =32
                                OnSelect: |-
                                    =UpdateContext({showHidePanel: true})
                                Size: =10
                                Text: ="Missing support details"
                                ZIndex: =6

                            "icoNonCompliant_3 As 'Fluent Icon (1.0.19)'":
                                DisplayMode: =DisplayMode.Edit
                                Height: =30
                                IconName: ="NavigateExternalInline"
                                LayoutMinHeight: =200
                                LayoutMinWidth: =200
                                OnChange: |-
                                    =UpdateContext({showHidePanel: true})
                                Theme: =AppThemeJson
                                Width: =30
                                X: =0
                                Y: =0
                                ZIndex: =7

                        c_Republish_7 As groupContainer.horizontalAutoLayoutContainer:
                            FillPortions: =0
                            Height: =32
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            Visible: |-
                                =And(
                                    vSelectedAppN.'App Type'<>'PowerApps Type'.'Model Driven',
                                    vSelectedAppN.'Admin Requirement - Republish State' = 'Risk Assessment State Choice'.Requested
                                )
                            ZIndex: =4

                            "icoNonCompliantLaunch_2 As 'Fluent Icon (1.0.19)'":
                                DisplayMode: =DisplayMode.Edit
                                Height: =30
                                IconName: ="WebPublish"
                                LayoutMinHeight: =200
                                LayoutMinWidth: =200
                                OnChange: |-
                                    =UpdateContext({showPopUp: true, showRepublish: true})
                                Theme: =AppThemeJson
                                Width: =30
                                X: =0
                                Y: =0
                                ZIndex: =5

                            lblRepublish_7 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FillPortions: =1
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =32
                                OnSelect: |-
                                    =UpdateContext({showPopUp: true, showRepublish: true})
                                Size: =10
                                Text: ="Republish needed"
                                ZIndex: =6

                            "icoNonCompliant_2 As 'Fluent Icon (1.0.19)'":
                                DisplayMode: =DisplayMode.Edit
                                Height: =30
                                IconName: ="NavigateExternalInline"
                                LayoutMinHeight: =200
                                LayoutMinWidth: =200
                                OnChange: |-
                                    =UpdateContext({showPopUp: true, showRepublish: true})
                                Theme: =AppThemeJson
                                Width: =30
                                X: =0
                                Y: =0
                                ZIndex: =7

                        c_Inactive_7 As groupContainer.horizontalAutoLayoutContainer:
                            FillPortions: =0
                            Height: =32
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            Visible: =CountRows(Filter(myArchivalTasks, 'App Name' = Text(vSelectedAppN.App))) > 0
                            ZIndex: =5

                            "icoNonCompliantLaunch_1 As 'Fluent Icon (1.0.19)'":
                                DisplayMode: =DisplayMode.Edit
                                Height: =30
                                IconName: ="Clock"
                                LayoutMinHeight: =200
                                LayoutMinWidth: =200
                                OnChange: |-
                                    =If(
                                        IsBlank(theArchivalCleanupAppURL), 
                                        false, 
                                        Launch(theArchivalCleanupAppURL)
                                    )
                                Theme: =AppThemeJson
                                Width: =30
                                X: =0
                                Y: =0
                                ZIndex: =1

                            lblInactive_7 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FillPortions: =1
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =32
                                OnSelect: |-
                                    =If(
                                        IsBlank(theArchivalCleanupAppURL), 
                                        false, 
                                        Launch(theArchivalCleanupAppURL)
                                    )
                                Size: =10
                                Text: ="Flagged as inactive"
                                ZIndex: =2

                            "icoNonCompliant_1 As 'Fluent Icon (1.0.19)'":
                                DisplayMode: =DisplayMode.Edit
                                Height: =30
                                IconName: ="NavigateExternalInline"
                                LayoutMinHeight: =200
                                LayoutMinWidth: =200
                                OnChange: |-
                                    =If(
                                        IsBlank(theArchivalCleanupAppURL), 
                                        false, 
                                        Launch(theArchivalCleanupAppURL)
                                    )
                                Theme: =AppThemeJson
                                Width: =30
                                X: =0
                                Y: =0
                                ZIndex: =3

                        c_NonCompliant_7 As groupContainer.horizontalAutoLayoutContainer:
                            FillPortions: =0
                            Height: =32
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            Visible: |-
                                =Or(
                                    vSelectedAppN.'DLP Evaluation Status' = "NonCompliant",
                                    vSelectedAppN.'Quarantine App'
                                )
                            ZIndex: =6

                            "icoNonCompliantLaunch As 'Fluent Icon (1.0.19)'":
                                DisplayMode: =DisplayMode.Edit
                                Height: =30
                                IconName: ="Warning"
                                LayoutMinHeight: =200
                                LayoutMinWidth: =200
                                OnChange: |-
                                    =UpdateContext({showHidePanel: true})
                                Theme: =AppThemeJson
                                Width: =2000
                                X: =0
                                Y: =0
                                ZIndex: =4

                            lblNonCompliant_7 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FillPortions: =1
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =32
                                OnSelect: |
                                    =UpdateContext({showHidePanel: true})
                                Size: =10
                                Text: |-
                                    ="Non-compliant"
                                    // App missing support details for 2 weeks
                                    // App doing something non-compliant in DLP or not sure what it's connecting to
                                    
                                    //"Please bring your app back into compliance"
                                ZIndex: =5

                            "icoNonCompliant As 'Fluent Icon (1.0.19)'":
                                DisplayMode: =DisplayMode.Edit
                                Height: =30
                                IconName: ="NavigateExternalInline"
                                LayoutMinHeight: =200
                                LayoutMinWidth: =200
                                OnChange: |-
                                    =UpdateContext({showHidePanel: true})
                                Theme: =AppThemeJson
                                Width: =30
                                X: =0
                                Y: =0
                                ZIndex: =6

            c_AppDetailsForm As groupContainer.manualLayoutContainer:
                AlignInContainer: =AlignInContainer.Start
                Height: =eleAppDetailsForm.Height
                LayoutMinHeight: =540
                LayoutMinWidth: =c_AppDetailsTop.LayoutMinWidth
                Width: =c_AppDetailsTop.LayoutMinWidth
                ZIndex: =2

                "eleAppDetailsForm As 'Fluent Elevation (1.0.19)'":
                    DisplayMode: =DisplayMode.Edit
                    Height: =c_AppDetailsMain.Height-50
                    HoverDepth: ='PowerCAT.Elevation.HoverDepth'.Depth4
                    OnChange: =false
                    PaddingBottom: =Self.PaddingLeft
                    PaddingLeft: =8
                    PaddingRight: =Self.PaddingLeft
                    PaddingTop: =Self.PaddingLeft
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =1

                c_FormAppDetails As groupContainer.verticalAutoLayoutContainer:
                    Height: =Parent.Height-Self.Y*2
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =8
                    LayoutMode: =LayoutMode.Auto
                    Width: =c_AppDetailsContent.Width
                    X: =24
                    Y: =24
                    ZIndex: =2

                    lblAppDetails As Label:
                        AlignInContainer: =AlignInContainer.Stretch
                        Color: =
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =12
                        FontWeight: =FontWeight.Semibold
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =320
                        OnChange: =false
                        Text: ="App Details"
                        TextRole: ='Label.TextRole'.Heading2
                        Width: =150
                        X: =41
                        Y: =652
                        ZIndex: =1

                    formAppDetails As form:
                        AcceptsFocus: =false
                        BorderColor: =RGBA(166, 166, 166, 1)
                        DataSource: ='PowerApps Apps'
                        Item: =vSelectedAppN
                        LayoutMinHeight: =150
                        LayoutMinWidth: =200
                        NumberOfColumns: =2
                        Visible: =false
                        ZIndex: =2

                        "'App Environment_DataCard1' As typedDataCard.comboBoxEditCard":
                            BorderColor: =RGBA(166, 166, 166, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="admin_AppEnvironment"
                            Default: =ThisItem.'App Environment'
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: ="App Environment"
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =false
                            Update: =DataCardValue36.Selected
                            Width: =283
                            X: =0
                            Y: =0
                            ZIndex: =1

                            DataCardKey42 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Size: =12
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue36 As combobox:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                ChevronBackground: =RGBA(255, 255, 255, 1)
                                ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                                ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                                ChevronFill: =RGBA(33, 33, 33, 1)
                                ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                                ChevronHoverFill: =RGBA(33, 33, 33, 1)
                                Color: =RGBA(51, 51, 51, 1)
                                DefaultSelectedItems: =Parent.Default
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                DisplayFields: =["admin_displayname"]
                                DisplayMode: =DisplayMode.View
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                                HoverColor: =RGBA(51, 51, 51, 1)
                                HoverFill: =RGBA(212, 212, 212, 1)
                                Items: =Choices([@'PowerApps Apps'].'App Environment')
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                PressedBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                                PressedColor: =RGBA(255, 255, 255, 1)
                                PressedFill: =RGBA(135, 100, 184, 1)
                                SearchFields: =["admin_displayname"]
                                SearchItems: =Search(Choices([@'PowerApps Apps'].'App Environment'),DataCardValue36.SearchText,"admin_displayname")
                                SelectionFill: =RGBA(135, 100, 184, 1)
                                SelectMultiple: =false
                                Size: =12
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardKey42.Y + DataCardKey42.Height + 5
                                ZIndex: =2

                            ErrorMessage42 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =13
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue36.Y + DataCardValue36.Height
                                ZIndex: =3

                            StarVisible42 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey42.Height
                                PaddingLeft: =0
                                Size: =13
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey42.Y
                                ZIndex: =4

                        "'App Published_DataCard1' As typedDataCard.dateTimeEditCard":
                            BorderColor: =RGBA(166, 166, 166, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="admin_apppublished"
                            Default: =ThisItem.'App Published'
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: ="App Published"
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =false
                            Update: =DateValue4.SelectedDate
                            Width: =283
                            X: =0
                            Y: =2
                            ZIndex: =1

                            DataCardKey34 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Size: =12
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DateValue4 As datepicker:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                CalendarHeaderFill: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                                Color: =RGBA(51, 51, 51, 1)
                                DefaultDate: =Parent.Default
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                DisplayMode: =DisplayMode.View
                                EndYear: =Year(Today())+100
                                Font: =Font.'Segoe UI'
                                HoverDateFill: =RGBA(200, 200, 200, 1)
                                IconBackground: =RGBA(135, 100, 184, 1)
                                IsEditable: =true
                                PaddingBottom: =0
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                SelectedDateFill: =RGBA(135, 100, 184, 1)
                                Size: =12
                                StartYear: =1899
                                Tooltip: =Parent.DisplayName
                                Width: =(Parent.Width - 60) / 2
                                X: =30
                                Y: =DataCardKey34.Y + DataCardKey34.Height + 5
                                ZIndex: =2

                            StarVisible34 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey34.Height
                                PaddingLeft: =0
                                Size: =13
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey34.Y
                                ZIndex: =7

                        "'App Description_DataCard1' As typedDataCard.textualMultiLineEditCard":
                            BorderColor: =RGBA(166, 166, 166, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="admin_appdescription"
                            Default: =ThisItem.'App Description'
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: ="App Description"
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =184
                            Required: =false
                            Update: =DataCardValue29.Text
                            Width: =283
                            WidthFit: =true
                            X: =0
                            Y: =3
                            ZIndex: =1

                            DataCardKey32 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Size: =12
                                Text: =Parent.DisplayName
                                Width: =Parent.Width/3
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue29 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                Default: |
                                    =If(IsBlank(vSelectedAppN.'App Description'),
                                    If(vSelectedAppN.'App Type'='PowerApps Type'.'Model Driven',
                                    "To Add Description:
                                    Got to this app > Edit > Settings > Add Description > Save and Publish.
                                    Then you will need to wait for the inventory to update next day to see it here", 
                                    "To Add Description:
                                    Got to this app > Edit > File > Settings > Add Description > Save and Publish.
                                    Then select refresh here to see the description"), Parent.Default)
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                DisplayMode: =DisplayMode.View
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =136
                                HoverBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                                HoverColor: =RGBA(51, 51, 51, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                Mode: =TextMode.MultiLine
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(135, 100, 184, 1)
                                PressedColor: =RGBA(51, 51, 51, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =60
                                ZIndex: =2

                            ErrorMessage32 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =13
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue29.Y + DataCardValue29.Height
                                ZIndex: =3

                            StarVisible32 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey32.Height
                                PaddingLeft: =0
                                Size: =13
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey32.Y
                                ZIndex: =4

                            Icon2 As icon.Reload:
                                AutoDisableOnSelect: =false
                                BorderColor: =RGBA(0, 0, 0, 0)
                                Color: =RGBA(135, 100, 184, 1)
                                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                DisabledColor: =RGBA(220, 220, 220, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                FocusedBorderThickness: =4
                                Height: =34
                                HoverBorderColor: =RGBA(0, 0, 0, 0)
                                HoverColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                                HoverFill: =RGBA(0, 0, 0, 0)
                                Icon: =Icon.Reload
                                OnSelect: |-
                                    =//get the description from the product
                                    UpdateContext({NewDescription: PowerAppsforMakers.GetApp(vSelectedAppN.App).properties.description});
                                    
                                    //if not Blank, update collection, inventory, and current selection
                                    If(
                                        !IsBlank(NewDescription), 
                                        UpdateIf(myApps, App=vSelectedAppN.App, {'App Description': NewDescription});
                                        UpdateIf('PowerApps Apps', App=vSelectedAppN.App, {'App Description': NewDescription});
                                        Set(vSelectedAppN, LookUp(myApps, App=vSelectedAppN.App));
                                    )
                                PaddingTop: =5
                                PressedBorderColor: =RGBA(0, 0, 0, 0)
                                PressedColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                                PressedFill: =RGBA(0, 0, 0, 0)
                                Visible: =IsBlank(vSelectedAppN.'App Description') && vSelectedAppN.'App Type'<>'PowerApps Type'.'Model Driven'
                                Width: =34
                                X: =DataCardKey32.X+DataCardKey32.Width
                                Y: =DataCardKey32.Y
                                ZIndex: =5

                        "'App Created On_DataCard1' As typedDataCard.dateTimeEditCard":
                            BorderColor: =RGBA(166, 166, 166, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="admin_appcreatedon"
                            Default: =ThisItem.'App Created On'
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: ="App Created On"
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =false
                            Update: =DateValue1.SelectedDate
                            Width: =283
                            X: =1
                            Y: =0
                            ZIndex: =2

                            DataCardKey10 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Size: =12
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DateValue1 As datepicker:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                CalendarHeaderFill: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                                Color: =RGBA(51, 51, 51, 1)
                                DefaultDate: =Parent.Default
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                DisplayMode: =DisplayMode.View
                                EndYear: =Year(Today())+100
                                Font: =Font.'Segoe UI'
                                HoverDateFill: =RGBA(200, 200, 200, 1)
                                IconBackground: =RGBA(135, 100, 184, 1)
                                IsEditable: =true
                                PaddingBottom: =0
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                SelectedDateFill: =RGBA(135, 100, 184, 1)
                                Size: =12
                                StartYear: =1899
                                Tooltip: =Parent.DisplayName
                                Width: =(Parent.Width - 60) / 2
                                X: =30
                                Y: =DataCardKey10.Y + DataCardKey10.Height + 5
                                ZIndex: =2

                            StarVisible10 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey10.Height
                                PaddingLeft: =0
                                Size: =13
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey10.Y
                                ZIndex: =7

                        "'App Modified On_DataCard1' As typedDataCard.dateTimeEditCard":
                            BorderColor: =RGBA(166, 166, 166, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="admin_appmodifiedon"
                            Default: =ThisItem.'App Modified On'
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: ="App Modified On"
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =false
                            Update: =DateValue2.SelectedDate
                            Width: =283
                            X: =0
                            Y: =1
                            ZIndex: =2

                            DataCardKey18 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Size: =12
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DateValue2 As datepicker:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                CalendarHeaderFill: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                                Color: =RGBA(51, 51, 51, 1)
                                DefaultDate: =Parent.Default
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                DisplayMode: =DisplayMode.View
                                EndYear: =Year(Today())+100
                                Font: =Font.'Segoe UI'
                                HoverDateFill: =RGBA(200, 200, 200, 1)
                                IconBackground: =RGBA(135, 100, 184, 1)
                                IsEditable: =true
                                PaddingBottom: =0
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                SelectedDateFill: =RGBA(135, 100, 184, 1)
                                Size: =12
                                StartYear: =1899
                                Tooltip: =Parent.DisplayName
                                Width: =(Parent.Width - 60) / 2
                                X: =30
                                Y: =DataCardKey18.Y + DataCardKey18.Height + 5
                                ZIndex: =2

                            StarVisible28 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey18.Height
                                PaddingLeft: =0
                                Size: =13
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey18.Y
                                ZIndex: =7

                        "'App Last Launched On_DataCard1' As typedDataCard.dateTimeEditCard":
                            BorderColor: =RGBA(166, 166, 166, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="admin_applastlaunchedon"
                            Default: =ThisItem.'App Last Launched On'
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: ="App Last Launched On"
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =false
                            Update: =DateValue3.SelectedDate
                            Width: =283
                            X: =1
                            Y: =1
                            ZIndex: =2

                            DataCardKey29 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Size: =12
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DateValue3 As datepicker:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                CalendarHeaderFill: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                                Color: =RGBA(51, 51, 51, 1)
                                DefaultDate: =Parent.Default
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                DisplayMode: =DisplayMode.View
                                EndYear: =Year(Today())+100
                                Font: =Font.'Segoe UI'
                                HoverDateFill: =RGBA(200, 200, 200, 1)
                                IconBackground: =RGBA(135, 100, 184, 1)
                                IsEditable: =true
                                PaddingBottom: =0
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                SelectedDateFill: =RGBA(135, 100, 184, 1)
                                Size: =12
                                StartYear: =1899
                                Tooltip: =Parent.DisplayName
                                Width: =(Parent.Width - 60) / 2
                                X: =30
                                Y: =DataCardKey29.Y + DataCardKey29.Height + 5
                                ZIndex: =2

                            StarVisible29 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey29.Height
                                PaddingLeft: =0
                                Size: =13
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey29.Y
                                ZIndex: =7

                        "'App Type_DataCard1' As typedDataCard.comboBoxOptionSetSingleEditCard":
                            BorderColor: =RGBA(166, 166, 166, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="admin_powerappstype"
                            Default: =ThisItem.'App Type'
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: ="App Type"
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =false
                            Update: =DataCardValue8.Selected.Value
                            Width: =283
                            X: =1
                            Y: =2
                            ZIndex: =2

                            DataCardKey30 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Size: =12
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue8 As combobox:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                ChevronBackground: =RGBA(255, 255, 255, 1)
                                ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                                ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                                ChevronFill: =RGBA(33, 33, 33, 1)
                                ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                                ChevronHoverFill: =RGBA(33, 33, 33, 1)
                                Color: =RGBA(51, 51, 51, 1)
                                DefaultSelectedItems: =[Parent.Default]
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                DisplayFields: =["Value"]
                                DisplayMode: =DisplayMode.View
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                                HoverColor: =RGBA(51, 51, 51, 1)
                                HoverFill: =RGBA(212, 212, 212, 1)
                                IsSearchable: =false
                                Items: =Choices('PowerApps Type')
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                PressedBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                                PressedColor: =RGBA(255, 255, 255, 1)
                                PressedFill: =RGBA(135, 100, 184, 1)
                                SearchFields: =["Value"]
                                SearchItems: =[]
                                SelectionFill: =RGBA(135, 100, 184, 1)
                                SelectMultiple: =false
                                Size: =12
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardKey30.Y + DataCardKey30.Height + 5
                                ZIndex: =2

                            ErrorMessage30 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =13
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue8.Y + DataCardValue8.Height
                                ZIndex: =3

                            StarVisible30 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(51, 51, 51, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey30.Height
                                PaddingLeft: =0
                                Size: =13
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey30.Y
                                ZIndex: =4

                    lblUserSeperator_4 As rectangle:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        DisabledFill: =lblUserSeperator_4.Fill
                        Fill: =RGBA(230, 230, 230, 1)
                        FocusedBorderColor: =lblUserSeperator_4.BorderColor
                        Height: =1
                        HoverFill: =lblUserSeperator_4.Fill
                        OnSelect: =
                        PressedFill: =lblUserSeperator_4.Fill
                        Width: =Parent.Width
                        ZIndex: =3

                    galProperties As gallery.variableTemplateHeightGallery:
                        BorderColor: =RGBA(166, 166, 166, 1)
                        Items: |-
                            =Table(
                                {Key: "App Environment" , Value: Text(vSelectedAppN.'App Environment'.'Display Name')},
                                {Key: "App Created On" , Value: Text(DateTimeValue(vSelectedAppN.'App Created On'),"mmmm dd, yyyy")},
                                {Key: "App Modified On" , Value: Text(DateTimeValue(vSelectedAppN.'App Modified On'),"mmmm dd, yyyy")},
                                {Key: "App Last Launched On" , Value: Coalesce(Text(DateTimeValue(vSelectedAppN.'App Last Launched On'),"mmmm dd, yyyy"),"")},
                                {Key: "App Published" , Value: Text(vSelectedAppN.'App Published')},
                                {Key: "App Type" , Value: Text(vSelectedAppN.'App Type')}
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =287
                        LayoutMinWidth: =320
                        TemplatePadding: =4
                        TemplateSize: =40
                        X: =40
                        Y: =40
                        ZIndex: =4

                        lblPropertyKey As label:
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            OnSelect: =Select(Parent)
                            Size: =10.5
                            TabIndex: =0
                            Text: =ThisItem.Key
                            Width: =170
                            ZIndex: =1

                        lblPropertyValue As label:
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(51, 51, 51, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            OnSelect: =Select(Parent)
                            Size: =10.5
                            TabIndex: =0
                            Text: =ThisItem.Value
                            Width: =Parent.TemplateWidth-Self.X
                            X: =lblPropertyKey.X + lblPropertyKey.Width
                            ZIndex: =2

                        lblUserSeperator_2 As rectangle:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            DisabledFill: =lblUserSeperator_2.Fill
                            Fill: =RGBA(230, 230, 230, 1)
                            FocusedBorderColor: =lblUserSeperator_2.BorderColor
                            Height: =1
                            HoverFill: =lblUserSeperator_2.Fill
                            OnSelect: =
                            PressedFill: =lblUserSeperator_2.Fill
                            Visible: =false
                            Width: =Parent.TemplateWidth
                            Y: =39
                            ZIndex: =3

            c_AppSupportDetails As groupContainer.manualLayoutContainer:
                LayoutMinHeight: =eleAppSupportDetails.Height
                LayoutMinWidth: =c_AppDetailsTop.LayoutMinWidth
                Width: =c_AppDetailsTop.LayoutMinWidth
                ZIndex: =3

                "eleAppSupportDetails As 'Fluent Elevation (1.0.19)'":
                    DisplayMode: =DisplayMode.Edit
                    Height: =c_AppDetailsMain.Height-50
                    HoverDepth: ='PowerCAT.Elevation.HoverDepth'.Depth4
                    OnChange: =false
                    PaddingBottom: =Self.PaddingLeft
                    PaddingLeft: =8
                    PaddingRight: =Self.PaddingLeft
                    PaddingTop: =Self.PaddingLeft
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =1

                c_FormAppSupportDetails As groupContainer.verticalAutoLayoutContainer:
                    Height: =Parent.Height
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =24
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =10
                    PaddingRight: =10
                    Width: =c_AppDetailsContent.Width
                    X: =24
                    Y: =24
                    ZIndex: =2

                    c_AppRoles As groupContainer.verticalAutoLayoutContainer:
                        FillPortions: =0
                        Height: =lblAppRoles.Height+dlAppRoles.Height+dlAppRoles.Visible+Self.LayoutGap
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =8
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =3

                        lblAppRoles As Label:
                            AlignInContainer: =AlignInContainer.Stretch
                            Color: =
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =12
                            FontWeight: =FontWeight.Semibold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            OnChange: =false
                            Text: ="Roles"
                            TextRole: ='Label.TextRole'.Heading2
                            Width: =150
                            X: =41
                            Y: =652
                            ZIndex: =1

                        "dlAppRoles As 'Fluent Details List (1.0.19)'.pcfdataset":
                            AlignInContainer: =AlignInContainer.Stretch
                            columns_Items: |-
                                =Table(
                                    {
                                        ColName: "Name",
                                        ColDisplayName: "Name",
                                        ColWidth: 150,
                                        ColSortable: true,
                                        ColIsBold: false,
                                        ColResizable: true
                                    },
                                     {
                                        ColName: "Role",
                                        ColDisplayName: "Role",
                                        ColWidth: 70,
                                        ColSortable: true,
                                        ColIsBold: false,
                                        ColResizable: true
                                    },
                                     {
                                        ColName: "Type",
                                        ColDisplayName: "Type",
                                        ColWidth: 70,
                                        ColSortable: true,
                                        ColIsBold: false,
                                        ColResizable: true
                                    })
                            DisplayMode: =DisplayMode.Edit
                            Height: =40+CountRows(appUserCollection)*40
                            Items: =appUserCollection
                            LayoutMinHeight: =100
                            LayoutMinWidth: =200
                            SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.None
                            Visible: =!IsEmpty(appUserCollection)
                            Width: =200
                            X: =0
                            Y: =0
                            ZIndex: =2

                            Name2 As pcfDataField.textualColumn:
                                FieldDisplayName: ="Name"
                                FieldName: ="Name"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =1
                                ZIndex: =9

                            Role2 As pcfDataField.textualColumn:
                                FieldDisplayName: ="Role"
                                FieldName: ="Role"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =2
                                ZIndex: =10

                            Type2 As pcfDataField.textualColumn:
                                FieldDisplayName: ="Type"
                                FieldName: ="Type"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =3
                                ZIndex: =11

                    c_AppConnections As groupContainer.verticalAutoLayoutContainer:
                        Height: =lblAppConnections.Height+dlConnections.Height*dlConnections.Visible+Self.LayoutGap
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =8
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =200
                        ZIndex: =5

                        lblAppConnections As Label:
                            AlignInContainer: =AlignInContainer.Stretch
                            Color: =
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =12
                            FontWeight: =FontWeight.Semibold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            OnChange: =false
                            Text: ="Connections"
                            TextRole: ='Label.TextRole'.Heading2
                            Width: =150
                            X: =41
                            Y: =652
                            ZIndex: =1

                        "dlConnections As 'Fluent Details List (1.0.19)'.pcfdataset":
                            AlignInContainer: =AlignInContainer.Stretch
                            columns_Items: |-
                                =Table(
                                     {
                                        ColName: "Picture",
                                        ColDisplayName: "",
                                        ColCellType:"image",
                                        ColWidth: 40,
                                        ColImageWidth: 30,
                                        ColImagePadding: 0,
                                        ColVerticalAlign: "Top"
                                },
                                    {
                                        ColName: "Name",
                                        ColDisplayName: "Name",
                                        ColWidth: 200,
                                        ColSortable: true,
                                        ColIsBold: false,
                                        ColResizable: true
                                    })
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =1
                            HeaderVisible: =false
                            Height: =200
                            Items: =Filter(appConnectionCollection, !IsBlank(Name))
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.None
                            Visible: =!IsEmpty(appConnectionCollection)
                            Width: =200
                            X: =0
                            Y: =0
                            ZIndex: =2

                            Name3 As pcfDataField.textualColumn:
                                FieldDisplayName: ="Name"
                                FieldName: ="Name"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =1
                                ZIndex: =12

                            Picture1 As pcfDataField.textualColumn:
                                FieldDisplayName: ="Picture"
                                FieldName: ="Picture"
                                FieldType: ="h"
                                FieldVariantName: ="textualColumn"
                                Order: =2
                                ZIndex: =13

    "Spinner1 As 'Fluent Spinner (1.0.19) Preview'":
        DisplayMode: =DisplayMode.Edit
        Height: =Parent.Height
        Label: =showLoaderText
        Theme: =AppThemeJson
        Visible: =showLoader
        Width: =Parent.Width
        X: =0
        Y: =0
        ZIndex: =3

    diagDelete As Dialog:
        Buttons: |-
            =Table({Label: "Delete", ButtonType:'Button.ButtonType'.Primary},{Label: "Cancel", ButtonType:'Button.ButtonType'.Standard } )
        DialogHeight: =220
        DialogWidth: =500
        Fill: =diagDelete.OverlayColor
        Height: =App.Height
        OnButtonSelect: |-
            =Switch(
                Self.SelectedButton.Label,
                "Delete",
                PowerAppsforMakers.RemoveApp(vSelectedAppN.App); 
                ClearCollect(
                    appsFromConnector,
                    PowerAppsforMakers.GetApps({'$top':1000}).value
                );
                
                Back();
            
                UpdateContext({showPopUp: false, confirmDeletion: false}),
            
                UpdateContext({showPopUp: false, confirmDeletion: false})
            )
        OnCloseSelect: |-
            =UpdateContext({showPopUp: false, confirmDeletion: false})
        OverlayColor: =RGBA(0, 0, 0, 0.2)
        SubTitle: ="Are you sure you want to delete '" & vSelectedAppN.'App Display Name' & "'? This action cannot be undone."
        Title: ="Warning"
        Visible: =showPopUp && confirmDeletion
        Width: =App.Width
        ZIndex: =4

    diagCantDoThat As Dialog:
        Buttons: |-
            =Table({Label: "Close", ButtonType:'Button.ButtonType'.Standard } )
        DialogHeight: =220
        DialogWidth: =500
        Fill: =diagCantDoThat.OverlayColor
        Height: =App.Height
        OnButtonSelect: |-
            =UpdateContext({showCantShowThat: false})
        OnCloseSelect: |-
            =UpdateContext({showCantShowThat: false})
        OverlayColor: =RGBA(0, 0, 0, 0.2)
        SubTitle: =CantShowThatText
        Title: ="Warning"
        Visible: =showCantShowThat
        Width: =App.Width
        ZIndex: =6

    c_SupportDetails As groupContainer.manualLayoutContainer:
        Height: =Parent.Height
        Visible: =showHidePanel
        Width: =Parent.Width
        X: =0+0
        Y: =0+0
        ZIndex: =7

        panSupportDetails As Panel:
            Buttons: |-
                =Table({Label: "Cancel", ButtonType:'Button.ButtonType'.Standard } ,{Label: "Save", ButtonType:'Button.ButtonType'.Primary})
            DialogWidth: =Min(800,Self.Width-64)
            Fill: =panSupportDetails.OverlayColor
            OnButtonSelect: |-
                =If(
                    Self.SelectedButton.Label = "Save",
                    //submit data
                    SubmitForm(formSupportDetails); Set(vSelectedAppN, formSupportDetails.LastSubmit); ResetForm(formSupportDetails);
                
                    //check if all requirements met
                    /*If(And(!IsBlank(vSelectedAppN.'App Description'), !IsBlank(vSelectedAppN.'Maker Requirement - Business Justification'), !IsBlank(vSelectedAppN.'Maker Requirement - Access Management'), !IsBlank(vSelectedAppN.'Maker Requirement - Dependencies'), !IsBlank(vSelectedAppN.'Maker Requirement - Business Impact'), !IsBlank(vSelectedAppN.'Maker Requirement - Data Classification'), vSelectedAppN.'Mitigation Plan Provided'='Mitigation Plan Provided (PowerApps Apps)'.Yes), */
                
                    //and change state to submitted and recollect the app
                    UpdateIf('PowerApps Apps', App=vSelectedAppN.App, {'Admin Requirement - Risk Assessment State': 'Risk Assessment State Choice'.Submitted, 'Compliance Requested on': Date(0,0,0)});
                    RemoveIf(myApps, App=vSelectedAppN.App);
                    Collect(myApps, LookUp('PowerApps Apps', App=vSelectedAppN.App));
                    Set(vSelectedAppN, LookUp(myApps, App=vSelectedAppN.App));
                    //)
                    Notify("Details updated.")
                );
                
                UpdateContext({showHidePanel:false})
            OnCloseSelect: |-
                =UpdateContext({showHidePanel:false})
            Subtitle: ="Please provide additional details about your app. This may be requested by your admin."
            Title: ="Support details"
            Width: =App.Width
            X: =0+0
            Y: =0+0
            ZIndex: =1

        formSupportDetails As form:
            AcceptsFocus: =false
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderStyle: =BorderStyle.None
            DataSource: ='PowerApps Apps'
            Height: =Min(panSupportDetails.Height,Parent.Height-Self.Y-60)
            Item: =vSelectedAppN
            NumberOfColumns: =2
            OnSuccess: =Notify("Your Support Details Form has been saved successfully.", NotificationType.Success)
            Visible: =panSupportDetails.Visible
            Width: =panSupportDetails.ContentWidth+40
            X: =panSupportDetails.ContentX-40
            Y: =panSupportDetails.ContentY+60
            ZIndex: =2

            "'Maker Requirement - Business Justification_DataCard1_1' As typedDataCard.textualEditCard":
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="admin_requirement_1"
                Default: =ThisItem.'Maker Requirement - Business Justification'
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Maker Requirement - Business Justification"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo('PowerApps Apps', DataSourceInfo.MaxLength, "admin_requirement_1")
                Required: =false
                Update: =DataCardValue15_1.Text
                Width: =320
                WidthFit: =true
                X: =0
                Y: =0
                ZIndex: =1

                DataCardKey15_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =DataCardKey15_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =34
                    HoverBorderColor: =DataCardKey15_1.BorderColor
                    HoverColor: =DataCardKey15_1.Color
                    HoverFill: =DataCardKey15_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =DataCardKey15_1.BorderColor
                    PressedColor: =DataCardKey15_1.Color
                    PressedFill: =DataCardKey15_1.Fill
                    Size: =10.5
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue15_1 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderColor: =DataCardValue15_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =60
                    HoverBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                    HoverColor: =RGBA(51, 51, 51, 1)
                    HoverFill: =RGBA(255, 255, 255, 1)
                    MaxLength: =Parent.MaxLength
                    Mode: =TextMode.MultiLine
                    PaddingLeft: =5
                    PressedBorderColor: =RGBA(135, 100, 184, 1)
                    PressedColor: =RGBA(51, 51, 51, 1)
                    PressedFill: =RGBA(255, 255, 255, 1)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey15_1.Y + DataCardKey15_1.Height + 5
                    ZIndex: =2

                ErrorMessage14_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderColor: =ErrorMessage14_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    HoverBorderColor: =ErrorMessage14_1.BorderColor
                    HoverColor: =ErrorMessage14_1.Color
                    HoverFill: =ErrorMessage14_1.Fill
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =ErrorMessage14_1.BorderColor
                    PressedColor: =ErrorMessage14_1.Color
                    PressedFill: =ErrorMessage14_1.Fill
                    Size: =13
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue15_1.Y + DataCardValue15_1.Height
                    ZIndex: =3

                StarVisible14_1 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(255, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =StarVisible14_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey15_1.Height
                    HoverBorderColor: =StarVisible14_1.BorderColor
                    HoverColor: =StarVisible14_1.Color
                    HoverFill: =StarVisible14_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =StarVisible14_1.BorderColor
                    PressedColor: =StarVisible14_1.Color
                    PressedFill: =StarVisible14_1.Fill
                    Size: =13
                    Text: ="*"
                    Visible: =false
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey15_1.Y
                    ZIndex: =4

            "'Maker Requirement - Access Management_DataCard1_1' As typedDataCard.textualEditCard":
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="admin_requirement_2"
                Default: =ThisItem.'Maker Requirement - Access Management'
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Maker Requirement - Access Management"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo('PowerApps Apps', DataSourceInfo.MaxLength, "admin_requirement_2")
                Required: =false
                Update: =DataCardValue13_1.Text
                Width: =320
                WidthFit: =true
                X: =1
                Y: =0
                ZIndex: =1

                DataCardKey13_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =DataCardKey13_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =34
                    HoverBorderColor: =DataCardKey13_1.BorderColor
                    HoverColor: =DataCardKey13_1.Color
                    HoverFill: =DataCardKey13_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =DataCardKey13_1.BorderColor
                    PressedColor: =DataCardKey13_1.Color
                    PressedFill: =DataCardKey13_1.Fill
                    Size: =10.5
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue13_1 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderColor: =DataCardValue13_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =60
                    HoverBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                    HoverColor: =RGBA(51, 51, 51, 1)
                    HoverFill: =RGBA(255, 255, 255, 1)
                    MaxLength: =Parent.MaxLength
                    Mode: =TextMode.MultiLine
                    PaddingLeft: =5
                    PressedBorderColor: =RGBA(135, 100, 184, 1)
                    PressedColor: =RGBA(51, 51, 51, 1)
                    PressedFill: =RGBA(255, 255, 255, 1)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey13_1.Y + DataCardKey13_1.Height + 5
                    ZIndex: =2

                ErrorMessage12_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderColor: =ErrorMessage12_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    HoverBorderColor: =ErrorMessage12_1.BorderColor
                    HoverColor: =ErrorMessage12_1.Color
                    HoverFill: =ErrorMessage12_1.Fill
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =ErrorMessage12_1.BorderColor
                    PressedColor: =ErrorMessage12_1.Color
                    PressedFill: =ErrorMessage12_1.Fill
                    Size: =13
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue13_1.Y + DataCardValue13_1.Height
                    ZIndex: =3

                StarVisible12_1 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =StarVisible12_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey13_1.Height
                    HoverBorderColor: =StarVisible12_1.BorderColor
                    HoverColor: =StarVisible12_1.Color
                    HoverFill: =StarVisible12_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =StarVisible12_1.BorderColor
                    PressedColor: =StarVisible12_1.Color
                    PressedFill: =StarVisible12_1.Fill
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey13_1.Y
                    ZIndex: =4

            "'Maker Requirement - Dependencies_DataCard1_1' As typedDataCard.textualEditCard":
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="admin_requirement_3"
                Default: =ThisItem.'Maker Requirement - Dependencies'
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Maker Requirement - Dependencies"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo('PowerApps Apps', DataSourceInfo.MaxLength, "admin_requirement_3")
                Required: =false
                Update: =DataCardValue17_1.Text
                Width: =320
                WidthFit: =true
                X: =0
                Y: =1
                ZIndex: =1

                DataCardKey17_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =DataCardKey17_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =34
                    HoverBorderColor: =DataCardKey17_1.BorderColor
                    HoverColor: =DataCardKey17_1.Color
                    HoverFill: =DataCardKey17_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =DataCardKey17_1.BorderColor
                    PressedColor: =DataCardKey17_1.Color
                    PressedFill: =DataCardKey17_1.Fill
                    Size: =10.5
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue17_1 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderColor: =DataCardValue17_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =60
                    HoverBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                    HoverColor: =RGBA(51, 51, 51, 1)
                    HoverFill: =RGBA(255, 255, 255, 1)
                    MaxLength: =Parent.MaxLength
                    Mode: =TextMode.MultiLine
                    PaddingLeft: =5
                    PressedBorderColor: =RGBA(135, 100, 184, 1)
                    PressedColor: =RGBA(51, 51, 51, 1)
                    PressedFill: =RGBA(255, 255, 255, 1)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey17_1.Y + DataCardKey17_1.Height + 5
                    ZIndex: =2

                ErrorMessage16_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderColor: =ErrorMessage16_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    HoverBorderColor: =ErrorMessage16_1.BorderColor
                    HoverColor: =ErrorMessage16_1.Color
                    HoverFill: =ErrorMessage16_1.Fill
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =ErrorMessage16_1.BorderColor
                    PressedColor: =ErrorMessage16_1.Color
                    PressedFill: =ErrorMessage16_1.Fill
                    Size: =13
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue17_1.Y + DataCardValue17_1.Height
                    ZIndex: =3

                StarVisible16_1 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =StarVisible16_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey17_1.Height
                    HoverBorderColor: =StarVisible16_1.BorderColor
                    HoverColor: =StarVisible16_1.Color
                    HoverFill: =StarVisible16_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =StarVisible16_1.BorderColor
                    PressedColor: =StarVisible16_1.Color
                    PressedFill: =StarVisible16_1.Fill
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey17_1.Y
                    ZIndex: =4

            "'Maker Requirement - Business Impact_DataCard1_1' As typedDataCard.comboBoxOptionSetSingleEditCard":
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="admin_requirement_4"
                Default: =ThisItem.'Maker Requirement - Business Impact'
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Maker Requirement - Business Impact"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =false
                Update: =DataCardValue14_1.Selected.Value
                Width: =320
                WidthFit: =true
                X: =1
                Y: =1
                ZIndex: =1

                DataCardKey14_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =DataCardKey14_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =34
                    HoverBorderColor: =DataCardKey14_1.BorderColor
                    HoverColor: =DataCardKey14_1.Color
                    HoverFill: =DataCardKey14_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =DataCardKey14_1.BorderColor
                    PressedColor: =DataCardKey14_1.Color
                    PressedFill: =DataCardKey14_1.Fill
                    Size: =10.5
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue14_1 As combobox:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    ChevronBackground: =RGBA(255, 255, 255, 1)
                    ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                    ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                    ChevronFill: =RGBA(33, 33, 33, 1)
                    ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                    ChevronHoverFill: =RGBA(33, 33, 33, 1)
                    Color: =RGBA(51, 51, 51, 1)
                    DefaultSelectedItems: =[Parent.Default]
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayFields: =["Value"]
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderColor: =DataCardValue14_1.BorderColor
                    Font: =Font.'Segoe UI'
                    Height: =30
                    HoverBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                    HoverColor: =RGBA(51, 51, 51, 1)
                    HoverFill: =RGBA(212, 212, 212, 1)
                    IsSearchable: =false
                    Items: =Choices('Business Impact')
                    MoreItemsButtonColor: =DataCardValue14_1.ChevronBackground
                    PaddingLeft: =If(DataCardValue14_1.DisplayMode = DisplayMode.Edit, 5, 0)
                    PressedBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(135, 100, 184, 1)
                    SearchFields: =["Value"]
                    SearchItems: =[]
                    SelectionFill: =RGBA(135, 100, 184, 1)
                    SelectionTagColor: =DataCardValue14_1.HoverColor
                    SelectionTagFill: =DataCardValue14_1.HoverFill
                    SelectMultiple: =false
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey14_1.Y + DataCardKey14_1.Height + 5
                    ZIndex: =2

                ErrorMessage13_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderColor: =ErrorMessage13_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    HoverBorderColor: =ErrorMessage13_1.BorderColor
                    HoverColor: =ErrorMessage13_1.Color
                    HoverFill: =ErrorMessage13_1.Fill
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =ErrorMessage13_1.BorderColor
                    PressedColor: =ErrorMessage13_1.Color
                    PressedFill: =ErrorMessage13_1.Fill
                    Size: =13
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue14_1.Y + DataCardValue14_1.Height
                    ZIndex: =3

                StarVisible13_1 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =StarVisible13_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey14_1.Height
                    HoverBorderColor: =StarVisible13_1.BorderColor
                    HoverColor: =StarVisible13_1.Color
                    HoverFill: =StarVisible13_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =StarVisible13_1.BorderColor
                    PressedColor: =StarVisible13_1.Color
                    PressedFill: =StarVisible13_1.Fill
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey14_1.Y
                    ZIndex: =4

            "'Maker Requirement - Data Classification_DataCard1_1' As typedDataCard.comboBoxOptionSetSingleEditCard":
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="admin_requirement_6"
                Default: =ThisItem.'Maker Requirement - Data Classification'
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Maker Requirement - Data Classification"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =false
                Update: =DataCardValue16_1.Selected.Value
                Width: =320
                WidthFit: =true
                X: =0
                Y: =2
                ZIndex: =1

                DataCardKey16_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =DataCardKey16_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =34
                    HoverBorderColor: =DataCardKey16_1.BorderColor
                    HoverColor: =DataCardKey16_1.Color
                    HoverFill: =DataCardKey16_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =DataCardKey16_1.BorderColor
                    PressedColor: =DataCardKey16_1.Color
                    PressedFill: =DataCardKey16_1.Fill
                    Size: =10.5
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue16_1 As combobox:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    ChevronBackground: =RGBA(255, 255, 255, 1)
                    ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                    ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                    ChevronFill: =RGBA(33, 33, 33, 1)
                    ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                    ChevronHoverFill: =RGBA(33, 33, 33, 1)
                    Color: =RGBA(51, 51, 51, 1)
                    DefaultSelectedItems: =[Parent.Default]
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayFields: =["Value"]
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderColor: =DataCardValue16_1.BorderColor
                    Font: =Font.'Segoe UI'
                    Height: =30
                    HoverBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                    HoverColor: =RGBA(51, 51, 51, 1)
                    HoverFill: =RGBA(212, 212, 212, 1)
                    IsSearchable: =false
                    Items: =Choices('Data Classification')
                    MoreItemsButtonColor: =DataCardValue16_1.ChevronBackground
                    PaddingLeft: =If(DataCardValue16_1.DisplayMode = DisplayMode.Edit, 5, 0)
                    PressedBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(135, 100, 184, 1)
                    SearchFields: =["Value"]
                    SearchItems: =[]
                    SelectionFill: =RGBA(135, 100, 184, 1)
                    SelectionTagColor: =DataCardValue16_1.HoverColor
                    SelectionTagFill: =DataCardValue16_1.HoverFill
                    SelectMultiple: =false
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey16_1.Y + DataCardKey16_1.Height + 5
                    ZIndex: =2

                ErrorMessage15_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderColor: =ErrorMessage15_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    HoverBorderColor: =ErrorMessage15_1.BorderColor
                    HoverColor: =ErrorMessage15_1.Color
                    HoverFill: =ErrorMessage15_1.Fill
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =ErrorMessage15_1.BorderColor
                    PressedColor: =ErrorMessage15_1.Color
                    PressedFill: =ErrorMessage15_1.Fill
                    Size: =13
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue16_1.Y + DataCardValue16_1.Height
                    ZIndex: =3

                StarVisible15_1 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =StarVisible15_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey16_1.Height
                    HoverBorderColor: =StarVisible15_1.BorderColor
                    HoverColor: =StarVisible15_1.Color
                    HoverFill: =StarVisible15_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =StarVisible15_1.BorderColor
                    PressedColor: =StarVisible15_1.Color
                    PressedFill: =StarVisible15_1.Fill
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey16_1.Y
                    ZIndex: =4

            "'Mitigation Plan Provided_DataCard1_1' As typedDataCard.comboBoxOptionSetSingleEditCard":
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="admin_requirement_5"
                Default: =ThisItem.'Mitigation Plan Provided'
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Mitigation Plan Provided"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =false
                Update: =DataCardValue20_1.Selected.Value
                Width: =320
                WidthFit: =true
                X: =1
                Y: =2
                ZIndex: =1

                DataCardKey20_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =DataCardKey20_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =34
                    HoverBorderColor: =DataCardKey20_1.BorderColor
                    HoverColor: =DataCardKey20_1.Color
                    HoverFill: =DataCardKey20_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =DataCardKey20_1.BorderColor
                    PressedColor: =DataCardKey20_1.Color
                    PressedFill: =DataCardKey20_1.Fill
                    Size: =10.5
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue20_1 As combobox:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    ChevronBackground: =RGBA(255, 255, 255, 1)
                    ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                    ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                    ChevronFill: =RGBA(33, 33, 33, 1)
                    ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                    ChevronHoverFill: =RGBA(33, 33, 33, 1)
                    Color: =RGBA(51, 51, 51, 1)
                    DefaultSelectedItems: =[Parent.Default]
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayFields: =["Value"]
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderColor: =DataCardValue20_1.BorderColor
                    Font: =Font.'Segoe UI'
                    Height: =30
                    HoverBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                    HoverColor: =RGBA(51, 51, 51, 1)
                    HoverFill: =RGBA(212, 212, 212, 1)
                    IsSearchable: =false
                    Items: =Choices('Mitigation Plan Provided (PowerApps Apps)')
                    MoreItemsButtonColor: =DataCardValue20_1.ChevronBackground
                    PaddingLeft: =If(DataCardValue20_1.DisplayMode = DisplayMode.Edit, 5, 0)
                    PressedBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(135, 100, 184, 1)
                    SearchFields: =["Value"]
                    SearchItems: =[]
                    SelectionFill: =RGBA(135, 100, 184, 1)
                    SelectionTagColor: =DataCardValue20_1.HoverColor
                    SelectionTagFill: =DataCardValue20_1.HoverFill
                    SelectMultiple: =false
                    Size: =12
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey20_1.Y + DataCardKey20_1.Height + 5
                    ZIndex: =2

                ErrorMessage19_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderColor: =ErrorMessage19_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    HoverBorderColor: =ErrorMessage19_1.BorderColor
                    HoverColor: =ErrorMessage19_1.Color
                    HoverFill: =ErrorMessage19_1.Fill
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =ErrorMessage19_1.BorderColor
                    PressedColor: =ErrorMessage19_1.Color
                    PressedFill: =ErrorMessage19_1.Fill
                    Size: =13
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue20_1.Y + DataCardValue20_1.Height
                    ZIndex: =3

                StarVisible19_1 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =StarVisible19_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey20_1.Height
                    HoverBorderColor: =StarVisible19_1.BorderColor
                    HoverColor: =StarVisible19_1.Color
                    HoverFill: =StarVisible19_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =StarVisible19_1.BorderColor
                    PressedColor: =StarVisible19_1.Color
                    PressedFill: =StarVisible19_1.Fill
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey20_1.Y
                    ZIndex: =4

            Category_DataCard1_1 As typedDataCard.comboBoxOptionSetSingleEditCard:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="admin_category"
                Default: =ThisItem.Category
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Category"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =false
                Update: =DataCardValue21_1.Selected.Value
                Width: =320
                WidthFit: =true
                X: =0
                Y: =3
                ZIndex: =1

                DataCardKey21_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =DataCardKey21_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =34
                    HoverBorderColor: =DataCardKey21_1.BorderColor
                    HoverColor: =DataCardKey21_1.Color
                    HoverFill: =DataCardKey21_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =DataCardKey21_1.BorderColor
                    PressedColor: =DataCardKey21_1.Color
                    PressedFill: =DataCardKey21_1.Fill
                    Size: =10.5
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue21_1 As combobox:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    ChevronBackground: =RGBA(255, 255, 255, 1)
                    ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
                    ChevronDisabledFill: =RGBA(166, 166, 166, 1)
                    ChevronFill: =RGBA(33, 33, 33, 1)
                    ChevronHoverBackground: =RGBA(212, 212, 212, 1)
                    ChevronHoverFill: =RGBA(33, 33, 33, 1)
                    Color: =RGBA(51, 51, 51, 1)
                    DefaultSelectedItems: =[Parent.Default]
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayFields: =["Value"]
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderColor: =DataCardValue21_1.BorderColor
                    Font: =Font.'Segoe UI'
                    Height: =30
                    HoverBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                    HoverColor: =RGBA(51, 51, 51, 1)
                    HoverFill: =RGBA(212, 212, 212, 1)
                    IsSearchable: =false
                    Items: =Choices('App Category')
                    MoreItemsButtonColor: =DataCardValue21_1.ChevronBackground
                    PaddingLeft: =If(DataCardValue21_1.DisplayMode = DisplayMode.Edit, 5, 0)
                    PressedBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(135, 100, 184, 1)
                    SearchFields: =["Value"]
                    SearchItems: =[]
                    SelectionFill: =RGBA(135, 100, 184, 1)
                    SelectionTagColor: =DataCardValue21_1.HoverColor
                    SelectionTagFill: =DataCardValue21_1.HoverFill
                    SelectMultiple: =false
                    Size: =12
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey21_1.Y + DataCardKey21_1.Height + 5
                    ZIndex: =2

                ErrorMessage20_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderColor: =ErrorMessage20_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    HoverBorderColor: =ErrorMessage20_1.BorderColor
                    HoverColor: =ErrorMessage20_1.Color
                    HoverFill: =ErrorMessage20_1.Fill
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =ErrorMessage20_1.BorderColor
                    PressedColor: =ErrorMessage20_1.Color
                    PressedFill: =ErrorMessage20_1.Fill
                    Size: =13
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue21_1.Y + DataCardValue21_1.Height
                    ZIndex: =3

                StarVisible20_1 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =StarVisible20_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey21_1.Height
                    HoverBorderColor: =StarVisible20_1.BorderColor
                    HoverColor: =StarVisible20_1.Color
                    HoverFill: =StarVisible20_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =StarVisible20_1.BorderColor
                    PressedColor: =StarVisible20_1.Color
                    PressedFill: =StarVisible20_1.Fill
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey21_1.Y
                    ZIndex: =4

            Attachments_DataCard1_1 As typedDataCard.attachmentsEditCard:
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="{Attachments}"
                Default: =ThisItem.Attachments
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Attachments"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =150
                Required: =false
                Update: =DataCardValue19_1.Attachments
                Width: =320
                WidthFit: =true
                X: =1
                Y: =3
                ZIndex: =1

                DataCardKey19_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =DataCardKey19_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =34
                    HoverBorderColor: =DataCardKey19_1.BorderColor
                    HoverColor: =DataCardKey19_1.Color
                    HoverFill: =DataCardKey19_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =DataCardKey19_1.BorderColor
                    PressedColor: =DataCardKey19_1.Color
                    PressedFill: =DataCardKey19_1.Fill
                    Size: =10.5
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue19_1 As attachments:
                    AddAttachmentColor: =DataCardValue19_1.Color
                    AddedItemColor: =DataCardValue19_1.Color
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderColor: =DataCardValue19_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =125
                    HoverBorderColor: =ColorFade(DataCardValue19_1.BorderColor, 15%)
                    HoverColor: =RGBA(51, 51, 51, 1)
                    HoverFill: =RGBA(212, 212, 212, 1)
                    IsInDataCard: =true
                    ItemColor: =RGBA(0, 0, 0, 1)
                    ItemDisabledColor: =DataCardValue19_1.DisabledColor
                    ItemDisabledFill: =DataCardValue19_1.DisabledFill
                    ItemFill: =RGBA(135, 100, 184, 1)
                    ItemHoverColor: =RGBA(51, 51, 51, 1)
                    ItemHoverFill: =RGBA(212, 212, 212, 1)
                    ItemPressedColor: =DataCardValue19_1.PressedColor
                    ItemPressedFill: =DataCardValue19_1.PressedFill
                    Items: =Parent.Default
                    ItemSpacing: =12
                    MaxAttachmentsColor: =DataCardValue19_1.Color
                    NoAttachmentsColor: =RGBA(166, 166, 166, 1)
                    PaddingBottom: =5
                    PaddingLeft: =If(DataCardValue19_1.DisplayMode = DisplayMode.Edit, 5, 0)
                    PaddingRight: =5
                    PaddingTop: =5
                    PressedBorderColor: =DataCardValue19_1.HoverBorderColor
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(135, 100, 184, 1)
                    RemovedItemColor: =DataCardValue19_1.Color
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey19_1.Y + DataCardKey19_1.Height + 5
                    ZIndex: =2

                ErrorMessage18_1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderColor: =ErrorMessage18_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    HoverBorderColor: =ErrorMessage18_1.BorderColor
                    HoverColor: =ErrorMessage18_1.Color
                    HoverFill: =ErrorMessage18_1.Fill
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =ErrorMessage18_1.BorderColor
                    PressedColor: =ErrorMessage18_1.Color
                    PressedFill: =ErrorMessage18_1.Fill
                    Size: =13
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue19_1.Y + DataCardValue19_1.Height
                    ZIndex: =3

                StarVisible18_1 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderColor: =StarVisible18_1.BorderColor
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey19_1.Height
                    HoverBorderColor: =StarVisible18_1.BorderColor
                    HoverColor: =StarVisible18_1.Color
                    HoverFill: =StarVisible18_1.Fill
                    PaddingLeft: =0
                    PressedBorderColor: =StarVisible18_1.BorderColor
                    PressedColor: =StarVisible18_1.Color
                    PressedFill: =StarVisible18_1.Fill
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey19_1.Y
                    ZIndex: =4

    c_EmailPanel As groupContainer.manualLayoutContainer:
        Height: =Parent.Height
        Visible: =showPopUp && emailUsers
        Width: =Parent.Width
        X: =0+0
        Y: =0+0
        ZIndex: =8

        panEmail As Panel:
            Buttons: |-
                =Table({Label: "Cancel", ButtonType:'Button.ButtonType'.Standard } ,{Label: "Send", ButtonType:'Button.ButtonType'.Primary})
            DialogWidth: =Min(640,Self.Width-64)
            Fill: =panEmail.OverlayColor
            OnButtonSelect: |-
                =If(
                    Self.SelectedButton.Label = "Send",
                    ForAll(
                        Filter(emailAppUserCollection, properties.principal.type <> "Tenant"),
                        Office365Outlook.SendEmailV2(
                            properties.principal.email,
                            txtEmailSubject.Value,
                            rteEmailMessage.HtmlText,
                            {
                                Importance: "Normal"
                            }
                        )
                    );
                    Notify("Your app users have been emailed successfully.", NotificationType.Success);
                    UpdateContext({showPopUp:false, emailUsers:false}),
                
                    UpdateContext({showPopUp:false, emailUsers:false})
                )
            OnCloseSelect: |-
                =UpdateContext({showPopUp:false, emailUsers:false})
            Subtitle: ="Complete this form to send an email to users."
            Title: ="Email users"
            Width: =App.Width
            X: =0+0
            Y: =0+0
            ZIndex: =1

        c_Email As groupContainer.verticalAutoLayoutContainer:
            Height: =panEmail.ContentHeight
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =24
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =24
            PaddingRight: =Self.PaddingLeft
            Width: =panEmail.ContentWidth+40
            X: =panEmail.ContentX-40
            Y: =panEmail.ContentY+40
            ZIndex: =2

            c_EmailSendTo As groupContainer.verticalAutoLayoutContainer:
                FillPortions: =0
                Height: =Min(200,lblEmailSendTo.Height+txtEmailSendTo.Height)
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =1

                lblEmailSendTo As Label:
                    Color: =
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =12
                    FontWeight: =FontWeight.Semibold
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =320
                    OnChange: =false
                    Text: ="Send to"
                    TextRole: ='Label.TextRole'.Heading2
                    Width: =150
                    X: =42
                    Y: =794
                    ZIndex: =2

                "txtEmailSendTo As 'Text box'":
                    AlignInContainer: =AlignInContainer.Stretch
                    ColorBackground: =
                    ColorText: =
                    DisplayMode: =DisplayMode.View
                    FillPortions: =1
                    Height: =32
                    LayoutMinHeight: =50
                    LayoutMinWidth: =320
                    Mode: ='TextBox.Mode'.Multiline
                    Value: =Concat(Filter(emailAppUserCollection, properties.principal.type <> "Tenant"), properties.principal.email & ",")
                    Width: =320
                    X: =0
                    Y: =0
                    ZIndex: =4

            c_EmailSubject As groupContainer.verticalAutoLayoutContainer:
                FillPortions: =0
                Height: =64
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =2

                lblEmailSubject As Label:
                    Color: =
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =12
                    FontWeight: =FontWeight.Semibold
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =320
                    OnChange: =false
                    Text: ="Subject"
                    TextRole: ='Label.TextRole'.Heading2
                    Width: =150
                    X: =42
                    Y: =794
                    ZIndex: =2

                "txtEmailSubject As 'Text box'":
                    AlignInContainer: =AlignInContainer.Stretch
                    ColorBackground: =
                    ColorText: =
                    DisplayMode: =DisplayMode.Edit
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =320
                    Value: ="Update for " & vSelectedAppN.admin_displayname
                    Width: =210
                    X: =68
                    Y: =254
                    ZIndex: =3

            c_EmailMessage As groupContainer.verticalAutoLayoutContainer:
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =3

                lblEmailMessage As Label:
                    Color: =
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =12
                    FontWeight: =FontWeight.Semibold
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =320
                    OnChange: =false
                    Text: ="Message"
                    TextRole: ='Label.TextRole'.Heading2
                    Width: =150
                    X: =42
                    Y: =794
                    ZIndex: =2

                rteEmailMessage As richTextEditor:
                    AlignInContainer: =AlignInContainer.Stretch
                    BorderColor: =RGBA(230, 230, 230, 1)
                    Default: =""
                    Height: =278
                    LayoutMinWidth: =400
                    Size: =12
                    Width: =884
                    X: =513
                    Y: =46
                    ZIndex: =3

    c_DialogReassign As groupContainer.manualLayoutContainer:
        Height: =Parent.Height
        Visible: =showPopUp && showNewOwner
        Width: =Parent.Width
        X: =0+0
        Y: =0+0
        ZIndex: =9

        diagReassign As Dialog:
            Buttons: |-
                =Table({Label: "Assign", ButtonType:'Button.ButtonType'.Primary},{Label: "Cancel", ButtonType:'Button.ButtonType'.Standard } )
            DialogHeight: =220
            DialogWidth: =500
            Fill: =diagReassign.OverlayColor
            Height: =App.Height
            OnButtonSelect: |-
                =Switch(
                    Self.SelectedButton.Label,
                    "Assign",
                    //get new owner guid
                    UpdateContext({NewOwner: IfError(Office365Users.UserProfileV2(txtReassign.Value).id, "")});
                
                    //if blank set to error
                    If(
                        IsBlank(NewOwner), 
                        UpdateContext({NewOwnerError: true}),
                
                        //else set new owner and update roles on backend
                        UpdateContext({NewOwnerError: false});
                        UpdateContext(
                            {
                                NewOwnerError: 
                                If(
                                    'HELPER-ObjectOperations'.Run(
                                        NewOwner, 
                                        vSelectedAppN.App, 
                                        vSelectedAppN.'App Environment'.Name, 
                                        "assign", 
                                        "app"
                                    ).thereturnstring ="fail",
                                    true,
                                    false
                                )
                            }
                        );
                
                        //if it worked
                        If(
                            !NewOwnerError,
                            
                            //re-collect the app
                            RemoveIf(myApps, App=vSelectedAppN.App);
                            Collect(myApps, LookUp('PowerApps Apps', App=vSelectedAppN.App));
                
                            //update this pages view of ownership
                            ClearCollect(
                                appUserCollection, 
                                IfError(
                                AddColumns(
                                    PowerAppsforMakers.GetAppRoleAssignment(vSelectedAppN.App).value.properties, 
                                    "Picture",
                                    If(
                                        And(properties.principal.type = "User",
                                            Office365Users.UserPhotoMetadata(properties.principal.id).HasPhoto
                                        ),
                                        Office365Users.UserPhotoV2(properties.principal.id), 
                                        properties.principal.type <> "Tenant",
                                        Person,
                                        Org
                                    )
                                ), Blank())
                            );
                
                            ClearCollect(
                                emailAppUserCollection,
                                IfError(
                                PowerAppsforMakers.GetAppRoleAssignment(vSelectedAppN.App).value.properties, Blank())
                            );
                
                            //and close the dialog
                            UpdateContext({showPopUp:false, showNewOwner: false})
                        )
                    ),
                
                    UpdateContext({showPopUp:false, showNewOwner: false})
                )
            OnCloseSelect: |-
                =UpdateContext({showPopUp:false, showNewOwner: false})
            OverlayColor: =RGBA(0, 0, 0, 0.2)
            SubTitle: =If(NewOwnerError, "Assigning a new owner failed. Email be invalid.", "Enter the email address of a new owner.")
            Title: ="Assign new owner"
            Width: =App.Width
            ZIndex: =1

        "txtReassign As 'Text box'":
            ColorBackground: =
            ColorText: =
            DisplayMode: =DisplayMode.Edit
            Height: =32
            Placeholder: ="Email address"
            Value: =""
            Width: =diagReassign.ContentWidth-24*2
            X: =diagReassign.ContentX+24
            Y: =diagReassign.ContentY+48
            ZIndex: =2

