DeploymentSettingsScreen As screen:
    OnVisible: |-
        =Reset(chkShareAllConnections);
        UpdateContext(
            {
                sortFlowEnabled: true,
                showDeployDialog: true,
                showDeploymentSettingsLoader: true,
                showConnectionReferenceSettings: false,
                showEnvironmentVariablesSettings: false,
                showSharingSettings: false,
                showOwnerSettings: false,
                showConnectorSettings: false,
                showGroupTeamsSettings: false,
                showWebHookURLs: false,
                showPortalConfig: false,
                showSDKMessage: false,
                locCloseAfterSave: true,
                locShareConnections: true,
                locDeploymentEnvironmentLabel: "Select an Environment to Configure",
                SolutionLoaderText: "LOADING...",
                DeploymentSettingsLoadingText: "GETTING SOLUTION DEPENDENCIES...",
                SaveDeploymentButtonText: "SAVE AND CLOSE"
            }
        );
        IfError(
            If(
                !IsBlank(Param("configsoln")) And !IsBlank(Param("env")) And !IsBlank(Param("profile")) And !IsBlank(Param("step")),
                ClearCollect(
                    AllEnvironments,
                    Sort(
                        PowerAppsforMakers.GetEnvironments().value,
                        DataSourceInfo.DisplayName
                    )
                );
                Set(
                    SelectedEnvironment,
                    LookUp(
                        AllEnvironments,
                        name = Param("env")
                    )
                );
                Clear(TempSelectedEnvironmentSolutions);
                Collect(
                    TempSelectedEnvironmentSolutions,
                    AddColumns(
                        GetEnvironmentSolutions.Run(
                            SelectedEnvironment.properties.linkedEnvironmentMetadata.uniqueName,
                            Last(
                                FirstN(
                                    ClearCollect(
                                        splitCol,
                                        ForAll(
                                            Split(
                                                SelectedEnvironment.properties.linkedEnvironmentMetadata.instanceUrl,
                                                "."
                                            ),
                                            {Result: ThisRecord.Value}
                                        )
                                    ),
                                    2
                                )
                            ).Result
                        ),
                        "deploymentrequests",
                        Sort(
                            Filter(
                                'Deployment Requests',
                                'Solution Name' = uniquename
                            ),
                            'Created On',
                            SortOrder.Descending
                        ),
                        "deploymentprofile",
                        First(
                            Sort(
                                Filter(
                                    'Deployment Requests',
                                    'Solution Name' = uniquename
                                ),
                                'Created On',
                                SortOrder.Descending
                            )
                        ).'Deployment Profile'
                    )
                );
                ClearCollect(
                    SelectedEnvironmentSolutions,
                    TempSelectedEnvironmentSolutions
                );
                Set(
                    SelectedSolutionToConfigure,
                    LookUp(
                        SelectedEnvironmentSolutions,
                        solutionid = Param("configsoln")
                    )
                );
                Set(
                    SelectedConfigurationDeploymentProfile,
                    LookUp(
                        'Deployment Profiles',
                        'Deployment Profile' = GUID(Param("profile"))
                    )
                );
                Set(
                    SelectedDeploymentEnvironmentId,
                    Param("step")
                );
                UpdateContext({SaveDeploymentButtonText: "Save"});
            );
            ClearCollect(
                DeploymentSteps,
                Filter(
                    'Deployment Steps',
                    'Deployment Profile'.'Deployment Profile' = SelectedConfigurationDeploymentProfile.'Deployment Profile'
                )
            );
            ClearCollect(
                DeploymentEnvironments,
                AddColumns(
                    Sort(
                        DeploymentSteps,
                        'Step Number'
                    ),
                    "EnvironmentUrl",
                    'Deployment Environment'.URL,
                    "MakerPortalUrl",
                    Substitute(LookUp(
                        AllEnvironments,
                        'Deployment Environment'.URL in properties.linkedEnvironmentMetadata.instanceUrl
                    ).properties.clientUris.maker, "/home", ""),
                    "EnvironmentId",
                    LookUp(
                        AllEnvironments,
                        'Deployment Environment'.URL in properties.linkedEnvironmentMetadata.instanceUrl
                    ).name,
                    "EnvironmentUniqueName",
                    LookUp(
                        AllEnvironments,
                        'Deployment Environment'.URL in properties.linkedEnvironmentMetadata.instanceUrl
                    ).properties.linkedEnvironmentMetadata.uniqueName
                )
            );
            UpdateContext({locDeploymentEnvironmentCount: CountRows(DeploymentEnvironments)});
            RemoveIf(
                DeploymentEnvironments,
                IsBlankOrError(EnvironmentUniqueName)
            );
            If(
                locDeploymentEnvironmentCount <> CountRows(DeploymentEnvironments),
                UpdateContext({locDeploymentEnvironmentLabel: "Select an Environment to Configure (NOTE: One or more deployment environment(s) could not be found. Only the available deployment environment(s) will be configurable.)"})
            );
            If(
                CountRows(DeploymentEnvironments) > 0,
                If(
                    IsBlankOrError(SelectedDeploymentEnvironmentId),
                    UpdateContext({SelectedDeploymentEnvironment: First(DeploymentEnvironments)}),
                    UpdateContext(
                        {
                            SelectedDeploymentEnvironment: LookUp(
                                DeploymentEnvironments,
                                EnvironmentId = SelectedDeploymentEnvironmentId
                            )
                        }
                    )
                );
            //Load existing values from deployment configuration data
        UpdateContext({locSharepointFilter: ""});
                UpdateContext({locAADGroupFilters: ""});
                UpdateContext({locEnvironmentUserFilters: ""});
                If(
                    Not IsBlank(SelectedDeploymentEnvironment),
                    UpdateContext({locSolutionEnvironmentDeploySettingName: DeploymentSettingName & " - " & SelectedSolutionToConfigure.uniquename & " - " & SelectedDeploymentEnvironment.EnvironmentUrl});
                    UpdateContext(
                        {
                            locEnvironmentDeploymentSetting: LookUp(
                                'User Settings',
                                Name = locSolutionEnvironmentDeploySettingName
                            )
                        }
                    );
                    If(
                        IsBlank(locEnvironmentDeploymentSetting.Data),
                        UpdateContext({EnvironmentDeploymentSettings: []}),
                        UpdateContext({EnvironmentDeploymentSettings: ParseDeploymentSettings.Run(locEnvironmentDeploymentSetting.Data)})
                    );
                    UpdateContext(
                        {
                            locSharepointFilter: Concat(
                                ForAll(
                                    Distinct(
                                        Filter(
                                            EnvironmentDeploymentSettings,
                                            StartsWith(
                                                Name,
                                                "environmentvariable."
                                            ) And ".sharepoint." in Value
                                        ),
                                        Value
                                    ),
                                    {Result: ThisRecord.Value}
                                ),
                                "site:" & Result,
                                " OR "
                            ),
                            locAADGroupFilters: Concat(
                                ForAll(
                                    Distinct(
                                        Filter(
                                            EnvironmentDeploymentSettings,
                                            (StartsWith(
                                                Name,
                                                "canvasshare.aadGroupId."
                                            ) Or StartsWith(
                                                Name,
                                                "groupteam."
                                            )) And !IsBlankOrError(Value)
                                        ),
                                        Value
                                    ),
                                    {Result: ThisRecord.Value}
                                ),
                                "id eq '" & Result & "'",
                                " OR "
                            ),
                            locEnvironmentUserFilters: Concat(
                                ForAll(
                                    Distinct(
                                        Filter(
                                            EnvironmentDeploymentSettings,
                                            (StartsWith(
                                                Name,
                                                "owner.ownerEmail."
                                            ) Or StartsWith(
                                                Name,
                                                "flow.activation."
                                            )) And !IsBlankOrError(Value)
                                        ),
                                        Value
                                    ),
                                    {Result: ThisRecord.Value}
                                ),
                                "internalemailaddress eq '" & Result & "'",
                                " or "
                            )
                        }
                    );
                );
                ClearCollect(
                    SolutionConnectionReferences,
                    {}
                );
                ClearCollect(
                    SolutionCanvasApps,
                    {}
                );
                ClearCollect(
                    SolutionSecurityRoles,
                    {}
                );
                ClearCollect(
                    SolutionEnvironmentVariables,
                    {}
                );
                ClearCollect(
                    SolutionWebHookURLs,
                    {}
                );
                ClearCollect(
                    SolutionSDKSteps,
                    {}
                );
                ClearCollect(
                    SolutionFlows,
                    {}
                );
                ClearCollect(
                    AppSharingPermissions,
                    {}
                );
                ClearCollect(
                    SharepointLists,
                    {}
                );
                ClearCollect(
                    CustomConnectors,
                    {}
                );
                Clear(SolutionConnectionReferences);
                Clear(SolutionCanvasApps);
                Clear(SolutionSecurityRoles);
                Clear(SolutionEnvironmentVariables);
                Clear(SolutionFlows);
                Clear(AppSharingPermissions);
                Clear(SharepointLists);
                Clear(CustomConnectors);
                Clear(SolutionWebHookURLs);
                Clear(SolutionSDKSteps);
                Concurrent(
                    ClearCollect(
                        AADGroups,
                        SearchAADGroups.Run(
                            {
                                text_1: If(
                                    IsBlank(locAADGroupFilters),
                                    "",
                                    locAADGroupFilters
                                ),
                                text: ""
                            }
                        ).value
                    ),
                    ClearCollect(
                        SharepointSites,
                        SearchSharepointSites.Run(
                            {
                                text: "",
                                text_1: If(
                                    IsBlank(locSharepointFilter),
                                    "",
                                    locSharepointFilter
                                )
                            }
                        ).value
                    ),
                    ClearCollect(
                        EnvironmentTeams,
                        SearchDeploymentEnvironmentTeams.Run(
                            Last(
                                FirstN(
                                    ClearCollect(
                                        splitCol2,
                                        ForAll(
                                            Split(
                                                SelectedDeploymentEnvironment.EnvironmentUrl,
                                                "."
                                            ),
                                            {Result: ThisRecord.Value}
                                        )
                                    ),
                                    2
                                )
                            ).Result,
                            LookUp(
                                AllEnvironments,
                                SelectedDeploymentEnvironment.EnvironmentUrl in properties.linkedEnvironmentMetadata.instanceUrl
                            ).properties.linkedEnvironmentMetadata.uniqueName,
                            {
                                text_3: "",
                                text_4: ""
                            }
                        )
                    ),
                    ClearCollect(
                        EnvironmentBusinessUnits,
                        SearchDeploymentEnvironmentBUnits.Run(
                            Last(
                                FirstN(
                                    ForAll(
                                        Split(
                                            SelectedDeploymentEnvironment.EnvironmentUrl,
                                            "."
                                        ),
                                        {Result: ThisRecord.Value}
                                    ),
                                    2
                                )
                            ).Result,
                            LookUp(
                                AllEnvironments,
                                SelectedDeploymentEnvironment.EnvironmentUrl in properties.linkedEnvironmentMetadata.instanceUrl
                            ).properties.linkedEnvironmentMetadata.uniqueName
                        )
                    )//,
                    //ClearCollect(
                    //    EnvironmentUsers,
                    //    SearchDeploymentEnvironmentUsers.Run(
                    //        Last(
                    //            FirstN(
                    //                ClearCollect(
                    //                    splitCol3,
                    //                    Split(
                    //                        SelectedDeploymentEnvironment.EnvironmentUrl,
                    //                        "."
                    //                   )
                    //                ),
                    //                2
                    //            )
                    //        ).Result,
                    //        LookUp(
                    //            AllEnvironments,
                    //            SelectedDeploymentEnvironment.EnvironmentUrl in properties.linkedEnvironmentMetadata.instanceUrl
                    //        ).properties.linkedEnvironmentMetadata.uniqueName,
                    //        {
                    //            text_3: "",
                    //            text_4: locEnvironmentUserFilters
                    //        }
                    //    )
                    //)
                );
                Collect(
                    AADGroups,
                    {
                        id: "",
                        displayName: ""
                    }
                );
                ClearCollect(
                    AADGroups,
                    Sort(
                        AADGroups,
                        displayName
                    )
                );
                ClearCollect(
                    TeamAADGroups,
                    AADGroups
                );
                Collect(
                    SharepointSites,
                    {webUrl: ""}
                );
                ClearCollect(
                    SharepointSites,
                    Sort(
                        SharepointSites,
                        webUrl
                    )
                );
            //Add an empty row to EnvironmentTeams
        Collect(
                    EnvironmentTeams,
                    {name: ""}
                );
                ClearCollect(
                    EnvironmentTeams,
                    Sort(
                        EnvironmentTeams,
                        name,
                        SortOrder.Ascending
                    )
                );
                //Collect(
                //    EnvironmentUsers,
                //    {internalemailaddress: ""}
                //);
                //ClearCollect(
                //    EnvironmentUsers,
                //    Sort(
                //        EnvironmentUsers,
                //        internalemailaddress,
                //        Ascending
                //    )
                //);
        If(
                    CountRows(DeploymentEnvironments) > 0,
                    Concurrent(
                        Collect(
                            SolutionConnectionReferences,
                            AddColumns(
                                GetSolutionConnectionReferences.Run(
                                    Last(
                                        FirstN(
                                            ClearCollect(
                                                splitCol1,
                                                ForAll(
                                                    Split(
                                                        SelectedEnvironment.properties.linkedEnvironmentMetadata.instanceUrl,
                                                        "."
                                                    ),
                                                    {Result: ThisRecord.Value}
                                                )
                                            ),
                                            2
                                        )
                                    ).Result,
                                    SelectedEnvironment.properties.linkedEnvironmentMetadata.uniqueName,
                                    SelectedSolutionToConfigure.solutionid
                                ),
                                "CurrentValue",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "connectionreference." & connectionreferencelogicalname
                                ).Value,
                                "UserId",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "connectionreference.user." & connectionreferencelogicalname
                                ).Value,
                                "Shared",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "connectionreference.shared." & connectionreferencelogicalname
                                ).Value,
                                "ManualEntry",
                                false
                            )
                        ),
                        Collect(
                            SolutionWebHookURLs,
                            AddColumns(
                                GetSolutionWebHookURLs.Run(
                                    Last(
                                        FirstN(
                                            ClearCollect(
                                                splitColUrls,
                                                ForAll(
                                                    Split(
                                                        SelectedEnvironment.properties.linkedEnvironmentMetadata.instanceUrl,
                                                        "."
                                                    ),
                                                    {Result: ThisRecord.Value}
                                                )
                                            ),
                                            2
                                        )
                                    ).Result,
                                    SelectedEnvironment.properties.linkedEnvironmentMetadata.uniqueName,
                                    SelectedSolutionToConfigure.solutionid
                                ),
                                "CurrentValue",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "webhookurl." & name
                                ).Value
                            )
                        ),
                        Collect(
                            SolutionSDKSteps,
                            AddColumns(
                                GetSolutionSDKSteps.Run(
                                    Last(
                                        FirstN(
                                            ClearCollect(
                                                splitColSteps,
                                                ForAll(
                                                    Split(
                                                        SelectedEnvironment.properties.linkedEnvironmentMetadata.instanceUrl,
                                                        "."
                                                    ),
                                                    {Result: ThisRecord.Value}
                                                )
                                            ),
                                            2
                                        )
                                    ).Result,
                                    SelectedEnvironment.properties.linkedEnvironmentMetadata.uniqueName,
                                    SelectedSolutionToConfigure.solutionid
                                ),
                                "UnsecureConfig",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "sdkstep.unsec." & ItemInternalId
                                ).Value,
                                "SecureConfig",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "sdkstep.sec." & ItemInternalId
                                ).Value
                            )
                        ),
                        Collect(
                            SolutionEnvironmentVariables,
                            AddColumns(
                                GetSolutionEnvironmentVariableDefinitions.Run(
                                    Last(
                                        FirstN(
                                            ClearCollect(
                                                splitCol2,
                                                ForAll(
                                                    Split(
                                                        SelectedEnvironment.properties.linkedEnvironmentMetadata.instanceUrl,
                                                        "."
                                                    ),
                                                    {Result: ThisRecord.Value}
                                                )
                                            ),
                                            2
                                        )
                                    ).Result,
                                    SelectedEnvironment.properties.linkedEnvironmentMetadata.uniqueName,
                                    SelectedSolutionToConfigure.solutionid
                                ),
                                "SharepointSites",
                                SharepointSites,
                                "FilterText",
                                "",
                                "FilterIcon",
                                Icon.FilterFlat,
                                "FilterVisible",
                                false,
                                "CurrentValue",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "environmentvariable." & schemaname
                                ).Value
                            )
                        ),
                        Collect(
                            AppSharingPermissions,
                            {
                                Text: "Can View",
                                Value: "CanView"
                            },
                            {
                                Text: "Can Edit",
                                Value: "CanEdit"
                            }//,
                            //{
                            //    Text: "Can View and Share",
                            //    Value: "CanViewWithShare"
                            //}
                        ),
                        Collect(
                            SolutionCanvasApps,
                            AddColumns(
                                GetSolutionCanvasApps.Run(
                                    Last(
                                        FirstN(
                                            ClearCollect(
                                                splitCol3,
                                                ForAll(
                                                    Split(
                                                        SelectedEnvironment.properties.linkedEnvironmentMetadata.instanceUrl,
                                                        "."
                                                    ),
                                                    {Result: ThisRecord.Value}
                                                )
                                            ),
                                            2
                                        )
                                    ).Result,
                                    SelectedEnvironment.properties.linkedEnvironmentMetadata.uniqueName,
                                    SelectedSolutionToConfigure.solutionid
                                ),
                                "AADGroups",
                                AADGroups,
                                "FilterText",
                                "",
                                "FilterIcon",
                                Icon.FilterFlat,
                                "FilterVisible",
                                false,
                                "CurrentValue",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "canvasshare.aadGroupId." & name
                                ).Value,
                                "CurrentPermission",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "canvasshare.roleName." & name
                                ).Value,
                                "IsCopy",
                                false,
                                "Suffix",
                                ""
                            )
                        ),
                        Collect(
                            SolutionFlows,
                            AddColumns(
                            //Filter to Modern Flows only for Now category = 5
                                Filter(
                                    GetSolutionFlows.Run(
                                        Last(
                                            FirstN(
                                                ClearCollect(
                                                    splitCol4,
                                                    ForAll(
                                                        Split(
                                                            SelectedEnvironment.properties.linkedEnvironmentMetadata.instanceUrl,
                                                            "."
                                                        ),
                                                        {Result: ThisRecord.Value}
                                                    )
                                                ),
                                                2
                                            )
                                        ).Result,
                                        SelectedEnvironment.properties.linkedEnvironmentMetadata.uniqueName,
                                        SelectedSolutionToConfigure.solutionid
                                    ),
                                    category = 5
                                ),
                                //"EnvironmentUsers",
                                //EnvironmentUsers,
                                "FilterText",
                                "",
                                "FilterIcon",
                                Icon.FilterFlat,
                                "FilterVisible",
                                false,
                                //"ActivationEnvironmentUsers",
                                //EnvironmentUsers,
                                "ActivationFilterText",
                                "",
                                "ActivationFilterIcon",
                                Icon.FilterFlat,
                                "ActivationFilterVisible",
                                false,
                                "ActivationCurrentValue",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = ""
                                ).Value,
                                "SharingCurrentValue",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "flow.sharing." & Substitute(
                                        name,
                                        " ",
                                        ""
                                    ) & "." & workflowid
                                ).Value,
                                "CurrentValue",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "owner.ownerEmail." & Substitute(
                                        name,
                                        " ",
                                        ""
                                    ) & "." & workflowid
                                ).Value,
                                "SortOrder",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "activateflow.order." & Substitute(
                                        name,
                                        " ",
                                        ""
                                    ) & "." & workflowid
                                ).Value,
                                "Activate",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "activateflow.activate." & Substitute(
                                        name,
                                        " ",
                                        ""
                                    ) & "." & workflowid
                                ).Value
                            )
                        ),
                        Collect(
                            CustomConnectors,
                            AddColumns(
                                GetSolutionCustomConnectors.Run(
                                    Last(
                                        FirstN(
                                            ClearCollect(
                                                splitCol5,
                                                ForAll(
                                                    Split(
                                                        SelectedEnvironment.properties.linkedEnvironmentMetadata.instanceUrl,
                                                        "."
                                                    ),
                                                    {Result: ThisRecord.Value}
                                                )
                                            ),
                                            2
                                        )
                                    ).Result,
                                    SelectedEnvironment.properties.linkedEnvironmentMetadata.uniqueName,
                                    SelectedSolutionToConfigure.solutionid
                                ),
                                "CurrentValue",
                                LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "connector.teamname." & Substitute(
                                        displayname,
                                        " ",
                                        ""
                                    ) & "." & connectorid
                                ).Value
                            )
                        ),
                        Collect(
                            SolutionSecurityRoles,
                            GetSolutionSecurityRoles.Run(
                                Last(
                                    FirstN(
                                        ClearCollect(
                                            splitCol6,
                                            ForAll(
                                                Split(
                                                    SelectedEnvironment.properties.linkedEnvironmentMetadata.instanceUrl,
                                                    "."
                                                ),
                                                {Result: ThisRecord.Value}
                                            )
                                        ),
                                        2
                                    )
                                ).Result,
                                SelectedEnvironment.properties.linkedEnvironmentMetadata.uniqueName
                            )
                        )
                    );
                );
                UpdateContext({showConnectionReferenceSettings: true});
                Select(fncLoadEnvironmentDeploymentSettings);
            ),
            UpdateContext({errorMessage: FirstError.Message});
            Notify("Error getting solution dependencies: " & errorMessage);
            
        )

    DeploymentSettingsDialog As groupContainer:
        BorderColor: =BorderColorValue
        BorderThickness: =BorderThicknessValue
        Fill: =BorderColorValue
        Height: =1080
        Visible: =showDeployDialog
        Width: =1920
        ZIndex: =1

        rctDeployDialog As rectangle:
            AccessibleLabel: ="Deployment Settings"
            BorderColor: =ColorFade(rctDeployDialog.Fill, -20%)
            DisabledFill: =rctDeployDialog.Fill
            Fill: =RGBA(255, 255, 255, 1)
            Height: =1080
            HoverFill: =ColorFade(rctDeployDialog.Fill, 20%)
            PressedFill: =ColorFade(rctDeployDialog.Fill, -20%)
            Width: =1920
            ZIndex: =1

        lblDeployFlowOwner As label:
            FontWeight: =FontWeight.Semibold
            Height: =37
            OnSelect: =
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Owner"
            Tooltip: ="Updates the owner of the flow in the target environment."
            Visible: =showOwnerSettings && !IsEmpty(glrFlows.AllItems)
            Width: =182
            X: =516
            Y: =249
            ZIndex: =2

        lblDeployFlowTeamSharing As label:
            FontWeight: =FontWeight.Semibold
            Height: =37
            OnSelect: =FontWeight.Semibold
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Team Sharing"
            Tooltip: ="Required if your Flow is called from a canvas app. To correctly share the Flow with a Dataverse group team."
            Visible: =showOwnerSettings && !IsEmpty(glrFlows.AllItems)
            Width: =350
            X: =1097
            Y: =249
            ZIndex: =3

        lblDeployCustomConnectors As label:
            FontWeight: =If(showConnectorSettings, FontWeight.Bold, FontWeight.Semibold)
            Height: =45
            OnSelect: =
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Custom Connectors"
            Width: =182
            X: =754
            Y: =208
            ZIndex: =4

        icoDeployCustomConnectors As icon.Add:
            AccessibleLabel: ="Ownership"
            BorderColor: =ColorFade(icoDeployCustomConnectors.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledFill: =ColorFade(icoDeployCustomConnectors.Fill, -80%)
            FocusedBorderThickness: =
            Height: =49
            HoverBorderColor: =ColorFade(icoDeployCustomConnectors.BorderColor, 20%)
            HoverColor: =ColorFade(icoDeployCustomConnectors.Color, 20%)
            HoverFill: =ColorFade(icoDeployCustomConnectors.Fill, 20%)
            Icon: =
            OnSelect: |
                =UpdateContext(
                    {
                        showConnectionReferenceSettings: false,
                        showEnvironmentVariablesSettings: false,
                        showOwnerSettings: false,
                        showSharingSettings: false,
                        showConnectorSettings: true,
                        showGroupTeamsSettings: false,
                        showWebHookURLs: false,
                        showPortalConfig: false,
                        showSDKMessage: false        
                    }
                );
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =5
            PaddingTop: =8
            PressedBorderColor: =ColorFade(icoDeployCustomConnectors.BorderColor, -20%)
            PressedColor: =ColorFade(icoDeployCustomConnectors.Color, -20%)
            PressedFill: =ColorFade(icoDeployCustomConnectors.Fill, -20%)
            Tooltip: ="Set Sharing Configuration for the Target Environment"
            Width: =182
            X: =754
            Y: =204
            ZIndex: =5

        lblDeployGroupTeams As label:
            FontWeight: =If(showGroupTeamsSettings, FontWeight.Bold, FontWeight.Semibold)
            Height: =45
            OnSelect: =
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Group Teams"
            Width: =125
            X: =565
            Y: =208
            ZIndex: =6

        icoDeployGroupTeams As icon.Add:
            AccessibleLabel: ="Ownership"
            BorderColor: =ColorFade(icoDeployGroupTeams.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledFill: =ColorFade(icoDeployGroupTeams.Fill, -80%)
            FocusedBorderThickness: =
            Height: =49
            HoverBorderColor: =ColorFade(icoDeployGroupTeams.BorderColor, 20%)
            HoverColor: =ColorFade(icoDeployGroupTeams.Color, 20%)
            HoverFill: =ColorFade(icoDeployGroupTeams.Fill, 20%)
            Icon: =
            OnSelect: |
                =UpdateContext(
                    {
                        showConnectionReferenceSettings: false,
                        showEnvironmentVariablesSettings: false,
                        showOwnerSettings: false,
                        showSharingSettings: false,
                        showConnectorSettings: false,
                        showGroupTeamsSettings: true,
                        showWebHookURLs: false,
                        showPortalConfig: false,
                        showSDKMessage: false        
                    }
                );
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =5
            PaddingTop: =8
            PressedBorderColor: =ColorFade(icoDeployGroupTeams.BorderColor, -20%)
            PressedColor: =ColorFade(icoDeployGroupTeams.Color, -20%)
            PressedFill: =ColorFade(icoDeployGroupTeams.Fill, -20%)
            Tooltip: ="Set Group Teams and Roles for the Target Environment"
            Width: =125
            X: =565
            Y: =204
            ZIndex: =7

        lblDeployAppSharing As label:
            FontWeight: =If(showSharingSettings, FontWeight.Bold, FontWeight.Semibold)
            Height: =45
            OnSelect: =
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Canvas Apps"
            Width: =120
            X: =443
            Y: =208
            ZIndex: =8

        lblDeployFlowOwnership As label:
            FontWeight: =If(showOwnerSettings, FontWeight.Bold, FontWeight.Semibold)
            Height: =45
            OnSelect: =
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Flows"
            Width: =60
            X: =693
            Y: =208
            ZIndex: =9

        icoDeployOwnership As icon.Add:
            AccessibleLabel: ="Ownership"
            BorderColor: =ColorFade(icoDeployOwnership.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledFill: =ColorFade(icoDeployOwnership.Fill, -80%)
            FocusedBorderThickness: =
            Height: =49
            HoverBorderColor: =ColorFade(icoDeployOwnership.BorderColor, 20%)
            HoverColor: =ColorFade(icoDeployOwnership.Color, 20%)
            HoverFill: =ColorFade(icoDeployOwnership.Fill, 20%)
            Icon: =
            OnSelect: |
                =UpdateContext(
                    {
                        showConnectionReferenceSettings: false,
                        showEnvironmentVariablesSettings: false,
                        showOwnerSettings: true,
                        showSharingSettings: false,
                        showConnectorSettings: false,
                        showGroupTeamsSettings: false,
                        showWebHookURLs: false,
                        showPortalConfig: false,
                        showSDKMessage: false        
                    }
                );
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =5
            PaddingTop: =8
            PressedBorderColor: =ColorFade(icoDeployOwnership.BorderColor, -20%)
            PressedColor: =ColorFade(icoDeployOwnership.Color, -20%)
            PressedFill: =ColorFade(icoDeployOwnership.Fill, -20%)
            Tooltip: ="Set Sharing Configuration for the Target Environment"
            Width: =60
            X: =693
            Y: =204
            ZIndex: =10

        lblDeployEnvironmentVariables As label:
            FontWeight: =If(showEnvironmentVariablesSettings, FontWeight.Bold, FontWeight.Semibold)
            Height: =45
            OnSelect: =
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Environment Variables"
            Width: =210
            X: =238
            Y: =208
            ZIndex: =11

        lblDeployDialogTitle As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =PrimaryColor2Value
            FontWeight: =FontWeight.Semibold
            Height: =64
            Size: =16
            Text: ="CONFIGURE DEPLOYMENT SETTINGS (" & SelectedSolutionToConfigure.friendlyname & ")"
            Width: =1920
            ZIndex: =12

        icoDeployDialogClose As icon.Cancel:
            AccessibleLabel: ="Close"
            BorderColor: =ColorFade(icoDeployDialogClose.Fill, -20%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledFill: =ColorFade(icoDeployDialogClose.Fill, -80%)
            Height: =55
            HoverBorderColor: =ColorFade(icoDeployDialogClose.BorderColor, 20%)
            HoverColor: =ColorFade(icoDeployDialogClose.Color, 20%)
            HoverFill: =ColorFade(icoDeployDialogClose.Fill, 20%)
            Icon: =Icon.Cancel
            OnSelect: |-
                =Navigate(
                    ReturnScreen,
                    ScreenTransition.Fade
                )
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(icoDeployDialogClose.BorderColor, -20%)
            PressedColor: =ColorFade(icoDeployDialogClose.Color, -20%)
            PressedFill: =ColorFade(icoDeployDialogClose.Fill, -20%)
            Visible: =!IsBlankOrError(ReturnScreen)
            Width: =55
            X: =1851
            Y: =4
            ZIndex: =13

        lblDeployEnvironment As label:
            FontWeight: =FontWeight.Semibold
            Height: =53
            PaddingLeft: =0
            PaddingTop: =0
            Text: =locDeploymentEnvironmentLabel
            Width: =1823
            X: =28
            Y: =84
            ZIndex: =14

        drpDeployEnvironments As dropdown:
            AccessibleLabel: ="Deployment Environments"
            ChevronHoverBackground: =ColorFade(drpDeployEnvironments.ChevronBackground, 20%)
            ChevronHoverFill: =ColorFade(drpDeployEnvironments.ChevronFill, 20%)
            Default: |
                =SelectedDeploymentEnvironment.Name
            Height: =46
            HoverBorderColor: =ColorFade(drpDeployEnvironments.BorderColor, 20%)
            HoverColor: =ColorFade(drpDeployEnvironments.Color, 20%)
            HoverFill: =ColorFade(drpDeployEnvironments.SelectionFill, 20%)
            Items: =Sort(DeploymentEnvironments, 'Step Number')
            OnChange: |-
                =UpdateContext({locCloseAfterSave: false, locShareConnections: true});
                Select(btnSaveDeployment);
            OnSelect: =
            PressedBorderColor: =drpDeployEnvironments.HoverBorderColor
            PressedColor: =drpDeployEnvironments.Fill
            PressedFill: =drpDeployEnvironments.Color
            Tooltip: ="Select an Environment to Configure Deployment Settings"
            Visible: =!showNewDeployEnvironment
            Width: =1620
            X: =28
            Y: =137
            ZIndex: =15

        icoAddDeploymentEnvironment As icon.Add:
            AccessibleLabel: ="Create Environment"
            BorderColor: =ColorFade(icoAddDeploymentEnvironment.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledFill: =ColorFade(icoAddDeploymentEnvironment.Fill, -80%)
            FocusedBorderThickness: =
            Height: =47
            HoverBorderColor: =ColorFade(icoAddDeploymentEnvironment.BorderColor, 20%)
            HoverColor: =ColorFade(icoAddDeploymentEnvironment.Color, 20%)
            HoverFill: =ColorFade(icoAddDeploymentEnvironment.Fill, 20%)
            Icon: =Icon.Add
            OnSelect: |-
                =UpdateContext({showNewDeployEnvironment: true})
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =5
            PaddingTop: =8
            PressedBorderColor: =ColorFade(icoAddDeploymentEnvironment.BorderColor, -20%)
            PressedColor: =ColorFade(icoAddDeploymentEnvironment.Color, -20%)
            PressedFill: =ColorFade(icoAddDeploymentEnvironment.Fill, -20%)
            Tooltip: ="Cancel Adding New Deployment Environment"
            Visible: =false
            Width: =57
            X: =1168
            Y: =138
            ZIndex: =16

        txtNewDeployEnvironment As text:
            AccessibleLabel: ="Create Environment"
            Default: =""
            Height: =45
            HintText: ="Enter a Name for the Environment"
            HoverBorderColor: =ColorFade(txtNewDeployEnvironment.BorderColor, 20%)
            HoverColor: =ColorFade(txtNewDeployEnvironment.Color, 20%)
            HoverFill: =ColorFade(txtNewDeployEnvironment.Fill, 20%)
            PressedBorderColor: =txtNewDeployEnvironment.HoverBorderColor
            PressedColor: =txtNewDeployEnvironment.Color
            PressedFill: =txtNewDeployEnvironment.Fill
            Tooltip: ="Enter a Name for the Environment"
            Visible: =showNewDeployEnvironment
            Width: =1140
            X: =28
            Y: =138
            ZIndex: =17

        icoDeployNewEnvironmentClose As icon.Cancel:
            AccessibleLabel: ="Close"
            BorderColor: =ColorFade(icoDeployNewEnvironmentClose.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledFill: =ColorFade(icoDeployNewEnvironmentClose.Fill, -80%)
            Height: =47
            HoverBorderColor: =ColorFade(icoDeployNewEnvironmentClose.BorderColor, 20%)
            HoverColor: =ColorFade(icoAddDeploymentEnvironment.Color, 20%)
            HoverFill: =ColorFade(icoDeployNewEnvironmentClose.Fill, 20%)
            Icon: =Icon.Cancel
            OnSelect: |-
                =UpdateContext({showNewDeployEnvironment: false})
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(icoDeployNewEnvironmentClose.BorderColor, -20%)
            PressedColor: =ColorFade(icoDeployNewEnvironmentClose.Color, -20%)
            PressedFill: =ColorFade(icoDeployNewEnvironmentClose.Fill, -20%)
            Visible: =showNewDeployEnvironment
            Width: =57
            X: =1168
            Y: =137
            ZIndex: =18

        "glrCustomConnectors As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            AccessibleLabel: ="Flows"
            Height: =653
            Items: =CustomConnectors
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =68
            Visible: =showConnectorSettings
            Width: =1850
            X: =24
            Y: =274
            ZIndex: =19

            icoFlow_1 As image:
                AccessibleLabel: ="Flow"
                BorderColor: =ColorFade(icoFlow_1.Fill, -20%)
                Height: =58
                HoverBorderColor: =ColorFade(icoFlow_1.BorderColor, 20%)
                HoverFill: =ColorFade(icoFlow_1.Fill, 20%)
                Image: |-
                    ="data:image/jpeg;base64," & ThisItem.iconblob
                OnSelect: =Select(Parent);
                PressedBorderColor: =ColorFade(icoFlow_1.BorderColor, -20%)
                PressedFill: =ColorFade(icoFlow_1.Fill, -20%)
                Tooltip: ="Select to Open App"
                Width: =58
                Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                ZIndex: =1

            lblConnectorName As label:
                Height: =24
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =14
                Text: =ThisItem.displayname
                VerticalAlign: =VerticalAlign.Top
                Width: =600
                X: =58
                Y: =10
                ZIndex: =2

            lblConnectorId As label:
                Height: =Self.Size * 1.8
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =12
                Text: =ThisItem.name
                VerticalAlign: =VerticalAlign.Top
                Width: =900
                X: =58
                Y: =35
                ZIndex: =3

            Separator3_4 As rectangle:
                BorderColor: =ColorFade(Separator3_4.Fill, -20%)
                DisabledFill: =Separator3_4.Fill
                Height: =1
                HoverFill: =ColorFade(Separator3_4.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedFill: =ColorFade(Separator3_4.Fill, -20%)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =5

            icoOpenConnector As icon.Add:
                AccessibleLabel: ="Open Flow"
                BorderColor: =ColorFade(icoOpenConnector.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoOpenConnector.Fill, -80%)
                FocusedBorderThickness: =
                Height: =45
                HoverBorderColor: =ColorFade(icoOpenConnector.BorderColor, 20%)
                HoverColor: =ColorFade(icoOpenConnector.Color, 20%)
                HoverFill: =ColorFade(icoOpenConnector.Fill, 20%)
                Icon: =
                OnSelect: |-
                    =Select(Parent);
                    Launch("https://us.flow.microsoft.com/manage/environments/" & SelectedEnvironment.properties.linkedEnvironmentMetadata.uniqueName & "/solutions/" & glrSolutions.Selected.solutionid & "/flows/" & ThisItem.connectorid,
                        "",
                        "_blank"
                    )
                PaddingBottom: =8
                PaddingLeft: =8
                PaddingRight: =5
                PaddingTop: =8
                PressedBorderColor: =ColorFade(icoOpenConnector.BorderColor, -20%)
                PressedColor: =ColorFade(icoOpenConnector.Color, -20%)
                PressedFill: =ColorFade(icoOpenConnector.Fill, -20%)
                Tooltip: ="Select to Open App"
                Width: =600
                Y: =10
                ZIndex: =9

            drpConnectorShareGroupTeams As dropdown:
                AccessibleLabel: ="App Sharing Group"
                ChevronHoverBackground: =ColorFade(drpConnectorShareGroupTeams.ChevronBackground, 20%)
                ChevronHoverFill: =ColorFade(drpConnectorShareGroupTeams.ChevronFill, 20%)
                Default: =If(IsBlank(ThisItem.CurrentValue), First(EnvironmentTeams).name, ThisItem.CurrentValue)
                Height: =46
                HoverBorderColor: =ColorFade(drpConnectorShareGroupTeams.BorderColor, 20%)
                HoverColor: =ColorFade(drpConnectorShareGroupTeams.Color, 20%)
                HoverFill: =ColorFade(drpConnectorShareGroupTeams.SelectionFill, 20%)
                Items: =EnvironmentTeams
                PressedBorderColor: =drpConnectorShareGroupTeams.HoverBorderColor
                PressedColor: =drpConnectorShareGroupTeams.Fill
                PressedFill: =drpConnectorShareGroupTeams.Color
                Reset: =resetEnvironment
                Tooltip: ="Select an Existing AAD Group"
                Width: =850
                X: =979
                Y: =11
                ZIndex: =13

        "glrFlows As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            AccessibleLabel: ="Flows"
            DisplayMode: =If(sortFlowEnabled, DisplayMode.Edit, DisplayMode.Disabled)
            Height: =653
            Items: =Sort(SolutionFlows, Value(SortOrder))
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =71
            Visible: =showOwnerSettings
            Width: =1850
            X: =24
            Y: =274
            ZIndex: =20

            icoFlow As image:
                AccessibleLabel: ="Flow"
                BorderColor: =ColorFade(icoFlow.Fill, -20%)
                Height: =58
                HoverBorderColor: =ColorFade(icoFlow.BorderColor, 20%)
                HoverFill: =ColorFade(icoFlow.Fill, 20%)
                Image: =PowerAutomate_scalable
                OnSelect: =Select(Parent);
                PressedBorderColor: =ColorFade(icoFlow.BorderColor, -20%)
                PressedFill: =ColorFade(icoFlow.Fill, -20%)
                Tooltip: ="Select to Open App"
                Width: =58
                Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                ZIndex: =1

            lblFlowName As label:
                Height: =24
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =14
                Text: =ThisItem.name
                VerticalAlign: =VerticalAlign.Top
                Width: =300
                X: =58
                Y: =10
                ZIndex: =2

            lblFlowId As label:
                Height: =Self.Size * 1.8
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =12
                Text: =ThisItem._statuscode_label
                VerticalAlign: =VerticalAlign.Top
                Width: =300
                X: =58
                Y: =35
                ZIndex: =3

            Separator3_3 As rectangle:
                BorderColor: =ColorFade(Separator3_3.Fill, -20%)
                DisabledFill: =Separator3_3.Fill
                Height: =1
                HoverFill: =ColorFade(Separator3_3.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedFill: =ColorFade(Separator3_3.Fill, -20%)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =4

            icoOpenFlow As icon.Add:
                AccessibleLabel: ="Open Flow"
                BorderColor: =ColorFade(icoOpenFlow.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoOpenFlow.Fill, -80%)
                FocusedBorderThickness: =
                Height: =45
                HoverBorderColor: =ColorFade(icoOpenFlow.BorderColor, 20%)
                HoverColor: =ColorFade(icoOpenFlow.Color, 20%)
                HoverFill: =ColorFade(icoOpenFlow.Fill, 20%)
                Icon: =
                OnSelect: |-
                    =Select(Parent);
                    Launch("https://us.flow.microsoft.com/manage/environments/" & SelectedEnvironment.properties.linkedEnvironmentMetadata.uniqueName & "/solutions/" & glrSolutions.Selected.solutionid & "/flows/" & ThisItem.workflowidunique,
                        "",
                        "_blank"
                    )
                PaddingBottom: =8
                PaddingLeft: =8
                PaddingRight: =5
                PaddingTop: =8
                PressedBorderColor: =ColorFade(icoOpenFlow.BorderColor, -20%)
                PressedColor: =ColorFade(icoOpenFlow.Color, -20%)
                PressedFill: =ColorFade(icoOpenFlow.Fill, -20%)
                Tooltip: ="Select to Open " & ThisItem.name
                Width: =350
                Y: =10
                ZIndex: =5

            drpFlowShareGroupTeams As dropdown:
                AccessibleLabel: ="App Sharing Group"
                ChevronHoverBackground: =ColorFade(drpFlowShareGroupTeams.ChevronBackground, 20%)
                ChevronHoverFill: =ColorFade(drpFlowShareGroupTeams.ChevronFill, 20%)
                Default: =If(IsBlank(ThisItem.SharingCurrentValue), First(EnvironmentTeams).name, ThisItem.SharingCurrentValue)
                Height: =46
                HoverBorderColor: =ColorFade(drpFlowShareGroupTeams.BorderColor, 20%)
                HoverColor: =ColorFade(drpFlowShareGroupTeams.Color, 20%)
                HoverFill: =ColorFade(drpFlowShareGroupTeams.SelectionFill, 20%)
                Items: =EnvironmentTeams
                PressedBorderColor: =drpFlowShareGroupTeams.HoverBorderColor
                PressedColor: =drpFlowShareGroupTeams.Fill
                PressedFill: =drpFlowShareGroupTeams.Color
                Reset: =resetEnvironment
                Tooltip: ="Select an Existing AAD Group"
                Width: =500
                X: =1072
                Y: =11
                ZIndex: =9

            icoSortFlowsUp As icon.FilterFlat:
                BorderColor: =ColorFade(icoSortFlowsUp.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoSortFlowsUp.Fill, -80%)
                DisplayMode: =If(sortFlowEnabled && Value(ThisItem.SortOrder) > 1, DisplayMode.Edit, DisplayMode.Disabled)
                Height: =35
                HoverBorderColor: =ColorFade(icoSortFlowsUp.BorderColor, 20%)
                HoverColor: =ColorFade(icoSortFlowsUp.Color, 20%)
                HoverFill: =ColorFade(icoSortFlowsUp.Fill, 20%)
                Icon: =Icon.ArrowUp
                OnSelect: |
                    =UpdateContext({sortFlowEnabled: false});
                    If(
                        Value(ThisItem.SortOrder) > 1,
                        UpdateContext({newSortOrder: Text(Value(ThisItem.SortOrder) - 1)});
                        UpdateContext(
                            {
                                adjacentFlow: LookUp(
                                    SolutionFlows,
                                    SortOrder = newSortOrder
                                ),
                                adjacentRow: LookUp(
                                    glrFlows.AllItems,
                                    SortOrder = newSortOrder
                                )
                            }
                        );
                        UpdateContext(
                            {
                                adjacentRowActivate: Text(adjacentRow.chkActivateFlow.Value),
                                adjacentRowCurrentValue: adjacentRow.txtFlowOwnerUsers.Text,
                                adjacentRowActivationCurrentValue: adjacentRow.txtFlowActivationUsers.Text,
                                adjacentRowSharingCurrentValue: adjacentRow.drpFlowShareGroupTeams.Selected.name,
                    
                                adjacentRowSortOrder: ThisItem.SortOrder,
                    
                                newActivate: Text(glrFlows.Selected.chkActivateFlow.Value),
                                newCurrentValue: glrFlows.Selected.txtFlowOwnerUsers.Text,
                                newActivationCurrentValue: glrFlows.Selected.txtFlowActivationUsers.Text,
                                newSharingCurrentValue: glrFlows.Selected.drpFlowShareGroupTeams.Selected.name
                            }
                        );
                        Patch(
                            SolutionFlows,
                            ThisItem,
                            {
                                Activate: newActivate,
                                CurrentValue: newCurrentValue,
                                ActivationCurrentValue: newActivationCurrentValue,
                                SharingCurrentValue: newSharingCurrentValue,
                                SortOrder: newSortOrder
                            }
                        );    
                        Patch(
                            SolutionFlows,
                            adjacentFlow,
                            {
                                Activate: adjacentRowActivate,
                                CurrentValue: adjacentRowCurrentValue,
                                ActivationCurrentValue: adjacentRowActivationCurrentValue,
                                SharingCurrentValue: adjacentRowSharingCurrentValue,
                                SortOrder: adjacentRowSortOrder
                            }
                        );
                    );
                    UpdateContext({sortFlowEnabled: true});
                PressedBorderColor: =ColorFade(icoSortFlowsUp.BorderColor, -20%)
                PressedColor: =ColorFade(icoSortFlowsUp.Color, -20%)
                PressedFill: =ColorFade(icoSortFlowsUp.Fill, -20%)
                Tooltip: ="Move up " & ThisItem.name
                Width: =35
                X: =1706
                Y: =15
                ZIndex: =10

            icoSortFlowsDown As icon.FilterFlat:
                BorderColor: =ColorFade(icoSortFlowsDown.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoSortFlowsDown.Fill, -80%)
                DisplayMode: =If(sortFlowEnabled && Value(ThisItem.SortOrder) < CountRows(SolutionFlows), DisplayMode.Edit, DisplayMode.Disabled)
                Height: =35
                HoverBorderColor: =ColorFade(icoSortFlowsDown.BorderColor, 20%)
                HoverColor: =ColorFade(icoSortFlowsDown.Color, 20%)
                HoverFill: =ColorFade(icoSortFlowsDown.Fill, 20%)
                OnSelect: |
                    =UpdateContext({sortFlowEnabled: false});
                    If(
                        Value(ThisItem.SortOrder) < CountRows(SolutionFlows),
                        UpdateContext({newSortOrder: Text(Value(ThisItem.SortOrder) + 1)});
                        UpdateContext(
                            {
                                adjacentFlow: LookUp(
                                    SolutionFlows,
                                    SortOrder = newSortOrder
                                ),
                                adjacentRow: LookUp(
                                    glrFlows.AllItems,
                                    SortOrder = newSortOrder
                                )
                            }
                        );
                        UpdateContext(
                            {
                                adjacentRowActivate: Text(adjacentRow.chkActivateFlow.Value),
                                adjacentRowCurrentValue: adjacentRow.txtFlowOwnerUsers.Text,
                                adjacentRowActivationCurrentValue: adjacentRow.txtFlowActivationUsers.Text,
                                adjacentRowSharingCurrentValue: adjacentRow.drpFlowShareGroupTeams.Selected.name,
                                adjacentRowSortOrder: ThisItem.SortOrder,
                                newActivate: Text(glrFlows.Selected.chkActivateFlow.Value),
                                newCurrentValue: glrFlows.Selected.txtFlowOwnerUsers.Text,
                                newActivationCurrentValue: glrFlows.Selected.txtFlowActivationUsers.Text,
                                newSharingCurrentValue: glrFlows.Selected.drpFlowShareGroupTeams.Selected.name
                            }
                        );
                        Patch(
                            SolutionFlows,
                            ThisItem,
                            {
                                Activate: newActivate,
                                CurrentValue: newCurrentValue,
                                ActivationCurrentValue: newActivationCurrentValue,
                                SharingCurrentValue: newSharingCurrentValue,
                                SortOrder: newSortOrder
                            }
                        );
                        Patch(
                            SolutionFlows,
                            adjacentFlow,
                            {
                                SortOrder: adjacentRowSortOrder,
                                Activate: adjacentRowActivate,
                                CurrentValue: adjacentRowCurrentValue,
                                ActivationCurrentValue: adjacentRowActivationCurrentValue,
                                SharingCurrentValue: adjacentRowSharingCurrentValue
                            }
                        );
                        
                    );
                    UpdateContext({sortFlowEnabled: true});
                PressedBorderColor: =ColorFade(icoSortFlowsDown.BorderColor, -20%)
                PressedColor: =ColorFade(icoSortFlowsDown.Color, -20%)
                PressedFill: =ColorFade(icoSortFlowsDown.Fill, -20%)
                Tooltip: ="Move down " & ThisItem.name
                Width: =35
                X: =1747
                Y: =16
                ZIndex: =11

            chkActivateFlow As checkbox:
                Default: =If(IsBlankOrError(ThisItem.Activate) Or ThisItem.Activate = "" Or ThisItem.Activate = "true", true, false)
                HoverBorderColor: =ColorFade(chkActivateFlow.BorderColor, 20%)
                HoverColor: =ColorFade(chkActivateFlow.Color, 20%)
                HoverFill: =ColorFade(chkActivateFlow.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedBorderColor: =ColorFade(chkActivateFlow.BorderColor, -20%)
                PressedColor: =ColorFade(chkActivateFlow.Color, -20%)
                PressedFill: =ColorFade(chkActivateFlow.Fill, -20%)
                Text: =""
                Tooltip: ="Activate " & ThisItem.name
                Width: =50
                X: =1650
                Y: =6
                ZIndex: =14

            txtFlowOwnerUsers As text:
                Default: |-
                    =If(
                        IsBlank(ThisItem.CurrentValue),
                        First(EnvironmentUsers).internalemailaddress,
                        ThisItem.CurrentValue
                    )
                Height: =46
                HintText: ="Enter a User (user@org.domain.com)"
                HoverBorderColor: =ColorFade(txtFlowOwnerUsers.BorderColor, 20%)
                HoverColor: =ColorFade(txtFlowOwnerUsers.Color, 20%)
                HoverFill: =ColorFade(txtFlowOwnerUsers.Fill, 20%)
                OnChange: =
                OnSelect: =Select(Parent)
                PressedBorderColor: =txtFlowOwnerUsers.HoverBorderColor
                PressedColor: =txtFlowOwnerUsers.Color
                PressedFill: =txtFlowOwnerUsers.Fill
                Tooltip: ="The email address of the owner of this Flow"
                Width: =500
                X: =491
                Y: =11
                ZIndex: =16

            txtFlowActivationUsers As text:
                Default: |-
                    =If(
                        IsBlank(ThisItem.ActivationCurrentValue) || !chkActivateFlow.Value,
                        First(EnvironmentUsers).internalemailaddress,
                        ThisItem.ActivationCurrentValue
                    )
                Height: =53
                HintText: ="Enter a User (user@org.domain.com)"
                HoverBorderColor: =ColorFade(txtFlowActivationUsers.BorderColor, 20%)
                HoverColor: =ColorFade(txtFlowActivationUsers.Color, 20%)
                HoverFill: =ColorFade(txtFlowActivationUsers.Fill, 20%)
                OnChange: =
                OnSelect: =Select(Parent)
                PressedBorderColor: =txtFlowActivationUsers.HoverBorderColor
                PressedColor: =txtFlowActivationUsers.Color
                PressedFill: =txtFlowActivationUsers.Fill
                Tooltip: ="The email address of the user to activate this Flow"
                Visible: =false
                Width: =56
                X: =1658
                Y: =11
                ZIndex: =17

            icoCopyOwnerDown As icon.FilterFlat:
                BorderColor: =ColorFade(icoCopyOwnerDown.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoCopyOwnerDown.Fill, -80%)
                Height: =35
                HoverBorderColor: =ColorFade(icoCopyOwnerDown.BorderColor, 20%)
                HoverColor: =ColorFade(icoCopyOwnerDown.Color, 20%)
                HoverFill: =ColorFade(icoCopyOwnerDown.Fill, 20%)
                Icon: =Icon.Copy
                OnSelect: |
                    =UpdateContext({ownerEmail: glrFlows.Selected.txtFlowOwnerUsers.Text});
                    UpdateIf(SolutionFlows, true, {CurrentValue: ownerEmail});
                PressedBorderColor: =ColorFade(icoCopyOwnerDown.BorderColor, -20%)
                PressedColor: =ColorFade(icoCopyOwnerDown.Color, -20%)
                PressedFill: =ColorFade(icoCopyOwnerDown.Fill, -20%)
                Tooltip: ="Copy Owner to all Flows"
                Width: =35
                X: =996
                Y: =16
                ZIndex: =18

            icoCopyActivationDown As icon.FilterFlat:
                BorderColor: =ColorFade(icoCopyActivationDown.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoCopyActivationDown.Fill, -80%)
                Height: =35
                HoverBorderColor: =ColorFade(icoCopyActivationDown.BorderColor, 20%)
                HoverColor: =ColorFade(icoCopyActivationDown.Color, 20%)
                HoverFill: =ColorFade(icoCopyActivationDown.Fill, 20%)
                Icon: =Icon.Copy
                OnSelect: |
                    =UpdateContext({activationUser: glrFlows.Selected.txtFlowActivationUsers.Text});
                    ForAll(
                        glrFlows.AllItems,
                        Patch(
                            SolutionFlows,
                            ThisRecord,
                            {ActivationCurrentValue: activationUser}
                        )
                    );
                PressedBorderColor: =ColorFade(icoCopyActivationDown.BorderColor, -20%)
                PressedColor: =ColorFade(icoCopyActivationDown.Color, -20%)
                PressedFill: =ColorFade(icoCopyActivationDown.Fill, -20%)
                Tooltip: ="Copy Activation User to all Flows"
                Visible: =false
                Width: =35
                X: =1722
                Y: =16
                ZIndex: =19

            icoCopySharingDown As icon.FilterFlat:
                BorderColor: =ColorFade(icoCopySharingDown.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoCopySharingDown.Fill, -80%)
                Height: =35
                HoverBorderColor: =ColorFade(icoCopySharingDown.BorderColor, 20%)
                HoverColor: =ColorFade(icoCopySharingDown.Color, 20%)
                HoverFill: =ColorFade(icoCopySharingDown.Fill, 20%)
                Icon: =Icon.Copy
                OnSelect: |
                    =UpdateContext({teamShare: glrFlows.Selected.drpFlowShareGroupTeams.Selected.name});
                    UpdateIf(SolutionFlows, true, {SharingCurrentValue: teamShare});
                PressedBorderColor: =ColorFade(icoCopySharingDown.BorderColor, -20%)
                PressedColor: =ColorFade(icoCopySharingDown.Color, -20%)
                PressedFill: =ColorFade(icoCopySharingDown.Fill, -20%)
                Tooltip: ="Copy Owner to all Flows"
                Width: =35
                X: =1580
                Y: =16
                ZIndex: =20

        "glrEnvironmentVariables As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            AccessibleLabel: ="Environment Variables"
            Height: =674
            Items: =SolutionEnvironmentVariables
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =68
            Visible: =showEnvironmentVariablesSettings
            Width: =1850
            X: =24
            Y: =253
            ZIndex: =21

            lblEnvironmentVariableLogicalName As label:
                FocusedBorderThickness: =FocusedBorderThicknessValue
                Height: =24
                OnSelect: =ThisItem.schemaname
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =14
                Text: =ThisItem.displayname
                Tooltip: =ThisItem.displayname
                VerticalAlign: =VerticalAlign.Top
                Width: =880
                X: =58
                Y: =10
                ZIndex: =2

            lblEnvironmentVariableType As label:
                Height: =Self.Size * 1.8
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =12
                Text: =ThisItem._type_label
                VerticalAlign: =VerticalAlign.Top
                Width: =600
                X: =58
                Y: =35
                ZIndex: =3

            Separator3_1 As rectangle:
                BorderColor: =ColorFade(Separator3_1.Fill, -20%)
                DisabledFill: =Separator3_1.Fill
                Height: =1
                HoverFill: =ColorFade(Separator3_1.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedFill: =ColorFade(Separator3_1.Fill, -20%)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =5

            icoEnvironmentVariable As image:
                BorderColor: =ColorFade(icoEnvironmentVariable.Fill, -20%)
                Height: =58
                HoverBorderColor: =ColorFade(icoEnvironmentVariable.BorderColor, 20%)
                HoverFill: =ColorFade(icoEnvironmentVariable.Fill, 20%)
                Image: =If(ThisItem.type = 100000004, sharepointicon, download)
                OnSelect: =Select(Parent)
                PressedBorderColor: =ColorFade(icoEnvironmentVariable.BorderColor, -20%)
                PressedFill: =ColorFade(icoEnvironmentVariable.Fill, -20%)
                Width: =58
                Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                ZIndex: =6

            txtWebHoosURL As text:
                AccessibleLabel: ="Environment Variable Value"
                Default: =ThisItem.CurrentValue
                HintText: ="Enter an Environment Variable Value"
                HoverBorderColor: =ColorFade(txtWebHoosURL.BorderColor, 20%)
                HoverColor: =ColorFade(txtWebHoosURL.Color, 20%)
                HoverFill: =ColorFade(txtWebHoosURL.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedBorderColor: =txtWebHoosURL.HoverBorderColor
                PressedColor: =txtWebHoosURL.Color
                PressedFill: =txtWebHoosURL.Fill
                Reset: =resetEnvironment
                Tooltip: ="Enter a Value for this Environment Variable in the Target Environment"
                Visible: =ThisItem.type <> 100000004
                Width: =880
                X: =943
                Y: =14
                ZIndex: =8

            drpSharepointSites As dropdown:
                AccessibleLabel: ="Sharepoint Sites"
                ChevronHoverBackground: =ColorFade(drpSharepointSites.ChevronBackground, 20%)
                ChevronHoverFill: =ColorFade(drpSharepointSites.ChevronFill, 20%)
                Default: =If(IsBlank(ThisItem.CurrentValue), First(SharepointSites).webUrl, ThisItem.CurrentValue)
                Height: =44
                HoverBorderColor: =ColorFade(drpSharepointSites.BorderColor, 20%)
                HoverColor: =ColorFade(drpSharepointSites.Color, 20%)
                HoverFill: =ColorFade(drpSharepointSites.SelectionFill, 20%)
                Items: =ThisItem.SharepointSites
                OnChange: |-
                    =ClearCollect(
                        SharepointLists,
                        Filter(
                            SharepointLists,
                            DefinitionId <> ThisItem.environmentvariabledefinitionid
                        )
                    );
                    If(
                        Not IsBlank(drpSharepointSites.Selected.id),
                        Collect(
                            SharepointLists,
                            AddColumns(
                                SearchSharepointLists.Run(drpSharepointSites.Selected.id).value,
                                "DefinitionId",
                                ThisItem.environmentvariabledefinitionid
                            )
                        )
                    );
                    txtWebHoosURL.Text = drpSharepointSites.Selected.webUrl
                PressedBorderColor: =drpSharepointSites.HoverBorderColor
                PressedColor: =drpSharepointSites.Fill
                PressedFill: =drpSharepointSites.Color
                Reset: =resetEnvironment
                Tooltip: ="Select a Sharepoint Site"
                Visible: =ThisItem.type = 100000004 && ThisItem.parameterkey = "dataset" && ThisItem.apiid = "/providers/microsoft.powerapps/apis/shared_sharepointonline"
                Width: =840
                X: =943
                Y: =12
                ZIndex: =9

            drpSharepointLists As dropdown:
                AccessibleLabel: ="Sharepoint Lists"
                ChevronHoverBackground: =ColorFade(drpSharepointLists.ChevronBackground, 20%)
                ChevronHoverFill: =ColorFade(drpSharepointLists.ChevronFill, 20%)
                Default: =If(IsBlank(ThisItem.CurrentValue), First(SharepointLists).name, LookUp(SharepointLists, id = ThisItem.CurrentValue).name)
                DisplayMode: |-
                    =If(
                        IsBlank(First(Filter(
                            SharepointLists,
                            DefinitionId = ThisItem._parentdefinitionid_value
                        )).id),
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )
                Height: =45
                HoverBorderColor: =ColorFade(drpSharepointLists.BorderColor, 20%)
                HoverColor: =ColorFade(drpSharepointLists.Color, 20%)
                HoverFill: =ColorFade(drpSharepointLists.SelectionFill, 20%)
                Items: =Sort(Filter(SharepointLists, DefinitionId = ThisItem._parentdefinitionid_value), name)
                OnChange: =txtWebHoosURL.Text = drpSharepointLists.Selected.id
                PressedBorderColor: =drpSharepointLists.HoverBorderColor
                PressedColor: =drpSharepointLists.Fill
                PressedFill: =drpSharepointLists.Color
                Reset: =resetEnvironment
                Tooltip: ="Select a Sharepoint List"
                Visible: =ThisItem.type = 100000004 && ThisItem.parameterkey = "table" && ThisItem.apiid = "/providers/microsoft.powerapps/apis/shared_sharepointonline"
                Width: =850
                X: =973
                Y: =12
                ZIndex: =10

            icoChildEnvironmentVariable1 As icon.Cancel:
                BorderColor: =ColorFade(icoChildEnvironmentVariable1.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoChildEnvironmentVariable1.Fill, -80%)
                Height: =42
                HoverBorderColor: =ColorFade(icoChildEnvironmentVariable1.BorderColor, 20%)
                HoverColor: =ColorFade(icoChildEnvironmentVariable1.Color, 20%)
                HoverFill: =ColorFade(icoChildEnvironmentVariable1.Fill, 20%)
                Icon: =Icon.HorizontalLine
                OnSelect: =
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                PressedBorderColor: =ColorFade(icoChildEnvironmentVariable1.BorderColor, -20%)
                PressedColor: =ColorFade(icoChildEnvironmentVariable1.Color, -20%)
                PressedFill: =ColorFade(icoChildEnvironmentVariable1.Fill, -20%)
                Visible: =ThisItem.type = 100000004 && ThisItem.parameterkey = "table"
                Width: =42
                X: =934
                Y: =15
                ZIndex: =11

            icoChildEnvironmentVariable2 As icon.Cancel:
                BorderColor: =ColorFade(icoChildEnvironmentVariable2.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoChildEnvironmentVariable2.Fill, -80%)
                Height: =42
                HoverBorderColor: =ColorFade(icoChildEnvironmentVariable2.BorderColor, 20%)
                HoverColor: =ColorFade(icoChildEnvironmentVariable2.Color, 20%)
                HoverFill: =ColorFade(icoChildEnvironmentVariable2.Fill, 20%)
                Icon: =Icon.VerticalLine
                OnSelect: =
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                PressedBorderColor: =ColorFade(icoChildEnvironmentVariable2.BorderColor, -20%)
                PressedColor: =ColorFade(icoChildEnvironmentVariable2.Color, -20%)
                PressedFill: =ColorFade(icoChildEnvironmentVariable2.Fill, -20%)
                Visible: =ThisItem.type = 100000004 && ThisItem.parameterkey = "table"
                Width: =42
                X: =923
                Y: =5
                ZIndex: =12

            icoFilterSites As icon.FilterFlat:
                BorderColor: =ColorFade(icoFilterSites.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoFilterSites.Fill, -80%)
                Height: =35
                HoverBorderColor: =ColorFade(icoFilterSites.BorderColor, 20%)
                HoverColor: =ColorFade(icoFilterSites.Color, 20%)
                HoverFill: =ColorFade(icoFilterSites.Fill, 20%)
                Icon: =ThisItem.FilterIcon
                OnSelect: |-
                    =UpdateContext({currentSharepointSite: glrEnvironmentVariables.Selected.drpSharepointSites.Selected});
                    If(
                        glrEnvironmentVariables.Selected.FilterVisible,
                        If(
                            !IsBlankOrError(glrEnvironmentVariables.Selected.txtSearchSites.Text),
                            ClearCollect(
                                SharepointSites,
                                SearchSharepointSites.Run(
                                    {
                                        text: "*" & glrEnvironmentVariables.Selected.txtSearchSites.Text & "*",
                                        text_1: ""
                                    }
                                ).value
                            ),
                            ClearCollect(
                                SharepointSites,
                                SearchSharepointSites.Run(
                                    {
                                        text: "",
                                        text_1: ""
                                    }
                                ).value
                            )
                        );
                        UpdateContext(
                            {
                                lclFirstSite: First(
                                    Sort(
                                        SharepointSites,
                                        webUrl
                                    )
                                )
                            }
                        );
                        Collect(
                            SharepointSites,
                            {webUrl: ""}
                        );
                        ClearCollect(
                            SharepointSites,
                            Sort(
                                SharepointSites,
                                webUrl
                            )
                        );
                        If(
                            IsBlankOrError(lclFirstSite),
                            Patch(
                                SolutionEnvironmentVariables,
                                glrEnvironmentVariables.Selected,
                                {
                                    FilterIcon: Icon.FilterFlatFilled,
                                    SharepointSites: SharepointSites,
                                    FilterVisible: false,
                                    CurrentValue: currentSharepointSite.webUrl
                                }
                            ),
                            Patch(
                                SolutionEnvironmentVariables,
                                glrEnvironmentVariables.Selected,
                                {
                                    FilterIcon: Icon.FilterFlatFilled,
                                    SharepointSites: SharepointSites,
                                    FilterVisible: false,
                                    CurrentValue: lclFirstSite.webUrl
                                }
                            );
                            UpdateContext({currentSharepointSite: lclFirstSite});
                            Reset(drpSharepointSites);
                        ),
                        Patch(
                            SolutionEnvironmentVariables,
                            glrEnvironmentVariables.Selected,
                            {
                                FilterIcon: Icon.Search,
                                FilterVisible: true,
                                CurrentValue: currentSharepointSite.webUrl
                            }
                        );
                        
                    );
                    ClearCollect(
                        SharepointLists,
                        Filter(
                            SharepointLists,
                            DefinitionId <> glrEnvironmentVariables.Selected.environmentvariabledefinitionid
                        )
                    );
                    If(
                        Not IsBlank(currentSharepointSite.id),
                        Collect(
                            SharepointLists,
                            AddColumns(
                                SearchSharepointLists.Run(currentSharepointSite.id).value,
                                "DefinitionId",
                                glrEnvironmentVariables.Selected.environmentvariabledefinitionid
                            )
                        )
                    );
                    glrEnvironmentVariables.Selected.txtWebHoosURL.Text = currentSharepointSite.webUrl
                PressedBorderColor: =ColorFade(icoFilterSites.BorderColor, -20%)
                PressedColor: =ColorFade(icoFilterSites.Color, -20%)
                PressedFill: =ColorFade(icoFilterSites.Fill, -20%)
                Tooltip: ="Filter this list"
                Visible: =ThisItem.type = 100000004 && ThisItem.parameterkey = "dataset" && ThisItem.apiid = "/providers/microsoft.powerapps/apis/shared_sharepointonline"
                Width: =35
                X: =1790
                Y: =17
                ZIndex: =13

            txtSearchSites As text:
                AccessibleLabel: ="Environment Variable Value"
                Default: =
                Height: =44
                HintText: ="Enter the name of the Sharepoint site to search for and select the search icon"
                HoverBorderColor: =ColorFade(txtSearchSites.BorderColor, 20%)
                HoverColor: =ColorFade(txtSearchSites.Color, 20%)
                HoverFill: =ColorFade(txtSearchSites.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedBorderColor: =txtSearchSites.HoverBorderColor
                PressedColor: =txtSearchSites.Color
                PressedFill: =txtSearchSites.Fill
                Reset: =resetEnvironment
                Tooltip: ="Enter the name of the Sharepoint site to search for and select the search icon"
                Visible: =ThisItem.FilterVisible
                Width: =840
                X: =943
                Y: =12
                ZIndex: =14

        "glrConnectionReferences As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            AccessibleLabel: ="Connection References"
            Height: =590
            Items: =SolutionConnectionReferences
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =68
            Visible: =showConnectionReferenceSettings
            Width: =1860
            X: =24
            Y: =394
            ZIndex: =22

            icoConnectorIcon As image:
                BorderColor: =ColorFade(icoConnectorIcon.Fill, -20%)
                Height: =58
                HoverBorderColor: =ColorFade(icoConnectorIcon.BorderColor, 20%)
                HoverFill: =ColorFade(icoConnectorIcon.Fill, 20%)
                Image: =drpConnectionReferenceConnections.Selected.IconUrl
                OnSelect: =Select(Parent)
                PressedBorderColor: =ColorFade(icoConnectorIcon.BorderColor, -20%)
                PressedFill: =ColorFade(icoConnectorIcon.Fill, -20%)
                Width: =58
                Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                ZIndex: =1

            lblConnectionReferenceName As label:
                Height: =24
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =14
                Text: =ThisItem.connectionreferencedisplayname
                VerticalAlign: =VerticalAlign.Top
                Width: =600
                X: =58
                Y: =10
                ZIndex: =2

            lblConnectionReferenceLogicalName As label:
                Height: =Self.Size * 1.8
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =12
                Text: =ThisItem.connectionreferencelogicalname
                VerticalAlign: =VerticalAlign.Top
                Width: =600
                X: =58
                Y: =35
                ZIndex: =3

            Separator3 As rectangle:
                BorderColor: =ColorFade(Separator3.Fill, -20%)
                DisabledFill: =Separator3.Fill
                Height: =1
                HoverFill: =ColorFade(Separator3.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedFill: =ColorFade(Separator3.Fill, -20%)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =4

            drpConnectionReferenceConnections As dropdown:
                AccessibleLabel: ="Connections"
                ChevronHoverBackground: =ColorFade(drpConnectionReferenceConnections.ChevronBackground, 20%)
                ChevronHoverFill: =ColorFade(drpConnectionReferenceConnections.ChevronFill, 20%)
                Default: =If(IsBlank(ThisItem.CurrentValue), First(Filter(EnvironmentConnections, ApiId = ThisItem.connectorid And Status = "Connected")).DisplayName, LookUp(EnvironmentConnections, ConnectionId = ThisItem.CurrentValue).DisplayName)
                Height: =45
                HoverBorderColor: =ColorFade(drpConnectionReferenceConnections.BorderColor, 20%)
                HoverColor: =ColorFade(drpConnectionReferenceConnections.Color, 20%)
                HoverFill: =ColorFade(drpConnectionReferenceConnections.SelectionFill, 20%)
                Items: |-
                    =If(
                        IsBlankOrError(ThisItem.CustomConnectorId),
                        Sort(
                            Filter(
                                EnvironmentConnections,
                                ApiId = ThisItem.connectorid
                            ),
                            Status
                        ),
                        //Need to parse out the name of the connector from the expand query which returns a json string for some reason in the legacy connector.
                        //We should be able to clean this up when the new dataverse connector supports cross environment actions
                        Sort(
                            Filter(
                                EnvironmentConnections,
                                First(
                                    Filter(
                                        EnvironmentCustomConnectors,
                                        name = Trim(
                                            Substitute(
                                                Substitute(
                                                    Last(
                                                        ForAll(Split(
                                                            First(
                                                                ForAll(Split(
                                                                    ThisItem.CustomConnectorId,
                                                                    ","
                                                                ), {Result: ThisRecord.Value})
                                                            ).Result,
                                                            ":"
                                                        ), {Result: ThisRecord.Value})
                                                    ).Result,
                                                    """",
                                                    ""
                                                ),
                                                "\n",
                                                ""
                                            )
                                        )
                                    )
                                ).connectorinternalid in ApiId
                            ),
                            Status
                        )
                    )
                PressedBorderColor: =drpConnectionReferenceConnections.HoverBorderColor
                PressedColor: =drpConnectionReferenceConnections.Fill
                PressedFill: =drpConnectionReferenceConnections.Color
                Reset: =resetEnvironment
                Tooltip: ="Select and Existing Connection"
                Visible: =!ThisItem.ManualEntry
                Width: =665
                X: =842
                Y: =12
                ZIndex: =5

            lblConnectionStatus As label:
                Align: =Align.Center
                Color: =If(drpConnectionReferenceConnections.Selected.Status = "Connected", Color.Green, If(drpConnectionReferenceConnections.Selected.Status = "Unknown", Color.DarkOrange, Color.Red))
                FontWeight: =FontWeight.Semibold
                Height: =43
                PaddingLeft: =0
                PaddingTop: =0
                Text: =If(IsBlank(drpConnectionReferenceConnections.Selected), "Not Connected", drpConnectionReferenceConnections.Selected.Status)
                Tooltip: =If(IsBlank(drpConnectionReferenceConnections.Selected), "Select + to Create a New Connection", drpConnectionReferenceConnections.Selected.Status)
                Width: =200
                X: =642
                Y: =12
                ZIndex: =6

            icoNewConnection As icon.Add:
                AccessibleLabel: ="New Connection"
                BorderColor: =ColorFade(icoNewConnection.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoNewConnection.Fill, -80%)
                DisplayMode: |-
                    =If(
                        IsBlankOrError(drpDeployEnvironments.Selected.EnvironmentId) Or (!IsBlankOrError(ThisItem.CustomConnectorId) And IsBlankOrError(
                            First(
                                Filter(
                                    EnvironmentCustomConnectors,
                                    name = Trim(
                                        Substitute(
                                            Substitute(
                                                Last(
                                                    ForAll(Split(
                                                        First(
                                                            ForAll(Split(
                                                                ThisItem.CustomConnectorId,
                                                                ","
                                                            ), {Result: ThisRecord.Value})
                                                        ).Result,
                                                        ":"
                                                    ), {Result: ThisRecord.Value})
                                                ).Result,
                                                """",
                                                ""
                                            ),
                                            "\n",
                                            ""
                                        )
                                    )
                                )
                            )
                        )),
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )
                FocusedBorderThickness: =
                Height: =47
                HoverBorderColor: =ColorFade(icoNewConnection.BorderColor, 20%)
                HoverColor: =ColorFade(icoNewConnection.Color, 20%)
                HoverFill: =ColorFade(icoNewConnection.Fill, 20%)
                Icon: =Icon.Add
                OnSelect: |
                    =Select(Parent);
                    If(
                        IsBlankOrError(glrConnectionReferences.Selected.CustomConnectorId),
                        Launch(
                            drpDeployEnvironments.Selected.MakerPortalUrl & "/connections/available?apiName=" & Last(
                                ForAll(Split(
                                    glrConnectionReferences.Selected.connectorid,
                                    "/"
                                ), {Result: ThisRecord.Value})
                            ).Result
                        ),
                        //Need to parse out the name of the connector from the expand query which returns a json string for some reason in the legacy connector.
                        UpdateContext(
                            {
                                locConnectorId: First(
                                    Filter(
                                        EnvironmentCustomConnectors,
                                        name = Trim(
                                            Substitute(
                                                Substitute(
                                                    Last(
                                                        ForAll(Split(
                                                            First(
                                                                ForAll(Split(
                                                                    glrConnectionReferences.Selected.CustomConnectorId,
                                                                    ","
                                                                ), {Result: ThisRecord.Value})
                                                            ).Result,
                                                            ":"
                                                        ), {Result: ThisRecord.Value})
                                                    ).Result,
                                                    """",
                                                    ""
                                                ),
                                                "\n",
                                                ""
                                            )
                                        )
                                    )
                                ).connectorinternalid
                            }
                        );
                        If(
                            !IsBlankOrError(locConnectorId),
                            Launch(drpDeployEnvironments.Selected.MakerPortalUrl & "/connections/available?apiName=" & locConnectorId)
                        )
                    );
                PaddingBottom: =8
                PaddingLeft: =8
                PaddingRight: =5
                PaddingTop: =8
                PressedBorderColor: =ColorFade(icoNewConnection.BorderColor, -20%)
                PressedColor: =ColorFade(icoNewConnection.Color, -20%)
                PressedFill: =ColorFade(icoNewConnection.Fill, -20%)
                Tooltip: =If(IsBlankOrError(drpDeployEnvironments.Selected.EnvironmentId), "You Don't Have Permissions to This Environment to Create Connections. Please Request a Connection from a User With Permissions To This Environment", "Create a New Connection")
                Width: =57
                X: =1667
                Y: =9
                ZIndex: =7

            icoConnectionStatus As icon.Add:
                AccessibleLabel: ="Connection Status"
                BorderColor: =ColorFade(icoConnectionStatus.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoConnectionStatus.Fill, -80%)
                FocusedBorderThickness: =
                Height: =58
                HoverBorderColor: =ColorFade(icoConnectionStatus.BorderColor, 20%)
                HoverColor: =ColorFade(icoConnectionStatus.Color, 20%)
                HoverFill: =ColorFade(icoConnectionStatus.Fill, 20%)
                Icon: =
                OnSelect: |-
                    =Select(Parent);
                        Set(
                            connectorName,
                            Last(
                                ForAll(Split(
                                    glrConnectionReferences.Selected.connectorid,
                                    "/"
                                ), {Result: ThisRecord.Value})
                            ).Result
                        );
                    If(
                        IsBlank(glrConnectionReferences.Selected.drpConnectionReferenceConnections.Selected),
                        Launch(
                        drpDeployEnvironments.Selected.MakerPortalUrl & "/connections/available?apiName=" & connectorName,
                        "",
                        "_blank"
                    ),
                    
                        Launch(
                            drpDeployEnvironments.Selected.MakerPortalUrl & "/connections/" & connectorName & "/" & glrConnectionReferences.Selected.drpConnectionReferenceConnections.Selected.ConnectionId &"/details?apiName=" & connectorName,
                            "",
                            "_blank"
                        )
                    )
                PaddingBottom: =8
                PaddingLeft: =8
                PaddingRight: =5
                PaddingTop: =8
                PressedBorderColor: =ColorFade(icoConnectionStatus.BorderColor, -20%)
                PressedColor: =ColorFade(icoConnectionStatus.Color, -20%)
                PressedFill: =ColorFade(icoConnectionStatus.Fill, -20%)
                Tooltip: ="Select to open the Connection"
                Width: =842
                Y: =5
                ZIndex: =9

            icoRequestConnection As icon.Add:
                AccessibleLabel: ="Request Connection"
                BorderColor: =ColorFade(icoRequestConnection.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoRequestConnection.Fill, -80%)
                FocusedBorderThickness: =
                Height: =47
                HoverBorderColor: =ColorFade(icoRequestConnection.BorderColor, 20%)
                HoverColor: =ColorFade(icoRequestConnection.Color, 20%)
                HoverFill: =ColorFade(icoRequestConnection.Fill, 20%)
                Icon: =Icon.AddUser
                OnSelect: |
                    =UpdateContext(
                        {
                            showDeploymentDialogOverlay: true,
                            showConnectionRequestDialog: true
                        }
                    );
                PaddingBottom: =8
                PaddingLeft: =8
                PaddingRight: =5
                PaddingTop: =8
                PressedBorderColor: =ColorFade(icoRequestConnection.BorderColor, -20%)
                PressedColor: =ColorFade(icoRequestConnection.Color, -20%)
                PressedFill: =ColorFade(icoRequestConnection.Fill, -20%)
                Tooltip: ="Request a New Connection from Another User"
                Width: =57
                X: =1766
                Y: =9
                ZIndex: =10

            icoOpenConnection As icon.Add:
                AccessibleLabel: ="New Connection"
                BorderColor: =ColorFade(icoOpenConnection.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoOpenConnection.Fill, -80%)
                FocusedBorderThickness: =
                Height: =45
                HoverBorderColor: =ColorFade(icoOpenConnection.BorderColor, 20%)
                HoverColor: =ColorFade(icoOpenConnection.Color, 20%)
                HoverFill: =ColorFade(icoOpenConnection.Fill, 20%)
                Icon: =Icon.OpenInNewWindow
                OnSelect: |-
                    =Select(Parent);
                        Set(
                            connectorName,
                            Last(
                                ForAll(Split(
                                    glrConnectionReferences.Selected.connectorid,
                                    "/"
                                ), {Result: ThisRecord.Value})
                            ).Result
                        );
                    If(
                        IsBlank(glrConnectionReferences.Selected.drpConnectionReferenceConnections.Selected),
                        Launch(
                        drpDeployEnvironments.Selected.MakerPortalUrl & "/connections/available?apiName=" & connectorName,
                        "",
                        "_blank"
                    ),
                    
                        Launch(
                            drpDeployEnvironments.Selected.MakerPortalUrl & "/connections/" & connectorName & "/" & glrConnectionReferences.Selected.drpConnectionReferenceConnections.Selected.ConnectionId &"/details?apiName=" & connectorName,
                            "",
                            "_blank"
                        )
                    )
                PaddingBottom: =8
                PaddingLeft: =8
                PaddingRight: =5
                PaddingTop: =8
                PressedBorderColor: =ColorFade(icoOpenConnection.BorderColor, -20%)
                PressedColor: =ColorFade(icoOpenConnection.Color, -20%)
                PressedFill: =ColorFade(icoOpenConnection.Fill, -20%)
                Tooltip: =If(IsBlankOrError(drpDeployEnvironments.Selected.EnvironmentId), "You Don't Have Permissions to This Environment to View Connections.", "View Selected Connection")
                Width: =45
                X: =1723
                Y: =9
                ZIndex: =11

            chkShareConnection As checkbox:
                Default: =If(IsBlank(ThisItem.Shared), false, ThisItem.Shared)
                FontWeight: =FontWeight.Semibold
                HoverBorderColor: =ColorFade(chkShareConnection.BorderColor, 20%)
                HoverColor: =ColorFade(chkShareConnection.Color, 20%)
                HoverFill: =ColorFade(chkShareConnection.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedBorderColor: =ColorFade(chkShareConnection.BorderColor, -20%)
                PressedColor: =ColorFade(chkShareConnection.Color, -20%)
                PressedFill: =ColorFade(chkShareConnection.Fill, -20%)
                Text: ="Share"
                Tooltip: ="Connections specified in the connection reference tab are required to be shared with the pipeline user that deploys the solution. You must consent to sharing connections in order to deploy your solution with connection references."
                Width: =125
                X: =1514
                Y: =5
                ZIndex: =12

            icoEditConnection As icon.Add:
                AccessibleLabel: ="New Connection"
                BorderColor: =ColorFade(icoEditConnection.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoEditConnection.Fill, -80%)
                DisplayMode: |-
                    =If(
                        IsBlankOrError(drpDeployEnvironments.Selected.EnvironmentId) Or (!IsBlankOrError(ThisItem.CustomConnectorId) And IsBlankOrError(
                            First(
                                Filter(
                                    EnvironmentCustomConnectors,
                                    name = Trim(
                                        Substitute(
                                            Substitute(
                                                Last(
                                                    ForAll(Split(
                                                        First(
                                                            ForAll(Split(
                                                                ThisItem.CustomConnectorId,
                                                                ","
                                                            ), {Result: ThisRecord.Value})
                                                        ).Result,
                                                        ":"
                                                    ), {Result: ThisRecord.Value})
                                                ).Result,
                                                """",
                                                ""
                                            ),
                                            "\n",
                                            ""
                                        )
                                    )
                                )
                            )
                        )),
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )
                FocusedBorderThickness: =
                Height: =47
                HoverBorderColor: =ColorFade(icoEditConnection.BorderColor, 20%)
                HoverColor: =ColorFade(icoEditConnection.Color, 20%)
                HoverFill: =ColorFade(icoEditConnection.Fill, 20%)
                Icon: =If(!ThisItem.ManualEntry, Icon.Text, Icon.OptionsList)
                OnSelect: |
                    =Patch(
                        SolutionConnectionReferences,
                        glrConnectionReferences.Selected,
                        {
                            ManualEntry: !glrConnectionReferences.Selected.ManualEntry,
                            Shared: chkShareConnection.Value,
                            CurrentValue: If(
                                glrConnectionReferences.Selected.ManualEntry,
                                txtConnectionId.Text,
                                drpConnectionReferenceConnections.Selected.ConnectionId
                            )
                        }
                    );
                    If(
                        glrConnectionReferences.Selected.ManualEntry,
                        Reset(drpConnectionReferenceConnections)
                    );
                PaddingBottom: =8
                PaddingLeft: =8
                PaddingRight: =5
                PaddingTop: =8
                PressedBorderColor: =ColorFade(icoEditConnection.BorderColor, -20%)
                PressedColor: =ColorFade(icoEditConnection.Color, -20%)
                PressedFill: =ColorFade(icoEditConnection.Fill, -20%)
                Tooltip: |-
                    =If(
                        ThisItem.ManualEntry,
                        "Select to choose an existing connection",
                        "Select to enter connection manually or view the selected connection id."
                    )
                Width: =50
                X: =1625
                Y: =9
                ZIndex: =13

            txtConnectionId As text:
                Default: =ThisItem.CurrentValue
                Height: =45
                HoverBorderColor: =ColorFade(txtConnectionId.BorderColor, 20%)
                HoverColor: =ColorFade(txtConnectionId.Color, 20%)
                HoverFill: =ColorFade(txtConnectionId.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedBorderColor: =txtConnectionId.HoverBorderColor
                PressedColor: =txtConnectionId.Color
                PressedFill: =txtConnectionId.Fill
                Visible: =ThisItem.ManualEntry
                Width: =665
                X: =842
                Y: =12
                ZIndex: =14

        "glrCanvasApps As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            AccessibleLabel: ="Canvas Apps"
            Height: =653
            Items: =Sort(SolutionCanvasApps, name)
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =68
            Visible: =showSharingSettings
            Width: =1850
            X: =24
            Y: =274
            ZIndex: =23

            icoCanvasApp As image:
                AccessibleLabel: ="Canvas App"
                BorderColor: =ColorFade(icoCanvasApp.Fill, -20%)
                Height: =58
                HoverBorderColor: =ColorFade(icoCanvasApp.BorderColor, 20%)
                HoverFill: =ColorFade(icoCanvasApp.Fill, 20%)
                Image: =PowerApps_scalable
                OnSelect: =Select(Parent);
                PressedBorderColor: =ColorFade(icoCanvasApp.BorderColor, -20%)
                PressedFill: =ColorFade(icoCanvasApp.Fill, -20%)
                Tooltip: ="Select to Open App"
                Width: =58
                Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                ZIndex: =1

            lblCanvasAppName As label:
                Height: =24
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =14
                Text: =ThisItem.displayname
                VerticalAlign: =VerticalAlign.Top
                Width: =644
                X: =58
                Y: =10
                ZIndex: =2

            lblCanvasAppLogicalName As label:
                Height: =Self.Size * 1.8
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =12
                Text: =ThisItem._componentstate_label
                VerticalAlign: =VerticalAlign.Top
                Width: =600
                X: =58
                Y: =35
                ZIndex: =3

            Separator3_2 As rectangle:
                BorderColor: =ColorFade(Separator3_2.Fill, -20%)
                DisabledFill: =Separator3_2.Fill
                Height: =1
                HoverFill: =ColorFade(Separator3_2.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedFill: =ColorFade(Separator3_2.Fill, -20%)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =4

            drpCanvasAppSharePermission As dropdown:
                AccessibleLabel: ="App Sharing Permission"
                ChevronHoverBackground: =ColorFade(drpCanvasAppSharePermission.ChevronBackground, 20%)
                ChevronHoverFill: =ColorFade(drpCanvasAppSharePermission.ChevronFill, 20%)
                Default: =If(IsBlank(ThisItem.CurrentPermission), First(AppSharingPermissions).Text, LookUp(AppSharingPermissions, Value = ThisItem.CurrentPermission).Text)
                Height: =45
                HoverBorderColor: =ColorFade(drpCanvasAppSharePermission.BorderColor, 20%)
                HoverColor: =ColorFade(drpCanvasAppSharePermission.Color, 20%)
                HoverFill: =ColorFade(drpCanvasAppSharePermission.SelectionFill, 20%)
                Items: =AppSharingPermissions
                PressedBorderColor: =drpCanvasAppSharePermission.HoverBorderColor
                PressedColor: =drpCanvasAppSharePermission.Fill
                PressedFill: =drpCanvasAppSharePermission.Color
                Reset: =resetEnvironment
                Tooltip: ="Select a Permission for the Group"
                Width: =220
                X: =1558
                Y: =12
                ZIndex: =5

            icoLaunchApp As icon.Add:
                AccessibleLabel: ="Open App"
                BorderColor: =ColorFade(icoLaunchApp.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoLaunchApp.Fill, -80%)
                FocusedBorderThickness: =
                Height: =46
                HoverBorderColor: =ColorFade(icoLaunchApp.BorderColor, 20%)
                HoverColor: =ColorFade(icoLaunchApp.Color, 20%)
                HoverFill: =ColorFade(icoLaunchApp.Fill, 20%)
                Icon: =
                OnSelect: |-
                    =Select(Parent);
                    Launch(ThisItem.appopenuri,
                        "",
                        "_blank"
                    )
                PaddingBottom: =8
                PaddingLeft: =8
                PaddingRight: =5
                PaddingTop: =8
                PressedBorderColor: =ColorFade(icoLaunchApp.BorderColor, -20%)
                PressedColor: =ColorFade(icoLaunchApp.Color, -20%)
                PressedFill: =ColorFade(icoLaunchApp.Fill, -20%)
                Tooltip: ="Select to Open App"
                Width: =691
                Y: =10
                ZIndex: =6

            drpCanvasAppShareGroups As dropdown:
                AccessibleLabel: ="App Sharing Group"
                ChevronHoverBackground: =ColorFade(drpCanvasAppShareGroups.ChevronBackground, 20%)
                ChevronHoverFill: =ColorFade(drpCanvasAppShareGroups.ChevronFill, 20%)
                Default: =If(IsBlank(ThisItem.CurrentValue), First(ThisItem.AADGroups).displayName, LookUp(ThisItem.AADGroups, Text(id) = ThisItem.CurrentValue).displayName)
                Height: =46
                HoverBorderColor: =ColorFade(drpCanvasAppShareGroups.BorderColor, 20%)
                HoverColor: =ColorFade(drpCanvasAppShareGroups.Color, 20%)
                HoverFill: =ColorFade(drpCanvasAppShareGroups.SelectionFill, 20%)
                Items: =ThisItem.AADGroups
                PressedBorderColor: =drpCanvasAppShareGroups.HoverBorderColor
                PressedColor: =drpCanvasAppShareGroups.Fill
                PressedFill: =drpCanvasAppShareGroups.Color
                Reset: =resetEnvironment
                Tooltip: ="Select an Existing AAD Group"
                Width: =750
                X: =707
                Y: =12
                ZIndex: =7

            icoViewGroupMembers As icon.Add:
                AccessibleLabel: ="Open Group Members"
                BorderColor: =ColorFade(icoViewGroupMembers.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoViewGroupMembers.Fill, -80%)
                FocusedBorderThickness: =
                Height: =47
                HoverBorderColor: =ColorFade(icoViewGroupMembers.BorderColor, 20%)
                HoverColor: =ColorFade(icoViewGroupMembers.Color, 20%)
                HoverFill: =ColorFade(icoViewGroupMembers.Fill, 20%)
                Icon: =Icon.DetailList
                OnSelect: |-
                    =Select(Parent);
                    Launch("https://portal.azure.com/#blade/Microsoft_AAD_IAM/GroupDetailsMenuBlade/Members/groupId/" & drpCanvasAppShareGroups.Selected.id)
                PaddingBottom: =8
                PaddingLeft: =8
                PaddingRight: =5
                PaddingTop: =8
                PressedBorderColor: =ColorFade(icoViewGroupMembers.BorderColor, -20%)
                PressedColor: =ColorFade(icoViewGroupMembers.Color, -20%)
                PressedFill: =ColorFade(icoViewGroupMembers.Fill, -20%)
                Tooltip: ="View Azure AD Group Details"
                Width: =53
                X: =1501
                Y: =12
                ZIndex: =8

            txtFilterGroups As text:
                Default: =""
                Height: =46
                HintText: ="Enter the name of the group to filter the drop down"
                HoverBorderColor: =ColorFade(txtFilterGroups.BorderColor, 20%)
                HoverColor: =ColorFade(txtFilterGroups.Color, 20%)
                HoverFill: =ColorFade(txtFilterGroups.Fill, 20%)
                PressedBorderColor: =txtFilterGroups.HoverBorderColor
                PressedColor: =txtFilterGroups.Color
                PressedFill: =txtFilterGroups.Fill
                Visible: =ThisItem.FilterVisible
                Width: =750
                X: =707
                Y: =12
                ZIndex: =9

            icoFilterGroups As icon.FilterFlat:
                BorderColor: =ColorFade(icoFilterGroups.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoFilterGroups.Fill, -80%)
                Height: =35
                HoverBorderColor: =ColorFade(icoFilterGroups.BorderColor, 20%)
                HoverColor: =ColorFade(icoFilterGroups.Color, 20%)
                HoverFill: =ColorFade(icoFilterGroups.Fill, 20%)
                Icon: =ThisItem.FilterIcon
                OnSelect: |
                    =UpdateContext(
                        {
                            currentGroup: glrCanvasApps.Selected.drpCanvasAppShareGroups.Selected,
                            currentPermission: glrCanvasApps.Selected.drpCanvasAppSharePermission.Selected
                        }
                    );
                    If(
                        glrCanvasApps.Selected.FilterVisible,
                        ClearCollect(
                            AADGroups,
                            SearchAADGroups.Run(
                                {
                                    text: glrCanvasApps.Selected.txtFilterGroups.Text,
                                    text_1: ""
                                }
                            ).value
                        );
                        UpdateContext(
                            {
                                lclFirstAADGroup: First(
                                    Sort(
                                        AADGroups,
                                        displayName
                                    )
                                )
                            }
                        );
                        Collect(
                            AADGroups,
                            {
                                id: "",
                                displayName: ""
                            }
                        );
                        ClearCollect(
                            AADGroups,
                            Sort(
                                AADGroups,
                                displayName
                            )
                        );
                        If(
                            IsBlankOrError(lclFirstAADGroup),
                            Patch(
                                SolutionCanvasApps,
                                glrCanvasApps.Selected,
                                {
                                    FilterIcon: Icon.FilterFlatFilled,
                                    AADGroups: AADGroups,
                                    FilterVisible: false,
                                    CurrentValue: currentGroup.id,
                                    CurrentPermission: currentPermission.Value
                                }
                            ),
                            Patch(
                                SolutionCanvasApps,
                                glrCanvasApps.Selected,
                                {
                                    FilterIcon: Icon.FilterFlatFilled,
                                    AADGroups: AADGroups,
                                    FilterVisible: false,
                                    CurrentValue: lclFirstAADGroup.id,
                                    CurrentPermission: currentPermission.Value
                                }
                            );
                            Reset(drpCanvasAppShareGroups);
                        ),
                        Patch(
                            SolutionCanvasApps,
                            glrCanvasApps.Selected,
                            {
                                FilterIcon: Icon.Search,
                                FilterVisible: true,
                                CurrentValue: currentGroup.id,
                                CurrentPermission: currentPermission.Value
                            }
                        );
                        
                    );
                PressedBorderColor: =ColorFade(icoFilterGroups.BorderColor, -20%)
                PressedColor: =ColorFade(icoFilterGroups.Color, -20%)
                PressedFill: =ColorFade(icoFilterGroups.Fill, -20%)
                Tooltip: ="Filter this list"
                Visible: =showSharingSettings
                Width: =35
                X: =1470
                Y: =18
                ZIndex: =10

            icoAddAppSharing As icon.FilterFlat:
                BorderColor: =ColorFade(icoAddAppSharing.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoAddAppSharing.Fill, -80%)
                Height: =35
                HoverBorderColor: =ColorFade(icoAddAppSharing.BorderColor, 20%)
                HoverColor: =ColorFade(icoAddAppSharing.Color, 20%)
                HoverFill: =ColorFade(icoAddAppSharing.Fill, 20%)
                Icon: =If(ThisItem.IsCopy, Icon.Cancel, Icon.Add)
                OnSelect: |
                    =If(
                        ThisItem.IsCopy,
                        Remove(
                            SolutionCanvasApps,
                            ThisItem
                        ),
                        Patch(
                            SolutionCanvasApps,
                            ThisItem,
                            {CurrentValue: drpCanvasAppShareGroups.Selected.id}
                        );
                        Collect(
                            SolutionCanvasApps,
                            {
                                _componentstate_label: ThisItem._componentstate_label,
                                name: ThisItem.name,
                                displayname: ThisItem.displayname,
                                IsCopy: true,
                                AADGroups: ThisItem.AADGroups,
                                FilterIcon: Icon.FilterFlat,
                                FilterVisible: false,
                                Suffix: "." & CountIf(
                                    SolutionCanvasApps,
                                    name = ThisItem.name
                                )
                            }
                        )
                    );
                PressedBorderColor: =ColorFade(icoAddAppSharing.BorderColor, -20%)
                PressedColor: =ColorFade(icoAddAppSharing.Color, -20%)
                PressedFill: =ColorFade(icoAddAppSharing.Fill, -20%)
                Tooltip: ="Add Another AAD Group Sharing Row"
                Visible: =showSharingSettings
                Width: =35
                X: =1806
                Y: =18
                ZIndex: =11

        "glrGroupTeams As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            AccessibleLabel: ="Canvas Apps"
            Height: =652
            Items: =GroupTeams
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =68
            Visible: =showGroupTeamsSettings
            Width: =1850
            X: =24
            Y: =274
            ZIndex: =24

            icoGroupTeam As image:
                AccessibleLabel: ="Canvas App"
                BorderColor: =ColorFade(icoGroupTeam.Fill, -20%)
                Height: =58
                HoverBorderColor: =ColorFade(icoGroupTeam.BorderColor, 20%)
                HoverFill: =ColorFade(icoGroupTeam.Fill, 20%)
                Image: =AADIcon
                OnSelect: =Select(Parent);
                PressedBorderColor: =ColorFade(icoGroupTeam.BorderColor, -20%)
                PressedFill: =ColorFade(icoGroupTeam.Fill, -20%)
                Tooltip: ="Select to Open App"
                Width: =58
                Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                ZIndex: =1

            lblCanvasAppName_1 As label:
                Height: =25
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =14
                Text: =ThisItem.DisplayName
                VerticalAlign: =VerticalAlign.Top
                Width: =350
                X: =58
                Y: =10
                ZIndex: =2

            lblCanvasAppLogicalName_1 As label:
                Height: =21
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =12
                Text: =If(IsBlank(ThisItem.Value), First(ThisItem.AADGroups).displayName, LookUp(ThisItem.AADGroups, Text(id) = ThisItem.Value).displayName)
                VerticalAlign: =VerticalAlign.Top
                Width: =353
                X: =58
                Y: =35
                ZIndex: =3

            Separator3_5 As rectangle:
                BorderColor: =ColorFade(Separator3_5.Fill, -20%)
                DisabledFill: =Separator3_5.Fill
                Height: =1
                HoverFill: =ColorFade(Separator3_5.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedFill: =ColorFade(Separator3_5.Fill, -20%)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =4

            txtGroupTeamName As text:
                AccessibleLabel: ="Environment Variable Value"
                Default: =ThisItem.DisplayName
                Height: =46
                HintText: ="Enter a Team Name"
                HoverBorderColor: =ColorFade(txtGroupTeamName.BorderColor, 20%)
                HoverColor: =ColorFade(txtGroupTeamName.Color, 20%)
                HoverFill: =ColorFade(txtGroupTeamName.Fill, 20%)
                OnChange: |-
                    =Patch(
                        GroupTeams,
                        ThisItem,
                        {DisplayName: txtGroupTeamName.Text}
                    );
                    Patch(
                        EnvironmentTeams,
                        LookUp(EnvironmentTeams, teamid = ThisItem.Id),
                        {name: txtGroupTeamName.Text}
                    );
                    ClearCollect(EnvironmentTeams, Sort(EnvironmentTeams, name));
                OnSelect: =Select(Parent)
                PressedBorderColor: =txtGroupTeamName.HoverBorderColor
                PressedColor: =txtGroupTeamName.Color
                PressedFill: =txtGroupTeamName.Fill
                Reset: =resetEnvironment
                Tooltip: ="Enter a Value for this Environment Variable in the Target Environment"
                Width: =290
                X: =399
                Y: =10
                ZIndex: =5

            cmbGroupTeamRoles As combobox:
                ChevronHoverBackground: =ColorFade(cmbGroupTeamRoles.ChevronBackground, 20%)
                ChevronHoverFill: =ColorFade(cmbGroupTeamRoles.ChevronFill, 20%)
                DefaultSelectedItems: |-
                    =ForAll(Distinct(
                        Filter(
                            GroupTeamSelectedRoles,
                            GroupTeamId = ThisItem.Id
                        ),
                        name
                    ), {Result: ThisRecord.Value})
                DisplayFields: =["Result"]
                Height: =46
                HoverBorderColor: =ColorFade(cmbGroupTeamRoles.BorderColor, 20%)
                HoverColor: =ColorFade(cmbGroupTeamRoles.Color, 20%)
                HoverFill: =ColorFade(cmbGroupTeamRoles.SelectionFill, 20%)
                InputTextPlaceholder: ="Find Roles"
                IsSearchable: =false
                Items: |-
                    =ForAll(Distinct(SolutionSecurityRoles, name), {Result: ThisRecord.Value}).Result
                MoreItemsButtonColor: =Self.ChevronBackground
                OnChange: =ThisItem.DisplayMode
                OnSelect: =Select(Parent)
                PressedBorderColor: =cmbGroupTeamRoles.HoverBorderColor
                SearchFields: =["Result"]
                SearchItems: =[]
                Width: =290
                X: =1329
                Y: =10
                ZIndex: =6

            drpGroupTeamGroups As dropdown:
                AccessibleLabel: ="App Sharing Group"
                ChevronHoverBackground: =ColorFade(drpGroupTeamGroups.ChevronBackground, 20%)
                ChevronHoverFill: =ColorFade(drpGroupTeamGroups.ChevronFill, 20%)
                Default: =If(IsBlank(ThisItem.Value), First(ThisItem.AADGroups).displayName, LookUp(ThisItem.AADGroups, Text(id) = ThisItem.Value).displayName)
                Height: =46
                HoverBorderColor: =ColorFade(drpGroupTeamGroups.BorderColor, 20%)
                HoverColor: =ColorFade(drpGroupTeamGroups.Color, 20%)
                HoverFill: =ColorFade(drpGroupTeamGroups.SelectionFill, 20%)
                Items: =ThisItem.AADGroups
                OnChange: |-
                    =Patch(
                        GroupTeams,
                        ThisItem,
                        {Value: drpGroupTeamGroups.Selected.id}
                    );
                OnSelect: =
                PressedBorderColor: =drpGroupTeamGroups.HoverBorderColor
                PressedColor: =drpGroupTeamGroups.Fill
                PressedFill: =drpGroupTeamGroups.Color
                Reset: =resetEnvironment
                Tooltip: ="Select an Existing AAD Group"
                Width: =280
                X: =992
                Y: =10
                ZIndex: =7

            txtFilterTeamGroupGroups As text:
                Default: =""
                Height: =46
                HintText: ="Enter the name of the group to filter."
                HoverBorderColor: =ColorFade(txtFilterTeamGroupGroups.BorderColor, 20%)
                HoverColor: =ColorFade(txtFilterTeamGroupGroups.Color, 20%)
                HoverFill: =ColorFade(txtFilterTeamGroupGroups.Fill, 20%)
                PressedBorderColor: =txtFilterTeamGroupGroups.HoverBorderColor
                PressedColor: =txtFilterTeamGroupGroups.Color
                PressedFill: =txtFilterTeamGroupGroups.Fill
                Visible: =ThisItem.FilterVisible
                X: =1082
                Y: =10
                ZIndex: =8

            icoDeleteGroupTeam As icon.Add:
                AccessibleLabel: ="Refresh"
                BorderColor: =ColorFade(icoDeleteGroupTeam.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledColor: =ColorFade(icoDeleteGroupTeam.Color, 50%)
                DisabledFill: =ColorFade(icoDeleteGroupTeam.Fill, -80%)
                Height: =45
                HoverBorderColor: =ColorFade(icoDeleteGroupTeam.BorderColor, 20%)
                HoverColor: =ColorFade(icoDeleteGroupTeam.Color, 20%)
                HoverFill: =ColorFade(icoDeleteGroupTeam.Fill, 20%)
                Icon: =Icon.Cancel
                OnSelect: |
                    =Remove(
                        EnvironmentTeams,
                        LookUp(EnvironmentTeams, teamid = glrGroupTeams.Selected.Id)
                    );
                    Remove(
                        GroupTeams,
                        ThisItem
                    );
                PaddingBottom: =8
                PaddingLeft: =8
                PaddingRight: =5
                PaddingTop: =8
                PressedBorderColor: =ColorFade(icoDeleteGroupTeam.BorderColor, -20%)
                PressedColor: =ColorFade(icoDeleteGroupTeam.Color, -20%)
                PressedFill: =ColorFade(icoDeleteGroupTeam.Fill, -20%)
                Tooltip: ="Delete Group Team"
                Visible: =showGroupTeamsSettings
                Width: =45
                X: =1790
                Y: =12
                ZIndex: =9

            icoFilterTeamsGroups As icon.FilterFlat:
                BorderColor: =ColorFade(icoFilterTeamsGroups.Fill, -20%)
                Color: =PrimaryColor2Value
                DisabledFill: =ColorFade(icoFilterTeamsGroups.Fill, -80%)
                Height: =35
                HoverBorderColor: =ColorFade(icoFilterTeamsGroups.BorderColor, 20%)
                HoverColor: =ColorFade(icoFilterTeamsGroups.Color, 20%)
                HoverFill: =ColorFade(icoFilterTeamsGroups.Fill, 20%)
                Icon: =ThisItem.FilterIcon
                OnSelect: |-
                    =UpdateContext({currentGroup: glrGroupTeams.Selected.drpGroupTeamGroups.Selected});
                    If(
                        glrGroupTeams.Selected.FilterVisible,
                        ClearCollect(
                            AADGroups,
                            SearchAADGroups.Run(
                                {
                                    text: glrGroupTeams.Selected.txtFilterTeamGroupGroups.Text,
                                    text_1: ""
                                }
                            ).value
                        );
                        UpdateContext(
                            {
                                lclFirstTeamAADGroup: First(
                                    Sort(
                                        AADGroups,
                                        displayName
                                    )
                                )
                            }
                        );
                        Collect(
                            AADGroups,
                            {
                                id: "",
                                displayName: ""
                            }
                        );
                        ClearCollect(
                            AADGroups,
                            Sort(
                                AADGroups,
                                displayName
                            )
                        );
                        If(
                            IsBlankOrError(lclFirstTeamAADGroup),
                            Patch(
                                GroupTeams,
                                glrGroupTeams.Selected,
                                {
                                    FilterIcon: Icon.FilterFlatFilled,
                                    AADGroups: AADGroups,
                                    FilterVisible: false,
                                    Value: currentGroup.id
                                }
                            ),
                            Patch(
                                GroupTeams,
                                glrGroupTeams.Selected,
                                {
                                    FilterIcon: Icon.FilterFlatFilled,
                                    AADGroups: AADGroups,
                                    FilterVisible: false,
                                    Value: lclFirstTeamAADGroup.id
                                }
                            );
                            Reset(drpGroupTeamGroups);
                        ),
                        Patch(
                            GroupTeams,
                            glrGroupTeams.Selected,
                            {
                                FilterIcon: Icon.Search,
                                FilterVisible: true,
                                Value: currentGroup.id
                            }
                        );
                        
                    );
                PressedBorderColor: =ColorFade(icoFilterTeamsGroups.BorderColor, -20%)
                PressedColor: =ColorFade(icoFilterTeamsGroups.Color, -20%)
                PressedFill: =ColorFade(icoFilterTeamsGroups.Fill, -20%)
                Tooltip: ="Filter this list"
                Visible: =showGroupTeamsSettings
                Width: =35
                X: =1284
                Y: =17
                ZIndex: =10

            drpGroupTeamBUs As dropdown:
                AccessibleLabel: ="App Sharing Group"
                ChevronHoverBackground: =ColorFade(drpGroupTeamBUs.ChevronBackground, 20%)
                ChevronHoverFill: =ColorFade(drpGroupTeamBUs.ChevronFill, 20%)
                Default: |-
                    =If(
                        IsBlank(ThisItem.BusinessUnitId),
                        First(ThisItem.EnvironmentBusinessUnits).name,
                        LookUp(
                            ThisItem.EnvironmentBusinessUnits,
                            Text(businessunitid) = ThisItem.BusinessUnitId
                        ).name
                    )
                Height: =46
                HoverBorderColor: =ColorFade(drpGroupTeamBUs.BorderColor, 20%)
                HoverColor: =ColorFade(drpGroupTeamBUs.Color, 20%)
                HoverFill: =ColorFade(drpGroupTeamBUs.SelectionFill, 20%)
                Items: =ThisItem.EnvironmentBusinessUnits
                OnChange: =
                OnSelect: =
                PressedBorderColor: =drpGroupTeamBUs.HoverBorderColor
                PressedColor: =drpGroupTeamBUs.Fill
                PressedFill: =drpGroupTeamBUs.Color
                Reset: =resetEnvironment
                Tooltip: ="Select an Existing AAD Group"
                Width: =280
                X: =700
                Y: =10
                ZIndex: =11

            tglSkipRoleDeletionGrpTeams As toggleSwitch:
                Default: =ThisItem.SkipRoleDeletion
                FalseFill: =Color.Red
                FalseHoverFill: =ColorFade(tglSkipRoleDeletionGrpTeams.FalseFill, 20%)
                HoverBorderColor: =ColorFade(tglSkipRoleDeletionGrpTeams.BorderColor, 20%)
                OnChange: |-
                    =Patch(
                        GroupTeams,
                        ThisItem,
                        {SkipRoleDeletion: tglSkipRoleDeletionGrpTeams.Value}
                    );
                OnSelect: =Select(Parent)
                PressedBorderColor: =ColorFade(tglSkipRoleDeletionGrpTeams.BorderColor, -20%)
                ShowLabel: =false
                Tooltip: |-
                    =If(
                        !tglSkipRoleDeletionGrpTeams.Value,
                        "You chose to delete any additional team roles that are not specified in the settings from the target.",
                        "You chose not to delete any additional team roles that are not specified in the settings from the target."
                    )
                TrueFill: =Color.Blue
                TrueHoverFill: =ColorFade(tglSkipRoleDeletionGrpTeams.TrueFill, 20%)
                Visible: =false
                X: =1685
                Y: =17
                ZIndex: =12

            chkboxSkipRoleDeletionGrpTeams As checkbox:
                Default: =ThisItem.SkipRoleDeletion
                HoverBorderColor: =ColorFade(chkboxSkipRoleDeletionGrpTeams.BorderColor, 20%)
                HoverColor: =ColorFade(chkboxSkipRoleDeletionGrpTeams.Color, 20%)
                HoverFill: =ColorFade(chkboxSkipRoleDeletionGrpTeams.Fill, 20%)
                OnCheck: |-
                    =Patch(
                        GroupTeams,
                        ThisItem,
                        {SkipRoleDeletion: chkboxSkipRoleDeletionGrpTeams.Value}
                    );
                OnSelect: =Select(Parent)
                OnUncheck: |-
                    =Patch(
                        GroupTeams,
                        ThisItem,
                        {SkipRoleDeletion: chkboxSkipRoleDeletionGrpTeams.Value}
                    );
                PressedBorderColor: =ColorFade(chkboxSkipRoleDeletionGrpTeams.BorderColor, -20%)
                PressedColor: =ColorFade(chkboxSkipRoleDeletionGrpTeams.Color, -20%)
                PressedFill: =ColorFade(chkboxSkipRoleDeletionGrpTeams.Fill, -20%)
                Text: =""
                Tooltip: |-
                    =If(
                        !chkboxSkipRoleDeletionGrpTeams.Value,
                        "You've chosen to delete any additional team roles that are not specified in the settings from the target.",
                        "You've chosen not to delete any additional team roles that are not specified in the settings from the target."
                    )
                Width: =55
                X: =1685
                Y: =5
                ZIndex: =13

        "glrWebHookURLs As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            AccessibleLabel: ="Environment Variables"
            Height: =674
            Items: =SolutionWebHookURLs
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =68
            Visible: =showWebHookURLs
            Width: =1850
            X: =24
            Y: =253
            ZIndex: =25

            lblWebHookURL As label:
                FocusedBorderThickness: =FocusedBorderThicknessValue
                FontWeight: =FontWeight.Normal
                Height: =24
                OnSelect: =ThisItem.url
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =12
                Text: =ThisItem.url
                Tooltip: =ThisItem.url
                VerticalAlign: =VerticalAlign.Top
                Width: =880
                X: =63
                Y: =37
                ZIndex: =2

            lblWebHookName As label:
                FontWeight: =FontWeight.Semibold
                Height: =Self.Size * 1.8
                OnSelect: =
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =14
                Text: =ThisItem.name
                VerticalAlign: =VerticalAlign.Top
                Width: =600
                X: =63
                Y: =14
                ZIndex: =3

            Separator3_6 As rectangle:
                BorderColor: =ColorFade(Separator3_6.Fill, -20%)
                DisabledFill: =Separator3_6.Fill
                Height: =1
                HoverFill: =ColorFade(Separator3_6.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedFill: =ColorFade(Separator3_6.Fill, -20%)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =5

            txtWebHookNewURL As text:
                AccessibleLabel: ="Environment Variable Value"
                Default: =ThisItem.CurrentValue
                HintText: ="Enter a WebHook URL Value"
                HoverBorderColor: =ColorFade(txtWebHookNewURL.BorderColor, 20%)
                HoverColor: =ColorFade(txtWebHookNewURL.Color, 20%)
                HoverFill: =ColorFade(txtWebHookNewURL.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedBorderColor: =txtWebHookNewURL.HoverBorderColor
                PressedColor: =txtWebHookNewURL.Color
                PressedFill: =txtWebHookNewURL.Fill
                Reset: =resetEnvironment
                Tooltip: ="Enter a Value for this Environment Variable in the Target Environment"
                Width: =880
                X: =943
                Y: =14
                ZIndex: =8

            Image3 As image:
                BorderColor: =ColorFade(Image3.Fill, -20%)
                Height: =58
                HoverBorderColor: =ColorFade(Image3.BorderColor, 20%)
                HoverFill: =ColorFade(Image3.Fill, 20%)
                Image: =webhook_icon_138018
                OnSelect: =Select(Parent)
                PressedBorderColor: =ColorFade(Image3.BorderColor, -20%)
                PressedFill: =ColorFade(Image3.Fill, -20%)
                Width: =58
                Y: =7
                ZIndex: =9

        "glrSDKMesages As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            AccessibleLabel: ="Environment Variables"
            Height: =653
            Items: =SolutionSDKSteps
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =178
            Visible: =showSDKMessage
            Width: =1850
            X: =24
            Y: =283
            ZIndex: =26

            lblSDKMessageName As label:
                FontWeight: =FontWeight.Semibold
                Height: =51
                OnSelect: =
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =12
                Text: =ThisItem.name
                VerticalAlign: =VerticalAlign.Top
                Width: =453
                X: =63
                Y: =14
                ZIndex: =3

            Separator3_7 As rectangle:
                BorderColor: =ColorFade(Separator3_7.Fill, -20%)
                DisabledFill: =Separator3_7.Fill
                Height: =1
                HoverFill: =ColorFade(Separator3_7.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedFill: =ColorFade(Separator3_7.Fill, -20%)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =5

            txtUnsecuredConfig As text:
                AccessibleLabel: ="Environment Variable Value"
                Default: =ThisItem.UnsecureConfig
                Height: =160
                HintText: ="Enter unsecured configuration"
                HoverBorderColor: =ColorFade(txtUnsecuredConfig.BorderColor, 20%)
                HoverColor: =ColorFade(txtUnsecuredConfig.Color, 20%)
                HoverFill: =ColorFade(txtUnsecuredConfig.Fill, 20%)
                Mode: =TextMode.MultiLine
                OnSelect: =Select(Parent)
                PressedBorderColor: =txtUnsecuredConfig.HoverBorderColor
                PressedColor: =txtUnsecuredConfig.Color
                PressedFill: =txtUnsecuredConfig.Fill
                Reset: =resetEnvironment
                Tooltip: ="Enter a Value for this Environment Variable in the Target Environment"
                Width: =628
                X: =558
                Y: =7
                ZIndex: =8

            imgSDKSteps As image:
                BorderColor: =ColorFade(imgSDKSteps.Fill, -20%)
                Height: =58
                HoverBorderColor: =ColorFade(imgSDKSteps.BorderColor, 20%)
                HoverFill: =ColorFade(imgSDKSteps.Fill, 20%)
                Image: =webhook_icon_138018
                OnSelect: =Select(Parent)
                PressedBorderColor: =ColorFade(imgSDKSteps.BorderColor, -20%)
                PressedFill: =ColorFade(imgSDKSteps.Fill, -20%)
                Width: =58
                Y: =7
                ZIndex: =9

            txtSecuredConfig As text:
                AccessibleLabel: ="Environment Variable Value"
                Default: =ThisItem.SecureConfig
                Height: =160
                HintText: ="Enter secured configuration"
                HoverBorderColor: =ColorFade(txtSecuredConfig.BorderColor, 20%)
                HoverColor: =ColorFade(txtSecuredConfig.Color, 20%)
                HoverFill: =ColorFade(txtSecuredConfig.Fill, 20%)
                Mode: =TextMode.MultiLine
                OnSelect: =Select(Parent)
                PressedBorderColor: =txtSecuredConfig.HoverBorderColor
                PressedColor: =txtSecuredConfig.Color
                PressedFill: =txtSecuredConfig.Fill
                Reset: =resetEnvironment
                Tooltip: ="Enter a Value for this Environment Variable in the Target Environment"
                Width: =628
                X: =1205
                Y: =7
                ZIndex: =10

            lblsdkstepid As label:
                Height: =49
                OnSelect: =Select(Parent)
                Text: =ThisItem.ItemInternalId
                Visible: =false
                Width: =407
                X: =58
                Y: =128
                ZIndex: =12

        lblDeployAppGroupSharing As label:
            FontWeight: =FontWeight.Semibold
            Height: =37
            OnSelect: =FontWeight.Semibold
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Sharing"
            Visible: =showSharingSettings && !IsEmpty(glrCanvasApps.AllItems)
            Width: =182
            X: =732
            Y: =249
            ZIndex: =27

        lblDeployAppPermission As label:
            FontWeight: =FontWeight.Semibold
            Height: =37
            OnSelect: =FontWeight.Semibold
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Permissions"
            Visible: =showSharingSettings && !IsEmpty(glrCanvasApps.AllItems)
            Width: =182
            X: =1583
            Y: =249
            ZIndex: =28

        btnSaveDeployment As button:
            Height: =45
            HoverBorderColor: =ColorFade(btnSaveDeployment.BorderColor, 20%)
            HoverColor: =ColorFade(btnSaveDeployment.Color, 20%)
            HoverFill: =ColorFade(btnSaveDeployment.Fill, 20%)
            OnSelect: |
                =UpdateContext({PreviousSaveButtonText: SaveDeploymentButtonText});
                UpdateContext({SaveDeploymentButtonText: "SAVING..."});
                //Save Deployment Settings
                UpdateContext(
                    {
                        showSolutionComponentLoader: true,
                        DeploymentSettingsLoadingText: "SHARING AND SAVING DEPLOYMENT SETTINGS",
                        SolutionLoaderText: "SHARING AND SAVING DEPLOYMENT SETTINGS"
                    }
                );
                Clear(DeploymentSettings);
                UpdateContext(
                    {
                        lclServiceConnectionName: If(
                            IsBlankOrError(SelectedConfigurationDeploymentProfile.'Service Connection Name'),
                            SelectedDeploymentEnvironment.EnvironmentUrl,
                            SelectedConfigurationDeploymentProfile.'Service Connection Name'
                        )
                    }
                );
                UpdateContext(
                    {
                        lclServiceConnectionAppId: First(
                            Filter(
                                CustomAzureDevOps.GetServiceEndpoints(
                                    SelectedConfigurationDeploymentProfile.Organization,
                                    SelectedConfigurationDeploymentProfile.Project
                                ).value,
                                name = lclServiceConnectionName
                            )
                        ).authorization.parameters.applicationId
                    }
                );
                //Save Connection References
                ForAll(
                    glrConnectionReferences.AllItems,
                    If(
                        !IsBlankOrError(drpConnectionReferenceConnections.Selected.ConnectionId),
                        If(
                            !IsBlankOrError(lclServiceConnectionAppId) And chkShareConnection.Value And drpConnectionReferenceConnections.Selected.Status <> "Unknown" And locShareConnections,
                            ShareConnectionWithServicePrincipal.Run(
                                lclServiceConnectionAppId,
                                SelectedDeploymentEnvironment.EnvironmentId,
                                drpConnectionReferenceConnections.Selected.ApiId,
                                drpConnectionReferenceConnections.Selected.ConnectionId,
                                "CanView"
                            )
                        );
                        Collect(
                            DeploymentSettings,
                            {
                                Name: "connectionreference." & connectionreferencelogicalname,
                                Value: If(
                                    IsBlank(drpConnectionReferenceConnections.Selected) And drpConnectionReferenceConnections.Visible,
                                    "",
                                    If(ManualEntry, txtConnectionId.Text, drpConnectionReferenceConnections.Selected.ConnectionId)
                                ),
                                Data: connectorid
                            }
                        );
                        Collect(
                            DeploymentSettings,
                            {
                                Name: "connectionreference.user." & connectionreferencelogicalname,
                                Value: If(
                                    IsBlank(drpConnectionReferenceConnections.Selected),
                                    "",
                                    drpConnectionReferenceConnections.Selected.UserId
                                )
                            }
                        );
                        Collect(
                            DeploymentSettings,
                            {
                                Name: "connectionreference.shared." & connectionreferencelogicalname,
                                Value: If(
                                    IsBlank(drpConnectionReferenceConnections.Selected),
                                    "",
                                    chkShareConnection.Value
                                )
                            }
                        ),
                        Collect(
                            DeploymentSettings,
                            LookUp(
                                EnvironmentDeploymentSettings,
                                Name = "connectionreference." & connectionreferencelogicalname
                            )
                        );
                        Collect(
                            DeploymentSettings,
                            LookUp(
                                EnvironmentDeploymentSettings,
                                Name = "connectionreference.user." & connectionreferencelogicalname
                            )
                        );
                        Collect(
                            DeploymentSettings,
                            LookUp(
                                EnvironmentDeploymentSettings,
                                Name = "connectionreference.shared." & connectionreferencelogicalname
                            )
                        )
                    )
                );
                //Save Envrionment Variables
                ForAll(
                    glrEnvironmentVariables.AllItems,
                    Collect(
                        DeploymentSettings,
                        {
                            Name: "environmentvariable." & schemaname,
                            Value: If(
                                type = 100000004 && apiid = "/providers/microsoft.powerapps/apis/shared_sharepointonline",
                                If(
                                    parameterkey = "dataset",
                                    drpSharepointSites.Selected.webUrl,
                                    drpSharepointLists.Selected.id
                                ),
                                txtWebHoosURL.Text
                            ),
                            Data: Text(type)
                        }
                    )
                );
                //Save Web Hook URLs
                ForAll(
                    glrWebHookURLs.AllItems,
                    Collect(
                        DeploymentSettings,
                        {
                            Name: "webhookurl." & name,
                            Value: txtWebHookNewURL.Text
                        }
                    )
                );
                //Save SDK Steps
                ForAll(
                    glrSDKMesages.AllItems,
                    Collect(
                        DeploymentSettings,
                        {
                            Name: "sdkstep.unsec." & lblsdkstepid.Text,
                            Value: txtUnsecuredConfig.Text
                        },
                        {
                            Name: "sdkstep.sec." & lblsdkstepid.Text,
                            Value: txtSecuredConfig.Text
                        }
                    )
                );
                //Save Canvas App Sharing
                ForAll(
                    glrCanvasApps.AllItems,
                    Collect(
                        DeploymentSettings,
                        {
                            Name: "canvasshare.aadGroupId." & name & Suffix,
                            Value: drpCanvasAppShareGroups.Selected.id
                        },
                        {
                            Name: "canvasshare.roleName." & name & Suffix,
                            Value: drpCanvasAppSharePermission.Selected.Value
                        }
                    )
                );
                //Save Flow Ownership
                ForAll(
                    glrFlows.AllItems,
                    Collect(
                        DeploymentSettings,
                        {
                            Name: "owner.ownerEmail." & Substitute(
                                name,
                                " ",
                                ""
                            ) & "." & workflowid,
                            Value: txtFlowOwnerUsers.Text
                        },
                        {
                            Name: "flow.sharing." & Substitute(
                                name,
                                " ",
                                ""
                            ) & "." & workflowid,
                            Value: drpFlowShareGroupTeams.Selected.name
                        },
                        {
                            Name: "activateflow.order." & Substitute(
                                name,
                                " ",
                                ""
                            ) & "." & workflowid,
                            Value: SortOrder
                        },
                        {
                            Name: "activateflow.activate." & Substitute(
                                name,
                                " ",
                                ""
                            ) & "." & workflowid,
                            Value: Text(chkActivateFlow.Value)
                        }
                    )
                );
                //Save Group Teams
                ForAll(
                    glrGroupTeams.AllItems,
                    Collect(
                        DeploymentSettings,
                        {
                            Name: "groupTeam." & Id & "." & txtGroupTeamName.Text,
                            Value: drpGroupTeamGroups.Selected.id,
                            Data: Concat(
                                cmbGroupTeamRoles.SelectedItems,
                                ThisRecord.Result,
                                ","
                            )
                        }
                    );
                    Collect(
                        DeploymentSettings,
                        {
                            Name: "businessUnit." & Id & "." & txtGroupTeamName.Text,
                            Value: drpGroupTeamBUs.Selected.businessunitid
                        }
                    );
                    Collect(
                        DeploymentSettings,
                        {
                            Name: "teamnameskiproles." & Id & "." & txtGroupTeamName.Text,
                            Value: Text(chkboxSkipRoleDeletionGrpTeams.Value)
                        }
                    );
                    Collect(
                        DeploymentSettings,
                        {
                            Name: "teamname." & Id,
                            Value: txtGroupTeamName.Text
                        }
                    )
                );
                ForAll(
                    glrCustomConnectors.AllItems,
                    Collect(
                        DeploymentSettings,
                        {
                            Name: "connector.teamname." & Substitute(
                                displayname,
                                " ",
                                ""
                            ) & "." & connectorid,
                            Value: drpConnectorShareGroupTeams.Selected.name
                        }
                    )
                );
                Collect(
                    DeploymentSettings,
                    {
                        Name: "TriggerSolutionUpgrade",
                        Value: Text(chkUpgradeSolution.Value)
                    }
                );
                
                //Convert settings to json and store in user settings
                UpdateContext({locSolutionEnvironmentDeploySettingName: DeploymentSettingName & " - " & glrSolutions.Selected.uniquename & " - " & SelectedDeploymentEnvironment.EnvironmentUrl});
                // Store 'UserSettings' ID to read Portal configuration file during Commit process
                Collect(
                    DeploymentSettings,
                    {
                        Name: "UserSettingId",
                        Value: LookUp(
                            'User Settings',
                            Name = locSolutionEnvironmentDeploySettingName
                        ).'User Setting'
                    }
                );
                UpdateContext({settingsJsonText: JSON(DeploymentSettings, JSONFormat.IndentFour)});
                UpdateContext(
                    {
                        locEnvironmentDeploymentSetting: LookUp(
                            'User Settings',
                            Name = locSolutionEnvironmentDeploySettingName
                        )
                    }
                );
                If(
                    IsBlank(locEnvironmentDeploymentSetting),// create it if we don't have one
                    Patch(
                        'User Settings',
                        {
                            'App User Setting': AppUserSetting,
                            Name: locSolutionEnvironmentDeploySettingName,
                            Data: settingsJsonText
                        }
                    ),
                    Patch(
                        'User Settings',
                        locEnvironmentDeploymentSetting,
                        {Data: settingsJsonText}
                    );
                    Patch(
                        AppUserSetting_UserSettings,
                        locEnvironmentDeploymentSetting,
                        {Data: settingsJsonText}
                    )
                );
                If(
                    locCloseAfterSave && !IsBlankOrError(ReturnScreen),
                    Navigate(
                        ReturnScreen,
                        ScreenTransition.Fade
                    ),
                    Select(fncLoadEnvironmentDeploymentSettings)
                );
                UpdateContext(
                    {
                        locCloseAfterSave: true,
                        locShareConnections: true,
                        SaveDeploymentButtonText: PreviousSaveButtonText
                    }
                );
                Reset(chkShareAllConnections);
            PressedBorderColor: =btnSaveDeployment.Fill
            PressedColor: =btnSaveDeployment.Fill
            PressedFill: =btnSaveDeployment.Color
            Text: =SaveDeploymentButtonText
            Tooltip: ="Save the Current Environment's Deployment Configuration"
            Visible: =IsBlankOrError(ReturnScreen) Or !IsBlankOrError(SaveDeploymentButtonText)
            Width: =240
            X: =1644
            Y: =1003
            ZIndex: =29

        lblDeployConnectionReferences As label:
            FontWeight: =If(showConnectionReferenceSettings, FontWeight.Bold, FontWeight.Semibold)
            Height: =45
            OnSelect: =
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Connection References"
            Width: =210
            X: =28
            Y: =208
            ZIndex: =30

        icoRefreshConnections As icon.Add:
            AccessibleLabel: ="Refresh"
            BorderColor: =ColorFade(icoRefreshConnections.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledColor: =ColorFade(icoRefreshConnections.Color, 50%)
            DisabledFill: =ColorFade(icoRefreshConnections.Fill, -80%)
            Height: =42
            HoverBorderColor: =ColorFade(icoRefreshConnections.BorderColor, 20%)
            HoverColor: =ColorFade(icoRefreshConnections.Color, 20%)
            HoverFill: =ColorFade(icoRefreshConnections.Fill, 20%)
            Icon: =Icon.Reload
            OnSelect: |+
                =UpdateContext({locCloseAfterSave: false, locShareConnections: false});
                Select(btnSaveDeployment);
                //Select(fncLoadEnvironmentDeploymentSettings);
                
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =5
            PaddingTop: =8
            PressedBorderColor: =ColorFade(icoRefreshConnections.BorderColor, -20%)
            PressedColor: =ColorFade(icoRefreshConnections.Color, -20%)
            PressedFill: =ColorFade(icoRefreshConnections.Fill, -20%)
            Tooltip: ="Refresh Connections"
            Visible: =showConnectionReferenceSettings And CountRows(SolutionConnectionReferences) > 0
            Width: =42
            X: =1793
            Y: =349
            ZIndex: =31

        lblNoResults As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Height: =45
            PaddingLeft: =0
            PaddingTop: =0
            Text: |-
                =If(
                    glrCanvasApps.Visible,
                    "There are no canvas apps in this solution",
                    If(
                        glrConnectionReferences.Visible,
                        "There are no connnection references in this solution",
                        If(
                            glrEnvironmentVariables.Visible,
                            "There are no environment variables in this solution",
                            If(
                                glrCustomConnectors.Visible,
                                "There are no custom connectors in this solution",
                                If(
                                    glrFlows.Visible,
                                    "There are no flows in this solution",
                                    If(
                                        glrGroupTeams.Visible,
                                        "Select + to create a new dataverse team to sync with an Azure AD security group (optional). ",
                                        glrWebHookURLs.Visible,
                                        "There are no webhooks in this solution",
                                        glrSDKMesages.Visible,
                                        "There are no plugin steps in this solution"                        
                                    )
                                )
                            )
                        )
                    )
                )
            Visible: =(IsEmpty(glrCanvasApps.AllItems) && glrCanvasApps.Visible) || (IsEmpty(glrConnectionReferences.AllItems) && glrConnectionReferences.Visible) || (IsEmpty(glrEnvironmentVariables.AllItems) && glrEnvironmentVariables.Visible) || (IsEmpty(glrCustomConnectors.AllItems) && glrCustomConnectors.Visible) || (IsEmpty(glrGroupTeams.AllItems) && glrGroupTeams.Visible) || (IsEmpty(glrFlows.AllItems) && glrFlows.Visible) || (IsEmpty(glrWebHookURLs.AllItems) && glrWebHookURLs.Visible || (IsEmpty(glrSDKMesages.AllItems) && glrSDKMesages.Visible))
            Width: =600
            X: =653
            Y: =476
            ZIndex: =32

        lblDeployGroupTeamName As label:
            FontWeight: =FontWeight.Semibold
            Height: =37
            OnSelect: =FontWeight.Semibold
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Team Name"
            Visible: =showGroupTeamsSettings && !IsEmpty(glrGroupTeams.AllItems)
            Width: =182
            X: =484
            Y: =249
            ZIndex: =33

        lblDeployGroupTeamRoles As label:
            FontWeight: =FontWeight.Semibold
            Height: =37
            OnSelect: =FontWeight.Semibold
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Roles"
            Visible: =showGroupTeamsSettings && !IsEmpty(glrGroupTeams.AllItems)
            Width: =182
            X: =1481
            Y: =249
            ZIndex: =34

        lblDeployGroupTeamGroup As label:
            FontWeight: =FontWeight.Semibold
            Height: =37
            OnSelect: =FontWeight.Semibold
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="AAD Group"
            Visible: =showGroupTeamsSettings && !IsEmpty(glrGroupTeams.AllItems)
            Width: =182
            X: =1106
            Y: =249
            ZIndex: =35

        lblDeployConnectorTeamSharing As label:
            FontWeight: =FontWeight.Semibold
            Height: =37
            OnSelect: =FontWeight.Semibold
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Sharing"
            Visible: =showConnectorSettings && !IsEmpty(glrCustomConnectors.AllItems)
            Width: =182
            X: =1006
            Y: =251
            ZIndex: =36

        lblDeployFlowActivateAs As label:
            FontWeight: =FontWeight.Semibold
            Height: =37
            OnSelect: =
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Activation User"
            Tooltip: ="Allows for overriding of the user who will activate the flow in the target environment. By default activation will happen by either the user who owns the flow or by a user who created any connection references used by the flow."
            Visible: =false//showOwnerSettings && !IsEmpty(glrFlows.AllItems)
            Width: =182
            X: =1299
            Y: =249
            ZIndex: =37

        lblDeployFlowsActivateAll As label:
            Align: =Align.Center
            FontWeight: =If(showGroupTeamsSettings, FontWeight.Bold, FontWeight.Semibold)
            Height: =45
            OnSelect: =
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Flows to Activate And Order"
            Visible: =showOwnerSettings && !IsEmpty(glrFlows.AllItems)
            Width: =173
            X: =1658
            Y: =241
            ZIndex: =38

        icoAddNewGroupTeam As icon.Add:
            AccessibleLabel: ="Refresh"
            BorderColor: =ColorFade(icoAddNewGroupTeam.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledColor: =ColorFade(icoAddNewGroupTeam.Color, 50%)
            DisabledFill: =ColorFade(icoAddNewGroupTeam.Fill, -80%)
            Height: =45
            HoverBorderColor: =ColorFade(icoAddNewGroupTeam.BorderColor, 20%)
            HoverColor: =ColorFade(icoAddNewGroupTeam.Color, 20%)
            HoverFill: =ColorFade(icoAddNewGroupTeam.Fill, 20%)
            Icon: =Icon.Add
            OnSelect: |
                =UpdateContext({NewGroupTeamId: Text(GUID())});
                Collect(
                    GroupTeams,
                    {
                        Name: "",
                        DisplayName: "",
                        Value: "",
                        Id: NewGroupTeamId,
                        EnvironmentBusinessUnits: EnvironmentBusinessUnits,
                        AADGroups: TeamAADGroups,
                        DisplayMode: DisplayMode.Edit,
                        FilterVisible: false,
                        FilterIcon: Icon.FilterFlat,
                        SkipRoleDeletion: true
                    }
                );
                Collect(
                    EnvironmentTeams,
                    {
                        name: "",
                        teamid: NewGroupTeamId
                    }
                );
                ClearCollect(
                    EnvironmentTeams,
                    Sort(
                        EnvironmentTeams,
                        name
                    )
                );
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =5
            PaddingTop: =8
            PressedBorderColor: =ColorFade(icoAddNewGroupTeam.BorderColor, -20%)
            PressedColor: =ColorFade(icoAddNewGroupTeam.Color, -20%)
            PressedFill: =ColorFade(icoAddNewGroupTeam.Fill, -20%)
            Tooltip: ="Add New Group Team"
            Visible: =showGroupTeamsSettings
            Width: =45
            X: =1822
            Y: =206
            ZIndex: =39

        chkUpgradeSolution As checkbox:
            Default: =If(solutionupgradetag="true",true,false)
            FontWeight: =FontWeight.Semibold
            Height: =46
            HoverBorderColor: =ColorFade(chkUpgradeSolution.BorderColor, 20%)
            HoverColor: =ColorFade(chkUpgradeSolution.Color, 20%)
            HoverFill: =ColorFade(chkUpgradeSolution.Fill, 20%)
            PressedBorderColor: =ColorFade(chkUpgradeSolution.BorderColor, -20%)
            PressedColor: =ColorFade(chkUpgradeSolution.Color, -20%)
            PressedFill: =ColorFade(chkUpgradeSolution.Fill, -20%)
            Text: ="Upgrade Solution"
            Tooltip: ="If components have been removed that already exist in the target environment, select Upgrade Solution to ensure they are removed in the target environment."
            Visible: =!showSolutionComponentLoader
            Width: =219
            X: =1658
            Y: =137
            ZIndex: =40

        lblDeployGroupTeamBU As label:
            FontWeight: =FontWeight.Semibold
            Height: =37
            OnSelect: =FontWeight.Semibold
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Business Unit"
            Visible: =showGroupTeamsSettings && !IsEmpty(glrGroupTeams.AllItems)
            Width: =182
            X: =796
            Y: =249
            ZIndex: =41

        icoDeployConnectionReferences As icon.Add:
            AccessibleLabel: ="Connection References"
            BorderColor: =ColorFade(icoDeployConnectionReferences.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledFill: =ColorFade(icoDeployConnectionReferences.Fill, -80%)
            FocusedBorderThickness: =
            Height: =49
            HoverBorderColor: =ColorFade(icoDeployConnectionReferences.BorderColor, 20%)
            HoverColor: =ColorFade(icoDeployConnectionReferences.Color, 20%)
            HoverFill: =ColorFade(icoDeployConnectionReferences.Fill, 20%)
            Icon: =
            OnSelect: |
                =UpdateContext(
                    {
                        showConnectionReferenceSettings: true,
                        showEnvironmentVariablesSettings: false,
                        showOwnerSettings: false,
                        showSharingSettings: false,
                        showConnectorSettings: false,
                        showGroupTeamsSettings: false,
                        showWebHookURLs: false,
                        showPortalConfig: false,
                        showSDKMessage: false
                    }
                );
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =5
            PaddingTop: =8
            PressedBorderColor: =ColorFade(icoDeployConnectionReferences.BorderColor, -20%)
            PressedColor: =ColorFade(icoDeployConnectionReferences.Color, -20%)
            PressedFill: =ColorFade(icoDeployConnectionReferences.Fill, -20%)
            Tooltip: ="Set Connection References for the Target Environment"
            Width: =200
            X: =24
            Y: =204
            ZIndex: =42

        icoDeployEnvironmentVariables As icon.Add:
            AccessibleLabel: ="Environment Variables"
            BorderColor: =ColorFade(icoDeployEnvironmentVariables.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledFill: =ColorFade(icoDeployEnvironmentVariables.Fill, -80%)
            FocusedBorderThickness: =
            Height: =49
            HoverBorderColor: =ColorFade(icoDeployEnvironmentVariables.BorderColor, 20%)
            HoverColor: =ColorFade(icoDeployEnvironmentVariables.Color, 20%)
            HoverFill: =ColorFade(icoDeployEnvironmentVariables.Fill, 20%)
            Icon: =
            OnSelect: |
                =UpdateContext(
                    {
                        showConnectionReferenceSettings: false,
                        showEnvironmentVariablesSettings: true,
                        showOwnerSettings: false,
                        showSharingSettings: false,
                        showConnectorSettings: false,
                        showGroupTeamsSettings: false,
                        showWebHookURLs: false,
                        showPortalConfig: false,
                        showSDKMessage: false        
                    }
                );
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =5
            PaddingTop: =8
            PressedBorderColor: =ColorFade(icoDeployEnvironmentVariables.BorderColor, -20%)
            PressedColor: =ColorFade(icoDeployEnvironmentVariables.Color, -20%)
            PressedFill: =ColorFade(icoDeployEnvironmentVariables.Fill, -20%)
            Tooltip: ="Set Environment Variable Values for the Target Environment"
            Width: =200
            X: =236
            Y: =204
            ZIndex: =43

        icoDeploySharing As icon.Add:
            AccessibleLabel: ="Sharing"
            BorderColor: =ColorFade(icoDeploySharing.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledFill: =ColorFade(icoDeploySharing.Fill, -80%)
            FocusedBorderThickness: =
            Height: =49
            HoverBorderColor: =ColorFade(icoDeploySharing.BorderColor, 20%)
            HoverColor: =ColorFade(icoDeploySharing.Color, 20%)
            HoverFill: =ColorFade(icoDeploySharing.Fill, 20%)
            Icon: =
            OnSelect: |
                =UpdateContext(
                    {
                        showConnectionReferenceSettings: false,
                        showEnvironmentVariablesSettings: false,
                        showOwnerSettings: false,
                        showSharingSettings: true,
                        showConnectorSettings: false,
                        showGroupTeamsSettings: false,
                        showWebHookURLs: false,
                        showPortalConfig: false,
                        showSDKMessage: false        
                    }
                );
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =5
            PaddingTop: =8
            PressedBorderColor: =ColorFade(icoDeploySharing.BorderColor, -20%)
            PressedColor: =ColorFade(icoDeploySharing.Color, -20%)
            PressedFill: =ColorFade(icoDeploySharing.Fill, -20%)
            Tooltip: ="Set Sharing Configuration for the Target Environment"
            Width: =120
            X: =439
            Y: =204
            ZIndex: =44

        lblDeploymentSettingsNote As label:
            Align: =Align.Center
            Color: =RGBA(0, 0, 0, 1)
            FontWeight: =FontWeight.Semibold
            Height: =30
            HoverColor: =RGBA(0, 0, 0, 1)
            PaddingLeft: =0
            PaddingTop: =0
            Size: =12
            Text: |-
                ="NOTE: Changes made to the deployment settings requires you to run " & promoteSolutionLabel & " again to update the deployment."
            Tooltip: ="""Changes made to the deployment settings requires you to run "" & promoteSolutionLabel & "" again to update the deployment."""
            VerticalAlign: =VerticalAlign.Bottom
            Width: =1010
            X: =444
            Y: =1010
            ZIndex: =45

        lblDeployPluginWebHooks As label:
            FontWeight: =If(showWebHookURLs, FontWeight.Bold, FontWeight.Semibold)
            Height: =45
            OnSelect: =
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="WebHooks"
            Width: =210
            X: =936
            Y: =208
            ZIndex: =46

        icoPluginWebHooks As icon.Add:
            AccessibleLabel: ="Webhook URL Variables"
            BorderColor: =ColorFade(icoPluginWebHooks.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledFill: =ColorFade(icoPluginWebHooks.Fill, -80%)
            FocusedBorderThickness: =
            Height: =49
            HoverBorderColor: =ColorFade(icoPluginWebHooks.BorderColor, 20%)
            HoverColor: =ColorFade(icoPluginWebHooks.Color, 20%)
            HoverFill: =ColorFade(icoPluginWebHooks.Fill, 20%)
            Icon: =
            OnSelect: |
                =UpdateContext(
                    {
                        showConnectionReferenceSettings: false,
                        showEnvironmentVariablesSettings: false,
                        showOwnerSettings: false,
                        showSharingSettings: false,
                        showConnectorSettings: false,
                        showGroupTeamsSettings: false,
                        showWebHookURLs: true,
                        showPortalConfig: false,
                        showSDKMessage: false        
                    }
                );
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =5
            PaddingTop: =8
            PressedBorderColor: =ColorFade(icoPluginWebHooks.BorderColor, -20%)
            PressedColor: =ColorFade(icoPluginWebHooks.Color, -20%)
            PressedFill: =ColorFade(icoPluginWebHooks.Fill, -20%)
            Tooltip: ="Set WebHook URL Values for the Target Environment"
            Width: =100
            X: =936
            Y: =195
            ZIndex: =47

        lblShareConnectionsNote As label:
            Align: =Align.Center
            BorderThickness: =1
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(219, 219, 219, 1)
            FontWeight: =FontWeight.Semibold
            Height: =60
            HoverColor: =RGBA(0, 0, 0, 1)
            PaddingLeft: =0
            PaddingTop: =7
            Size: =14
            Text: ="In order for your solution to be deployed successfully your connection(s) must be shared with the deployment user. Select 'Share' to agree to share your connection(s) before saving your deployment settings."
            Tooltip: =" Your deployment settings contain connection reference(s). In order for your solution to be deployed successfully your connection(s) must be shared with the deployment user. Select 'Share' to agree to share your connection(s) before saving your deployment settings."
            Visible: =showConnectionReferenceSettings And CountRows(SolutionConnectionReferences) > 0
            Width: =1790
            X: =33
            Y: =265
            ZIndex: =48

        lblShareConnectionsNote_1 As label:
            Align: =Align.Center
            BorderThickness: =1
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(219, 219, 219, 1)
            FontWeight: =FontWeight.Semibold
            Height: =60
            HoverColor: =RGBA(0, 0, 0, 1)
            PaddingLeft: =0
            PaddingTop: =0
            Size: =14
            Text: =""
            Tooltip: =" Your deployment settings contain connection reference(s). In order for your solution to be deployed successfully your connection(s) must be shared with the deployment user. Select 'Share' to agree to share your connection(s) before saving your deployment settings."
            Visible: =showConnectionReferenceSettings And CountRows(SolutionConnectionReferences) > 0
            Width: =62
            X: =1822
            Y: =265
            ZIndex: =49

        icoConnectionSharingHelp As icon.Help:
            BorderColor: =ColorFade(icoConnectionSharingHelp.Fill, -20%)
            DisabledFill: =ColorFade(icoConnectionSharingHelp.Fill, -80%)
            Height: =23
            HoverBorderColor: =ColorFade(icoConnectionSharingHelp.BorderColor, 20%)
            HoverColor: =ColorFade(icoConnectionSharingHelp.Color, 20%)
            HoverFill: =ColorFade(icoConnectionSharingHelp.Fill, 20%)
            Icon: =Icon.Help
            OnSelect: |-
                =Launch(
                        "https://learn.microsoft.com/power-apps/maker/data-platform/create-connection-reference#enabling-flows-containing-connections-from-another-user"
                    );
            PressedBorderColor: =ColorFade(icoConnectionSharingHelp.BorderColor, -20%)
            PressedColor: =ColorFade(icoConnectionSharingHelp.Color, -20%)
            PressedFill: =ColorFade(icoConnectionSharingHelp.Fill, -20%)
            Tooltip: ="Learn More"
            Visible: =showConnectionReferenceSettings And CountRows(SolutionConnectionReferences) > 0
            Width: =23
            X: =1842
            Y: =285
            ZIndex: =50

        chkShareAllConnections As checkbox:
            FontWeight: =FontWeight.Semibold
            Height: =46
            HoverBorderColor: =ColorFade(chkShareAllConnections.BorderColor, 20%)
            HoverColor: =ColorFade(chkShareAllConnections.Color, 20%)
            HoverFill: =ColorFade(chkShareAllConnections.Fill, 20%)
            OnCheck: |
                =ForAll(
                    glrConnectionReferences.AllItems,
                    If (
                        drpConnectionReferenceConnections.Selected.Status = "Connected",
                        Patch(
                            SolutionConnectionReferences,
                            ThisRecord,
                            {
                                Shared: true,
                                CurrentValue: If(
                                    IsBlankOrError(drpConnectionReferenceConnections.Selected.ConnectionId),
                                    "",
                                    drpConnectionReferenceConnections.Selected.ConnectionId
                                )
                            }
                        )
                    )
                );
            OnSelect: =true
            OnUncheck: |
                =ForAll(
                    glrConnectionReferences.AllItems,
                    If (
                        drpConnectionReferenceConnections.Selected.Status = "Connected",
                        Patch(
                            SolutionConnectionReferences,
                            ThisRecord,
                            {Shared: false}
                        )
                    )
                );
            PressedBorderColor: =ColorFade(chkShareAllConnections.BorderColor, -20%)
            PressedColor: =ColorFade(chkShareAllConnections.Color, -20%)
            PressedFill: =ColorFade(chkShareAllConnections.Fill, -20%)
            Text: ="Share All"
            Tooltip: ="Connections specified in the connection reference tab are required to be shared with the pipeline user that deploys the solution. You must consent to sharing connections in order to deploy your solution with connection references."
            Visible: =showConnectionReferenceSettings And CountRows(SolutionConnectionReferences) > 0
            Width: =219
            X: =1538
            Y: =345
            ZIndex: =51

        verticalContainerPortalSettings As groupContainer.verticalAutoLayoutContainer:
            Height: =290
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMode: =LayoutMode.Auto
            Visible: =showPortalConfig
            Width: =1854
            X: =glrWebHookURLs.X
            Y: =glrWebHookURLs.Y
            ZIndex: =52

            formUserSettings As form:
                DataSource: ='User Settings'
                FillPortions: =0
                Height: =200
                Item: =locEnvironmentDeploymentSetting
                LayoutMinHeight: =250
                LayoutMinWidth: =400
                NumberOfColumns: =1
                Visible: =showPortalConfig && !(IsBlank(locEnvironmentDeploymentSetting))
                Width: =1882
                X: =glrWebHookURLs.X
                Y: =glrWebHookURLs.Y
                ZIndex: =1

                "'Portal Setting File_DataCard1' As typedDataCard.fileEditCard":
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="cat_portalsettingfile"
                    Default: |-
                        =If(
                            !IsBlank(ThisItem.'Portal Setting File'.FileName),    
                            Table(
                                {
                                    DisplayName: ThisItem.'Portal Setting File'.FileName,
                                    Value: ThisItem.'Portal Setting File'.FileName
                                }
                            ),
                            Blank()
                        )
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@'User Settings'],DataSourceInfo.DisplayName,"cat_portalsettingfile")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =50
                    Required: =false
                    Update: =PortalSettingsFileValue.Attachments
                    Width: =1882
                    X: =0
                    Y: =0
                    ZIndex: =1

                    DataCardKey1 As label:
                        AutoHeight: =true
                        FontWeight: =FontWeight.Semibold
                        Height: =34
                        Text: ="Site Settings File"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    PortalSettingsFileValue As attachments:
                        AddAttachmentText: ="Choose a settings file"
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        BorderThickness: =1
                        DisplayMode: =Parent.DisplayMode
                        DropTargetBorderThickness: =1
                        Height: =120
                        HoverColor: =ColorFade(PortalSettingsFileValue.Color, 20%)
                        HoverFill: =ColorFade(PortalSettingsFileValue.Fill, 20%)
                        IsInDataCard: =true
                        ItemFill: =Color.Transparent
                        ItemHoverColor: =Color.Gray
                        ItemHoverFill: =ColorFade(PortalSettingsFileValue.ItemFill, 20%)
                        Items: =Parent.Default
                        MaxAttachments: =1
                        MaxAttachmentSize: =5
                        MaxAttachmentsText: =""
                        NoAttachmentsColor: =PortalSettingsFileValue.Color
                        NoAttachmentsText: ="No settings file selected"
                        OnAddFile: |-
                            =If(
                                Not(
                                    EndsWith(
                                        First(Self.Attachments).Name,
                                        ".yml"
                                    )
                                ),    
                                    // Clear the attached file
                                Reset(Self);
                                Notify(
                                    "Only a file with '.yml' extension is allowed.",
                                    NotificationType.Error
                                );
                                
                            )
                        OnRemoveFile: |
                            =If(
                                !IsBlank(locEnvironmentDeploymentSetting.'Portal Setting File'.FileName),
                                SubmitForm(formUserSettings);
                                Notify("File has been deleted successfully.");
                                ,
                                ""
                            );
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        Tooltip: ="Only .yml file types are allowed up to 5MB."
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardKey1.Y + DataCardKey1.Height + 5
                        ZIndex: =2

                    ErrorMessage1 As label:
                        AutoHeight: =true
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =PortalSettingsFileValue.Y + PortalSettingsFileValue.Height
                        ZIndex: =3

                    StarVisible1 As label:
                        Align: =Align.Center
                        Height: =DataCardKey1.Height
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey1.Y
                        ZIndex: =4

                    iconPortalSettingsHelp As icon.Help:
                        BorderColor: =ColorFade(iconPortalSettingsHelp.Fill, -20%)
                        DisabledFill: =ColorFade(iconPortalSettingsHelp.Fill, -80%)
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =26
                        HoverBorderColor: =ColorFade(iconPortalSettingsHelp.BorderColor, 20%)
                        HoverColor: =ColorFade(iconPortalSettingsHelp.Color, 20%)
                        HoverFill: =ColorFade(iconPortalSettingsHelp.Fill, 20%)
                        Icon: =Icon.Help
                        OnSelect: |-
                            =Launch("https://learn.microsoft.com/power-pages/configure/power-platform-cli-tutorial#upload-the-changes-using-deployment-profile")
                        PressedBorderColor: =ColorFade(iconPortalSettingsHelp.BorderColor, -20%)
                        PressedColor: =ColorFade(iconPortalSettingsHelp.Color, -20%)
                        PressedFill: =ColorFade(iconPortalSettingsHelp.Fill, -20%)
                        Tooltip: ="When working with multiple different environments, you may consider using deployment profiles to ensure the changes are uploaded to the correct environment using deployment profile. Click to learn about deployment profile."
                        Width: =26
                        X: =188
                        Y: =17
                        ZIndex: =5

                    lblPortalConfigValidation As label:
                        Height: =42
                        Size: =13
                        Text: ="(Only '.yml' file types are allowed. Maximum file size 5 MB.)"
                        Width: =500
                        X: =214
                        Y: =10
                        ZIndex: =6

            btnUploadPortalSettingsFile As button:
                AlignInContainer: =AlignInContainer.End
                DisplayMode: |-
                    =If(
                        CountRows(PortalSettingsFileValue.Attachments) > 0,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                Height: =45
                HoverBorderColor: =ColorFade(btnUploadPortalSettingsFile.BorderColor, 20%)
                HoverColor: =ColorFade(btnUploadPortalSettingsFile.Color, 20%)
                HoverFill: =ColorFade(btnUploadPortalSettingsFile.Fill, 20%)
                OnSelect: |-
                    =SubmitForm(formUserSettings);
                    Notify(
                        "File has been uploaded successfully",
                        NotificationType.Success
                    );
                    // Read the file and set the 'File Content' column
                    //ReadDataverseFileColumn.Run(locEnvironmentDeploymentSetting.'User Setting');
                PressedBorderColor: =btnUploadPortalSettingsFile.Fill
                PressedColor: =btnUploadPortalSettingsFile.Fill
                PressedFill: =btnUploadPortalSettingsFile.Color
                Text: ="Upload File"
                Visible: =CountRows(PortalSettingsFileValue.Attachments) > 0
                Width: =200
                X: =762
                Y: =483
                ZIndex: =3

            lblValidationNoUserSettings As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Semibold
                Text: ="In order to attach the 'Portal Setting' file, you will need to save the 'Deployment Settings' at least once."
                Visible: =IsBlank(locEnvironmentDeploymentSetting)
                Width: =Parent.Width
                ZIndex: =4

        lblDeployPortals As label:
            FontWeight: =If(showPortalConfig, FontWeight.Bold, FontWeight.Semibold)
            Height: =24
            OnSelect: =
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Power Pages"
            Width: =130
            X: =1041
            Y: =219
            ZIndex: =53

        lblDeployGroupTeamSkipDelete As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Height: =37
            OnSelect: =FontWeight.Semibold
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Skip Role Deletion"
            Visible: =showGroupTeamsSettings && !IsEmpty(glrGroupTeams.AllItems)
            Width: =164
            X: =1656
            Y: =249
            ZIndex: =54

        iconHelpSkipRoles As icon.Help:
            BorderColor: =ColorFade(iconHelpSkipRoles.Fill, -20%)
            DisabledFill: =ColorFade(iconHelpSkipRoles.Fill, -80%)
            Height: =24
            HoverBorderColor: =ColorFade(iconHelpSkipRoles.BorderColor, 20%)
            HoverColor: =ColorFade(iconHelpSkipRoles.Color, 20%)
            HoverFill: =ColorFade(iconHelpSkipRoles.Fill, 20%)
            Icon: =Icon.Help
            PressedBorderColor: =ColorFade(iconHelpSkipRoles.BorderColor, -20%)
            PressedColor: =ColorFade(iconHelpSkipRoles.Color, -20%)
            PressedFill: =ColorFade(iconHelpSkipRoles.Fill, -20%)
            Tooltip: ="Check 'Skip Role Deletion' in order to maintain any existing roles in the downstream environment. If you want to delete all existing roles then uncheck this option"
            Visible: =showGroupTeamsSettings && !IsEmpty(glrGroupTeams.AllItems)
            Width: =50
            X: =1806
            Y: =253
            ZIndex: =55

        icoPortalConfigs As icon.Add:
            AccessibleLabel: ="Webhook URL Variables"
            BorderColor: =ColorFade(icoPortalConfigs.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledFill: =ColorFade(icoPortalConfigs.Fill, -80%)
            FocusedBorderThickness: =
            Height: =24
            HoverBorderColor: =ColorFade(icoPortalConfigs.BorderColor, 20%)
            HoverColor: =ColorFade(icoPortalConfigs.Color, 20%)
            HoverFill: =ColorFade(icoPortalConfigs.Fill, 20%)
            Icon: =
            OnSelect: |
                =UpdateContext(
                    {
                        showConnectionReferenceSettings: false,
                        showEnvironmentVariablesSettings: false,
                        showOwnerSettings: false,
                        showSharingSettings: false,
                        showConnectorSettings: false,
                        showGroupTeamsSettings: false,
                        showWebHookURLs: false,
                        showPortalConfig: true,
                        showSDKMessage: false        
                    }
                );
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =5
            PaddingTop: =8
            PressedBorderColor: =ColorFade(icoPortalConfigs.BorderColor, -20%)
            PressedColor: =ColorFade(icoPortalConfigs.Color, -20%)
            PressedFill: =ColorFade(icoPortalConfigs.Fill, -20%)
            Tooltip: ="Set Power Pages Configuration for the Target Environment."
            Width: =lblDeployPortals.Width
            X: =lblDeployPortals.X
            Y: =219
            ZIndex: =56

        lblSDKMessages As label:
            FontWeight: =If(showSDKMessage, FontWeight.Bold, FontWeight.Semibold)
            Height: =24
            OnSelect: =
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Plugin Steps"
            Width: =120
            X: =1161
            Y: =219
            ZIndex: =57

        icoSDKMessages As icon.Add:
            AccessibleLabel: ="Webhook URL Variables"
            BorderColor: =ColorFade(icoSDKMessages.Fill, -20%)
            Color: =PrimaryColor2Value
            DisabledFill: =ColorFade(icoSDKMessages.Fill, -80%)
            FocusedBorderThickness: =
            Height: =24
            HoverBorderColor: =ColorFade(icoSDKMessages.BorderColor, 20%)
            HoverColor: =ColorFade(icoSDKMessages.Color, 20%)
            HoverFill: =ColorFade(icoSDKMessages.Fill, 20%)
            Icon: =
            OnSelect: |
                =UpdateContext(
                    {
                        showConnectionReferenceSettings: false,
                        showEnvironmentVariablesSettings: false,
                        showOwnerSettings: false,
                        showSharingSettings: false,
                        showConnectorSettings: false,
                        showGroupTeamsSettings: false,
                        showWebHookURLs: false,
                        showPortalConfig: false,
                        showSDKMessage: true        
                    }
                );
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =5
            PaddingTop: =8
            PressedBorderColor: =ColorFade(icoSDKMessages.BorderColor, -20%)
            PressedColor: =ColorFade(icoSDKMessages.Color, -20%)
            PressedFill: =ColorFade(icoSDKMessages.Fill, -20%)
            Tooltip: ="Set Plugin Steps Secure and Unsecure Configurations."
            Width: =120
            X: =1161
            Y: =219
            ZIndex: =58

        lblHeaderSecuredConfig As label:
            FontWeight: =FontWeight.Semibold
            Height: =34
            OnSelect: =FontWeight.Semibold
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Secured Configuration"
            Visible: =showSDKMessage && !IsEmpty(glrSDKMesages.AllItems)
            Width: =245
            X: =1395
            Y: =254
            ZIndex: =60

        lblHeaderUnsecuredConfig As label:
            FontWeight: =FontWeight.Semibold
            Height: =34
            OnSelect: =FontWeight.Semibold
            PaddingLeft: =0
            PaddingTop: =0
            Text: ="Unsecured Configuration"
            Visible: =showSDKMessage && !IsEmpty(glrSDKMesages.AllItems)
            Width: =245
            X: =753
            Y: =254
            ZIndex: =61

        loaderSolutionComponents As Preloader:
            Height: =844
            IsLoading: =showSolutionComponentLoader
            SpinnerColorHex: =LookUp(loaderSolutionComponents.Styles, Name = "PrimaryColor2Value").Value
            Styles: =ComponentStyles
            Text: =SolutionLoaderText
            Visible: =loaderSolutionComponents.IsLoading
            Width: =1920
            Y: =204
            ZIndex: =62

        loaderDeploymentEnvironment As Preloader:
            Height: =984
            IsLoading: =showDeploymentSettingsLoader
            SpinnerColorHex: =LookUp(loaderDeploymentEnvironment.Styles, Name = "PrimaryColor2Value").Value
            Styles: =ComponentStyles
            Text: =DeploymentSettingsLoadingText
            Visible: =loaderDeploymentEnvironment.IsLoading
            Width: =1920
            Y: =64
            ZIndex: =63

    btnFunctionsDeploy As groupContainer:
        Height: =320
        Visible: =false
        Width: =564
        X: =1
        Y: =760
        ZIndex: =2

        fncLoadEnvironmentDeploymentSettings As button:
            Height: =28
            HoverBorderColor: =ColorFade(fncLoadEnvironmentDeploymentSettings.BorderColor, 20%)
            HoverColor: =ColorFade(fncLoadEnvironmentDeploymentSettings.Color, 20%)
            HoverFill: =ColorFade(fncLoadEnvironmentDeploymentSettings.Fill, 20%)
            OnSelect: |-
                =IfError(
                    UpdateContext(
                        {
                            showSolutionComponentLoader: true,
                            DeploymentSettingsLoadingText: "LOADING DEPLOYMENT ENVIRONMENT CONFIGURATION...",
                            SolutionLoaderText: "LOADING DEPLOYMENT ENVIRONMENT CONFIGURATION...",
                            solutionupgradetag: "false"
                        }
                    );
                    If(
                        IsBlank(drpDeployEnvironments.Selected),
                        UpdateContext({SelectedDeploymentEnvironment: First(DeploymentEnvironments)}),
                        UpdateContext({SelectedDeploymentEnvironment: drpDeployEnvironments.Selected})
                    );
                    If(
                        Not IsBlank(SelectedDeploymentEnvironment),
                        UpdateContext({locSolutionEnvironmentDeploySettingName: DeploymentSettingName & " - " & SelectedSolutionToConfigure.uniquename & " - " & SelectedDeploymentEnvironment.EnvironmentUrl});
                        UpdateContext(
                            {
                                locEnvironmentDeploymentSetting: LookUp(
                                    'User Settings',
                                    Name = locSolutionEnvironmentDeploySettingName
                                )
                            }
                        );
                        If(
                            IsBlank(locEnvironmentDeploymentSetting.Data),
                            UpdateContext({EnvironmentDeploymentSettings: ParseDeploymentSettings.Run("[]")}),
                            UpdateContext({EnvironmentDeploymentSettings: ParseDeploymentSettings.Run(locEnvironmentDeploymentSetting.Data)})
                        );
                        UpdateContext(
                            {
                                locSharepointFilter: Concat(
                                    ForAll(
                                        Distinct(
                                            Filter(
                                                EnvironmentDeploymentSettings,
                                                StartsWith(
                                                    Name,
                                                    "environmentvariable."
                                                ) And !IsBlankOrError(Value) And !IsBlank(
                                                    Find(
                                                        "sharepoint",
                                                        Value
                                                    )
                                                )
                                            ),
                                            Value
                                        ),
                                        {Result: ThisRecord.Value}
                                    ),
                                    "site:" & Result,
                                    " OR "
                                ),
                                locAADGroupFilters: Concat(
                                    ForAll(
                                        Distinct(
                                            Filter(
                                                EnvironmentDeploymentSettings,
                                                (StartsWith(
                                                    Name,
                                                    "canvasshare.aadGroupId."
                                                ) Or StartsWith(
                                                    Name,
                                                    "groupteam."
                                                )) And !IsBlankOrError(Value)
                                            ),
                                            Value
                                        ),
                                        {Result: ThisRecord.Value}
                                    ),
                                    "id eq '" & Result & "'",
                                    " OR "
                                )
                            }
                        );
                        UpdateContext(
                            {
                                solutionupgradetag: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "TriggerSolutionUpgrade"
                                ).Value,
                                deployunmanagedtag: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "IsUnmanaged"
                                ).Value
                            }
                        );
                        Concurrent(
                            ClearCollect(
                                EnvironmentTeams,
                                SearchDeploymentEnvironmentTeams.Run(
                                    Last(
                                        FirstN(
                                            ForAll(
                                                Split(
                                                    SelectedDeploymentEnvironment.EnvironmentUrl,
                                                    "."
                                                ),
                                                {Result: ThisRecord.Value}
                                            ),
                                            2
                                        )
                                    ).Result,
                                    LookUp(
                                        AllEnvironments,
                                        SelectedDeploymentEnvironment.EnvironmentUrl in properties.linkedEnvironmentMetadata.instanceUrl
                                    ).properties.linkedEnvironmentMetadata.uniqueName,
                                    {
                                        text_3: "",
                                        text_4: ""
                                    }
                                )
                            ),
                            ClearCollect(
                                EnvironmentBusinessUnits,
                                SearchDeploymentEnvironmentBUnits.Run(
                                    Last(
                                        FirstN(
                                            ForAll(
                                                Split(
                                                    SelectedDeploymentEnvironment.EnvironmentUrl,
                                                    "."
                                                ),
                                                {Result: ThisRecord.Value}
                                            ),
                                            2
                                        )
                                    ).Result,
                                    LookUp(
                                        AllEnvironments,
                                        SelectedDeploymentEnvironment.EnvironmentUrl in properties.linkedEnvironmentMetadata.instanceUrl
                                    ).properties.linkedEnvironmentMetadata.uniqueName
                                )
                            ),
                            ClearCollect(
                                EnvironmentCustomConnectors,
                                SearchDeploymentEnvironmentConnectors.Run(
                                    Last(
                                        FirstN(
                                            ForAll(
                                                Split(
                                                    SelectedDeploymentEnvironment.EnvironmentUrl,
                                                    "."
                                                ),
                                                {Result: ThisRecord.Value}
                                            ),
                                            2
                                        )
                                    ).Result,
                                    LookUp(
                                        AllEnvironments,
                                        SelectedDeploymentEnvironment.EnvironmentUrl in properties.linkedEnvironmentMetadata.instanceUrl
                                    ).properties.linkedEnvironmentMetadata.uniqueName,
                                    {text_3: ""}
                                )
                            ),
                            ClearCollect(
                                AADGroups,
                                SearchAADGroups.Run(
                                    {
                                        text: "",
                                        text_1: If(
                                            IsBlank(locAADGroupFilters),
                                            "",
                                            locAADGroupFilters
                                        )
                                    }
                                ).value
                            ),
                            ClearCollect(
                                SharepointSites,
                                SearchSharepointSites.Run(
                                    {
                                        text: "",
                                        text_1: If(
                                            IsBlank(locSharepointFilter),
                                            "",
                                            locSharepointFilter
                                        )
                                    }
                                ).value
                            )
                        )
                    );
                    ClearCollect(
                        TeamAADGroups,
                        AADGroups
                    );
                    ClearCollect(
                        GroupTeams,
                        AddColumns(
                            Filter(
                                EnvironmentDeploymentSettings,
                                StartsWith(
                                    Name,
                                    "groupteam"
                                )
                            ),
                            "DisplayName",
                            LookUp(
                                EnvironmentDeploymentSettings As eds,
                                eds.Name = "teamname." & Last(
                                    FirstN(
                                        ForAll(
                                            Split(
                                                Name,
                                                "."
                                            ),
                                            {Result: ThisRecord.Value}
                                        ),
                                        2
                                    )
                                ).Result
                            ).Value,
                            "Id",
                            Last(
                                FirstN(
                                    ForAll(
                                        Split(
                                            Name,
                                            "."
                                        ),
                                        {Result: ThisRecord.Value}
                                    ),
                                    2
                                )
                            ).Result,
                            "BusinessUnitId",
                            If(
                                !IsBlankOrError(
                                    LookUp(
                                        EnvironmentDeploymentSettings As eds,
                                        eds.Name = Substitute(
                                            Name,
                                            "groupTeam",
                                            "businessUnit"
                                        )
                                    ).Value
                                ),
                                LookUp(
                                    EnvironmentDeploymentSettings As eds,
                                    eds.Name = Substitute(
                                        Name,
                                        "groupTeam",
                                        "businessUnit"
                                    )
                                ).Value
                            ),
                            "AADGroups",
                            TeamAADGroups,
                            "EnvironmentBusinessUnits",
                            EnvironmentBusinessUnits,
                            "FilterVisible",
                            false,
                            "FilterIcon",
                            Icon.FilterFlat,
                            "SelectedRoles",
                            Data,
                            "SkipRoleDeletion",
                            true
                        )
                    );
                    // Add an empty row & Sort SharePoint sites
                Collect(
                        SharepointSites,
                        {webUrl: ""}
                    );
                    ClearCollect(
                        SharepointSites,
                        Sort(
                            SharepointSites,
                            webUrl
                        )
                    );
                    ClearCollect(
                        SharepointSitesSorted,// Used to update collection SolutionEnvironmentVariables
                        SharepointSites
                    );
                    Clear(GroupTeamSelectedRoles);
                    ForAll(
                        GroupTeams As gt,
                        If(
                            IsBlankOrError(
                                LookUp(
                                    EnvironmentTeams,
                                    name = gt.Name
                                )
                            ),
                            Collect(
                                EnvironmentTeams,
                                {
                                    name: gt.DisplayName,
                                    teamid: gt.Id
                                }
                            );
                        );
                        ForAll(
                            ForAll(
                                Split(
                                    gt.SelectedRoles,
                                    ","
                                ),
                                {Result: ThisRecord.Value}
                            ),
                            Collect(
                                GroupTeamSelectedRoles,
                                AddColumns(
                                    Filter(
                                        SolutionSecurityRoles,
                                        name = Result
                                    ),
                                    "GroupTeamId",
                                    gt.Id
                                )
                            )
                        );
                    );
                    
                //Add an empty row to EnvironmentTeams
                Collect(
                        EnvironmentTeams,
                        {name: ""}
                    );
                    ClearCollect(
                        EnvironmentTeams,
                        Sort(
                            EnvironmentTeams,
                            name,
                            SortOrder.Ascending
                        )
                    );
                    
                //Add an empty row to EnvironmentUsers
                Collect(
                        EnvironmentUsers,
                        {internalemailaddress: ""}
                    );
                    ClearCollect(
                        EnvironmentUsers,
                        Sort(
                            EnvironmentUsers,
                            internalemailaddress,
                            SortOrder.Ascending
                        )
                    );
                    ClearCollect(
                        EnvironmentConnections,
                        AddColumns(
                            PowerAppsforMakers.GetConnections(
                                {
                                    '$filter': "environment eq '" & LookUp(
                                        AllEnvironments,
                                        SelectedDeploymentEnvironment.EnvironmentUrl in properties.linkedEnvironmentMetadata.instanceUrl,
                                        name
                                    ) & "'",
                                    'api-version': "2016-11-01",
                                    '$top': 500
                                }
                            ).value,
                            "DisplayName",
                            properties.displayName,
                            "ConnectionId",
                            name,
                            "ApiId",
                            properties.apiId,
                            "IconUrl",
                            properties.iconUri,
                            "Status",
                            First(properties.statuses).status,
                            "UserId",
                            properties.createdBy.id
                        )
                    );
                    Concurrent(
                        UpdateIf(
                            SolutionConnectionReferences,
                            true,
                            {
                                CurrentValue: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "connectionreference." & connectionreferencelogicalname
                                ).Value,
                                UserId: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "connectionreference.user." & connectionreferencelogicalname
                                ).Value,
                                Shared: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "connectionreference.shared." & connectionreferencelogicalname
                                ).Value,
                                ManualEntry: If(
                                    LookUp(
                                        EnvironmentDeploymentSettings,
                                        Name = "connectionreference." & connectionreferencelogicalname
                                    ).Value in EnvironmentConnections.ConnectionId Or IsBlankOrError(
                                        LookUp(
                                            EnvironmentDeploymentSettings,
                                            Name = "connectionreference." & connectionreferencelogicalname
                                        ).Value
                                    ),
                                    false,
                                    true
                                )
                            }
                        ),
                        UpdateIf(
                            SolutionWebHookURLs,
                            true,
                            {
                                CurrentValue: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "webhookurl." & name
                                ).Value
                            }
                        ),
                        UpdateIf(
                            SolutionSDKSteps,
                            true,
                            {
                                UnsecureConfig: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "sdkstep.unsec." & ItemInternalId
                                ).Value,
                                SecureConfig: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "sdkstep.sec." & ItemInternalId
                                ).Value
                            }
                        ),
                        UpdateIf(
                            SolutionEnvironmentVariables,
                            true,
                            {
                                CurrentValue: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "environmentvariable." & schemaname
                                ).Value,
                                SharepointSites: SharepointSitesSorted
                            }
                        ),
                        UpdateIf(
                            SolutionCanvasApps,
                            true,
                            {
                                CurrentValue: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "canvasshare.aadGroupId." & name
                                ).Value,
                                CurrentPermission: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "canvasshare.roleName." & name
                                ).Value
                            }
                        ),
                        UpdateIf(
                            SolutionFlows,
                            true,
                            {
                                CurrentValue: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "owner.ownerEmail." & Substitute(
                                        name,
                                        " ",
                                        ""
                                    ) & "." & workflowid
                                ).Value,
                                //EnvironmentUsers: EnvironmentUsers,
                                ActivationCurrentValue: "",
                                //ActivationEnvironmentUsers: EnvironmentUsers,
                                SharingCurrentValue: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "flow.sharing." & Substitute(
                                        name,
                                        " ",
                                        ""
                                    ) & "." & workflowid
                                ).Value,
                                SortOrder: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "activateflow.order." & Substitute(
                                        name,
                                        " ",
                                        ""
                                    ) & "." & workflowid
                                ).Value,
                                Activate: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "activateflow.activate." & Substitute(
                                        name,
                                        " ",
                                        ""
                                    ) & "." & workflowid
                                ).Value
                            }
                        ),
                        UpdateIf(
                            CustomConnectors,
                            true,
                            {
                                CurrentValue: LookUp(
                                    EnvironmentDeploymentSettings,
                                    Name = "connector.teamname." & Substitute(
                                        displayname,
                                        " ",
                                        ""
                                    ) & "." & connectorid
                                ).Value
                            }
                        )
                    );
                    RemoveIf(
                        SolutionCanvasApps,
                        IsCopy
                    );
                    ClearCollect(
                        tmpSolutionCanvasApps,
                        SolutionCanvasApps
                    );
                    ForAll(
                        tmpSolutionCanvasApps As lclApp,
                        ForAll(
                            Filter(
                                EnvironmentDeploymentSettings,
                                StartsWith(
                                    Name,
                                    "canvasshare.aadGroupId." & lclApp.name & "."
                                )
                            ) As lclCanvasDeploymentSetting,
                            Collect(
                                SolutionCanvasApps,
                                {
                                    _componentstate_label: lclApp._componentstate_label,
                                    name: lclApp.name,
                                    displayname: lclApp.displayname,
                                    IsCopy: true,
                                    AADGroups: lclApp.AADGroups,
                                    FilterIcon: Icon.FilterFlat,
                                    FilterVisible: false,
                                    Suffix: "." & Last(
                                        ForAll(
                                            Split(
                                                lclCanvasDeploymentSetting.Name,
                                                "."
                                            ),
                                            {Result: ThisRecord.Value}
                                        )
                                    ).Result,
                                    CurrentValue: lclCanvasDeploymentSetting.Value,
                                    CurrentPermission: LookUp(
                                        EnvironmentDeploymentSettings,
                                        Name = Substitute(
                                            lclCanvasDeploymentSetting.Name,
                                            "aadGroupId",
                                            "roleName"
                                        )
                                    ).Value
                                }
                            );
                        )
                    );
                    ClearCollect(
                        lclSolutionFlowsTemp,
                        SolutionFlows
                    );
                    ForAll(
                        lclSolutionFlowsTemp As sf,
                        If(
                            IsBlankOrError(sf.SortOrder),
                            Patch(
                                SolutionFlows,
                                LookUp(
                                    SolutionFlows,
                                    sf.workflowid = workflowid
                                ),
                                {
                                    SortOrder: CountIf(
                                        SolutionFlows,
                                        !IsBlankOrError(SortOrder)
                                    ) + 1
                                }
                            )
                        )
                    );
                    
                //Add any connections that the current user doesn't have permissions to access
                ClearCollect(
                        locUnsharedConnections,
                        Filter(
                            SolutionConnectionReferences,
                            !IsBlankOrError(CurrentValue) And !(CurrentValue in EnvironmentConnections.ConnectionId)
                        )
                    );
                    If(
                        CountRows(locUnsharedConnections) > 0,
                        UpdateContext(
                            {
                                locConnectorSearchCriteria: Concat(
                                    ForAll(
                                        Distinct(
                                            locUnsharedConnections,
                                            connectorid
                                        ),
                                        {Result: ThisRecord.Value}
                                    ),
                                    "id eq '" & Result & "' or "
                                )
                            }
                        );
                        UpdateContext(
                            {
                                locConnectorSearchCriteria: Left(
                                    locConnectorSearchCriteria,
                                    Len(locConnectorSearchCriteria) - 3
                                )
                            }
                        );
                        ClearCollect(
                            locConnectors,
                            PowerAppsforMakers.GetConnectors({'$filter': "environment eq '" & SelectedEnvironment.name & "' and " & locConnectorSearchCriteria}).value
                        );
                        ForAll(
                            locUnsharedConnections,
                            If(
                                IsEmpty(
                                    Filter(
                                        EnvironmentConnections,
                                        ConnectionId = CurrentValue
                                    )
                                ),
                                Collect(
                                    EnvironmentConnections,
                                    {
                                        ApiId: connectorid,
                                        ConnectionId: CurrentValue,
                                        UserId: UserId,
                                        DisplayName: "Existing Unknown Connection",
                                        Status: "Unknown",
                                        IconUrl: First(
                                            Filter(
                                                locConnectors,
                                                id = connectorid
                                            )
                                        ).properties.iconUri
                                    }
                                )
                            )
                        )
                    );
                    Clear(SharepointLists);
                    ForAll(
                        Filter(
                            SolutionEnvironmentVariables,
                            type = 100000004 And parameterkey = "dataset"
                        ),
                        If(
                            Not IsBlank(CurrentValue) And Not IsBlank(
                                First(
                                    Filter(
                                        SharepointSites,
                                        webUrl = CurrentValue
                                    )
                                ).id
                            ),
                            Collect(
                                SharepointLists,
                                AddColumns(
                                    SearchSharepointLists.Run(
                                        LookUp(
                                            SharepointSites,
                                            webUrl = CurrentValue
                                        ).id
                                    ).value,
                                    "DefinitionId",
                                    environmentvariabledefinitionid
                                )
                            )
                        )
                    );
                    UpdateContext({resetEnvironment: false});
                    UpdateContext({resetEnvironment: true});
                    UpdateContext(
                        {
                            showDeploymentSettingsLoader: false,
                            showSolutionComponentLoader: false
                        }
                    );
                    ,
                    UpdateContext({errorMessage: FirstError.Message});
                    Notify("Error reading environment configuration: " & errorMessage);
                    Reset(chkShareAllConnections);
                    
                )
            PressedBorderColor: =fncLoadEnvironmentDeploymentSettings.Fill
            PressedColor: =fncLoadEnvironmentDeploymentSettings.Fill
            PressedFill: =fncLoadEnvironmentDeploymentSettings.Color
            Text: ="fncInitializeHome"
            Width: =560
            X: =4
            Y: =77
            ZIndex: =9

    DeploymentDialogOverlay As rectangle:
        BorderColor: =ColorFade(DeploymentDialogOverlay.Fill, -20%)
        DisabledFill: =DeploymentDialogOverlay.Fill
        Fill: =RGBA(0, 0, 0, .5)
        Height: =1080
        HoverFill: =RGBA(0, 0, 0, .5)
        PressedFill: =ColorFade(DeploymentDialogOverlay.Fill, -20%)
        Visible: =showDeploymentDialogOverlay
        Width: =1920
        ZIndex: =3

    ConnectionRequestDialog As groupContainer:
        Height: =1080
        Visible: =showConnectionRequestDialog
        Width: =550
        X: =1370
        ZIndex: =4

        rctConnectionRequestDialog As rectangle:
            BorderColor: =ColorFade(rctConnectionRequestDialog.Fill, -20%)
            DisabledFill: =rctConnectionRequestDialog.Fill
            Fill: =RGBA(255, 255, 255, 1)
            Height: =1080
            HoverFill: =ColorFade(rctConnectionRequestDialog.Fill, 20%)
            PressedFill: =ColorFade(rctConnectionRequestDialog.Fill, -20%)
            Width: =550
            ZIndex: =1

        lblConnectionRequestDialogTitle As label:
            Align: =LayoutAlignItems.Center
            FontWeight: =FontWeight.Semibold
            Height: =64
            Size: =16
            Text: ="CONNECTION REQUEST"
            Width: =546
            ZIndex: =2

        icoConnectionRequestDialogClose As icon.Cancel:
            AccessibleLabel: ="Close"
            BorderColor: =ColorFade(icoConnectionRequestDialogClose.Fill, -20%)
            DisabledFill: =ColorFade(icoConnectionRequestDialogClose.Fill, -80%)
            Height: =55
            HoverBorderColor: =ColorFade(icoConnectionRequestDialogClose.BorderColor, 20%)
            HoverColor: =ColorFade(icoConnectionRequestDialogClose.Color, 20%)
            HoverFill: =ColorFade(icoConnectionRequestDialogClose.Fill, 20%)
            Icon: =Icon.Cancel
            OnSelect: |-
                =UpdateContext({showDeploymentDialogOverlay:false,showConnectionRequestDialog:false});
                Clear(MyPeople);
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(icoConnectionRequestDialogClose.BorderColor, -20%)
            PressedColor: =ColorFade(icoConnectionRequestDialogClose.Color, -20%)
            PressedFill: =ColorFade(icoConnectionRequestDialogClose.Fill, -20%)
            Width: =55
            X: =495
            Y: =4
            ZIndex: =3

        btnSendRequest As button:
            DisplayMode: |-
                =If(
                    CountRows(glrInvitedUsers.AllItems) = 0,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Height: =45
            HoverBorderColor: =ColorFade(btnSendRequest.BorderColor, 20%)
            HoverColor: =ColorFade(btnSendRequest.Color, 20%)
            HoverFill: =ColorFade(btnSendRequest.Fill, 20%)
            OnSelect: |
                =UpdateContext(
                    {
                        showDeploymentDialogOverlay: false,
                        showConnectionRequestDialog: false
                    }
                );
                ClearCollect(
                    Apps,
                    Filter(
                        PowerAppsforMakers.GetApps(
                            {
                                '$filter': "environment eq '" & ExecutingEnvironment.tags.environmentName & "'",
                                '$top': 1000
                            }
                        ).value,
                        properties.displayName = AppName
                    )
                );
                Launch(
                    "mailto:" & Concat(
                        glrInvitedUsers.AllItems,
                        Mail & ";"
                    ) & "?subject=" & gblUser.FullName & " is requesting your help to re-establish a Power Apps Solution Connection" & "&body=" & "Hello,%0D%0A%0D%0ACan you assist with re-establishing the following connection in " & drpDeployEnvironments.Selected.Name & "%0D%0A%0D%0APlease use the following link to login and re-establish the connection https://web.powerapps.com/apps/" & First(Apps).name & "?profile=" & SelectedConfigurationDeploymentProfile.'Deployment Profile' & "%26step=" & SelectedDeploymentEnvironment.EnvironmentId & "%26env=" & SelectedEnvironment.name & "%26configsoln=" & Text(SelectedSolutionToConfigure.solutionid)
                );
                Clear(MyPeople);
            PressedBorderColor: =btnSendRequest.Fill
            PressedColor: =btnSendRequest.Fill
            PressedFill: =btnSendRequest.Color
            Text: ="SEND"
            Width: =200
            X: =330
            Y: =1015
            ZIndex: =8

        lblPullRequestSolutionFriendlyName_1 As label:
            Align: =LayoutAlignItems.Center
            FontWeight: =FontWeight.Semibold
            Height: =28
            OnSelect: =glrConnectionReferences.Selected.connectionreferencedisplayname
            Size: =16
            Text: =glrConnectionReferences.Selected.connectionreferencedisplayname
            Width: =550
            Y: =58
            ZIndex: =14

        lblConnectionRequestInstructions As label:
            Align: =LayoutAlignItems.Center
            FontWeight: =FontWeight.Semibold
            Height: =62
            PaddingLeft: =0
            Text: ="Use the search below to invite another user to create and / or refresh connections in the target environment."
            Width: =513
            X: =28
            Y: =97
            ZIndex: =15

        LblAppName1 As label:
            Height: =64
            Text: ="People"
            Width: =Parent.Width - Self.X * 2
            Wrap: =false
            X: =32
            ZIndex: =16

        txtConnectionRequestSearch As text:
            AccessibleLabel: ="Search"
            Align: =TextPosition.Left
            Default: =""
            Height: =48
            HintText: ="Enter a name or email address"
            HoverBorderColor: =ColorFade(txtConnectionRequestSearch.BorderColor, 20%)
            HoverColor: =ColorFade(txtConnectionRequestSearch.Color, 20%)
            HoverFill: =ColorFade(txtConnectionRequestSearch.Fill, 20%)
            PaddingLeft: =70
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =550
            Y: =187
            ZIndex: =17

        SearchIcon1 As icon.Search:
            BorderColor: =ColorFade(SearchIcon1.Fill, -20%)
            DisabledFill: =ColorFade(SearchIcon1.Fill, -80%)
            Height: =38
            HoverBorderColor: =ColorFade(SearchIcon1.BorderColor, 20%)
            HoverColor: =ColorFade(SearchIcon1.Color, 20%)
            HoverFill: =ColorFade(SearchIcon1.Fill, 20%)
            Icon: =Icon.Search
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =8
            PaddingTop: =8
            PressedBorderColor: =ColorFade(SearchIcon1.BorderColor, -20%)
            PressedColor: =ColorFade(SearchIcon1.Color, -20%)
            PressedFill: =ColorFade(SearchIcon1.Fill, -20%)
            Tooltip: ="Search"
            Width: =43
            X: =24
            Y: =190
            ZIndex: =18

        glrConnectionRequestBrowseUsers As gallery.PeoplePickerTabletGallery:
            AccessibleLabel: ="User look up search results"
            BorderColor: =PrimaryColor3Value
            Fill: =Parent.Fill
            Height: =364
            Items: |-
                =If(!IsBlank(Trim(txtConnectionRequestSearch.Text)), Office365Users.SearchUser({searchTerm: Trim(txtConnectionRequestSearch.Text), top: 15}))
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =87
            Width: =550
            Y: =228
            ZIndex: =23

            iconUser1 As icon.Person:
                AccessibleLabel: ="User"
                BorderColor: =ColorFade(iconUser1.Color, -20%)
                Color: =PrimaryColor1Value
                Fill: =PrimaryColor1Value
                Height: =connectionRequestUserImage.Height
                Icon: =Icon.Person
                OnSelect: =Select(connectionRequestUserName)
                PaddingBottom: =12
                PaddingLeft: =12
                PaddingRight: =12
                PaddingTop: =12
                PressedFill: =ColorFade(iconUser1.Color, -20%)
                Width: =connectionRequestUserImage.Width
                X: =connectionRequestUserImage.X
                Y: =connectionRequestUserImage.Y
                ZIndex: =2

            connectionRequestUserImage As image:
                AccessibleLabel: ="User"
                BorderColor: =ColorFade(connectionRequestUserImage.Fill, -20%)
                FocusedBorderThickness: =2
                Height: =Self.Width
                HoverBorderColor: =ColorFade(connectionRequestUserImage.BorderColor, 20%)
                HoverFill: =ColorFade(connectionRequestUserImage.Fill, 20%)
                Image: =If(!IsBlank(ThisItem.Id), Office365Users.UserPhotoV2(ThisItem.Id))
                OnSelect: =Select(connectionRequestUserName)
                PressedBorderColor: =ColorFade(connectionRequestUserImage.BorderColor, -20%)
                PressedFill: =ColorFade(connectionRequestUserImage.Fill, -20%)
                Width: =glrConnectionRequestBrowseUsers.TemplateHeight - 10
                X: =28
                Y: =10
                ZIndex: =3

            connectionRequestUserName As label:
                BorderColor: =Self.Color
                FocusedBorderThickness: =2
                FontWeight: =FontWeight.Semibold
                Height: =Self.Size * 1.8
                OnSelect: |-
                    =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                    Concurrent(
                        Reset(txtConnectionRequestSearch),
                        If(
                            Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName),
                            Collect(
                                MyPeople,
                                ThisItem
                            )
                        )
                    )
                Size: =12
                TabIndex: =0
                Text: =ThisItem.DisplayName
                Width: =glrConnectionRequestBrowseUsers.TemplateWidth - 232
                Wrap: =false
                X: =connectionRequestUserImage.X + connectionRequestUserImage.Width + 16
                Y: =16
                ZIndex: =4

            connectionRequestUserEmail As label:
                FocusedBorderThickness: =2
                Height: =Self.Size * 1.8
                OnSelect: =Select(connectionRequestUserName)
                Size: =12
                Text: =ThisItem.Mail
                Width: =connectionRequestUserName.Width
                Wrap: =false
                X: =connectionRequestUserName.X
                Y: =glrConnectionRequestBrowseUsers.TemplateHeight - Self.Height - 20
                ZIndex: =5

            Separator5 As rectangle:
                BorderColor: =ColorFade(Separator5.Fill, -20%)
                DisabledFill: =Separator5.Fill
                Height: =1
                HoverFill: =ColorFade(Separator5.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedFill: =ColorFade(Separator5.Fill, -20%)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =6

            icoSelectUser As icon.Cancel:
                AccessibleLabel: ="Select User"
                BorderColor: =ColorFade(icoSelectUser.Fill, -20%)
                DisabledFill: =ColorFade(icoSelectUser.Fill, -80%)
                Height: =77
                HoverBorderColor: =ColorFade(icoSelectUser.BorderColor, 20%)
                HoverColor: =ColorFade(icoSelectUser.Color, 20%)
                HoverFill: =ColorFade(icoSelectUser.Fill, 20%)
                Icon: =
                OnSelect: =Select(connectionRequestUserName)
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                PressedBorderColor: =ColorFade(icoSelectUser.BorderColor, -20%)
                PressedColor: =ColorFade(icoSelectUser.Color, -20%)
                PressedFill: =ColorFade(icoSelectUser.Fill, -20%)
                Width: =549
                X: =1
                Y: =10
                ZIndex: =7

        glrInvitedUsers As gallery.PeoplePickerTabletGallery:
            AccessibleLabel: ="User look up search results"
            BorderColor: =PrimaryColor3Value
            Fill: =Parent.Fill
            Height: =314
            Items: =MyPeople
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =87
            Width: =550
            Y: =662
            ZIndex: =24

            Rectangle2_1 As rectangle:
                BorderColor: =PrimaryColor2Value
                DisabledFill: =Rectangle2_1.Fill
                Fill: =RGBA(0,0,0,0)
                FocusedBorderThickness: =2
                Height: =Parent.TemplateHeight - 2*Self.Y
                HoverFill: =RGBA(0,0,0,0)
                OnSelect: =Select(connectionInvitedUserName)
                PressedFill: =ColorFade(Rectangle2_1.Fill, -20%)
                Width: =Parent.TemplateWidth - 2*Self.X
                X: =1
                Y: =1
                ZIndex: =1

            iconUser1_1 As icon.Person:
                AccessibleLabel: ="User"
                BorderColor: =ColorFade(iconUser1_1.Color, -20%)
                Color: =PrimaryColor1Value
                Fill: =PrimaryColor1Value
                Height: =connectionRequestUserImage_1.Height
                Icon: =Icon.Person
                OnSelect: =Select(connectionInvitedUserName)
                PaddingBottom: =12
                PaddingLeft: =12
                PaddingRight: =12
                PaddingTop: =12
                PressedFill: =ColorFade(iconUser1_1.Color, -20%)
                Width: =connectionRequestUserImage_1.Width
                X: =connectionRequestUserImage_1.X
                Y: =connectionRequestUserImage_1.Y
                ZIndex: =2

            connectionRequestUserImage_1 As image:
                BorderColor: =ColorFade(connectionRequestUserImage_1.Fill, -20%)
                FocusedBorderThickness: =2
                Height: =Self.Width
                HoverBorderColor: =ColorFade(connectionRequestUserImage_1.BorderColor, 20%)
                HoverFill: =ColorFade(connectionRequestUserImage_1.Fill, 20%)
                Image: =If(!IsBlank(ThisItem.Id), Office365Users.UserPhotoV2(ThisItem.Id))
                OnSelect: =
                PressedBorderColor: =ColorFade(connectionRequestUserImage_1.BorderColor, -20%)
                PressedFill: =ColorFade(connectionRequestUserImage_1.Fill, -20%)
                Width: =glrInvitedUsers.TemplateHeight - 10
                X: =28
                Y: =(glrInvitedUsers.TemplateHeight / 2) - (Self.Height/2)
                ZIndex: =3

            connectionInvitedUserName As label:
                BorderColor: =Self.Color
                FocusedBorderThickness: =2
                FontWeight: =FontWeight.Semibold
                Height: =Self.Size * 1.8
                OnSelect: |-
                    =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                    Concurrent(
                    Reset(txtConnectionRequestSearch),
                    If(Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName), Collect(MyPeople, ThisItem)))
                Size: =12
                TabIndex: =0
                Text: =ThisItem.DisplayName
                Width: =glrInvitedUsers.TemplateWidth - 232
                Wrap: =false
                X: =connectionRequestUserImage_1.X + connectionRequestUserImage_1.Width + 16
                Y: =16
                ZIndex: =4

            connectionInvitedUserEmail As label:
                FocusedBorderThickness: =2
                Height: =Self.Size * 1.8
                OnSelect: =Select(connectionInvitedUserName)
                Size: =12
                Text: =ThisItem.Mail
                Width: =connectionInvitedUserName.Width
                Wrap: =false
                X: =connectionInvitedUserName.X
                Y: =glrInvitedUsers.TemplateHeight - Self.Height - 20
                ZIndex: =5

            Separator5_1 As rectangle:
                BorderColor: =ColorFade(Separator5_1.Fill, -20%)
                DisabledFill: =Separator5_1.Fill
                Height: =1
                HoverFill: =ColorFade(Separator5_1.Fill, 20%)
                OnSelect: =Select(Parent)
                PressedFill: =ColorFade(Separator5_1.Fill, -20%)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =6

            icoConnectionRequestRemoveUser As icon.Cancel:
                AccessibleLabel: ="Remove User"
                BorderColor: =ColorFade(icoConnectionRequestRemoveUser.Fill, -20%)
                DisabledFill: =ColorFade(icoConnectionRequestRemoveUser.Fill, -80%)
                Height: =55
                HoverBorderColor: =ColorFade(icoConnectionRequestRemoveUser.BorderColor, 20%)
                HoverColor: =ColorFade(icoConnectionRequestRemoveUser.Color, 20%)
                HoverFill: =ColorFade(icoConnectionRequestRemoveUser.Fill, 20%)
                Icon: =Icon.Cancel
                OnSelect: =Remove(MyPeople, LookUp(MyPeople, UserPrincipalName = ThisItem.UserPrincipalName))
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                PressedBorderColor: =ColorFade(icoConnectionRequestRemoveUser.BorderColor, -20%)
                PressedColor: =ColorFade(icoConnectionRequestRemoveUser.Color, -20%)
                PressedFill: =ColorFade(icoConnectionRequestRemoveUser.Fill, -20%)
                Width: =55
                X: =483
                Y: =17
                ZIndex: =7

        lblInvitedUserTitle As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Height: =28
            Size: =16
            Text: ="Invited Users"
            Width: =550
            Y: =622
            ZIndex: =25

        RectSeparator2_1 As rectangle:
            BorderColor: =ColorFade(RectSeparator2_1.Fill, -20%)
            DisabledFill: =RectSeparator2_1.Fill
            Height: =1
            HoverFill: =ColorFade(RectSeparator2_1.Fill, 20%)
            PressedFill: =ColorFade(RectSeparator2_1.Fill, -20%)
            Width: =Parent.Width
            Y: =235
            ZIndex: =26

        RectSeparator2_2 As rectangle:
            BorderColor: =ColorFade(RectSeparator2_2.Fill, -20%)
            DisabledFill: =RectSeparator2_2.Fill
            Height: =1
            HoverFill: =ColorFade(RectSeparator2_2.Fill, 20%)
            PressedFill: =ColorFade(RectSeparator2_2.Fill, -20%)
            Width: =Parent.Width
            Y: =655
            ZIndex: =27

        lblNoUsersSelected As label:
            Align: =LayoutAlignItems.Center
            FontWeight: =FontWeight.Semibold
            Height: =62
            PaddingLeft: =0
            Text: ="No users have been invited. Search for a user to add them to the invitation."
            Visible: =CountRows(glrInvitedUsers.AllItems) = 0
            Width: =513
            X: =18
            Y: =674
            ZIndex: =28

